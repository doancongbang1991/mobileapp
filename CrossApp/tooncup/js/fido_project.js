!function(t){function e(t){var e=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.src=p.p+""+t+"."+_+".hot-update.js",e.appendChild(i)}function i(t){if("undefined"==typeof XMLHttpRequest)return t(new Error("No browser support"));try{var e=new XMLHttpRequest,i=p.p+""+_+".hot-update.json";e.open("GET",i,!0),e.timeout=1e4,e.send(null)}catch(r){return t(r)}e.onreadystatechange=function(){if(4===e.readyState)if(0===e.status)t(new Error("Manifest request to "+i+" timed out."));else if(404===e.status)t();else if(200!==e.status&&304!==e.status)t(new Error("Manifest request to "+i+" failed."));else{try{var r=JSON.parse(e.responseText)}catch(n){return void t(n)}t(null,r)}}}function r(t){function e(t,e){"ready"===T&&o("prepare"),E++,p.e(t,function(){function i(){E--,"prepare"===T&&(C[t]||l(t),0===E&&0===M&&c())}try{e.call(null,r)}finally{i()}})}var i=P[t];if(!i)return p;var r=function(e){return i.hot.active?P[e]?(P[e].parents.indexOf(t)<0&&P[e].parents.push(t),i.children.indexOf(e)<0&&i.children.push(e)):w=[t]:w=[],p(e)};for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&(f?Object.defineProperty(r,n,function(t){return{configurable:!0,enumerable:!0,get:function(){return p[t]},set:function(e){p[t]=e}}}(n)):r[n]=p[n]);return f?Object.defineProperty(r,"e",{enumerable:!0,value:e}):r.e=e,r}function n(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],active:!0,accept:function(t,i){if("undefined"==typeof t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var r=0;r<t.length;r++)e._acceptedDependencies[t[r]]=i;else e._acceptedDependencies[t]=i},decline:function(t){if("undefined"==typeof t)e._selfDeclined=!0;else if("number"==typeof t)e._declinedDependencies[t]=!0;else for(var i=0;i<t.length;i++)e._declinedDependencies[t[i]]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var i=e._disposeHandlers.indexOf(t);i>=0&&e._disposeHandlers.splice(i,1)},check:a,apply:u,status:function(t){return t?void S.push(t):T},addStatusHandler:function(t){S.push(t)},removeStatusHandler:function(t){var e=S.indexOf(t);e>=0&&S.splice(e,1)},data:b[t]};return e}function o(t){T=t;for(var e=0;e<S.length;e++)S[e].call(null,t)}function s(t){var e=+t+""===t;return e?+t:t}function a(t,e){if("idle"!==T)throw new Error("check() is only allowed in idle status");"function"==typeof t?(x=!1,e=t):(x=t,e=e||function(t){if(t)throw t}),o("check"),i(function(t,i){if(t)return e(t);if(!i)return o("idle"),void e(null,null);A={},L={},C={};for(var r=0;r<i.c.length;r++)L[i.c[r]]=!0;y=i.h,o("prepare"),g=e,v={};var n=0;l(n),"prepare"===T&&0===E&&0===M&&c()})}function h(t,e){if(L[t]&&A[t]){A[t]=!1;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(v[i]=e[i]);0===--M&&0===E&&c()}}function l(t){L[t]?(A[t]=!0,M++,e(t)):C[t]=!0}function c(){o("ready");var t=g;if(g=null,t)if(x)u(x,t);else{var e=[];for(var i in v)Object.prototype.hasOwnProperty.call(v,i)&&e.push(s(i));t(null,e)}}function u(e,i){function r(t){for(var e=[t],i={},r=e.slice();r.length>0;){var o=r.pop(),t=P[o];if(t&&!t.hot._selfAccepted){if(t.hot._selfDeclined)return new Error("Aborted because of self decline: "+o);if(0===o)return;for(var s=0;s<t.parents.length;s++){var a=t.parents[s],h=P[a];if(h.hot._declinedDependencies[o])return new Error("Aborted because of declined dependency: "+o+" in "+a);e.indexOf(a)>=0||(h.hot._acceptedDependencies[o]?(i[a]||(i[a]=[]),n(i[a],[o])):(delete i[a],e.push(a),r.push(a)))}}}return[e,i]}function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];t.indexOf(r)<0&&t.push(r)}}if("ready"!==T)throw new Error("apply() is only allowed in ready status");"function"==typeof e?(i=e,e={}):e&&"object"==typeof e?i=i||function(t){if(t)throw t}:(e={},i=i||function(t){if(t)throw t});var a={},h=[],l={};for(var c in v)if(Object.prototype.hasOwnProperty.call(v,c)){var u=s(c),d=r(u);if(!d){if(e.ignoreUnaccepted)continue;return o("abort"),i(new Error("Aborted because "+u+" is not accepted"))}if(d instanceof Error)return o("abort"),i(d);l[u]=v[u],n(h,d[0]);for(var u in d[1])Object.prototype.hasOwnProperty.call(d[1],u)&&(a[u]||(a[u]=[]),n(a[u],d[1][u]))}for(var f=[],m=0;m<h.length;m++){var u=h[m];P[u]&&P[u].hot._selfAccepted&&f.push({module:u,errorHandler:P[u].hot._selfAccepted})}o("dispose");for(var g=h.slice();g.length>0;){var u=g.pop(),x=P[u];if(x){for(var S={},M=x.hot._disposeHandlers,E=0;E<M.length;E++){var C=M[E];C(S)}b[u]=S,x.hot.active=!1,delete P[u];for(var E=0;E<x.children.length;E++){var A=P[x.children[E]];if(A){var L=A.parents.indexOf(u);L>=0&&A.parents.splice(L,1)}}}}for(var u in a)if(Object.prototype.hasOwnProperty.call(a,u))for(var x=P[u],R=a[u],E=0;E<R.length;E++){var O=R[E],L=x.children.indexOf(O);L>=0&&x.children.splice(L,1)}o("apply"),_=y;for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(t[u]=l[u]);var I=null;for(var u in a)if(Object.prototype.hasOwnProperty.call(a,u)){for(var x=P[u],R=a[u],D=[],m=0;m<R.length;m++){var O=R[m],C=x.hot._acceptedDependencies[O];D.indexOf(C)>=0||D.push(C)}for(var m=0;m<D.length;m++){var C=D[m];try{C(a)}catch(B){I||(I=B)}}}for(var m=0;m<f.length;m++){var k=f[m],u=k.module;w=[u];try{p(u)}catch(B){if("function"==typeof k.errorHandler)try{k.errorHandler(B)}catch(B){I||(I=B)}else I||(I=B)}}return I?(o("fail"),i(I)):(o("idle"),void i(null,h))}function p(e){if(P[e])return P[e].exports;var i=P[e]={exports:{},id:e,loaded:!1,hot:n(e),parents:w,children:[]};return t[e].call(i.exports,i,i.exports,r(e)),i.loaded=!0,i.exports}var d=this.webpackHotUpdate;this.webpackHotUpdate=function(t,e){h(t,e),d&&d(t,e)};var f=!1;try{Object.defineProperty({},"x",{get:function(){}}),f=!0}catch(m){}var g,v,y,x=!0,_="bb8d6fb3223a00fdab15",b={},w=[],S=[],T="idle",M=0,E=0,C={},A={},L={},P={};return p.m=t,p.c=P,p.p="",p.h=function(){return _},r(0)(0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){function r(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}function n(){document.getElementById("container");window.scrollTo(0,0),a.resize(window.innerWidth,window.innerHeight)}if(window.ASSET_URL="assets/",config={app:"com/football/app/FootballApp"},window.console||(window.console={log:function(t){}}),window.console.log||(window.console.log=function(t){}),window.DEVICE_SCALE=window.devicePixelRatio||1,r()){var o=(i(3),i(4),i(5),i(6),i(7),i(10));window.THREE=o;var s=i(11),a=(i(21),new s);window.app=a;var h=document.getElementById("container");document.body.appendChild(a.view),h.style.background="black",a.view.style.position="absolute",a.view.style.top=0,a.view.style.left=0,window.addEventListener("resize",function(){n()}),n()}else{var l=i(2);new l(document.body)}},function(t,e,i){var r;r=function(t,e,i){var r=function(t){this.domElement=t||document.body;var e={message:'<p>Uh-oh! It looks like you need to update your browser before you\'ll be able to play this game</p><p>In the meantime, check out <a href="#brand_url">this</a> or <a href="#cbeebies_games_url">this</a>.',brand_url:"http://www.someurl.tld/",games_url:"http://www.someurl.tld/",enabled:!0},i=e.message;i=i.replace("#brand_url",e.brand_url),i=i.replace("#games_url",e.games_url),this.active=!1,this.checkDevice(navigator.userAgent),this.checkCanvas(),this.checkCookies()};r.prototype.constructor=r,r.prototype={checkDevice:function(t){for(var e=[/(Mobile\/8C148)/,/(Mobile\/8C148a)/,/(Mobile\/8A293)/,/(Mobile\/8A306)/,/(Mobile\/8A400)/,/(Mobile\/8B117)/,/(Mobile\/8E128)/,/(Mobile\/8E200)/,/(Mobile\/8E303)/,/(Mobile\/8E401)/,/(Mobile\/8E600)/,/(Mobile\/8E501)/,/(Mobile\/8G4)/,/(Mobile\/8H7)/,/(Mobile\/8J2)/,/(Mobile\/8K2)/,/(Mobile\/8L1)/,/(Mobile\/9A334)/,/(Mobile\/10A523)/,/(Mobile\/9A405)/],i=0;i<e.length;i++)if(t.match(e[i])){var r=ASSET_URL+"img/unsupported.jpg";return this.createBigImage(r),!1}if(/iP[ao]d|iPhone/i.test(t)){var n=parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||!1;if(6>n){var r=ASSET_URL+"img/unsupported.jpg";return this.createBigImage(r),!1}}},checkCanvas:function(){if(!this.hasCanvasSupport()){var t=ASSET_URL+"img/unsupported.jpg";return this.createBigImage(t),!1}return!0},hasCanvasSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},checkCookies:function(){if(!this.cookiesEnabled()){var t=ASSET_URL+"img/cookies.jpg";this.createBigImage(t)}},cookiesEnabled:function(){var t=!!navigator.cookieEnabled;return"undefined"!=typeof navigator.cookieEnabled||t||(document.cookie="testcookie",t=-1!=document.cookie.indexOf("testcookie")),t},createBigImage2:function(t){var e=document.createElement("div");e.style.backgroundPosition="50% 50%",e.style.backgroundColor="#3b3b3b",e.style.backgroundRepeat="no-repeat",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.bottom="0",e.style.right="0",e.style.zIndex=1e5,e.height="100%",e.width="100%",e.style.backgroundImage="url("+t+")",this.domElement.appendChild(e),this.active=!0},createBigImage:function(t){var e=new Image;e.style.backgroundPosition="50% 50%",e.style.backgroundColor="#3b3b3b",e.style.backgroundRepeat="no-repeat",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.bottom="0",e.style.right="0",e.style.zIndex=1e5,e.src=t,this.domElement.appendChild(e),window.onresize=function(){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=t/750;r>1&&(r=1),e.width=750*r,e.height=500*r,e.style.left=t/2-750*r/2+"px",e.style.top=i/2-500*r/2+"px"},window.onresize(),this.active=!0}},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r,n;!function(i){"use strict";var o,s,a,h,l,c=i.GreenSockGlobals||i,u=function(t){var e,i=t.split("."),r=c;for(e=0;i.length>e;e++)r[i[e]]=r=r[i[e]]||{};return r},p=u("com.greensock"),d=[].slice,f=function(){},m={},g=function(i,o,s,a){this.sc=m[i]?m[i].sc:[],m[i]=this,this.gsClass=null,this.func=s;var h=[];this.check=function(l){for(var p,d,f,v,y=o.length,x=y;--y>-1;)(p=m[o[y]]||new g(o[y],[])).gsClass?(h[y]=p.gsClass,x--):l&&p.sc.push(this);if(0===x&&s)for(d=("com.greensock."+i).split("."),f=d.pop(),v=u(d.join("."))[f]=this.gsClass=s.apply(s,h),a&&(c[f]=v,r=[],n=function(){return v}.apply(e,r),!(void 0!==n&&(t.exports=n))),y=0;this.sc.length>y;y++)this.sc[y].check()},this.check(!0)},v=i._gsDefine=function(t,e,i,r){return new g(t,e,i,r)},y=p._class=function(t,e,i){return e=e||function(){},v(t,[],function(){return e},i),e};v.globals=c;var x=[0,0,1,1],_=[],b=y("easing.Ease",function(t,e,i,r){this._func=t,this._type=i||0,this._power=r||0,this._params=e?x.concat(e):x},!0),w=b.map={},S=b.register=function(t,e,i,r){for(var n,o,s,a,h=e.split(","),l=h.length,c=(i||"easeIn,easeOut,easeInOut").split(",");--l>-1;)for(o=h[l],n=r?y("easing."+o,null,!0):p.easing[o]||{},s=c.length;--s>-1;)a=c[s],w[o+"."+a]=w[a+o]=n[a]=t.getRatio?t:t[a]||new t};for(a=b.prototype,a._calcEnd=!1,a.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,r=1===e?1-t:2===e?t:.5>t?2*t:2*(1-t);return 1===i?r*=r:2===i?r*=r*r:3===i?r*=r*r*r:4===i&&(r*=r*r*r*r),1===e?1-r:2===e?r:.5>t?r/2:1-r/2},o=["Linear","Quad","Cubic","Quart","Quint,Strong"],s=o.length;--s>-1;)a=o[s]+",Power"+s,S(new b(null,null,1,s),a,"easeOut",!0),S(new b(null,null,2,s),a,"easeIn"+(0===s?",easeNone":"")),S(new b(null,null,3,s),a,"easeInOut");w.linear=p.easing.Linear.easeIn,w.swing=p.easing.Quad.easeInOut;var T=y("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});a=T.prototype,a.addEventListener=function(t,e,i,r,n){n=n||0;var o,s,a=this._listeners[t],c=0;for(null==a&&(this._listeners[t]=a=[]),s=a.length;--s>-1;)o=a[s],o.c===e&&o.s===i?a.splice(s,1):0===c&&n>o.pr&&(c=s+1);a.splice(c,0,{c:e,s:i,up:r,pr:n}),this!==h||l||h.wake()},a.removeEventListener=function(t,e){var i,r=this._listeners[t];if(r)for(i=r.length;--i>-1;)if(r[i].c===e)return void r.splice(i,1)},a.dispatchEvent=function(t){var e,i,r,n=this._listeners[t];if(n)for(e=n.length,i=this._eventTarget;--e>-1;)r=n[e],r.up?r.c.call(r.s||i,{type:t,target:i}):r.c.call(r.s||i)};var M=i.requestAnimationFrame,E=i.cancelAnimationFrame,C=Date.now||function(){return(new Date).getTime()},A=C();for(o=["ms","moz","webkit","o"],s=o.length;--s>-1&&!M;)M=i[o[s]+"RequestAnimationFrame"],E=i[o[s]+"CancelAnimationFrame"]||i[o[s]+"CancelRequestAnimationFrame"];y("Ticker",function(t,e){var i,r,n,o,s,a=this,c=C(),u=e!==!1&&M,p=function(t){A=C(),a.time=(A-c)/1e3;var e,h=a.time-s;(!i||h>0||t===!0)&&(a.frame++,s+=h+(h>=o?.004:o-h),e=!0),t!==!0&&(n=r(p)),e&&a.dispatchEvent("tick")};T.call(a),this.time=this.frame=0,this.tick=function(){p(!0)},this.sleep=function(){null!=n&&(u&&E?E(n):clearTimeout(n),r=f,n=null,a===h&&(l=!1))},this.wake=function(){null!==n&&a.sleep(),r=0===i?f:u&&M?M:function(t){return setTimeout(t,0|1e3*(s-a.time)+1)},a===h&&(l=!0),p(2)},this.fps=function(t){return arguments.length?(i=t,o=1/(i||60),s=this.time+o,void a.wake()):i},this.useRAF=function(t){return arguments.length?(a.sleep(),u=t,void a.fps(i)):u},a.fps(t),setTimeout(function(){u&&(!n||5>a.frame)&&a.useRAF(!1)},1500)}),a=p.Ticker.prototype=new p.events.EventDispatcher,a.constructor=p.Ticker;var L=y("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,V){l||h.wake();var i=this.vars.useFrames?z:V;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});h=L.ticker=new p.Ticker,a=L.prototype,a._dirty=a._gc=a._initted=a._paused=!1,a._totalTime=a._time=0,a._rawPrevTime=-1,a._next=a._last=a._onUpdate=a._timeline=a.timeline=null,a._paused=!1;var P=function(){C()-A>2e3&&h.wake(),setTimeout(P,2e3)};P(),a.play=function(t,e){return arguments.length&&this.seek(t,e),this.reversed(!1).paused(!1)},a.pause=function(t,e){return arguments.length&&this.seek(t,e),this.paused(!0)},a.resume=function(t,e){return arguments.length&&this.seek(t,e),this.paused(!1)},a.seek=function(t,e){return this.totalTime(Number(t),e!==!1)},a.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,e!==!1,!0)},a.reverse=function(t,e){return arguments.length&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},a.render=function(){},a.invalidate=function(){return this},a._enabled=function(t,e){return l||h.wake(),this._gc=!t,this._active=t&&!this._paused&&this._totalTime>0&&this._totalTime<this._totalDuration,e!==!0&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},a._kill=function(){return this._enabled(!1,!1)},a.kill=function(t,e){return this._kill(t,e),this},a._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},a._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},a.eventCallback=function(t,e,i,r){if("on"===(t||"").substr(0,2)){var n=this.vars;if(1===arguments.length)return n[t];null==e?delete n[t]:(n[t]=e,n[t+"Params"]=i instanceof Array&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,n[t+"Scope"]=r),"onUpdate"===t&&(this._onUpdate=e)}return this},a.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},a.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},a.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},a.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},a.totalTime=function(t,e,i){if(l||h.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var r=this._totalDuration,n=this._timeline;if(t>r&&!i&&(t=r),this._startTime=(this._paused?this._pauseTime:n._time)-(this._reversed?r-t:t)/this._timeScale,n._dirty||this._uncache(!1),n._timeline)for(;n._timeline;)n._timeline._time!==(n._startTime+n._totalTime)/n._timeScale&&n.totalTime(n._totalTime,!0),n=n._timeline}this._gc&&this._enabled(!0,!1),this._totalTime!==t&&this.render(t,e,!1)}return this},a.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},a.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||1e-6,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},a.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._totalTime,!0)),this):this._reversed},a.paused=function(t){if(!arguments.length)return this._paused;if(t!=this._paused&&this._timeline){l||t||h.wake();var e=this._timeline,i=e.rawTime(),r=i-this._pauseTime;!t&&e.smoothChildTiming&&(this._startTime+=r,this._uncache(!1)),this._pauseTime=t?i:null,this._paused=t,this._active=!t&&this._totalTime>0&&this._totalTime<this._totalDuration,t||0===r||0===this._duration||this.render(e.smoothChildTiming?this._totalTime:(i-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!t&&this._enabled(!0,!1),this};var R=y("core.SimpleTimeline",function(t){L.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});a=R.prototype=new L,a.constructor=R,a.kill()._gc=!1,a._first=a._last=null,a._sortChildren=!1,a.add=a.insert=function(t,e){var i,r;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),i=this._last,this._sortChildren)for(r=t._startTime;i&&i._startTime>r;)i=i._prev;return i?(t._next=i._next,i._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=i,this._timeline&&this._uncache(!0),this},a._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t.timeline=null,t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),this._timeline&&this._uncache(!0)),this},a.render=function(t,e,i){var r,n=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;n;)r=n._next,(n._active||t>=n._startTime&&!n._paused)&&(n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(t-n._startTime)*n._timeScale,e,i):n.render((t-n._startTime)*n._timeScale,e,i)),n=r},a.rawTime=function(){return l||h.wake(),this._totalTime};var O=y("TweenLite",function(t,e,r){if(L.call(this,e,r),this.render=O.prototype.render,null==t)throw"Cannot tween a null target.";this.target=t="string"!=typeof t?t:O.selector(t)||t;var n,o,s,a=t.jquery||t.length&&t!==i&&t[0]&&(t[0]===i||t[0].nodeType&&t[0].style&&!t.nodeType),h=this.vars.overwrite;if(this._overwrite=h=null==h?G[O.defaultOverwrite]:"number"==typeof h?h>>0:G[h],(a||t instanceof Array)&&"number"!=typeof t[0])for(this._targets=s=d.call(t,0),this._propLookup=[],this._siblings=[],n=0;s.length>n;n++)o=s[n],o?"string"!=typeof o?o.length&&o!==i&&o[0]&&(o[0]===i||o[0].nodeType&&o[0].style&&!o.nodeType)?(s.splice(n--,1),this._targets=s=s.concat(d.call(o,0))):(this._siblings[n]=j(o,this,!1),1===h&&this._siblings[n].length>1&&H(o,this,null,1,this._siblings[n])):(o=s[n--]=O.selector(o),"string"==typeof o&&s.splice(n+1,1)):s.splice(n--,1);else this._propLookup={},this._siblings=j(t,this,!1),1===h&&this._siblings.length>1&&H(t,this,null,1,this._siblings);(this.vars.immediateRender||0===e&&0===this._delay&&this.vars.immediateRender!==!1)&&this.render(-this._delay,!1,!0)},!0),I=function(t){return t.length&&t!==i&&t[0]&&(t[0]===i||t[0].nodeType&&t[0].style&&!t.nodeType)},D=function(t,e){var i,r={};for(i in t)U[i]||i in e&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!k[i]||k[i]&&k[i]._autoCSS)||(r[i]=t[i],delete t[i]);t.css=r};a=O.prototype=new L,a.constructor=O,a.kill()._gc=!1,a.ratio=0,a._firstPT=a._targets=a._overwrittenProps=a._startAt=null,a._notifyPluginsOfEnabled=!1,O.version="1.10.2",O.defaultEase=a._ease=new b(null,null,1,1),O.defaultOverwrite="auto",O.ticker=h,O.autoSleep=!0,O.selector=i.$||i.jQuery||function(t){return i.$?(O.selector=i.$,i.$(t)):i.document?i.document.getElementById("#"===t.charAt(0)?t.substr(1):t):t};var B=O._internals={},k=O._plugins={},F=O._tweenLookup={},N=0,U=B.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1},G={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},z=L._rootFramesTimeline=new R,V=L._rootTimeline=new R;V._startTime=h.time,z._startTime=h.frame,V._active=z._active=!0,L._updateRoot=function(){if(V.render((h.time-V._startTime)*V._timeScale,!1,!1),z.render((h.frame-z._startTime)*z._timeScale,!1,!1),!(h.frame%120)){var t,e,i;for(i in F){for(e=F[i].tweens,t=e.length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete F[i]}if(i=V._first,(!i||i._paused)&&O.autoSleep&&!z._first&&1===h._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||h.sleep()}}},h.addEventListener("tick",L._updateRoot);var j=function(t,e,i){var r,n,o=t._gsTweenID;if(F[o||(t._gsTweenID=o="t"+N++)]||(F[o]={target:t,tweens:[]}),e&&(r=F[o].tweens,r[n=r.length]=e,i))for(;--n>-1;)r[n]===e&&r.splice(n,1);return F[o].tweens},H=function(t,e,i,r,n){var o,s,a,h;if(1===r||r>=4){for(h=n.length,o=0;h>o;o++)if((a=n[o])!==e)a._gc||a._enabled(!1,!1)&&(s=!0);else if(5===r)break;return s}var l,c=e._startTime+1e-10,u=[],p=0,d=0===e._duration;for(o=n.length;--o>-1;)(a=n[o])===e||a._gc||a._paused||(a._timeline!==e._timeline?(l=l||W(e,0,d),0===W(a,l,d)&&(u[p++]=a)):c>=a._startTime&&a._startTime+a.totalDuration()/a._timeScale+1e-10>c&&((d||!a._initted)&&2e-10>=c-a._startTime||(u[p++]=a)));for(o=p;--o>-1;)a=u[o],2===r&&a._kill(i,t)&&(s=!0),(2!==r||!a._firstPT&&a._initted)&&a._enabled(!1,!1)&&(s=!0);return s},W=function(t,e,i){for(var r=t._timeline,n=r._timeScale,o=t._startTime,s=1e-10;r._timeline;){if(o+=r._startTime,n*=r._timeScale,r._paused)return-100;r=r._timeline}return o/=n,o>e?o-e:i&&o===e||!t._initted&&2*s>o-e?s:(o+=t.totalDuration()/t._timeScale/n)>e+s?0:o-e-s};a._init=function(){var t,e,i,r,n=this.vars,o=this._overwrittenProps,s=this._duration,a=n.immediateRender,h=n.ease;if(n.startAt){if(this._startAt&&this._startAt.render(-1,!0),n.startAt.overwrite=0,n.startAt.immediateRender=!0,this._startAt=O.to(this.target,0,n.startAt),a)if(this._time>0)this._startAt=null;else if(0!==s)return}else if(n.runBackwards&&n.immediateRender&&0!==s)if(this._startAt)this._startAt.render(-1,!0),this._startAt=null;else if(0===this._time){i={};for(r in n)U[r]&&"autoCSS"!==r||(i[r]=n[r]);return i.overwrite=0,void(this._startAt=O.to(this.target,0,i))}if(this._ease=h?h instanceof b?n.easeParams instanceof Array?h.config.apply(h,n.easeParams):h:"function"==typeof h?new b(h,n.easeParams):w[h]||O.defaultEase:O.defaultEase,this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(t=this._targets.length;--t>-1;)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],o?o[t]:null)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,o);if(e&&O._onPluginEvent("_onInitAllProps",this),o&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),n.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=n.onUpdate,this._initted=!0},a._initProps=function(t,e,r,n){var o,s,a,h,l,c;if(null==t)return!1;this.vars.css||t.style&&t!==i&&t.nodeType&&k.css&&this.vars.autoCSS!==!1&&D(this.vars,t);for(o in this.vars){if(c=this.vars[o],U[o])c instanceof Array&&-1!==c.join("").indexOf("{self}")&&(this.vars[o]=c=this._swapSelfInParams(c,this));else if(k[o]&&(h=new k[o])._onInitTween(t,this.vars[o],this)){for(this._firstPT=l={_next:this._firstPT,t:h,p:"setRatio",s:0,c:1,f:!0,n:o,pg:!0,pr:h._priority},s=h._overwriteProps.length;--s>-1;)e[h._overwriteProps[s]]=this._firstPT;(h._priority||h._onInitAllProps)&&(a=!0),(h._onDisable||h._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=e[o]=l={_next:this._firstPT,t:t,p:o,f:"function"==typeof t[o],n:o,pg:!1,pr:0},l.s=l.f?t[o.indexOf("set")||"function"!=typeof t["get"+o.substr(3)]?o:"get"+o.substr(3)]():parseFloat(t[o]),l.c="string"==typeof c&&"="===c.charAt(1)?parseInt(c.charAt(0)+"1",10)*Number(c.substr(2)):Number(c)-l.s||0;l&&l._next&&(l._next._prev=l)}return n&&this._kill(n,t)?this._initProps(t,e,r,n):this._overwrite>1&&this._firstPT&&r.length>1&&H(t,this,e,this._overwrite,r)?(this._kill(e,t),this._initProps(t,e,r,n)):a},a.render=function(t,e,i){var r,n,o,s=this._time;if(t>=this._duration)this._totalTime=this._time=this._duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(r=!0,n="onComplete"),0===this._duration&&((0===t||0>this._rawPrevTime)&&this._rawPrevTime!==t&&(i=!0,this._rawPrevTime>0&&(n="onReverseComplete",e&&(t=-1))),this._rawPrevTime=t);else if(1e-7>t)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===this._duration&&this._rawPrevTime>0)&&(n="onReverseComplete",r=this._reversed),0>t?(this._active=!1,0===this._duration&&(this._rawPrevTime>=0&&(i=!0),this._rawPrevTime=t)):this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var a=t/this._duration,h=this._easeType,l=this._easePower;(1===h||3===h&&a>=.5)&&(a=1-a),3===h&&(a*=2),1===l?a*=a:2===l?a*=a*a:3===l?a*=a*a*a:4===l&&(a*=a*a*a*a),this.ratio=1===h?1-a:2===h?a:.5>t/this._duration?a/2:1-a/2}else this.ratio=this._ease.getRatio(t/this._duration);if(this._time!==s||i){if(!this._initted){if(this._init(),!this._initted)return;this._time&&!r?this.ratio=this._ease.getRatio(this._time/this._duration):r&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._active||!this._paused&&this._time!==s&&t>=0&&(this._active=!0),0===s&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):n||(n="_dummyGS")),this.vars.onStart&&(0!==this._time||0===this._duration)&&(e||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||_))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>t&&this._startAt&&this._startAt.render(t,e,i),e||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||_)),n&&(this._gc||(0>t&&this._startAt&&!this._onUpdate&&this._startAt.render(t,e,i),r&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[n]&&this.vars[n].apply(this.vars[n+"Scope"]||this,this.vars[n+"Params"]||_)))}},a._kill=function(t,e){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:O.selector(e)||e;var i,r,n,o,s,a,h,l;if((e instanceof Array||I(e))&&"number"!=typeof e[0])for(i=e.length;--i>-1;)this._kill(t,e[i])&&(a=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(e===this._targets[i]){s=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[i]=t?this._overwrittenProps[i]||{}:"all";break}}else{if(e!==this.target)return!1;s=this._propLookup,r=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(s){h=t||s,l=t!==r&&"all"!==r&&t!==s&&(null==t||t._tempKill!==!0);for(n in h)(o=s[n])&&(o.pg&&o.t._kill(h)&&(a=!0),o.pg&&0!==o.t._overwriteProps.length||(o._prev?o._prev._next=o._next:o===this._firstPT&&(this._firstPT=o._next),o._next&&(o._next._prev=o._prev),o._next=o._prev=null),delete s[n]),l&&(r[n]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return a},a.invalidate=function(){return this._notifyPluginsOfEnabled&&O._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=!1,this._propLookup=this._targets?{}:[],this},a._enabled=function(t,e){if(l||h.wake(),t&&this._gc){var i,r=this._targets;if(r)for(i=r.length;--i>-1;)this._siblings[i]=j(r[i],this,!0);else this._siblings=j(this.target,this,!0)}return L.prototype._enabled.call(this,t,e),this._notifyPluginsOfEnabled&&this._firstPT?O._onPluginEvent(t?"_onEnable":"_onDisable",this):!1},O.to=function(t,e,i){return new O(t,e,i)},O.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new O(t,e,i)},O.fromTo=function(t,e,i,r){return r.startAt=i,r.immediateRender=0!=r.immediateRender&&0!=i.immediateRender,new O(t,e,r)},O.delayedCall=function(t,e,i,r,n){return new O(e,0,{delay:t,onComplete:e,onCompleteParams:i,onCompleteScope:r,onReverseComplete:e,onReverseCompleteParams:i,onReverseCompleteScope:r,immediateRender:!1,useFrames:n,overwrite:0})},O.set=function(t,e){return new O(t,0,e)},O.killTweensOf=O.killDelayedCallsTo=function(t,e){for(var i=O.getTweensOf(t),r=i.length;--r>-1;)i[r]._kill(e,t)},O.getTweensOf=function(t){if(null==t)return[];t="string"!=typeof t?t:O.selector(t)||t;var e,i,r,n;if((t instanceof Array||I(t))&&"number"!=typeof t[0]){for(e=t.length,i=[];--e>-1;)i=i.concat(O.getTweensOf(t[e]));for(e=i.length;--e>-1;)for(n=i[e],r=e;--r>-1;)n===i[r]&&i.splice(e,1)}else for(i=j(t).concat(),e=i.length;--e>-1;)i[e]._gc&&i.splice(e,1);return i};var X=y("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=X.prototype},!0);if(a=X.prototype,X.version="1.10.1",X.API=2,a._firstPT=null,a._addTween=function(t,e,i,r,n,o){var s,a;return null!=r&&(s="number"==typeof r||"="!==r.charAt(1)?Number(r)-i:parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)))?(this._firstPT=a={_next:this._firstPT,t:t,p:e,s:i,c:s,f:"function"==typeof t[e],n:n||e,r:o},a._next&&(a._next._prev=a),a):void 0},a.setRatio=function(t){for(var e,i=this._firstPT,r=1e-6;i;)e=i.c*t+i.s,i.r?e=0|e+(e>0?.5:-.5):r>e&&e>-r&&(e=0),i.f?i.t[i.p](e):i.t[i.p]=e,i=i._next},a._kill=function(t){var e,i=this._overwriteProps,r=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);for(;r;)null!=t[r.n]&&(r._next&&(r._next._prev=r._prev),r._prev?(r._prev._next=r._next,r._prev=null):this._firstPT===r&&(this._firstPT=r._next)),r=r._next;return!1},a._roundProps=function(t,e){for(var i=this._firstPT;i;)(t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&(i.r=e),i=i._next},O._onPluginEvent=function(t,e){var i,r,n,o,s,a=e._firstPT;if("_onInitAllProps"===t){for(;a;){for(s=a._next,r=n;r&&r.pr>a.pr;)r=r._next;(a._prev=r?r._prev:o)?a._prev._next=a:n=a,(a._next=r)?r._prev=a:o=a,a=s}a=e._firstPT=n}for(;a;)a.pg&&"function"==typeof a.t[t]&&a.t[t]()&&(i=!0),a=a._next;return i},X.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===X.API&&(k[(new t[e])._propName]=t[e]);return!0},v.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";
var e,i=t.propName,r=t.priority||0,n=t.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},s=y("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){X.call(this,i,r),this._overwriteProps=n||[]},t.global===!0),a=s.prototype=new X(i);a.constructor=s,s.API=t.API;for(e in o)"function"==typeof t[e]&&(a[o[e]]=t[e]);return s.version=t.version,X.activate([s]),s},o=i._gsQueue){for(s=0;o.length>s;s++)o[s]();for(a in m)m[a].func||i.console.log("GSAP encountered missing dependency: com.greensock."+a)}l=!1}(window)},function(t,e){(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";window._gsDefine("easing.Back",["easing.Ease"],function(t){var e,i,r,n=window.GreenSockGlobals||window,o=n.com.greensock,s=2*Math.PI,a=Math.PI/2,h=o._class,l=function(e,i){var r=h("easing."+e,function(){},!0),n=r.prototype=new t;return n.constructor=r,n.getRatio=i,r},c=t.register||function(){},u=function(t,e,i,r){var n=h("easing."+t,{easeOut:new e,easeIn:new i,easeInOut:new r},!0);return c(n,t),n},p=function(t,e,i){this.t=t,this.v=e,i&&(this.next=i,i.prev=this,this.c=i.v-e,this.gap=i.t-t)},d=function(e,i){var r=h("easing."+e,function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1},!0),n=r.prototype=new t;return n.constructor=r,n.getRatio=i,n.config=function(t){return new r(t)},r},f=u("Back",d("BackOut",function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1}),d("BackIn",function(t){return t*t*((this._p1+1)*t-this._p1)}),d("BackInOut",function(t){return 1>(t*=2)?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)})),m=h("easing.SlowMo",function(t,e,i){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),g=m.prototype=new t;return g.constructor=m,g.getRatio=function(t){var e=t+(.5-t)*this._p;return this._p1>t?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},m.ease=new m(.7,.7),g.config=m.config=function(t,e,i){return new m(t,e,i)},e=h("easing.SteppedEase",function(t){t=t||1,this._p1=1/t,this._p2=t+1},!0),g=e.prototype=new t,g.constructor=e,g.getRatio=function(t){return 0>t?t=0:t>=1&&(t=.999999999),(this._p2*t>>0)*this._p1},g.config=e.config=function(t){return new e(t)},i=h("easing.RoughEase",function(e){e=e||{};for(var i,r,n,o,s,a,h=e.taper||"none",l=[],c=0,u=0|(e.points||20),d=u,f=e.randomize!==!1,m=e.clamp===!0,g=e.template instanceof t?e.template:null,v="number"==typeof e.strength?.4*e.strength:.4;--d>-1;)i=f?Math.random():1/u*d,r=g?g.getRatio(i):i,"none"===h?n=v:"out"===h?(o=1-i,n=o*o*v):"in"===h?n=i*i*v:.5>i?(o=2*i,n=.5*o*o*v):(o=2*(1-i),n=.5*o*o*v),f?r+=Math.random()*n-.5*n:d%2?r+=.5*n:r-=.5*n,m&&(r>1?r=1:0>r&&(r=0)),l[c++]={x:i,y:r};for(l.sort(function(t,e){return t.x-e.x}),a=new p(1,1,null),d=u;--d>-1;)s=l[d],a=new p(s.x,s.y,a);this._prev=new p(0,0,0!==a.t?a:a.next)},!0),g=i.prototype=new t,g.constructor=i,g.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&e.t>=t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},g.config=function(t){return new i(t)},i.ease=new i,u("Bounce",l("BounceOut",function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),l("BounceIn",function(t){return 1/2.75>(t=1-t)?1-7.5625*t*t:2/2.75>t?1-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),l("BounceInOut",function(t){var e=.5>t;return t=e?1-2*t:2*t-1,t=1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})),u("Circ",l("CircOut",function(t){return Math.sqrt(1-(t-=1)*t)}),l("CircIn",function(t){return-(Math.sqrt(1-t*t)-1)}),l("CircInOut",function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})),r=function(e,i,r){var n=h("easing."+e,function(t,e){this._p1=t||1,this._p2=e||r,this._p3=this._p2/s*(Math.asin(1/this._p1)||0)},!0),o=n.prototype=new t;return o.constructor=n,o.getRatio=i,o.config=function(t,e){return new n(t,e)},n},u("Elastic",r("ElasticOut",function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*s/this._p2)+1},.3),r("ElasticIn",function(t){return-(this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*s/this._p2))},.3),r("ElasticInOut",function(t){return 1>(t*=2)?-.5*this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*s/this._p2):.5*this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*s/this._p2)+1},.45)),u("Expo",l("ExpoOut",function(t){return 1-Math.pow(2,-10*t)}),l("ExpoIn",function(t){return Math.pow(2,10*(t-1))-.001}),l("ExpoInOut",function(t){return 1>(t*=2)?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})),u("Sine",l("SineOut",function(t){return Math.sin(t*a)}),l("SineIn",function(t){return-Math.cos(t*a)+1}),l("SineInOut",function(t){return-.5*(Math.cos(Math.PI*t)-1)})),h("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),c(n.SlowMo,"SlowMo","ease,"),c(i,"RoughEase","ease,"),c(e,"SteppedEase","ease,"),f},!0)}),window._gsDefine&&window._gsQueue.pop()()},function(t,e){(window._gsQueue||(window._gsQueue=[])).push(function(){"use strict";window._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){var i,r,n,o,s=function(){t.call(this,"css"),this._overwriteProps.length=0},a={},h=s.prototype=new t("css");h.constructor=s,s.version="1.9.6",s.API=2,s.defaultTransformPerspective=0,h="px",s.suffixMap={top:h,right:h,bottom:h,left:h,width:h,height:h,fontSize:h,padding:h,margin:h,perspective:h};var l,c,u,p,d,f,m=/(?:\d|\-\d|\.\d|\-\.\d)+/g,g=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,v=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,y=/[^\d\-\.]/g,x=/(?:\d|\-|\+|=|#|\.)*/g,_=/opacity *= *([^)]*)/,b=/opacity:([^;]*)/,w=/alpha\(opacity *=.+?\)/i,S=/^(rgb|hsl)/,T=/([A-Z])/g,M=/-([a-z])/gi,E=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,C=function(t,e){return e.toUpperCase()},A=/(?:Left|Right|Width)/i,L=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,P=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,R=/,(?=[^\)]*(?:\(|$))/gi,O=Math.PI/180,I=180/Math.PI,D={},B=document,k=B.createElement("div"),F=B.createElement("img"),N=s._internals={_specialProps:a},U=navigator.userAgent,G=function(){var t,e=U.indexOf("Android"),i=B.createElement("div");return u=-1!==U.indexOf("Safari")&&-1===U.indexOf("Chrome")&&(-1===e||Number(U.substr(e+8,1))>3),d=u&&6>Number(U.substr(U.indexOf("Version/")+8,1)),p=-1!==U.indexOf("Firefox"),/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(U),f=parseFloat(RegExp.$1),i.innerHTML="<a style='top:1px;opacity:.55;'>a</a>",t=i.getElementsByTagName("a")[0],t?/^0.55/.test(t.style.opacity):!1}(),z=function(t){return _.test("string"==typeof t?t:(t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100:1},V=function(t){window.console&&void 0},j="",H="",W=function(t,e){e=e||k;var i,r,n=e.style;if(void 0!==n[t])return t;for(t=t.charAt(0).toUpperCase()+t.substr(1),i=["O","Moz","ms","Ms","Webkit"],r=5;--r>-1&&void 0===n[i[r]+t];);return r>=0?(H=3===r?"ms":i[r],j="-"+H.toLowerCase()+"-",H+t):null},X=B.defaultView?B.defaultView.getComputedStyle:function(){},Y=s.getStyle=function(t,e,i,r,n){var o;return G||"opacity"!==e?(!r&&t.style[e]?o=t.style[e]:(i=i||X(t,null))?(t=i.getPropertyValue(e.replace(T,"-$1").toLowerCase()),o=t||i.length?t:i[e]):t.currentStyle&&(i=t.currentStyle,o=i[e]),null==n||o&&"none"!==o&&"auto"!==o&&"auto auto"!==o?o:n):z(t)},q=function(t,e,i,r,n){if("px"===r||!r)return i;if("auto"===r||!i)return 0;var o,s=A.test(e),a=t,h=k.style,l=0>i;return l&&(i=-i),"%"===r&&-1!==e.indexOf("border")?o=i/100*(s?t.clientWidth:t.clientHeight):(h.cssText="border-style:solid; border-width:0; position:absolute; line-height:0;","%"!==r&&a.appendChild?h[s?"borderLeftWidth":"borderTopWidth"]=i+r:(a=t.parentNode||B.body,h[s?"width":"height"]=i+r),a.appendChild(k),o=parseFloat(k[s?"offsetWidth":"offsetHeight"]),a.removeChild(k),0!==o||n||(o=q(t,e,i,r,!0))),l?-o:o},K=function(t,e,i){if("absolute"!==Y(t,"position",i))return 0;var r="left"===e?"Left":"Top",n=Y(t,"margin"+r,i);return t["offset"+r]-(q(t,e,parseFloat(n),n.replace(x,""))||0)},Z=function(t,e){var i,r,n={};if(e=e||X(t,null))if(i=e.length)for(;--i>-1;)n[e[i].replace(M,C)]=e.getPropertyValue(e[i]);else for(i in e)n[i]=e[i];else if(e=t.currentStyle||t.style)for(i in e)n[i.replace(M,C)]=e[i];return G||(n.opacity=z(t)),r=St(t,e,!1),n.rotation=r.rotation*I,n.skewX=r.skewX*I,n.scaleX=r.scaleX,n.scaleY=r.scaleY,n.x=r.x,n.y=r.y,wt&&(n.z=r.z,n.rotationX=r.rotationX*I,n.rotationY=r.rotationY*I,n.scaleZ=r.scaleZ),n.filters&&delete n.filters,n},J=function(t,e,i,r,n){var o,s,a,h={},l=t.style;for(s in i)"cssText"!==s&&"length"!==s&&isNaN(s)&&(e[s]!==(o=i[s])||n&&n[s])&&-1===s.indexOf("Origin")&&("number"==typeof o||"string"==typeof o)&&(h[s]="auto"!==o||"left"!==s&&"top"!==s?""!==o&&"auto"!==o&&"none"!==o||"string"!=typeof e[s]||""===e[s].replace(y,"")?o:0:K(t,s),void 0!==l[s]&&(a=new ut(l,s,l[s],a)));if(r)for(s in r)"className"!==s&&(h[s]=r[s]);return{difs:h,firstMPT:a}},Q={width:["Left","Right"],height:["Top","Bottom"]},$=["marginLeft","marginRight","marginTop","marginBottom"],tt=function(t,e,i){var r=parseFloat("width"===e?t.offsetWidth:t.offsetHeight),n=Q[e],o=n.length;for(i=i||X(t,null);--o>-1;)r-=parseFloat(Y(t,"padding"+n[o],i,!0))||0,r-=parseFloat(Y(t,"border"+n[o]+"Width",i,!0))||0;return r},et=function(t,e){(null==t||""===t||"auto"===t||"auto auto"===t)&&(t="0 0");var i=t.split(" "),r=-1!==t.indexOf("left")?"0%":-1!==t.indexOf("right")?"100%":i[0],n=-1!==t.indexOf("top")?"0%":-1!==t.indexOf("bottom")?"100%":i[1];return null==n?n="0":"center"===n&&(n="50%"),("center"===r||isNaN(parseFloat(r)))&&(r="50%"),e&&(e.oxp=-1!==r.indexOf("%"),e.oyp=-1!==n.indexOf("%"),e.oxr="="===r.charAt(1),e.oyr="="===n.charAt(1),e.ox=parseFloat(r.replace(y,"")),e.oy=parseFloat(n.replace(y,""))),r+" "+n+(i.length>2?" "+i[2]:"")},it=function(t,e){return"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2)):parseFloat(t)-parseFloat(e)},rt=function(t,e){return null==t?e:"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*Number(t.substr(2))+e:parseFloat(t)},nt=function(t,e,i,r){var n,o,s,a,h=1e-6;return null==t?a=e:"number"==typeof t?a=t*O:(n=2*Math.PI,o=t.split("_"),s=Number(o[0].replace(y,""))*(-1===t.indexOf("rad")?O:1)-("="===t.charAt(1)?0:e),o.length&&(r&&(r[i]=e+s),-1!==t.indexOf("short")&&(s%=n,s!==s%(n/2)&&(s=0>s?s+n:s-n)),-1!==t.indexOf("_cw")&&0>s?s=(s+9999999999*n)%n-(0|s/n)*n:-1!==t.indexOf("ccw")&&s>0&&(s=(s-9999999999*n)%n-(0|s/n)*n)),a=e+s),h>a&&a>-h&&(a=0),a},ot={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},st=function(t,e,i){return t=0>t?t+1:t>1?t-1:t,0|255*(1>6*t?e+6*(i-e)*t:.5>t?i:2>3*t?e+6*(i-e)*(2/3-t):e)+.5},at=function(t){var e,i,r,n,o,s;return t&&""!==t?"number"==typeof t?[t>>16,255&t>>8,255&t]:(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),ot[t]?ot[t]:"#"===t.charAt(0)?(4===t.length&&(e=t.charAt(1),i=t.charAt(2),r=t.charAt(3),t="#"+e+e+i+i+r+r),t=parseInt(t.substr(1),16),[t>>16,255&t>>8,255&t]):"hsl"===t.substr(0,3)?(t=t.match(m),n=Number(t[0])%360/360,o=Number(t[1])/100,s=Number(t[2])/100,i=.5>=s?s*(o+1):s+o-s*o,e=2*s-i,t.length>3&&(t[3]=Number(t[3])),t[0]=st(n+1/3,e,i),t[1]=st(n,e,i),t[2]=st(n-1/3,e,i),t):(t=t.match(m)||ot.transparent,t[0]=Number(t[0]),t[1]=Number(t[1]),t[2]=Number(t[2]),t.length>3&&(t[3]=Number(t[3])),t)):ot.black},ht="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(h in ot)ht+="|"+h+"\\b";ht=RegExp(ht+")","gi");var lt=function(t,e,i,r){if(null==t)return function(t){return t};var n,o=e?(t.match(ht)||[""])[0]:"",s=t.split(o).join("").match(v)||[],a=t.substr(0,t.indexOf(s[0])),h=")"===t.charAt(t.length-1)?")":"",l=-1!==t.indexOf(" ")?" ":",",c=s.length,u=c>0?s[0].replace(m,""):"";return c?n=e?function(t){var e,p,d,f;if("number"==typeof t)t+=u;else if(r&&R.test(t)){for(f=t.replace(R,"|").split("|"),d=0;f.length>d;d++)f[d]=n(f[d]);return f.join(",")}if(e=(t.match(ht)||[o])[0],p=t.split(e).join("").match(v)||[],d=p.length,c>d--)for(;c>++d;)p[d]=i?p[0|(d-1)/2]:s[d];return a+p.join(l)+l+e+h+(-1!==t.indexOf("inset")?" inset":"")}:function(t){var e,o,p;if("number"==typeof t)t+=u;else if(r&&R.test(t)){for(o=t.replace(R,"|").split("|"),p=0;o.length>p;p++)o[p]=n(o[p]);return o.join(",")}if(e=t.match(v)||[],p=e.length,c>p--)for(;c>++p;)e[p]=i?e[0|(p-1)/2]:s[p];return a+e.join(l)+h}:function(t){return t}},ct=function(t){return t=t.split(","),function(e,i,r,n,o,s,a){var h,l=(i+"").split(" ");for(a={},h=0;4>h;h++)a[t[h]]=l[h]=l[h]||l[(h-1)/2>>0];return n.parse(e,a,o,s)}},ut=(N._setPluginRatio=function(t){this.plugin.setRatio(t);for(var e,i,r,n,o=this.data,s=o.proxy,a=o.firstMPT,h=1e-6;a;)e=s[a.v],a.r?e=e>0?0|e+.5:0|e-.5:h>e&&e>-h&&(e=0),a.t[a.p]=e,a=a._next;if(o.autoRotate&&(o.autoRotate.rotation=s.rotation),1===t)for(a=o.firstMPT;a;){if(i=a.t,i.type){if(1===i.type){for(n=i.xs0+i.s+i.xs1,r=1;i.l>r;r++)n+=i["xn"+r]+i["xs"+(r+1)];i.e=n}}else i.e=i.s+i.xs0;a=a._next}},function(t,e,i,r,n){this.t=t,this.p=e,this.v=i,this.r=n,r&&(r._prev=this,this._next=r)}),pt=(N._parseToProxy=function(t,e,i,r,n,o){var s,a,h,l,c,u=r,p={},d={},f=i._transform,m=D;for(i._transform=null,D=e,r=c=i.parse(t,e,r,n),D=m,o&&(i._transform=f,u&&(u._prev=null,u._prev&&(u._prev._next=null)));r&&r!==u;){if(1>=r.type&&(a=r.p,d[a]=r.s+r.c,p[a]=r.s,o||(l=new ut(r,"s",a,l,r.r),r.c=0),1===r.type))for(s=r.l;--s>0;)h="xn"+s,a=r.p+"_"+h,d[a]=r.data[h],p[a]=r[h],o||(l=new ut(r,h,a,l,r.rxp[h]));r=r._next}return{proxy:p,end:d,firstMPT:l,pt:c}},N.CSSPropTween=function(t,e,r,n,s,a,h,l,c,u,p){this.t=t,this.p=e,this.s=r,this.c=n,this.n=h||"css_"+e,t instanceof pt||o.push(this.n),this.r=l,this.type=a||0,c&&(this.pr=c,i=!0),this.b=void 0===u?r:u,this.e=void 0===p?r+n:p,s&&(this._next=s,s._prev=this)}),dt=s.parseComplex=function(t,e,i,r,n,o,s,a,h,c){s=new pt(t,e,0,0,s,c?2:1,null,!1,a,i,r),r+="";var u,p,d,f,v,y,x,_,b,w,T,M,E=i.split(", ").join(",").split(" "),C=r.split(", ").join(",").split(" "),A=E.length,L=l!==!1;for((-1!==r.indexOf(",")||-1!==i.indexOf(","))&&(E=E.join(" ").replace(R,", ").split(" "),C=C.join(" ").replace(R,", ").split(" "),A=E.length),A!==C.length&&(E=(o||"").split(" "),A=E.length),s.plugin=h,s.setRatio=c,u=0;A>u;u++)if(f=E[u],v=C[u],_=parseFloat(f),_||0===_)s.appendXtra("",_,it(v,_),v.replace(g,""),L&&-1!==v.indexOf("px"),!0);else if(n&&("#"===f.charAt(0)||ot[f]||S.test(f)))M=","===v.charAt(v.length-1)?"),":")",f=at(f),v=at(v),b=f.length+v.length>6,b&&!G&&0===v[3]?(s["xs"+s.l]+=s.l?" transparent":"transparent",s.e=s.e.split(C[u]).join("transparent")):(G||(b=!1),s.appendXtra(b?"rgba(":"rgb(",f[0],v[0]-f[0],",",!0,!0).appendXtra("",f[1],v[1]-f[1],",",!0).appendXtra("",f[2],v[2]-f[2],b?",":M,!0),b&&(f=4>f.length?1:f[3],s.appendXtra("",f,(4>v.length?1:v[3])-f,M,!1)));else if(y=f.match(m)){if(x=v.match(g),!x||x.length!==y.length)return s;for(d=0,p=0;y.length>p;p++)T=y[p],w=f.indexOf(T,d),s.appendXtra(f.substr(d,w-d),Number(T),it(x[p],T),"",L&&"px"===f.substr(w+T.length,2),0===p),d=w+T.length;s["xs"+s.l]+=f.substr(d)}else s["xs"+s.l]+=s.l?" "+f:f;if(-1!==r.indexOf("=")&&s.data){for(M=s.xs0+s.data.s,u=1;s.l>u;u++)M+=s["xs"+u]+s.data["xn"+u];s.e=M+s["xs"+u]}return s.l||(s.type=-1,s.xs0=s.e),s.xfirst||s},ft=9;for(h=pt.prototype,h.l=h.pr=0;--ft>0;)h["xn"+ft]=0,h["xs"+ft]="";h.xs0="",h._next=h._prev=h.xfirst=h.data=h.plugin=h.setRatio=h.rxp=null,h.appendXtra=function(t,e,i,r,n,o){var s=this,a=s.l;return s["xs"+a]+=o&&a?" "+t:t||"",i||0===a||s.plugin?(s.l++,s.type=s.setRatio?2:1,s["xs"+s.l]=r||"",a>0?(s.data["xn"+a]=e+i,s.rxp["xn"+a]=n,s["xn"+a]=e,s.plugin||(s.xfirst=new pt(s,"xn"+a,e,i,s.xfirst||s,0,s.n,n,s.pr),s.xfirst.xs0=0),s):(s.data={s:e+i},s.rxp={},s.s=e,s.c=i,s.r=n,s)):(s["xs"+a]+=e+(r||""),s)};var mt=function(t,e){e=e||{},this.p=e.prefix?W(t)||t:t,a[t]=a[this.p]=this,this.format=e.formatter||lt(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},gt=N._registerComplexSpecialProp=function(t,e,i){"object"!=typeof e&&(e={parser:i});var r,n,o=t.split(","),s=e.defaultValue;for(i=i||[s],r=0;o.length>r;r++)e.prefix=0===r&&e.prefix,e.defaultValue=i[r]||s,n=new mt(o[r],e)},vt=function(t){if(!a[t]){var e=t.charAt(0).toUpperCase()+t.substr(1)+"Plugin";gt(t,{parser:function(t,i,r,n,o,s,h){var l=(window.GreenSockGlobals||window).com.greensock.plugins[e];return l?(l._cssRegister(),a[r].parse(t,i,r,n,o,s,h)):(V("Error: "+e+" js file not loaded."),o)}})}};h=mt.prototype,h.parseComplex=function(t,e,i,r,n,o){var s,a,h,l,c,u,p=this.keyword;if(this.multi&&(R.test(i)||R.test(e)?(a=e.replace(R,"|").split("|"),h=i.replace(R,"|").split("|")):p&&(a=[e],h=[i])),h){for(l=h.length>a.length?h.length:a.length,s=0;l>s;s++)e=a[s]=a[s]||this.dflt,i=h[s]=h[s]||this.dflt,p&&(c=e.indexOf(p),u=i.indexOf(p),c!==u&&(i=-1===u?h:a,i[s]+=" "+p));e=a.join(", "),i=h.join(", ")}return dt(t,this.p,e,i,this.clrs,this.dflt,r,this.pr,n,o)},h.parse=function(t,e,i,r,o,s){return this.parseComplex(t.style,this.format(Y(t,this.p,n,!1,this.dflt)),this.format(e),o,s)},s.registerSpecialProp=function(t,e,i){gt(t,{parser:function(t,r,n,o,s,a){var h=new pt(t,n,0,0,s,2,n,!1,i);return h.plugin=a,h.setRatio=e(t,r,o._tween,n),h},priority:i})};var yt="scaleX,scaleY,scaleZ,x,y,z,skewX,rotation,rotationX,rotationY,perspective".split(","),xt=W("transform"),_t=j+"transform",bt=W("transformOrigin"),wt=null!==W("perspective"),St=function(t,e,i){var r,n,o,a,h,l,c,u,p,d,f,m,g,v=i?t._gsTransform||{skewY:0}:{skewY:0},y=0>v.scaleX,x=2e-5,_=1e5,b=-Math.PI+1e-4,w=Math.PI-1e-4,S=wt?parseFloat(Y(t,bt,e,!1,"0 0 0").split(" ")[2])||v.zOrigin||0:0;if(xt)r=Y(t,_t,e,!0);else if(t.currentStyle)if(r=t.currentStyle.filter.match(L),r&&4===r.length)r=[r[0].substr(4),Number(r[2].substr(4)),Number(r[1].substr(4)),r[3].substr(4),v.x||0,v.y||0].join(",");else{if(null!=v.x)return v;r=""}for(n=(r||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],o=n.length;--o>-1;)a=Number(n[o]),n[o]=(h=a-(a|=0))?(0|h*_+(0>h?-.5:.5))/_+a:a;if(16===n.length){var T=n[8],M=n[9],E=n[10],C=n[12],A=n[13],P=n[14];if(v.zOrigin&&(P=-v.zOrigin,C=T*P-n[12],A=M*P-n[13],P=E*P+v.zOrigin-n[14]),!i||null==v.rotationX){var R,O,I,D,B,k,F,N=n[0],U=n[1],G=n[2],z=n[3],V=n[4],j=n[5],H=n[6],W=n[7],X=n[11],q=v.rotationX=Math.atan2(H,E),K=b>q||q>w;q&&(D=Math.cos(-q),B=Math.sin(-q),R=V*D+T*B,O=j*D+M*B,I=H*D+E*B,T=V*-B+T*D,M=j*-B+M*D,E=H*-B+E*D,X=W*-B+X*D,V=R,j=O,H=I),q=v.rotationY=Math.atan2(T,N),q&&(k=b>q||q>w,D=Math.cos(-q),B=Math.sin(-q),R=N*D-T*B,O=U*D-M*B,I=G*D-E*B,M=U*B+M*D,E=G*B+E*D,X=z*B+X*D,N=R,U=O,G=I),q=v.rotation=Math.atan2(U,j),q&&(F=b>q||q>w,D=Math.cos(-q),B=Math.sin(-q),N=N*D+V*B,O=U*D+j*B,j=U*-B+j*D,H=G*-B+H*D,U=O),F&&K?v.rotation=v.rotationX=0:F&&k?v.rotation=v.rotationY=0:k&&K&&(v.rotationY=v.rotationX=0),v.scaleX=(0|Math.sqrt(N*N+U*U)*_+.5)/_,v.scaleY=(0|Math.sqrt(j*j+M*M)*_+.5)/_,v.scaleZ=(0|Math.sqrt(H*H+E*E)*_+.5)/_,v.skewX=0,v.perspective=X?1/(0>X?-X:X):0,v.x=C,v.y=A,v.z=P}}else if(!(wt&&0!==n.length&&v.x===n[4]&&v.y===n[5]&&(v.rotationX||v.rotationY)||void 0!==v.x&&"none"===Y(t,"display",e))){var Z=n.length>=6,J=Z?n[0]:1,Q=n[1]||0,$=n[2]||0,tt=Z?n[3]:1;v.x=n[4]||0,v.y=n[5]||0,l=Math.sqrt(J*J+Q*Q),c=Math.sqrt(tt*tt+$*$),u=J||Q?Math.atan2(Q,J):v.rotation||0,p=$||tt?Math.atan2($,tt)+u:v.skewX||0,d=l-Math.abs(v.scaleX||0),f=c-Math.abs(v.scaleY||0),Math.abs(p)>Math.PI/2&&Math.abs(p)<1.5*Math.PI&&(y?(l*=-1,p+=0>=u?Math.PI:-Math.PI,u+=0>=u?Math.PI:-Math.PI):(c*=-1,p+=0>=p?Math.PI:-Math.PI)),m=(u-v.rotation)%Math.PI,g=(p-v.skewX)%Math.PI,(void 0===v.skewX||d>x||-x>d||f>x||-x>f||m>b&&w>m&&!1|m*_||g>b&&w>g&&!1|g*_)&&(v.scaleX=l,v.scaleY=c,v.rotation=u,v.skewX=p),wt&&(v.rotationX=v.rotationY=v.z=0,v.perspective=parseFloat(s.defaultTransformPerspective)||0,v.scaleZ=1)}v.zOrigin=S;for(o in v)x>v[o]&&v[o]>-x&&(v[o]=0);return i&&(t._gsTransform=v),v},Tt=function(t){var e,i,r=this.data,n=-r.rotation,o=n+r.skewX,s=1e5,a=(0|Math.cos(n)*r.scaleX*s)/s,h=(0|Math.sin(n)*r.scaleX*s)/s,l=(0|Math.sin(o)*-r.scaleY*s)/s,c=(0|Math.cos(o)*r.scaleY*s)/s,u=this.t.style,p=this.t.currentStyle;if(p){i=h,h=-l,l=-i,e=p.filter,u.filter="";var d,m,g=this.t.offsetWidth,v=this.t.offsetHeight,y="absolute"!==p.position,b="progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+h+", M21="+l+", M22="+c,w=r.x,S=r.y;if(null!=r.ox&&(d=(r.oxp?.01*g*r.ox:r.ox)-g/2,m=(r.oyp?.01*v*r.oy:r.oy)-v/2,w+=d-(d*a+m*h),S+=m-(d*l+m*c)),y)d=g/2,m=v/2,b+=", Dx="+(d-(d*a+m*h)+w)+", Dy="+(m-(d*l+m*c)+S)+")";else{var T,M,E,C=8>f?1:-1;for(d=r.ieOffsetX||0,m=r.ieOffsetY||0,r.ieOffsetX=Math.round((g-((0>a?-a:a)*g+(0>h?-h:h)*v))/2+w),r.ieOffsetY=Math.round((v-((0>c?-c:c)*v+(0>l?-l:l)*g))/2+S),ft=0;4>ft;ft++)M=$[ft],T=p[M],i=-1!==T.indexOf("px")?parseFloat(T):q(this.t,M,parseFloat(T),T.replace(x,""))||0,E=i!==r[M]?2>ft?-r.ieOffsetX:-r.ieOffsetY:2>ft?d-r.ieOffsetX:m-r.ieOffsetY,u[M]=(r[M]=Math.round(i-E*(0===ft||2===ft?1:C)))+"px";b+=", sizingMethod='auto expand')"}u.filter=-1!==e.indexOf("DXImageTransform.Microsoft.Matrix(")?e.replace(P,b):b+" "+e,(0===t||1===t)&&1===a&&0===h&&0===l&&1===c&&(y&&-1===b.indexOf("Dx=0, Dy=0")||_.test(e)&&100!==parseFloat(RegExp.$1)||-1===e.indexOf("gradient(")&&u.removeAttribute("filter"))}},Mt=function(){var t,e,i,r,n,o,s,a,h,l=this.data,c=this.t.style,u=l.perspective,d=l.scaleX,f=0,m=0,g=0,v=0,y=l.scaleY,x=0,_=0,b=0,w=0,S=l.scaleZ,T=0,M=0,E=0,C=u?-1/u:0,A=l.rotation,L=l.zOrigin,P=1e5;p&&(s=c.top?"top":c.bottom?"bottom":parseFloat(Y(this.t,"top",null,!1))?"bottom":"top",i=Y(this.t,s,null,!1),a=parseFloat(i)||0,h=i.substr((a+"").length)||"px",l._ffFix=!l._ffFix,c[s]=(l._ffFix?a+.05:a-.05)+h),(A||l.skewX)&&(i=d*Math.cos(A),r=y*Math.sin(A),A-=l.skewX,f=d*-Math.sin(A),y*=Math.cos(A),d=i,v=r),A=l.rotationY,A&&(t=Math.cos(A),e=Math.sin(A),i=d*t,r=v*t,n=S*-e,o=C*-e,m=d*e,x=v*e,S*=t,C*=t,d=i,v=r,b=n,M=o),A=l.rotationX,A&&(t=Math.cos(A),e=Math.sin(A),i=f*t+m*e,r=y*t+x*e,n=w*t+S*e,o=E*t+C*e,m=f*-e+m*t,x=y*-e+x*t,S=w*-e+S*t,C=E*-e+C*t,f=i,y=r,w=n,E=o),L&&(T-=L,g=m*T,_=x*T,T=S*T+L),g=(i=(g+=l.x)-(g|=0))?(0|i*P+(0>i?-.5:.5))/P+g:g,_=(i=(_+=l.y)-(_|=0))?(0|i*P+(0>i?-.5:.5))/P+_:_,T=(i=(T+=l.z)-(T|=0))?(0|i*P+(0>i?-.5:.5))/P+T:T,c[xt]="matrix3d("+[(0|d*P)/P,(0|v*P)/P,(0|b*P)/P,(0|M*P)/P,(0|f*P)/P,(0|y*P)/P,(0|w*P)/P,(0|E*P)/P,(0|m*P)/P,(0|x*P)/P,(0|S*P)/P,(0|C*P)/P,g,_,T,u?1+-T/u:1].join(",")+")"},Et=function(){var t,e,i,r,n,o,s,a,h,l=this.data,c=this.t,u=c.style;p&&(t=u.top?"top":u.bottom?"bottom":parseFloat(Y(c,"top",null,!1))?"bottom":"top",e=Y(c,t,null,!1),i=parseFloat(e)||0,r=e.substr((i+"").length)||"px",l._ffFix=!l._ffFix,u[t]=(l._ffFix?i+.05:i-.05)+r),l.rotation||l.skewX?(n=l.rotation,o=n-l.skewX,s=1e5,a=l.scaleX*s,h=l.scaleY*s,u[xt]="matrix("+(0|Math.cos(n)*a)/s+","+(0|Math.sin(n)*a)/s+","+(0|Math.sin(o)*-h)/s+","+(0|Math.cos(o)*h)/s+","+l.x+","+l.y+")"):u[xt]="matrix("+l.scaleX+",0,0,"+l.scaleY+","+l.x+","+l.y+")"};gt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation",{parser:function(t,e,i,r,o,s,a){if(r._transform)return o;var h,l,c,u,p,d,f,m=r._transform=St(t,n,!0),g=t.style,v=1e-6,y=yt.length,x=a,_={};if("string"==typeof x.transform&&xt)c=g.cssText,g[xt]=x.transform,g.display="block",h=St(t,null,!1),g.cssText=c;else if("object"==typeof x){if(h={scaleX:rt(null!=x.scaleX?x.scaleX:x.scale,m.scaleX),scaleY:rt(null!=x.scaleY?x.scaleY:x.scale,m.scaleY),scaleZ:rt(null!=x.scaleZ?x.scaleZ:x.scale,m.scaleZ),x:rt(x.x,m.x),y:rt(x.y,m.y),z:rt(x.z,m.z),perspective:rt(x.transformPerspective,m.perspective)},f=x.directionalRotation,null!=f)if("object"==typeof f)for(c in f)x[c]=f[c];else x.rotation=f;h.rotation=nt("rotation"in x?x.rotation:"shortRotation"in x?x.shortRotation+"_short":"rotationZ"in x?x.rotationZ:m.rotation*I,m.rotation,"rotation",_),wt&&(h.rotationX=nt("rotationX"in x?x.rotationX:"shortRotationX"in x?x.shortRotationX+"_short":m.rotationX*I||0,m.rotationX,"rotationX",_),h.rotationY=nt("rotationY"in x?x.rotationY:"shortRotationY"in x?x.shortRotationY+"_short":m.rotationY*I||0,m.rotationY,"rotationY",_)),h.skewX=null==x.skewX?m.skewX:nt(x.skewX,m.skewX),h.skewY=null==x.skewY?m.skewY:nt(x.skewY,m.skewY),(l=h.skewY-m.skewY)&&(h.skewX+=l,h.rotation+=l)}for(p=m.z||m.rotationX||m.rotationY||h.z||h.rotationX||h.rotationY||h.perspective,p||null==x.scale||(h.scaleZ=1);--y>-1;)i=yt[y],u=h[i]-m[i],(u>v||-v>u||null!=D[i])&&(d=!0,o=new pt(m,i,m[i],u,o),i in _&&(o.e=_[i]),o.xs0=0,o.plugin=s,r._overwriteProps.push(o.n));return u=x.transformOrigin,(u||wt&&p&&m.zOrigin)&&(xt?(d=!0,u=(u||Y(t,i,n,!1,"50% 50%"))+"",i=bt,o=new pt(g,i,0,0,o,-1,"css_transformOrigin"),o.b=g[i],o.plugin=s,wt?(c=m.zOrigin,u=u.split(" "),m.zOrigin=(u.length>2?parseFloat(u[2]):c)||0,o.xs0=o.e=g[i]=u[0]+" "+(u[1]||"50%")+" 0px",o=new pt(m,"zOrigin",0,0,o,-1,o.n),o.b=c,o.xs0=o.e=m.zOrigin):o.xs0=o.e=g[i]=u):et(u+"",m)),d&&(r._transformType=p||3===this._transformType?3:2),o},prefix:!0}),gt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),gt("borderRadius",{defaultValue:"0px",parser:function(t,e,i,o,s){e=this.format(e);var a,h,l,c,u,p,d,f,m,g,v,y,x,_,b,w,S=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],T=t.style;for(m=parseFloat(t.offsetWidth),g=parseFloat(t.offsetHeight),a=e.split(" "),h=0;S.length>h;h++)this.p.indexOf("border")&&(S[h]=W(S[h])),u=c=Y(t,S[h],n,!1,"0px"),-1!==u.indexOf(" ")&&(c=u.split(" "),u=c[0],c=c[1]),p=l=a[h],d=parseFloat(u),y=u.substr((d+"").length),x="="===p.charAt(1),x?(f=parseInt(p.charAt(0)+"1",10),p=p.substr(2),f*=parseFloat(p),v=p.substr((f+"").length-(0>f?1:0))||""):(f=parseFloat(p),v=p.substr((f+"").length)),""===v&&(v=r[i]||y),v!==y&&(_=q(t,"borderLeft",d,y),b=q(t,"borderTop",d,y),"%"===v?(u=100*(_/m)+"%",c=100*(b/g)+"%"):"em"===v?(w=q(t,"borderLeft",1,"em"),u=_/w+"em",c=b/w+"em"):(u=_+"px",c=b+"px"),x&&(p=parseFloat(u)+f+v,l=parseFloat(c)+f+v)),s=dt(T,S[h],u+" "+c,p+" "+l,!1,"0px",s);return s},prefix:!0,formatter:lt("0px 0px 0px 0px",!1,!0)}),gt("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,i,r,o,s){var a,h,l,c,u,p,d="background-position",m=n||X(t,null),g=this.format((m?f?m.getPropertyValue(d+"-x")+" "+m.getPropertyValue(d+"-y"):m.getPropertyValue(d):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),v=this.format(e);if(-1!==g.indexOf("%")!=(-1!==v.indexOf("%"))&&(p=Y(t,"backgroundImage").replace(E,""),p&&"none"!==p)){for(a=g.split(" "),h=v.split(" "),F.setAttribute("src",p),l=2;--l>-1;)g=a[l],c=-1!==g.indexOf("%"),c!==(-1!==h[l].indexOf("%"))&&(u=0===l?t.offsetWidth-F.width:t.offsetHeight-F.height,a[l]=c?parseFloat(g)/100*u+"px":100*(parseFloat(g)/u)+"%");g=a.join(" ")}return this.parseComplex(t.style,g,v,o,s)},formatter:et}),gt("backgroundSize",{defaultValue:"0 0",formatter:et}),gt("perspective",{defaultValue:"0px",prefix:!0}),gt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),gt("transformStyle",{prefix:!0}),gt("backfaceVisibility",{prefix:!0}),gt("margin",{parser:ct("marginTop,marginRight,marginBottom,marginLeft")}),gt("padding",{parser:ct("paddingTop,paddingRight,paddingBottom,paddingLeft")}),gt("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,i,r,o,s){var a,h,l;return 9>f?(h=t.currentStyle,l=8>f?" ":",",a="rect("+h.clipTop+l+h.clipRight+l+h.clipBottom+l+h.clipLeft+")",e=this.format(e).split(",").join(l)):(a=this.format(Y(t,this.p,n,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,a,e,o,s)}}),gt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),gt("autoRound,strictUnits",{parser:function(t,e,i,r,n){return n}}),gt("border",{defaultValue:"0px solid #000",parser:function(t,e,i,r,o,s){return this.parseComplex(t.style,this.format(Y(t,"borderTopWidth",n,!1,"0px")+" "+Y(t,"borderTopStyle",n,!1,"solid")+" "+Y(t,"borderTopColor",n,!1,"#000")),this.format(e),o,s)},color:!0,formatter:function(t){var e=t.split(" ");return e[0]+" "+(e[1]||"solid")+" "+(t.match(ht)||["#000"])[0]}}),gt("float,cssFloat,styleFloat",{parser:function(t,e,i,r,n){var o=t.style,s="cssFloat"in o?"cssFloat":"styleFloat";return new pt(o,s,0,0,n,-1,i,!1,0,o[s],e)}});var Ct=function(t){var e,i=this.t,r=i.filter,n=0|this.s+this.c*t;100===n&&(-1===r.indexOf("atrix(")&&-1===r.indexOf("radient(")?(i.removeAttribute("filter"),e=!Y(this.data,"filter")):(i.filter=r.replace(w,""),e=!0)),e||(this.xn1&&(i.filter=r=r||"alpha(opacity=100)"),-1===r.indexOf("opacity")?i.filter+=" alpha(opacity="+n+")":i.filter=r.replace(_,"opacity="+n))};gt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,i,r,o,s){var a,h=parseFloat(Y(t,"opacity",n,!1,"1")),l=t.style;return e=parseFloat(e),"autoAlpha"===i&&(a=Y(t,"visibility",n),1===h&&"hidden"===a&&0!==e&&(h=0),o=new pt(l,"visibility",0,0,o,-1,null,!1,0,0!==h?"visible":"hidden",0===e?"hidden":"visible"),o.xs0="visible",r._overwriteProps.push(o.n)),G?o=new pt(l,"opacity",h,e-h,o):(o=new pt(l,"opacity",100*h,100*(e-h),o),o.xn1="autoAlpha"===i?1:0,l.zoom=1,o.type=2,o.b="alpha(opacity="+o.s+")",o.e="alpha(opacity="+(o.s+o.c)+")",o.data=t,o.plugin=s,o.setRatio=Ct),o}});var At=function(t,e){e&&(t.removeProperty?t.removeProperty(e.replace(T,"-$1").toLowerCase()):t.removeAttribute(e))},Lt=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.className=0===t?this.b:this.e;for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:At(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.className!==this.e&&(this.t.className=this.e)};gt("className",{parser:function(t,e,r,o,s,a,h){var l,c,u,p,d,f=t.className,m=t.style.cssText;if(s=o._classNamePT=new pt(t,r,0,0,s,2),s.setRatio=Lt,s.pr=-11,i=!0,s.b=f,c=Z(t,n),u=t._gsClassPT){for(p={},d=u.data;d;)p[d.p]=1,d=d._next;u.setRatio(1)}return t._gsClassPT=s,s.e="="!==e.charAt(1)?e:f.replace(RegExp("\\s*\\b"+e.substr(2)+"\\b"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),o._tween._duration&&(t.className=s.e,l=J(t,c,Z(t),h,p),t.className=f,s.data=l.firstMPT,t.style.cssText=m,s=s.xfirst=o.parse(t,l.difs,s,a)),s}});var Pt=function(t){if((1===t||0===t)&&this.data._totalTime===this.data._totalDuration)for(var e,i="all"===this.e,r=this.t.style,n=i?r.cssText.split(";"):this.e.split(","),o=n.length,s=a.transform.parse;--o>-1;)e=n[o],i&&(e=e.substr(0,e.indexOf(":")).split(" ").join("")),a[e]&&(e=a[e].parse===s?xt:a[e].p),At(r,e)};for(gt("clearProps",{parser:function(t,e,r,n,o){return o=new pt(t,r,0,0,o,2),o.setRatio=Pt,o.e=e,o.pr=-10,o.data=n._tween,i=!0,o}}),h="bezier,throwProps,physicsProps,physics2D".split(","),ft=h.length;ft--;)vt(h[ft]);h=s.prototype,h._firstPT=null,h._onInitTween=function(t,e,a){if(!t.nodeType)return!1;this._target=t,this._tween=a,this._vars=e,l=e.autoRound,i=!1,r=e.suffixMap||s.suffixMap,n=X(t,""),o=this._overwriteProps;var h,p,f,m,g,v,y,x,_,w=t.style;if(c&&""===w.zIndex&&(h=Y(t,"zIndex",n),("auto"===h||""===h)&&(w.zIndex=0)),"string"==typeof e&&(m=w.cssText,h=Z(t,n),w.cssText=m+";"+e,h=J(t,h,Z(t)).difs,!G&&b.test(e)&&(h.opacity=parseFloat(RegExp.$1)),e=h,w.cssText=m),this._firstPT=p=this.parse(t,e,null),this._transformType){for(_=3===this._transformType,xt?u&&(c=!0,""===w.zIndex&&(y=Y(t,"zIndex",n),("auto"===y||""===y)&&(w.zIndex=0)),d&&(w.WebkitBackfaceVisibility=this._vars.WebkitBackfaceVisibility||(_?"visible":"hidden"))):w.zoom=1,f=p;f&&f._next;)f=f._next;x=new pt(t,"transform",0,0,null,2),this._linkCSSP(x,null,f),x.setRatio=_&&wt?Mt:xt?Et:Tt,x.data=this._transform||St(t,n,!0),
o.pop()}if(i){for(;p;){for(v=p._next,f=m;f&&f.pr>p.pr;)f=f._next;(p._prev=f?f._prev:g)?p._prev._next=p:m=p,(p._next=f)?f._prev=p:g=p,p=v}this._firstPT=m}return!0},h.parse=function(t,e,i,o){var s,h,c,u,p,d,f,m,g,v,y=t.style;for(s in e)d=e[s],h=a[s],h?i=h.parse(t,d,s,this,i,o,e):(p=Y(t,s,n)+"",g="string"==typeof d,"color"===s||"fill"===s||"stroke"===s||-1!==s.indexOf("Color")||g&&S.test(d)?(g||(d=at(d),d=(d.length>3?"rgba(":"rgb(")+d.join(",")+")"),i=dt(y,s,p,d,!0,"transparent",i,0,o)):!g||-1===d.indexOf(" ")&&-1===d.indexOf(",")?(c=parseFloat(p),f=c||0===c?p.substr((c+"").length):"",(""===p||"auto"===p)&&("width"===s||"height"===s?(c=tt(t,s,n),f="px"):"left"===s||"top"===s?(c=K(t,s,n),f="px"):(c="opacity"!==s?0:1,f="")),v=g&&"="===d.charAt(1),v?(u=parseInt(d.charAt(0)+"1",10),d=d.substr(2),u*=parseFloat(d),m=d.replace(x,"")):(u=parseFloat(d),m=g?d.substr((u+"").length)||"":""),""===m&&(m=r[s]||f),d=u||0===u?(v?u+c:u)+m:e[s],f!==m&&""!==m&&(u||0===u)&&(c||0===c)&&(c=q(t,s,c,f),"%"===m?(c/=q(t,s,100,"%")/100,c>100&&(c=100),e.strictUnits!==!0&&(p=c+"%")):"em"===m?c/=q(t,s,1,"em"):(u=q(t,s,u,m),m="px"),v&&(u||0===u)&&(d=u+c+m)),v&&(u+=c),!c&&0!==c||!u&&0!==u?d||"NaN"!=d+""&&null!=d?(i=new pt(y,s,u||c||0,0,i,-1,"css_"+s,!1,0,p,d),i.xs0="none"!==d||"display"!==s&&-1===s.indexOf("Style")?d:p):V("invalid "+s+" tween value: "+e[s]):(i=new pt(y,s,c,u-c,i,0,"css_"+s,l!==!1&&("px"===m||"zIndex"===s),0,p,d),i.xs0=m)):i=dt(y,s,p,d,!0,null,i,0,o)),o&&i&&!i.plugin&&(i.plugin=o);return i},h.setRatio=function(t){var e,i,r,n=this._firstPT,o=1e-6;if(1!==t||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(t||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;n;){if(e=n.c*t+n.s,n.r?e=e>0?0|e+.5:0|e-.5:o>e&&e>-o&&(e=0),n.type)if(1===n.type)if(r=n.l,2===r)n.t[n.p]=n.xs0+e+n.xs1+n.xn1+n.xs2;else if(3===r)n.t[n.p]=n.xs0+e+n.xs1+n.xn1+n.xs2+n.xn2+n.xs3;else if(4===r)n.t[n.p]=n.xs0+e+n.xs1+n.xn1+n.xs2+n.xn2+n.xs3+n.xn3+n.xs4;else if(5===r)n.t[n.p]=n.xs0+e+n.xs1+n.xn1+n.xs2+n.xn2+n.xs3+n.xn3+n.xs4+n.xn4+n.xs5;else{for(i=n.xs0+e+n.xs1,r=1;n.l>r;r++)i+=n["xn"+r]+n["xs"+(r+1)];n.t[n.p]=i}else-1===n.type?n.t[n.p]=n.xs0:n.setRatio&&n.setRatio(t);else n.t[n.p]=e+n.xs0;n=n._next}else for(;n;)2!==n.type?n.t[n.p]=n.b:n.setRatio(t),n=n._next;else for(;n;)2!==n.type?n.t[n.p]=n.e:n.setRatio(t),n=n._next},h._enableTransforms=function(t){this._transformType=t||3===this._transformType?3:2},h._linkCSSP=function(t,e,i,r){return t&&(e&&(e._prev=t),t._next&&(t._next._prev=t._prev),i?i._next=t:r||null!==this._firstPT||(this._firstPT=t),t._prev?t._prev._next=t._next:this._firstPT===t&&(this._firstPT=t._next),t._next=e,t._prev=i),t},h._kill=function(e){var i,r,n,o=e;if(e.css_autoAlpha||e.css_alpha){o={};for(r in e)o[r]=e[r];o.css_opacity=1,o.css_autoAlpha&&(o.css_visibility=1)}return e.css_className&&(i=this._classNamePT)&&(n=i.xfirst,n&&n._prev?this._linkCSSP(n._prev,i._next,n._prev._prev):n===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,n._prev),this._classNamePT=null),t.prototype._kill.call(this,o)};var Rt=function(t,e,i){var r,n,o,s;if(t.slice)for(n=t.length;--n>-1;)Rt(t[n],e,i);else for(r=t.childNodes,n=r.length;--n>-1;)o=r[n],s=o.type,o.style&&(e.push(Z(o)),i&&i.push(o)),1!==s&&9!==s&&11!==s||!o.childNodes.length||Rt(o,e,i)};return s.cascadeTo=function(t,i,r){var n,o,s,a=e.to(t,i,r),h=[a],l=[],c=[],u=[],p=e._internals.reservedProps;for(t=a._targets||a.target,Rt(t,l,u),a.render(i,!0),Rt(t,c),a.render(0,!0),a._enabled(!0),n=u.length;--n>-1;)if(o=J(u[n],l[n],c[n]),o.firstMPT){o=o.difs;for(s in r)p[s]&&(o[s]=r[s]);h.push(e.to(u[n],i,o))}return h},t.activate([s]),s},!0)}),window._gsDefine&&window._gsQueue.pop()()},function(t,e,i){var r;!function(){var n={},o=function(t){var e=window.AudioContext||window.webkitAudioContext;t="number"==typeof t?t:44100;var i=new e;if(/(iPhone|iPad)/i.test(navigator.userAgent)&&i.sampleRate!==t){var r=i.createBuffer(1,1,t),n=i.createBufferSource();n.buffer=r,n.connect(i.destination),n.start(0),n.disconnect(),i.close(),i=new e}return i},s=null,a=!0,h=!1;try{"undefined"!=typeof AudioContext?s=new o:"undefined"!=typeof webkitAudioContext?s=new o:a=!1}catch(l){a=!1}if(!a)if("undefined"!=typeof Audio)try{new Audio}catch(l){h=!0}else h=!0;if(a){var c="undefined"==typeof s.createGain?s.createGainNode():s.createGain();c.gain.value=1,c.connect(s.destination)}var u=function(t){this._volume=1,this._muted=!1,this.usingWebAudio=a,this.ctx=s,this.noAudio=h,this._howls=[],this._codecs=t,this.iOSAutoEnable=!0};u.prototype={volume:function(t){var e=this;if(t=parseFloat(t),t>=0&&1>=t){e._volume=t,a&&(c.gain.value=t);for(var i in e._howls)if(e._howls.hasOwnProperty(i)&&e._howls[i]._webAudio===!1)for(var r=0;r<e._howls[i]._audioNode.length;r++)e._howls[i]._audioNode[r].volume=e._howls[i]._volume*e._volume;return e}return a?c.gain.value:e._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(t){var e=this;e._muted=t,a&&(c.gain.value=t?0:e._volume);for(var i in e._howls)if(e._howls.hasOwnProperty(i)&&e._howls[i]._webAudio===!1)for(var r=0;r<e._howls[i]._audioNode.length;r++)e._howls[i]._audioNode[r].muted=t},codecs:function(t){return this._codecs[t]},_enableiOSAudio:function(){var t=this;if(!s||!t._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){t._iOSEnabled=!1;var e=function(){var i=s.createBuffer(1,1,22050),r=s.createBufferSource();r.buffer=i,r.connect(s.destination),"undefined"==typeof r.start?r.noteOn(0):r.start(0),setTimeout(function(){r.playbackState!==r.PLAYING_STATE&&r.playbackState!==r.FINISHED_STATE||(t._iOSEnabled=!0,t.iOSAutoEnable=!1,window.removeEventListener("touchend",e,!1))},0)};return window.addEventListener("touchend",e,!1),t}}};var p=null,d={};h||(p=new Audio,d={mp3:!!p.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!p.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!p.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!p.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!p.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(p.canPlayType("audio/x-m4a;")||p.canPlayType("audio/m4a;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(p.canPlayType("audio/x-mp4;")||p.canPlayType("audio/mp4;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!p.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var f=new u(d),m=function(t){var e=this;e._autoplay=t.autoplay||!1,e._buffer=t.buffer||!1,e._duration=t.duration||0,e._format=t.format||null,e._loop=t.loop||!1,e._loaded=!1,e._sprite=t.sprite||{},e._src=t.src||"",e._pos3d=t.pos3d||[0,0,-.5],e._volume=void 0!==t.volume?t.volume:1,e._urls=t.urls||[],e._rate=t.rate||1,e._model=t.model||null,e._onload=[t.onload||function(){}],e._onloaderror=[t.onloaderror||function(){}],e._onend=[t.onend||function(){}],e._onpause=[t.onpause||function(){}],e._onplay=[t.onplay||function(){}],e._onendTimer=[],e._webAudio=a&&!e._buffer,e._audioNode=[],e._webAudio&&e._setupAudioNode(),"undefined"!=typeof s&&s&&f.iOSAutoEnable&&f._enableiOSAudio(),f._howls.push(e),e.load()};if(m.prototype={load:function(){var t=this,e=null;if(h)return void t.on("loaderror",new Error("No audio support."));for(var i=0;i<t._urls.length;i++){var r,n;if(t._format)r=t._format;else{if(n=t._urls[i],r=/^data:audio\/([^;,]+);/i.exec(n),r||(r=/\.([^.]+)$/.exec(n.split("?",1)[0])),!r)return void t.on("loaderror",new Error("Could not extract format from passed URLs, please add format parameter."));r=r[1].toLowerCase()}if(d[r]){e=t._urls[i];break}}if(!e)return void t.on("loaderror",new Error("No codec support for selected audio sources."));if(t._src=e,t._webAudio)g(t,e);else{var o=new Audio;o.addEventListener("error",function(){o.error&&4===o.error.code&&(u.noAudio=!0),t.on("loaderror",{type:o.error?o.error.code:0})},!1),t._audioNode.push(o),o.src=e,o._pos=0,o.preload="auto",o.volume=f._muted?0:t._volume*f.volume();var s=function(){t._duration=Math.ceil(10*o.duration)/10,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play(),o.removeEventListener("canplaythrough",s,!1)};o.addEventListener("canplaythrough",s,!1),o.load()}return t},urls:function(t){var e=this;return t?(e.stop(),e._urls="string"==typeof t?[t]:t,e._loaded=!1,e.load(),e):e._urls},play:function(t,e){var i=this;return"function"==typeof t&&(e=t),t&&"function"!=typeof t||(t="_default"),i._loaded?i._sprite[t]?(i._inactiveNode(function(r){r._sprite=t;var n=r._pos>0?r._pos:i._sprite[t][0]/1e3,o=0;i._webAudio?(o=i._sprite[t][1]/1e3-r._pos,r._pos>0&&(n=i._sprite[t][0]/1e3+n)):o=i._sprite[t][1]/1e3-(n-i._sprite[t][0]/1e3);var a,h=!(!i._loop&&!i._sprite[t][2]),l="string"==typeof e?e:Math.round(Date.now()*Math.random())+"";if(function(){var e={id:l,sprite:t,loop:h};a=setTimeout(function(){!i._webAudio&&h&&i.stop(e.id).play(t,e.id),i._webAudio&&!h&&(i._nodeById(e.id).paused=!0,i._nodeById(e.id)._pos=0,i._clearEndTimer(e.id)),i._webAudio||h||i.stop(e.id),i.on("end",l)},o/i._rate*1e3),i._onendTimer.push({timer:a,id:e.id})}(),i._webAudio){var c=i._sprite[t][0]/1e3,u=i._sprite[t][1]/1e3;r.id=l,r.paused=!1,x(i,[h,c,u],l),i._playStart=s.currentTime,r.gain.value=i._volume,"undefined"==typeof r.bufferSource.start?h?r.bufferSource.noteGrainOn(0,n,86400):r.bufferSource.noteGrainOn(0,n,o):h?r.bufferSource.start(0,n,86400):r.bufferSource.start(0,n,o)}else{if(4!==r.readyState&&(r.readyState||!navigator.isCocoonJS))return i._clearEndTimer(l),function(){var n=i,o=t,s=e,a=r,h=function(){n.play(o,s),a.removeEventListener("canplaythrough",h,!1)};a.addEventListener("canplaythrough",h,!1)}(),i;r.readyState=4,r.id=l,r.currentTime=n,r.muted=f._muted||r.muted,r.volume=i._volume*f.volume(),setTimeout(function(){r.play()},0)}return i.on("play"),"function"==typeof e&&e(l),i}),i):("function"==typeof e&&e(),i):(i.on("load",function(){i.play(t,e)}),i)},pause:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.pause(t)}),e;e._clearEndTimer(t);var i=t?e._nodeById(t):e._activeNode();if(i)if(i._pos=e.pos(null,t),e._webAudio){if(!i.bufferSource||i.paused)return e;i.paused=!0,"undefined"==typeof i.bufferSource.stop?i.bufferSource.noteOff(0):i.bufferSource.stop(0)}else i.pause();return e.on("pause"),e},stop:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.stop(t)}),e;e._clearEndTimer(t);var i=t?e._nodeById(t):e._activeNode();if(i)if(i._pos=0,e._webAudio){if(!i.bufferSource||i.paused)return e;i.paused=!0,"undefined"==typeof i.bufferSource.stop?i.bufferSource.noteOff(0):i.bufferSource.stop(0)}else isNaN(i.duration)||(i.pause(),i.currentTime=0);return e},mute:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.mute(t)}),e;var i=t?e._nodeById(t):e._activeNode();return i&&(e._webAudio?i.gain.value=0:i.muted=!0),e},unmute:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.unmute(t)}),e;var i=t?e._nodeById(t):e._activeNode();return i&&(e._webAudio?i.gain.value=e._volume:i.muted=!1),e},volume:function(t,e){var i=this;if(t=parseFloat(t),t>=0&&1>=t){if(i._volume=t,!i._loaded)return i.on("play",function(){i.volume(t,e)}),i;var r=e?i._nodeById(e):i._activeNode();return r&&(i._webAudio?r.gain.value=t:r.volume=t*f.volume()),i}return i._volume},loop:function(t){var e=this;return"boolean"==typeof t?(e._loop=t,e):e._loop},sprite:function(t){var e=this;return"object"==typeof t?(e._sprite=t,e):e._sprite},pos:function(t,e){var i=this;if(!i._loaded)return i.on("load",function(){i.pos(t)}),"number"==typeof t?i:i._pos||0;t=parseFloat(t);var r=e?i._nodeById(e):i._activeNode();if(r)return t>=0?(i.pause(e),r._pos=t,i.play(r._sprite,e),i):i._webAudio?r._pos+(s.currentTime-i._playStart):r.currentTime;if(t>=0)return i;for(var n=0;n<i._audioNode.length;n++)if(i._audioNode[n].paused&&4===i._audioNode[n].readyState)return i._webAudio?i._audioNode[n]._pos:i._audioNode[n].currentTime},pos3d:function(t,e,i,r){var n=this;if(e="undefined"!=typeof e&&e?e:0,i="undefined"!=typeof i&&i?i:-.5,!n._loaded)return n.on("play",function(){n.pos3d(t,e,i,r)}),n;if(!(t>=0||0>t))return n._pos3d;if(n._webAudio){var o=r?n._nodeById(r):n._activeNode();o&&(n._pos3d=[t,e,i],o.panner.setPosition(t,e,i),o.panner.panningModel=n._model||"HRTF")}return n},fade:function(t,e,i,r,n){var o=this,s=Math.abs(t-e),a=t>e?"down":"up",h=s/.01,l=i/h;if(!o._loaded)return o.on("load",function(){o.fade(t,e,i,r,n)}),o;o.volume(t,n);for(var c=1;h>=c;c++)!function(){var t=o._volume+("up"===a?.01:-.01)*c,i=Math.round(1e3*t)/1e3,s=e;setTimeout(function(){o.volume(i,n),i===s&&r&&r()},l*c)}()},fadeIn:function(t,e,i){return this.volume(0).play().fade(0,t,e,i)},fadeOut:function(t,e,i,r){var n=this;return n.fade(n._volume,t,e,function(){i&&i(),n.pause(r),n.on("end")},r)},_nodeById:function(t){for(var e=this,i=e._audioNode[0],r=0;r<e._audioNode.length;r++)if(e._audioNode[r].id===t){i=e._audioNode[r];break}return i},_activeNode:function(){for(var t=this,e=null,i=0;i<t._audioNode.length;i++)if(!t._audioNode[i].paused){e=t._audioNode[i];break}return t._drainPool(),e},_inactiveNode:function(t){for(var e=this,i=null,r=0;r<e._audioNode.length;r++)if(e._audioNode[r].paused&&4===e._audioNode[r].readyState){t(e._audioNode[r]),i=!0;break}if(e._drainPool(),!i){var n;if(e._webAudio)n=e._setupAudioNode(),t(n);else{e.load(),n=e._audioNode[e._audioNode.length-1];var o=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",s=function(){n.removeEventListener(o,s,!1),t(n)};n.addEventListener(o,s,!1)}}},_drainPool:function(){var t,e=this,i=0;for(t=0;t<e._audioNode.length;t++)e._audioNode[t].paused&&i++;for(t=e._audioNode.length-1;t>=0&&!(5>=i);t--)e._audioNode[t].paused&&(e._webAudio&&e._audioNode[t].disconnect(0),i--,e._audioNode.splice(t,1))},_clearEndTimer:function(t){for(var e=this,i=-1,r=0;r<e._onendTimer.length;r++)if(e._onendTimer[r].id===t){i=r;break}var n=e._onendTimer[i];n&&(clearTimeout(n.timer),e._onendTimer.splice(i,1))},_setupAudioNode:function(){var t=this,e=t._audioNode,i=t._audioNode.length;return e[i]="undefined"==typeof s.createGain?s.createGainNode():s.createGain(),e[i].gain.value=t._volume,e[i].paused=!0,e[i]._pos=0,e[i].readyState=4,e[i].connect(c),e[i].panner=s.createPanner(),e[i].panner.panningModel=t._model||"equalpower",e[i].panner.setPosition(t._pos3d[0],t._pos3d[1],t._pos3d[2]),e[i].panner.connect(e[i]),e[i]},on:function(t,e){var i=this,r=i["_on"+t];if("function"==typeof e)r.push(e);else for(var n=0;n<r.length;n++)e?r[n].call(i,e):r[n].call(i);return i},off:function(t,e){var i=this,r=i["_on"+t];if(e){for(var n=0;n<r.length;n++)if(e===r[n]){r.splice(n,1);break}}else i["_on"+t]=[];return i},unload:function(){for(var t=this,e=t._audioNode,i=0;i<t._audioNode.length;i++)e[i].paused||(t.stop(e[i].id),t.on("end",e[i].id)),t._webAudio?e[i].disconnect(0):e[i].src="";for(i=0;i<t._onendTimer.length;i++)clearTimeout(t._onendTimer[i].timer);var r=f._howls.indexOf(t);null!==r&&r>=0&&f._howls.splice(r,1),delete n[t._src],t=null}},a)var g=function(t,e){if(e in n)return t._duration=n[e].duration,void y(t);if(/^data:[^;]+;base64,/.test(e)){for(var i=atob(e.split(",")[1]),r=new Uint8Array(i.length),o=0;o<i.length;++o)r[o]=i.charCodeAt(o);v(r.buffer,t,e)}else{var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=function(){v(s.response,t,e)},s.onerror=function(){t._webAudio&&(t._buffer=!0,t._webAudio=!1,t._audioNode=[],delete t._gainNode,delete n[e],t.load())};try{s.send()}catch(a){s.onerror()}}},v=function(t,e,i){s.decodeAudioData(t,function(t){t&&(n[i]=t,y(e,t))},function(t){e.on("loaderror",t)})},y=function(t,e){t._duration=e?e.duration:t._duration,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play()},x=function(t,e,i){var r=t._nodeById(i);r.bufferSource=s.createBufferSource(),r.bufferSource.buffer=n[t._src],r.bufferSource.connect(r.panner),r.bufferSource.loop=e[0],e[0]&&(r.bufferSource.loopStart=e[1],r.bufferSource.loopEnd=e[1]+e[2]),r.bufferSource.playbackRate.value=t._rate};r=function(){return{Howler:f,Howl:m}}.call(e,i,e,t),!(void 0!==r&&(t.exports=r)),e.Howler=f,e.Howl=m,"undefined"!=typeof window&&(window.Howler=f,window.Howl=m)}()},function(t,e,i){var r,r;(function(e,i){!function(e){t.exports=e()}(function(){var t;return function n(t,e,i){function o(a,h){if(!e[a]){if(!t[a]){var l="function"==typeof r&&r;if(!h&&l)return r(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=e[a]={exports:{}};t[a][0].call(u.exports,function(e){var i=t[a][1][e];return o(i?i:e)},u,u.exports,n,t,e,i)}return e[a].exports}for(var s="function"==typeof r&&r,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,i){e.exports={createContext:t("./lib/createContext"),setVertexAttribArrays:t("./lib/setVertexAttribArrays"),GLBuffer:t("./lib/GLBuffer"),GLFramebuffer:t("./lib/GLFramebuffer"),GLShader:t("./lib/GLShader"),GLTexture:t("./lib/GLTexture"),VertexArrayObject:t("./lib/VertexArrayObject")}},{"./lib/GLBuffer":2,"./lib/GLFramebuffer":3,"./lib/GLShader":4,"./lib/GLTexture":5,"./lib/VertexArrayObject":6,"./lib/createContext":7,"./lib/setVertexAttribArrays":8}],2:[function(t,e,i){var r=new ArrayBuffer(0),n=function(t,e,i,n){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=n||t.STATIC_DRAW,this.data=r,i&&this.upload(i)};n.prototype.upload=function(t,e,i){i||this.bind();var r=this.gl;t=t||this.data,e=e||0,this.data.byteLength>=t.byteLength?r.bufferSubData(this.type,e,t):r.bufferData(this.type,t,this.drawType),this.data=t},n.prototype.bind=function(){var t=this.gl;t.bindBuffer(this.type,this.buffer)},n.createVertexBuffer=function(t,e,i){return new n(t,t.ARRAY_BUFFER,e,i)},n.createIndexBuffer=function(t,e,i){return new n(t,t.ELEMENT_ARRAY_BUFFER,e,i)},n.create=function(t,e,i,r){return new n(t,e,r)},n.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=n},{}],3:[function(t,e,i){var r=t("./GLTexture"),n=function(t,e,i){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=i||100};n.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new r(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},n.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},n.prototype.clear=function(t,e,i,r){this.bind();var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT)},n.prototype.bind=function(){var t=this.gl;this.texture&&this.texture.unbind(),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},n.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},n.prototype.resize=function(t,e){var i=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencil),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},n.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},n.createRGBA=function(t,e,i,o){var s=r.fromData(t,null,e,i);s.enableNearestScaling(),s.enableWrapClamp();var a=new n(t,e,i);return a.enableTexture(s),a.unbind(),a},n.createFloat32=function(t,e,i,o){var s=new r.fromData(t,o,e,i);s.enableNearestScaling(),s.enableWrapClamp();var a=new n(t,e,i);return a.enableTexture(s),a.unbind(),a},e.exports=n},{"./GLTexture":5}],4:[function(t,e,i){var r=t("./shader/compileProgram"),n=t("./shader/extractAttributes"),o=t("./shader/extractUniforms"),s=t("./shader/generateUniformAccessObject"),a=function(t,e,i){this.gl=t,this.program=r(t,e,i),this.attributes=n(t,this.program);var a=o(t,this.program);this.uniforms=s(t,a)};a.prototype.bind=function(){this.gl.useProgram(this.program)},a.prototype.destroy=function(){this.gl},e.exports=a},{"./shader/compileProgram":9,"./shader/extractAttributes":11,"./shader/extractUniforms":12,"./shader/generateUniformAccessObject":13}],5:[function(t,e,i){var r=function(t,e,i,r,n){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||0,this.height=i||0,this.format=r||t.RGBA,this.type=n||t.UNSIGNED_BYTE};r.prototype.upload=function(t){this.bind();var e=this.gl;this.width=t.videoWidth||t.width,this.height=t.videoHeight||t.height,e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t)};var n=!1;r.prototype.uploadData=function(t,e,i){this.bind();var r=this.gl;if(this.width=e||this.width,this.height=i||this.height,t instanceof Float32Array){if(!n){var o=r.getExtension("OES_texture_float");if(!o)throw new Error("floating point textures not available");n=!0}this.type=r.FLOAT}else this.type=r.UNSIGNED_BYTE;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),r.texImage2D(r.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,t||null)},r.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},r.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},r.prototype.minFilter=function(t){var e=this.gl;this.bind(),this.mipmap?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR:e.NEAREST)},r.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},r.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},r.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},r.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},r.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},r.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},r.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},r.prototype.destroy=function(){var t=this.gl;t.deleteTexture(this.texture)},r.fromSource=function(t,e,i){var n=new r(t);return n.premultiplyAlpha=i||!1,n.upload(e),n},r.fromData=function(t,e,i,n){var o=new r(t);return o.uploadData(e,i,n),o},e.exports=r},{}],6:[function(t,e,i){function r(t,e){if(this.nativeVaoExtension=null,r.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var i=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(i),attribState:new Array(i)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var n=t("./setVertexAttribArrays");r.prototype.constructor=r,e.exports=r,r.FORCE_NATIVE=!1,r.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},r.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},r.prototype.activate=function(){for(var t=this.gl,e=null,i=0;i<this.attributes.length;i++){var r=this.attributes[i];e!==r.buffer&&(r.buffer.bind(),e=r.buffer),t.vertexAttribPointer(r.attribute.location,r.attribute.size,r.type||t.FLOAT,r.normalized||!1,r.stride||0,r.start||0)}return n(t,this.attributes,this.nativeState),this.indexBuffer.bind(),this},r.prototype.addAttribute=function(t,e,i,r,n,o){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:i||this.gl.FLOAT,normalized:r||!1,stride:n||0,start:o||0}),this.dirty=!0,this},r.prototype.addIndex=function(t,e){return this.indexBuffer=t,this.dirty=!0,this},r.prototype.clear=function(){this.gl;return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},r.prototype.draw=function(t,e,i){var r=this.gl;return r.drawElements(t,e,r.UNSIGNED_SHORT,i||0),this},r.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null}},{"./setVertexAttribArrays":8}],7:[function(t,e,i){var r=function(t,e){var i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("This browser does not support webGL. Try using the canvas renderer");return i};e.exports=r},{}],8:[function(t,e,i){var r=function(t,e,i){var r;if(i){var n=i.tempAttribState,o=i.attribState;for(r=0;r<n.length;r++)n[r]=!1;for(r=0;r<e.length;r++)n[e[r].attribute.location]=!0;for(r=0;r<o.length;r++)o[r]!==n[r]&&(o[r]=n[r],i.attribState[r]?t.enableVertexAttribArray(r):t.disableVertexAttribArray(r))}else for(r=0;r<e.length;r++){var s=e[r];t.enableVertexAttribArray(s.attribute.location)}};e.exports=r},{}],9:[function(t,e,i){var r=function(t,e,i){var r=n(t,t.VERTEX_SHADER,e),o=n(t,t.FRAGMENT_SHADER,i),s=t.createProgram();return t.attachShader(s,r),t.attachShader(s,o),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(""!==t.getProgramInfoLog(s),t.deleteProgram(s),s=null),t.deleteShader(r),t.deleteShader(o),s},n=function(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null};e.exports=r},{}],10:[function(t,e,i){var r=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return n(2*e);case"bvec3":return n(3*e);case"bvec4":return n(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},n=function(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e};e.exports=r},{}],11:[function(t,e,i){var r=t("./mapType"),n=t("./mapSize"),o=function(t,e){for(var i={},o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;o>a;a++){var h=t.getActiveAttrib(e,a),l=r(t,h.type);i[h.name]={type:l,size:n(l),location:t.getAttribLocation(e,h.name),pointer:s}}return i},s=function(t,e,i,r){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,i||0,r||0)};e.exports=o},{"./mapSize":14,"./mapType":15}],12:[function(t,e,i){var r=t("./mapType"),n=t("./defaultValue"),o=function(t,e){for(var i={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;o>s;s++){var a=t.getActiveUniform(e,s),h=a.name.replace(/\[.*?\]/,""),l=r(t,a.type);i[h]={type:l,size:a.size,location:t.getUniformLocation(e,h),value:n(l,a.size)}}return i};e.exports=o},{"./defaultValue":10,"./mapType":15}],13:[function(t,e,i){var r=function(t,e){var i={data:{}};i.gl=t;for(var r=Object.keys(e),a=0;a<r.length;a++){var h=r[a],l=h.split("."),c=l[l.length-1],u=s(l,i),p=e[h];u.data[c]=p,u.gl=t,Object.defineProperty(u,c,{get:n(c),set:o(c,p)})}return i},n=function(t){var e=a.replace("%%",t);return new Function(e)},o=function(t,e){var i,r=h.replace(/%%/g,t);return i=1===e.size?l[e.type]:c[e.type],i&&(r+="\nthis.gl."+i+";"),new Function("value",r)},s=function(t,e){for(var i=e,r=0;r<t.length-1;r++){var n=i[t[r]]||{data:{}};i[t[r]]=n,i=n}return i},a=["return this.data.%%.value;"].join("\n"),h=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),l={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},c={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};e.exports=r},{}],14:[function(t,e,i){var r=function(t){return n[t]},n={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=r},{}],15:[function(t,e,i){var r=function(t,e){if(!n){var i=Object.keys(o);n={};for(var r=0;r<i.length;++r){var s=i[r];n[t[s]]=o[s]}}return n[e]},n=null,o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=r},{}],16:[function(r,n,o){(function(e,r){!function(){function o(){}function s(t){return t}function a(t){return!!t}function h(t){return!t}function l(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function c(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}function u(t){return z(t)||"number"==typeof t.length&&t.length>=0&&t.length%1===0}function p(t,e){for(var i=-1,r=t.length;++i<r;)e(t[i],i,t)}function d(t,e){for(var i=-1,r=t.length,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}function f(t){return d(Array(t),function(t,e){return e})}function m(t,e,i){return p(t,function(t,r,n){i=e(i,t,r,n)}),i}function g(t,e){p(j(t),function(i){e(t[i],i)})}function v(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function y(t){var e,i,r=-1;return u(t)?(e=t.length,function(){return r++,e>r?r:null}):(i=j(t),e=i.length,function(){return r++,e>r?i[r]:null})}function x(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),r=Array(i),n=0;i>n;n++)r[n]=arguments[n+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r)}}}function _(t){return function(e,i,r){return t(e,r)}}function b(t){return function(e,i,r){r=c(r||o),e=e||[];var n=y(e);if(0>=t)return r(null);var s=!1,a=0,h=!1;!function u(){if(s&&0>=a)return r(null);for(;t>a&&!h;){var o=n();if(null===o)return s=!0,void(0>=a&&r(null));a+=1,i(e[o],o,l(function(t){a-=1,t?(r(t),h=!0):u()}))}}()}}function w(t){return function(e,i,r){return t(N.eachOf,e,i,r)}}function S(t){return function(e,i,r,n){return t(b(i),e,r,n)}}function T(t){return function(e,i,r){return t(N.eachOfSeries,e,i,r);
}}function M(t,e,i,r){r=c(r||o),e=e||[];var n=u(e)?[]:{};t(e,function(t,e,r){i(t,function(t,i){n[e]=i,r(t)})},function(t){r(t,n)})}function E(t,e,i,r){var n=[];t(e,function(t,e,r){i(t,function(i){i&&n.push({index:e,value:t}),r()})},function(){r(d(n.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})}function C(t,e,i,r){E(t,e,function(t,e){i(t,function(t){e(!t)})},r)}function A(t,e,i){return function(r,n,o,s){function a(){s&&s(i(!1,void 0))}function h(t,r,n){return s?void o(t,function(r){s&&e(r)&&(s(i(!0,t)),s=o=!1),n()}):n()}arguments.length>3?t(r,n,h,a):(s=o,o=n,t(r,h,a))}}function L(t,e){return e}function P(t,e,i){i=i||o;var r=u(e)?[]:{};t(e,function(t,e,i){t(x(function(t,n){n.length<=1&&(n=n[0]),r[e]=n,i(t)}))},function(t){i(t,r)})}function R(t,e,i,r){var n=[];t(e,function(t,e,r){i(t,function(t,e){n=n.concat(e||[]),r(t)})},function(t){r(t,n)})}function O(t,e,i){function r(t,e,i,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return t.started=!0,z(e)||(e=[e]),0===e.length&&t.idle()?N.setImmediate(function(){t.drain()}):(p(e,function(e){var n={data:e,callback:r||o};i?t.tasks.unshift(n):t.tasks.push(n),t.tasks.length===t.concurrency&&t.saturated()}),void N.setImmediate(t.process))}function n(t,e){return function(){s-=1;var i=!1,r=arguments;p(e,function(t){p(a,function(e,r){e!==t||i||(a.splice(r,1),i=!0)}),t.callback.apply(t,r)}),t.tasks.length+s===0&&t.drain(),t.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var s=0,a=[],h={tasks:[],concurrency:e,payload:i,saturated:o,empty:o,drain:o,started:!1,paused:!1,push:function(t,e){r(h,t,!1,e)},kill:function(){h.drain=o,h.tasks=[]},unshift:function(t,e){r(h,t,!0,e)},process:function(){for(;!h.paused&&s<h.concurrency&&h.tasks.length;){var e=h.payload?h.tasks.splice(0,h.payload):h.tasks.splice(0,h.tasks.length),i=d(e,function(t){return t.data});0===h.tasks.length&&h.empty(),s+=1,a.push(e[0]);var r=l(n(h,e));t(i,r)}},length:function(){return h.tasks.length},running:function(){return s},workersList:function(){return a},idle:function(){return h.tasks.length+s===0},pause:function(){h.paused=!0},resume:function(){if(h.paused!==!1){h.paused=!1;for(var t=Math.min(h.concurrency,h.tasks.length),e=1;t>=e;e++)N.setImmediate(h.process)}}};return h}function I(t){return x(function(e,i){e.apply(null,i.concat([x(function(e,i){"object"==typeof console&&(e?console.error:console[t]&&p(i,function(t){}))})]))})}function D(t){return function(e,i,r){t(f(e),i,r)}}function B(t){return x(function(e,i){var r=x(function(i){var r=this,n=i.pop();return t(e,function(t,e,n){t.apply(r,i.concat([n]))},n)});return i.length?r.apply(this,i):r})}function k(t){return x(function(e){var i=e.pop();e.push(function(){var t=arguments;r?N.setImmediate(function(){i.apply(null,t)}):i.apply(null,t)});var r=!0;t.apply(this,e),r=!1})}var F,N={},U="object"==typeof self&&self.self===self&&self||"object"==typeof r&&r.global===r&&r||this;null!=U&&(F=U.async),N.noConflict=function(){return U.async=F,N};var G=Object.prototype.toString,z=Array.isArray||function(t){return"[object Array]"===G.call(t)},V=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},j=Object.keys||function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},H="function"==typeof i&&i,W=H?function(t){H(t)}:function(t){setTimeout(t,0)};"object"==typeof e&&"function"==typeof e.nextTick?N.nextTick=e.nextTick:N.nextTick=W,N.setImmediate=H?W:N.nextTick,N.forEach=N.each=function(t,e,i){return N.eachOf(t,_(e),i)},N.forEachSeries=N.eachSeries=function(t,e,i){return N.eachOfSeries(t,_(e),i)},N.forEachLimit=N.eachLimit=function(t,e,i,r){return b(e)(t,_(i),r)},N.forEachOf=N.eachOf=function(t,e,i){function r(t){a--,t?i(t):null===n&&0>=a&&i(null)}i=c(i||o),t=t||[];for(var n,s=y(t),a=0;null!=(n=s());)a+=1,e(t[n],n,l(r));0===a&&i(null)},N.forEachOfSeries=N.eachOfSeries=function(t,e,i){function r(){var o=!0;return null===s?i(null):(e(t[s],s,l(function(t){if(t)i(t);else{if(s=n(),null===s)return i(null);o?N.setImmediate(r):r()}})),void(o=!1))}i=c(i||o),t=t||[];var n=y(t),s=n();r()},N.forEachOfLimit=N.eachOfLimit=function(t,e,i,r){b(e)(t,i,r)},N.map=w(M),N.mapSeries=T(M),N.mapLimit=S(M),N.inject=N.foldl=N.reduce=function(t,e,i,r){N.eachOfSeries(t,function(t,r,n){i(e,t,function(t,i){e=i,n(t)})},function(t){r(t,e)})},N.foldr=N.reduceRight=function(t,e,i,r){var n=d(t,s).reverse();N.reduce(n,e,i,r)},N.transform=function(t,e,i,r){3===arguments.length&&(r=i,i=e,e=z(t)?[]:{}),N.eachOf(t,function(t,r,n){i(e,t,r,n)},function(t){r(t,e)})},N.select=N.filter=w(E),N.selectLimit=N.filterLimit=S(E),N.selectSeries=N.filterSeries=T(E),N.reject=w(C),N.rejectLimit=S(C),N.rejectSeries=T(C),N.any=N.some=A(N.eachOf,a,s),N.someLimit=A(N.eachOfLimit,a,s),N.all=N.every=A(N.eachOf,h,h),N.everyLimit=A(N.eachOfLimit,h,h),N.detect=A(N.eachOf,s,L),N.detectSeries=A(N.eachOfSeries,s,L),N.detectLimit=A(N.eachOfLimit,s,L),N.sortBy=function(t,e,i){function r(t,e){var i=t.criteria,r=e.criteria;return r>i?-1:i>r?1:0}N.map(t,function(t,i){e(t,function(e,r){e?i(e):i(null,{value:t,criteria:r})})},function(t,e){return t?i(t):void i(null,d(e.sort(r),function(t){return t.value}))})},N.auto=function(t,e,i){function r(t){f.unshift(t)}function n(t){var e=v(f,t);e>=0&&f.splice(e,1)}function s(){h--,p(f.slice(0),function(t){t()})}"function"==typeof arguments[1]&&(i=e,e=null),i=c(i||o);var a=j(t),h=a.length;if(!h)return i(null);e||(e=h);var l={},u=0,d=!1,f=[];r(function(){h||i(null,l)}),p(a,function(o){function a(){return e>u&&m(y,function(t,e){return t&&l.hasOwnProperty(e)},!0)&&!l.hasOwnProperty(o)}function h(){a()&&(u++,n(h),p[p.length-1](f,l))}if(!d){for(var c,p=z(t[o])?t[o]:[t[o]],f=x(function(t,e){if(u--,e.length<=1&&(e=e[0]),t){var r={};g(l,function(t,e){r[e]=t}),r[o]=e,d=!0,i(t,r)}else l[o]=e,N.setImmediate(s)}),y=p.slice(0,p.length-1),_=y.length;_--;){if(!(c=t[y[_]]))throw new Error("Has nonexistent dependency in "+y.join(", "));if(z(c)&&v(c,o)>=0)throw new Error("Has cyclic dependencies")}a()?(u++,p[p.length-1](f,l)):r(h)}})},N.retry=function(t,e,i){function r(t,e){if("number"==typeof e)t.times=parseInt(e,10)||o;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||o,t.interval=parseInt(e.interval,10)||s}}function n(t,e){function i(t,i){return function(r){t(function(t,e){r(!t||i,{err:t,result:e})},e)}}function r(t){return function(e){setTimeout(function(){e(null)},t)}}for(;h.times;){var n=!(h.times-=1);a.push(i(h.task,n)),!n&&h.interval>0&&a.push(r(h.interval))}N.series(a,function(e,i){i=i[i.length-1],(t||h.callback)(i.err,i.result)})}var o=5,s=0,a=[],h={times:o,interval:s},l=arguments.length;if(1>l||l>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=l&&"function"==typeof t&&(i=e,e=t),"function"!=typeof t&&r(h,t),h.callback=i,h.task=e,h.callback?n():n},N.waterfall=function(t,e){function i(t){return x(function(r,n){if(r)e.apply(null,[r].concat(n));else{var o=t.next();o?n.push(i(o)):n.push(e),k(t).apply(null,n)}})}if(e=c(e||o),!z(t)){var r=new Error("First argument to waterfall must be an array of functions");return e(r)}return t.length?void i(N.iterator(t))():e()},N.parallel=function(t,e){P(N.eachOf,t,e)},N.parallelLimit=function(t,e,i){P(b(e),t,i)},N.series=function(t,e){P(N.eachOfSeries,t,e)},N.iterator=function(t){function e(i){function r(){return t.length&&t[i].apply(null,arguments),r.next()}return r.next=function(){return i<t.length-1?e(i+1):null},r}return e(0)},N.apply=x(function(t,e){return x(function(i){return t.apply(null,e.concat(i))})}),N.concat=w(R),N.concatSeries=T(R),N.whilst=function(t,e,i){if(i=i||o,t()){var r=x(function(n,o){n?i(n):t.apply(this,o)?e(r):i.apply(null,[null].concat(o))});e(r)}else i(null)},N.doWhilst=function(t,e,i){var r=0;return N.whilst(function(){return++r<=1||e.apply(this,arguments)},t,i)},N.until=function(t,e,i){return N.whilst(function(){return!t.apply(this,arguments)},e,i)},N.doUntil=function(t,e,i){return N.doWhilst(t,function(){return!e.apply(this,arguments)},i)},N.during=function(t,e,i){i=i||o;var r=x(function(e,r){e?i(e):(r.push(n),t.apply(this,r))}),n=function(t,n){t?i(t):n?e(r):i(null)};t(n)},N.doDuring=function(t,e,i){var r=0;N.during(function(t){r++<1?t(null,!0):e.apply(this,arguments)},t,i)},N.queue=function(t,e){var i=O(function(e,i){t(e[0],i)},e,1);return i},N.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}function r(t,e,i){for(var r=-1,n=t.length-1;n>r;){var o=r+(n-r+1>>>1);i(e,t[o])>=0?r=o:n=o-1}return r}function n(t,e,n,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");return t.started=!0,z(e)||(e=[e]),0===e.length?N.setImmediate(function(){t.drain()}):void p(e,function(e){var a={data:e,priority:n,callback:"function"==typeof s?s:o};t.tasks.splice(r(t.tasks,a,i)+1,0,a),t.tasks.length===t.concurrency&&t.saturated(),N.setImmediate(t.process)})}var s=N.queue(t,e);return s.push=function(t,e,i){n(s,t,e,i)},delete s.unshift,s},N.cargo=function(t,e){return O(t,1,e)},N.log=I("log"),N.dir=I("dir"),N.memoize=function(t,e){var i={},r={},n=Object.prototype.hasOwnProperty;e=e||s;var o=x(function(o){var s=o.pop(),a=e.apply(null,o);n.call(i,a)?N.setImmediate(function(){s.apply(null,i[a])}):n.call(r,a)?r[a].push(s):(r[a]=[s],t.apply(null,o.concat([x(function(t){i[a]=t;var e=r[a];delete r[a];for(var n=0,o=e.length;o>n;n++)e[n].apply(null,t)})])))});return o.memo=i,o.unmemoized=t,o},N.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},N.times=D(N.map),N.timesSeries=D(N.mapSeries),N.timesLimit=function(t,e,i,r){return N.mapLimit(f(t),e,i,r)},N.seq=function(){var t=arguments;return x(function(e){var i=this,r=e[e.length-1];"function"==typeof r?e.pop():r=o,N.reduce(t,e,function(t,e,r){e.apply(i,t.concat([x(function(t,e){r(t,e)})]))},function(t,e){r.apply(i,[t].concat(e))})})},N.compose=function(){return N.seq.apply(null,Array.prototype.reverse.call(arguments))},N.applyEach=B(N.eachOf),N.applyEachSeries=B(N.eachOfSeries),N.forever=function(t,e){function i(t){return t?r(t):void n(i)}var r=l(e||o),n=k(t);i()},N.ensureAsync=k,N.constant=x(function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}}),N.wrapSync=N.asyncify=function(t){return x(function(e){var i,r=e.pop();try{i=t.apply(this,e)}catch(n){return r(n)}V(i)&&"function"==typeof i.then?i.then(function(t){r(null,t)})["catch"](function(t){r(t.message?t:new Error(t))}):r(null,i)})},"object"==typeof n&&n.exports?n.exports=N:"function"==typeof t&&t.amd?t([],function(){return N}):U.async=N}()}).call(this,r("_process"),"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:19}],17:[function(t,e,i){"use strict";"use restrict";function r(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}var n=32;i.INT_BITS=n,i.INT_MAX=2147483647,i.INT_MIN=-1<<n-1,i.sign=function(t){return(t>0)-(0>t)},i.abs=function(t){var e=t>>n-1;return(t^e)-e},i.min=function(t,e){return e^(t^e)&-(e>t)},i.max=function(t,e){return t^(t^e)&-(e>t)},i.isPow2=function(t){return!(t&t-1||!t)},i.log2=function(t){var e,i;return e=(t>65535)<<4,t>>>=e,i=(t>255)<<3,t>>>=i,e|=i,i=(t>15)<<2,t>>>=i,e|=i,i=(t>3)<<1,t>>>=i,e|=i,e|t>>1},i.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},i.popCount=function(t){return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24},i.countTrailingZeros=r,i.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1},i.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t-(t>>>1)},i.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,t&=15,27030>>>t&1};var o=new Array(256);!function(t){for(var e=0;256>e;++e){var i=e,r=e,n=7;for(i>>>=1;i;i>>>=1)r<<=1,r|=1&i,--n;t[e]=r<<n&255}}(o),i.reverse=function(t){return o[255&t]<<24|o[t>>>8&255]<<16|o[t>>>16&255]<<8|o[t>>>24&255]},i.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},i.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),t=65535&(t|t>>>16),t<<16>>16},i.interleave3=function(t,e,i){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,i&=1023,i=4278190335&(i|i<<16),i=251719695&(i|i<<8),i=3272356035&(i|i<<4),i=1227133513&(i|i<<2),t|i<<2},i.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),t=1023&(t|t>>>16),t<<22>>22},i.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>r(t)+1}},{}],18:[function(t,e,i){(function(t){function e(t,e){for(var i=0,r=t.length-1;r>=0;r--){var n=t[r];"."===n?t.splice(r,1):".."===n?(t.splice(r,1),i++):i&&(t.splice(r,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var i=[],r=0;r<t.length;r++)e(t[r],r,t)&&i.push(t[r]);return i}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return n.exec(t).slice(1)};i.resolve=function(){for(var i="",n=!1,o=arguments.length-1;o>=-1&&!n;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(i=s+"/"+i,n="/"===s.charAt(0))}return i=e(r(i.split("/"),function(t){return!!t}),!n).join("/"),(n?"/":"")+i||"."},i.normalize=function(t){var n=i.isAbsolute(t),o="/"===s(t,-1);return t=e(r(t.split("/"),function(t){return!!t}),!n).join("/"),t||n||(t="."),t&&o&&(t+="/"),(n?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var n=r(t.split("/")),o=r(e.split("/")),s=Math.min(n.length,o.length),a=s,h=0;s>h;h++)if(n[h]!==o[h]){a=h;break}for(var l=[],h=a;h<n.length;h++)l.push("..");return l=l.concat(o.slice(a)),l.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=o(t),i=e[0],r=e[1];return i||r?(r&&(r=r.substr(0,r.length-1)),i+r):"."},i.basename=function(t,e){var i=o(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:19}],19:[function(t,e,i){function r(){c=!1,a.length?l=a.concat(l):u=-1,l.length&&n()}function n(){if(!c){var t=setTimeout(r);c=!0;for(var e=l.length;e;){for(a=l,l=[];++u<e;)a&&a[u].run();u=-1,e=l.length}a=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,h=e.exports={},l=[],c=!1,u=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new o(t,e)),1!==l.length||c||setTimeout(n,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=s,h.addListener=s,h.once=s,h.off=s,h.removeListener=s,h.removeAllListeners=s,h.emit=s,h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],20:[function(i,r,n){(function(e){!function(i){function o(t){throw new RangeError(D[t])}function s(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function a(t,e){var i=t.split("@"),r="";i.length>1&&(r=i[0]+"@",t=i[1]),t=t.replace(I,".");var n=t.split("."),o=s(n,e).join(".");return r+o}function h(t){for(var e,i,r=[],n=0,o=t.length;o>n;)e=t.charCodeAt(n++),e>=55296&&56319>=e&&o>n?(i=t.charCodeAt(n++),56320==(64512&i)?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--)):r.push(e);return r}function l(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=F(t>>>10&1023|55296),t=56320|1023&t),e+=F(t)}).join("")}function c(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:S}function u(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function p(t,e,i){var r=0;for(t=i?k(t/C):t>>1,t+=k(t/e);t>B*M>>1;r+=S)t=k(t/B);return k(r+(B+1)*t/(t+E))}function d(t){var e,i,r,n,s,a,h,u,d,f,m=[],g=t.length,v=0,y=L,x=A;for(i=t.lastIndexOf(P),0>i&&(i=0),r=0;i>r;++r)t.charCodeAt(r)>=128&&o("not-basic"),m.push(t.charCodeAt(r));for(n=i>0?i+1:0;g>n;){for(s=v,a=1,h=S;n>=g&&o("invalid-input"),u=c(t.charCodeAt(n++)),(u>=S||u>k((w-v)/a))&&o("overflow"),v+=u*a,d=x>=h?T:h>=x+M?M:h-x,!(d>u);h+=S)f=S-d,a>k(w/f)&&o("overflow"),a*=f;e=m.length+1,x=p(v-s,e,0==s),k(v/e)>w-y&&o("overflow"),y+=k(v/e),v%=e,m.splice(v++,0,y)}return l(m)}function f(t){var e,i,r,n,s,a,l,c,d,f,m,g,v,y,x,_=[];for(t=h(t),g=t.length,e=L,i=0,s=A,a=0;g>a;++a)m=t[a],128>m&&_.push(F(m));for(r=n=_.length,n&&_.push(P);g>r;){for(l=w,a=0;g>a;++a)m=t[a],m>=e&&l>m&&(l=m);for(v=r+1,l-e>k((w-i)/v)&&o("overflow"),i+=(l-e)*v,e=l,a=0;g>a;++a)if(m=t[a],e>m&&++i>w&&o("overflow"),m==e){for(c=i,d=S;f=s>=d?T:d>=s+M?M:d-s,!(f>c);d+=S)x=c-f,y=S-f,_.push(F(u(f+x%y,0))),c=k(x/y);_.push(F(u(c,0))),s=p(i,v,r==n),i=0,++r}++i,++e}return _.join("")}function m(t){return a(t,function(t){return R.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return a(t,function(t){return O.test(t)?"xn--"+f(t):t})}var v="object"==typeof n&&n&&!n.nodeType&&n,y="object"==typeof r&&r&&!r.nodeType&&r,x="object"==typeof e&&e;x.global!==x&&x.window!==x&&x.self!==x||(i=x);var _,b,w=2147483647,S=36,T=1,M=26,E=38,C=700,A=72,L=128,P="-",R=/^xn--/,O=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},B=S-T,k=Math.floor,F=String.fromCharCode;if(_={version:"1.3.2",ucs2:{decode:h,encode:l},decode:d,encode:f,toASCII:g,toUnicode:m},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",function(){return _});else if(v&&y)if(r.exports==v)y.exports=_;else for(b in _)_.hasOwnProperty(b)&&(v[b]=_[b]);else i.punycode=_}(this)}).call(this,"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(t,e,i){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,o){e=e||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var h=1e3;o&&"number"==typeof o.maxKeys&&(h=o.maxKeys);var l=t.length;h>0&&l>h&&(l=h);for(var c=0;l>c;++c){var u,p,d,f,m=t[c].replace(a,"%20"),g=m.indexOf(i);g>=0?(u=m.substr(0,g),p=m.substr(g+1)):(u=m,p=""),d=decodeURIComponent(u),f=decodeURIComponent(p),r(s,d)?n(s[d])?s[d].push(f):s[d]=[s[d],f]:s[d]=f}return s};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],22:[function(t,e,i){"use strict";function r(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r++)i.push(e(t[r],r));return i}var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?r(s(t),function(s){var a=encodeURIComponent(n(s))+i;return o(t[s])?r(t[s],function(t){return a+encodeURIComponent(n(t))}).join(e):a+encodeURIComponent(n(t[s]))}).join(e):a?encodeURIComponent(n(a))+i+encodeURIComponent(n(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],23:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":21,"./encode":22}],24:[function(t,e,i){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(t,e,i){if(t&&l(t)&&t instanceof r)return t;var n=new r;return n.parse(t,e,i),n}function o(t){return h(t)&&(t=n(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return n(t,!1,!0).resolve(e)}function a(t,e){return t?n(t,!1,!0).resolveObject(e):e}function h(t){return"string"==typeof t}function l(t){return"object"==typeof t&&null!==t}function c(t){return null===t}function u(t){return null==t}var p=t("punycode");i.parse=n,i.resolve=s,i.resolveObject=a,i.format=o,i.Url=r;var d=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],g=["{","}","|","\\","^","`"].concat(m),v=["'"].concat(g),y=["%","/","?",";","#"].concat(v),x=["/","?","#"],_=255,b=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,S={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},M={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=t("querystring");r.prototype.parse=function(t,e,i){if(!h(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t;r=r.trim();var n=d.exec(r);if(n){n=n[0];var o=n.toLowerCase();this.protocol=o,r=r.substr(n.length)}if(i||n||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||n&&T[n]||(r=r.substr(2),this.slashes=!0)}if(!T[n]&&(s||n&&!M[n])){for(var a=-1,l=0;l<x.length;l++){var c=r.indexOf(x[l]);-1!==c&&(-1===a||a>c)&&(a=c)}var u,f;f=-1===a?r.lastIndexOf("@"):r.lastIndexOf("@",a),-1!==f&&(u=r.slice(0,f),r=r.slice(f+1),this.auth=decodeURIComponent(u)),a=-1;for(var l=0;l<y.length;l++){var c=r.indexOf(y[l]);-1!==c&&(-1===a||a>c)&&(a=c)}-1===a&&(a=r.length),this.host=r.slice(0,a),r=r.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var g=this.hostname.split(/\./),l=0,C=g.length;C>l;l++){var A=g[l];if(A&&!A.match(b)){for(var L="",P=0,R=A.length;R>P;P++)L+=A.charCodeAt(P)>127?"x":A[P];if(!L.match(b)){var O=g.slice(0,l),I=g.slice(l+1),D=A.match(w);D&&(O.push(D[1]),I.unshift(D[2])),I.length&&(r="/"+I.join(".")+r),this.hostname=O.join(".");break}}}if(this.hostname.length>_?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){for(var B=this.hostname.split("."),k=[],l=0;l<B.length;++l){var F=B[l];k.push(F.match(/[^A-Za-z0-9_-]/)?"xn--"+p.encode(F):F)}this.hostname=k.join(".")}var N=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+N,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!S[o])for(var l=0,C=v.length;C>l;l++){var G=v[l],z=encodeURIComponent(G);z===G&&(z=escape(G)),r=r.split(G).join(z)}var V=r.indexOf("#");-1!==V&&(this.hash=r.substr(V),r=r.slice(0,V));var j=r.indexOf("?");if(-1!==j?(this.search=r.substr(j),this.query=r.substr(j+1),e&&(this.query=E.parse(this.query)),r=r.slice(0,j)):e&&(this.search="",this.query={}),r&&(this.pathname=r),M[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",F=this.search||"";this.path=N+F}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",n=!1,o="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&l(this.query)&&Object.keys(this.query).length&&(o=E.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||M[e])&&n!==!1?(n="//"+(n||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):n||(n=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+n+i+s+r},r.prototype.resolve=function(t){return this.resolveObject(n(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(h(t)){var e=new r;e.parse(t,!1,!0),t=e}var i=new r;if(Object.keys(this).forEach(function(t){i[t]=this[t]},this),i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(i[e]=t[e])}),M[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i;if(t.protocol&&t.protocol!==i.protocol){if(!M[t.protocol])return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.href=i.format(),i;if(i.protocol=t.protocol,t.host||T[t.protocol])i.pathname=t.pathname;else{for(var n=(t.pathname||"").split("/");n.length&&!(t.host=n.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),i.pathname=n.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var o=i.pathname||"",s=i.search||"";i.path=o+s}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var a=i.pathname&&"/"===i.pathname.charAt(0),l=t.host||t.pathname&&"/"===t.pathname.charAt(0),p=l||a||i.host&&t.pathname,d=p,f=i.pathname&&i.pathname.split("/")||[],n=t.pathname&&t.pathname.split("/")||[],m=i.protocol&&!M[i.protocol];if(m&&(i.hostname="",i.port=null,i.host&&(""===f[0]?f[0]=i.host:f.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===n[0]?n[0]=t.host:n.unshift(t.host)),t.host=null),p=p&&(""===n[0]||""===f[0])),l)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,f=n;else if(n.length)f||(f=[]),f.pop(),f=f.concat(n),i.search=t.search,i.query=t.query;else if(!u(t.search)){if(m){i.hostname=i.host=f.shift();var g=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;g&&(i.auth=g.shift(),i.host=i.hostname=g.shift())}return i.search=t.search,i.query=t.query,c(i.pathname)&&c(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!f.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var v=f.slice(-1)[0],y=(i.host||t.host)&&("."===v||".."===v)||""===v,x=0,_=f.length;_>=0;_--)v=f[_],"."==v?f.splice(_,1):".."===v?(f.splice(_,1),x++):x&&(f.splice(_,1),x--);if(!p&&!d)for(;x--;x)f.unshift("..");!p||""===f[0]||f[0]&&"/"===f[0].charAt(0)||f.unshift(""),y&&"/"!==f.join("/").substr(-1)&&f.push("");var b=""===f[0]||f[0]&&"/"===f[0].charAt(0);if(m){i.hostname=i.host=b?"":f.length?f.shift():"";var g=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;g&&(i.auth=g.shift(),i.host=i.hostname=g.shift())}return p=p||i.host&&f.length,p&&!b&&f.unshift(""),f.length?i.pathname=f.join("/"):(i.pathname=null,i.path=null),c(i.pathname)&&c(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},r.prototype.parseHost=function(){var t=this.host,e=f.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:20,querystring:23}],25:[function(t,e,i){"use strict";function r(t,e,i){i=i||2;var r=e&&e.length,o=r?e[0]*i:t.length,a=n(t,0,o,i,!0),h=[];if(!a)return h;var l,c,p,d,f,m,g;if(r&&(a=u(t,e,a,i)),t.length>80*i){l=p=t[0],c=d=t[1];for(var v=i;o>v;v+=i)f=t[v],m=t[v+1],l>f&&(l=f),c>m&&(c=m),f>p&&(p=f),m>d&&(d=m);g=Math.max(p-l,d-c)}return s(a,h,i,l,c,g),h}function n(t,e,i,r,n){var o,s;if(n===R(t,e,i,r)>0)for(o=e;i>o;o+=r)s=A(o,t[o],t[o+1],s);else for(o=i-r;o>=e;o-=r)s=A(o,t[o],t[o+1],s);return s&&w(s,s.next)&&(L(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var i,r=t;do if(i=!1,r.steiner||!w(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(L(r),r=e=r.prev,r===r.next)return null;i=!0}while(i||r!==e);return e}function s(t,e,i,r,n,u,p){if(t){!p&&u&&m(t,r,n,u);for(var d,f,g=t;t.prev!==t.next;)if(d=t.prev,f=t.next,u?h(t,r,n,u):a(t))e.push(d.i/i),e.push(t.i/i),e.push(f.i/i),L(t),t=f.next,g=f.next;else if(t=f,t===g){p?1===p?(t=l(t,e,i),s(t,e,i,r,n,u,2)):2===p&&c(t,e,i,r,n,u):s(o(t),e,i,r,n,u,1);break}}}function a(t){var e=t.prev,i=t,r=t.next;if(b(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(x(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&b(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function h(t,e,i,r){var n=t.prev,o=t,s=t.next;if(b(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,l=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,c=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,u=v(a,h,e,i,r),p=v(l,c,e,i,r),d=t.nextZ;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&x(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&b(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&x(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&b(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function l(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!w(n,o)&&S(n,r,r.next,o)&&M(n,o)&&M(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),L(r),L(r.next),r=t=o),r=r.next}while(r!==t);return r}function c(t,e,i,r,n,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&_(h,l)){var c=C(h,l);return h=o(h,h.next),c=o(c,c.next),s(h,e,i,r,n,a),void s(c,e,i,r,n,a)}l=l.next}h=h.next}while(h!==t)}function u(t,e,i,r){var s,a,h,l,c,u=[];for(s=0,a=e.length;a>s;s++)h=e[s]*r,l=a-1>s?e[s+1]*r:t.length,c=n(t,h,l,r,!1),c===c.next&&(c.steiner=!0),u.push(y(c));for(u.sort(p),s=0;s<u.length;s++)d(u[s],i),i=o(i,i.next);return i}function p(t,e){return t.x-e.x}function d(t,e){if(e=f(t,e)){var i=C(e,t);o(i,i.next)}}function f(t,e){var i,r=e,n=t.x,o=t.y,s=-(1/0);do{if(o<=r.y&&o>=r.next.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(n>=a&&a>s){if(s=a,a===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===s)return i.prev;var h,l=i,c=i.x,u=i.y,p=1/0;for(r=i.next;r!==l;)n>=r.x&&r.x>=c&&x(u>o?n:s,o,c,u,u>o?s:n,o,r.x,r.y)&&(h=Math.abs(o-r.y)/(n-r.x),(p>h||h===p&&r.x>i.x)&&M(r,t)&&(i=r,p=h)),r=r.next;return i}function m(t,e,i,r){var n=t;do null===n.z&&(n.z=v(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,g(n)}function g(t){var e,i,r,n,o,s,a,h,l=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,r=i,a=0,e=0;l>e&&(a++,r=r.nextZ,r);e++);for(h=l;a>0||h>0&&r;)0===a?(n=r,r=r.nextZ,h--):0!==h&&r?i.z<=r.z?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--):(n=i,i=i.nextZ,a--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,l*=2}while(s>1);return t}function v(t,e,i,r,n){return t=32767*(t-i)/n,e=32767*(e-r)/n,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function y(t){var e=t,i=t;do e.x<i.x&&(i=e),e=e.next;while(e!==t);return i}function x(t,e,i,r,n,o,s,a){return(n-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!T(t,e)&&M(t,e)&&M(e,t)&&E(t,e)}function b(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function S(t,e,i,r){return w(t,e)&&w(i,r)||w(t,r)&&w(i,e)?!0:b(t,e,i)>0!=b(t,e,r)>0&&b(i,r,t)>0!=b(i,r,e)>0}function T(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&S(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function M(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0;
}function E(t,e){var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do i.y>o!=i.next.y>o&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==t);return r}function C(t,e){var i=new P(t.i,t.x,t.y),r=new P(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function A(t,e,i,r){var n=new P(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function L(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(t,e,i,r){for(var n=0,o=e,s=i-r;i>o;o+=r)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}e.exports=r,r.deviation=function(t,e,i,r){var n=e&&e.length,o=n?e[0]*i:t.length,s=Math.abs(R(t,0,o,i));if(n)for(var a=0,h=e.length;h>a;a++){var l=e[a]*i,c=h-1>a?e[a+1]*i:t.length;s-=Math.abs(R(t,l,c,i))}var u=0;for(a=0;a<r.length;a+=3){var p=r[a]*i,d=r[a+1]*i,f=r[a+2]*i;u+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)},r.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;e>s;s++)i.vertices.push(t[n][o][s]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i}},{}],26:[function(t,e,i){"use strict";function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function n(){}var o=Object.prototype.hasOwnProperty,s="function"!=typeof Object.create?"~":!1;n.prototype._events=void 0,n.prototype.eventNames=function(){var t,e=this._events,i=[];if(!e)return i;for(t in e)o.call(e,t)&&i.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},n.prototype.listeners=function(t,e){var i=s?s+t:t,r=this._events&&this._events[i];if(e)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var n=0,o=r.length,a=new Array(o);o>n;n++)a[n]=r[n].fn;return a},n.prototype.emit=function(t,e,i,r,n,o){var a=s?s+t:t;if(!this._events||!this._events[a])return!1;var h,l,c=this._events[a],u=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,i),!0;case 4:return c.fn.call(c.context,e,i,r),!0;case 5:return c.fn.call(c.context,e,i,r,n),!0;case 6:return c.fn.call(c.context,e,i,r,n,o),!0}for(l=1,h=new Array(u-1);u>l;l++)h[l-1]=arguments[l];c.fn.apply(c.context,h)}else{var p,d=c.length;for(l=0;d>l;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),u){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,e);break;case 3:c[l].fn.call(c[l].context,e,i);break;default:if(!h)for(p=1,h=new Array(u-1);u>p;p++)h[p-1]=arguments[p];c[l].fn.apply(c[l].context,h)}}return!0},n.prototype.on=function(t,e,i){var n=new r(e,i||this),o=s?s+t:t;return this._events||(this._events=s?{}:Object.create(null)),this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):this._events[o]=n,this},n.prototype.once=function(t,e,i){var n=new r(e,i||this,!0),o=s?s+t:t;return this._events||(this._events=s?{}:Object.create(null)),this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):this._events[o]=n,this},n.prototype.removeListener=function(t,e,i,r){var n=s?s+t:t;if(!this._events||!this._events[n])return this;var o=this._events[n],a=[];if(e)if(o.fn)(o.fn!==e||r&&!o.once||i&&o.context!==i)&&a.push(o);else for(var h=0,l=o.length;l>h;h++)(o[h].fn!==e||r&&!o[h].once||i&&o[h].context!==i)&&a.push(o[h]);return a.length?this._events[n]=1===a.length?a[0]:a:delete this._events[n],this},n.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[s?s+t:t]:this._events=s?{}:Object.create(null),this):this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prototype.setMaxListeners=function(){return this},n.prefixed=s,"undefined"!=typeof e&&(e.exports=n)},{}],27:[function(e,i,r){!function(e){var r=/iPhone/i,n=/iPod/i,o=/iPad/i,s=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,a=/Android/i,h=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,l=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,c=/IEMobile/i,u=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,p=/BlackBerry/i,d=/BB10/i,f=/Opera Mini/i,m=/(CriOS|Chrome)(?=.*\bMobile\b)/i,g=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,v=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),y=function(t,e){return t.test(e)},x=function(t){var e=t||navigator.userAgent,i=e.split("[FBAN");return"undefined"!=typeof i[1]&&(e=i[0]),i=e.split("Twitter"),"undefined"!=typeof i[1]&&(e=i[0]),this.apple={phone:y(r,e),ipod:y(n,e),tablet:!y(r,e)&&y(o,e),device:y(r,e)||y(n,e)||y(o,e)},this.amazon={phone:y(h,e),tablet:!y(h,e)&&y(l,e),device:y(h,e)||y(l,e)},this.android={phone:y(h,e)||y(s,e),tablet:!y(h,e)&&!y(s,e)&&(y(l,e)||y(a,e)),device:y(h,e)||y(l,e)||y(s,e)||y(a,e)},this.windows={phone:y(c,e),tablet:y(u,e),device:y(c,e)||y(u,e)},this.other={blackberry:y(p,e),blackberry10:y(d,e),opera:y(f,e),firefox:y(g,e),chrome:y(m,e),device:y(p,e)||y(d,e)||y(f,e)||y(g,e)||y(m,e)},this.seven_inch=y(v,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window?this:void 0},_=function(){var t=new x;return t.Class=x,t};"undefined"!=typeof i&&i.exports&&"undefined"==typeof window?i.exports=x:"undefined"!=typeof i&&i.exports&&"undefined"!=typeof window?i.exports=_():"function"==typeof t&&t.amd?t("isMobile",[],e.isMobile=_()):e.isMobile=_()}(this)},{}],28:[function(t,e,i){"use strict";function r(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function n(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;10>i;i++)e["_"+String.fromCharCode(i)]=i;var r=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==r.join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}var o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=n()?Object.assign:function(t,e){for(var i,n,a=r(t),h=1;h<arguments.length;h++){i=Object(arguments[h]);for(var l in i)o.call(i,l)&&(a[l]=i[l]);if(Object.getOwnPropertySymbols){n=Object.getOwnPropertySymbols(i);for(var c=0;c<n.length;c++)s.call(i,n[c])&&(a[n[c]]=i[n[c]])}}return a}},{}],29:[function(e,r,n){(function(e){!function(){function n(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(o,arguments)}}var o,s,a={};o=this,null!=o&&(s=o.async),a.noConflict=function(){return o.async=s,a};var h=Object.prototype.toString,l=Array.isArray||function(t){return"[object Array]"===h.call(t)},c=function(t,e){for(var i=0;i<t.length;i+=1)e(t[i],i,t)},u=function(t,e){if(t.map)return t.map(e);var i=[];return c(t,function(t,r,n){i.push(e(t,r,n))}),i},p=function(t,e,i){return t.reduce?t.reduce(e,i):(c(t,function(t,r,n){i=e(i,t,r,n)}),i)},d=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e};"undefined"!=typeof e&&e.nextTick?(a.nextTick=e.nextTick,"undefined"!=typeof i?a.setImmediate=function(t){i(t)}:a.setImmediate=a.nextTick):"function"==typeof i?(a.nextTick=function(t){i(t)},a.setImmediate=a.nextTick):(a.nextTick=function(t){setTimeout(t,0)},a.setImmediate=a.nextTick),a.each=function(t,e,i){function r(e){e?(i(e),i=function(){}):(o+=1,o>=t.length&&i())}if(i=i||function(){},!t.length)return i();var o=0;c(t,function(t){e(t,n(r))})},a.forEach=a.each,a.eachSeries=function(t,e,i){if(i=i||function(){},!t.length)return i();var r=0,n=function(){e(t[r],function(e){e?(i(e),i=function(){}):(r+=1,r>=t.length?i():n())})};n()},a.forEachSeries=a.eachSeries,a.eachLimit=function(t,e,i,r){var n=f(e);n.apply(null,[t,i,r])},a.forEachLimit=a.eachLimit;var f=function(t){return function(e,i,r){if(r=r||function(){},!e.length||0>=t)return r();var n=0,o=0,s=0;!function a(){if(n>=e.length)return r();for(;t>s&&o<e.length;)o+=1,s+=1,i(e[o-1],function(t){t?(r(t),r=function(){}):(n+=1,s-=1,n>=e.length?r():a())})}()}},m=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.each].concat(e))}},g=function(t,e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[f(t)].concat(i))}},v=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.eachSeries].concat(e))}},y=function(t,e,i,r){if(e=u(e,function(t,e){return{index:e,value:t}}),r){var n=[];t(e,function(t,e){i(t.value,function(i,r){n[t.index]=r,e(i)})},function(t){r(t,n)})}else t(e,function(t,e){i(t.value,function(t){e(t)})})};a.map=m(y),a.mapSeries=v(y),a.mapLimit=function(t,e,i,r){return x(e)(t,i,r)};var x=function(t){return g(t,y)};a.reduce=function(t,e,i,r){a.eachSeries(t,function(t,r){i(e,t,function(t,i){e=i,r(t)})},function(t){r(t,e)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(t,e,i,r){var n=u(t,function(t){return t}).reverse();a.reduce(n,e,i,r)},a.foldr=a.reduceRight;var _=function(t,e,i,r){var n=[];e=u(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i){i&&n.push(t),e()})},function(t){r(u(n.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.filter=m(_),a.filterSeries=v(_),a.select=a.filter,a.selectSeries=a.filterSeries;var b=function(t,e,i,r){var n=[];e=u(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i){i||n.push(t),e()})},function(t){r(u(n.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.reject=m(b),a.rejectSeries=v(b);var w=function(t,e,i,r){t(e,function(t,e){i(t,function(i){i?(r(t),r=function(){}):e()})},function(t){r()})};a.detect=m(w),a.detectSeries=v(w),a.some=function(t,e,i){a.each(t,function(t,r){e(t,function(t){t&&(i(!0),i=function(){}),r()})},function(t){i(!1)})},a.any=a.some,a.every=function(t,e,i){a.each(t,function(t,r){e(t,function(t){t||(i(!1),i=function(){}),r()})},function(t){i(!0)})},a.all=a.every,a.sortBy=function(t,e,i){a.map(t,function(t,i){e(t,function(e,r){e?i(e):i(null,{value:t,criteria:r})})},function(t,e){if(t)return i(t);var r=function(t,e){var i=t.criteria,r=e.criteria;return r>i?-1:i>r?1:0};i(null,u(e.sort(r),function(t){return t.value}))})},a.auto=function(t,e){e=e||function(){};var i=d(t),r=i.length;if(!r)return e();var n={},o=[],s=function(t){o.unshift(t)},h=function(t){for(var e=0;e<o.length;e+=1)if(o[e]===t)return void o.splice(e,1)},u=function(){r--,c(o.slice(0),function(t){t()})};s(function(){if(!r){var t=e;e=function(){},t(null,n)}}),c(i,function(i){var r=l(t[i])?t[i]:[t[i]],o=function(t){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1&&(r=r[0]),t){var o={};c(d(n),function(t){o[t]=n[t]}),o[i]=r,e(t,o),e=function(){}}else n[i]=r,a.setImmediate(u)},f=r.slice(0,Math.abs(r.length-1))||[],m=function(){return p(f,function(t,e){return t&&n.hasOwnProperty(e)},!0)&&!n.hasOwnProperty(i)};if(m())r[r.length-1](o,n);else{var g=function(){m()&&(h(g),r[r.length-1](o,n))};s(g)}})},a.retry=function(t,e,i){var r=5,n=[];"function"==typeof t&&(i=e,e=t,t=r),t=parseInt(t,10)||r;var o=function(r,o){for(var s=function(t,e){return function(i){t(function(t,r){i(!t||e,{err:t,result:r})},o)}};t;)n.push(s(e,!(t-=1)));a.series(n,function(t,e){e=e[e.length-1],(r||i)(e.err,e.result)})};return i?o():o},a.waterfall=function(t,e){if(e=e||function(){},!l(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();var r=function(t){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var n=Array.prototype.slice.call(arguments,1),o=t.next();o?n.push(r(o)):n.push(e),a.setImmediate(function(){t.apply(null,n)})}}};r(a.iterator(t))()};var S=function(t,e,i){if(i=i||function(){},l(e))t.map(e,function(t,e){t&&t(function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)})},i);else{var r={};t.each(d(e),function(t,i){e[t](function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),r[t]=n,i(e)})},function(t){i(t,r)})}};a.parallel=function(t,e){S({map:a.map,each:a.each},t,e)},a.parallelLimit=function(t,e,i){S({map:x(e),each:f(e)},t,i)},a.series=function(t,e){if(e=e||function(){},l(t))a.mapSeries(t,function(t,e){t&&t(function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)})},e);else{var i={};a.eachSeries(d(t),function(e,r){t[e](function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),i[e]=n,r(t)})},function(t){e(t,i)})}},a.iterator=function(t){var e=function(i){var r=function(){return t.length&&t[i].apply(null,arguments),r.next()};return r.next=function(){return i<t.length-1?e(i+1):null},r};return e(0)},a.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var T=function(t,e,i,r){var n=[];t(e,function(t,e){i(t,function(t,i){n=n.concat(i||[]),e(t)})},function(t){r(t,n)})};a.concat=m(T),a.concatSeries=v(T),a.whilst=function(t,e,i){t()?e(function(r){return r?i(r):void a.whilst(t,e,i)}):i()},a.doWhilst=function(t,e,i){t(function(r){if(r)return i(r);var n=Array.prototype.slice.call(arguments,1);e.apply(null,n)?a.doWhilst(t,e,i):i()})},a.until=function(t,e,i){t()?i():e(function(r){return r?i(r):void a.until(t,e,i)})},a.doUntil=function(t,e,i){t(function(r){if(r)return i(r);var n=Array.prototype.slice.call(arguments,1);e.apply(null,n)?i():a.doUntil(t,e,i)})},a.queue=function(t,e){function i(t,e,i,r){return t.started||(t.started=!0),l(e)||(e=[e]),0==e.length?a.setImmediate(function(){t.drain&&t.drain()}):void c(e,function(e){var n={data:e,callback:"function"==typeof r?r:null};i?t.tasks.unshift(n):t.tasks.push(n),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),a.setImmediate(t.process)})}void 0===e&&(e=1);var r=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){i(o,t,!1,e)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(t,e){i(o,t,!0,e)},process:function(){if(!o.paused&&r<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),r+=1;var i=function(){r-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+r===0&&o.drain(),o.process()},s=n(i);t(e.data,s)}},length:function(){return o.tasks.length},running:function(){return r},idle:function(){return o.tasks.length+r===0},pause:function(){o.paused!==!0&&(o.paused=!0)},resume:function(){if(o.paused!==!1){o.paused=!1;for(var t=1;t<=o.concurrency;t++)a.setImmediate(o.process)}}};return o},a.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}function r(t,e,i){for(var r=-1,n=t.length-1;n>r;){var o=r+(n-r+1>>>1);i(e,t[o])>=0?r=o:n=o-1}return r}function n(t,e,n,o){return t.started||(t.started=!0),l(e)||(e=[e]),0==e.length?a.setImmediate(function(){t.drain&&t.drain()}):void c(e,function(e){var s={data:e,priority:n,callback:"function"==typeof o?o:null};t.tasks.splice(r(t.tasks,s,i)+1,0,s),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),a.setImmediate(t.process)})}var o=a.queue(t,e);return o.push=function(t,e,i){n(o,t,e,i)},delete o.unshift,o},a.cargo=function(t,e){var i=!1,r=[],n={tasks:r,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,i){l(t)||(t=[t]),c(t,function(t){r.push({data:t,callback:"function"==typeof i?i:null}),n.drained=!1,n.saturated&&r.length===e&&n.saturated()}),a.setImmediate(n.process)},process:function o(){if(!i){if(0===r.length)return n.drain&&!n.drained&&n.drain(),void(n.drained=!0);var s="number"==typeof e?r.splice(0,e):r.splice(0,r.length),a=u(s,function(t){return t.data});n.empty&&n.empty(),i=!0,t(a,function(){i=!1;var t=arguments;c(s,function(e){e.callback&&e.callback.apply(null,t)}),o()})}},length:function(){return r.length},running:function(){return i}};return n};var M=function(t){return function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(null,i.concat([function(e){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error:console[t]&&c(i,function(t){}))}]))}};a.log=M("log"),a.dir=M("dir"),a.memoize=function(t,e){var i={},r={};e=e||function(t){return t};var n=function(){var n=Array.prototype.slice.call(arguments),o=n.pop(),s=e.apply(null,n);s in i?a.nextTick(function(){o.apply(null,i[s])}):s in r?r[s].push(o):(r[s]=[o],t.apply(null,n.concat([function(){i[s]=arguments;var t=r[s];delete r[s];for(var e=0,n=t.length;n>e;e++)t[e].apply(null,arguments)}])))};return n.memo=i,n.unmemoized=t,n},a.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},a.times=function(t,e,i){for(var r=[],n=0;t>n;n++)r.push(n);return a.map(r,e,i)},a.timesSeries=function(t,e,i){for(var r=[],n=0;t>n;n++)r.push(n);return a.mapSeries(r,e,i)},a.seq=function(){var t=arguments;return function(){var e=this,i=Array.prototype.slice.call(arguments),r=i.pop();a.reduce(t,i,function(t,i,r){i.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);r(t,e)}]))},function(t,i){r.apply(e,[t].concat(i))})}},a.compose=function(){return a.seq.apply(null,Array.prototype.reverse.call(arguments))};var E=function(t,e){var i=function(){var i=this,r=Array.prototype.slice.call(arguments),n=r.pop();return t(e,function(t,e){t.apply(i,r.concat([e]))},n)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return i.apply(this,r)}return i};a.applyEach=m(E),a.applyEachSeries=v(E),a.forever=function(t,e){function i(r){if(r){if(e)return e(r);throw r}t(i)}i()},"undefined"!=typeof r&&r.exports?r.exports=a:"undefined"!=typeof t&&t.amd?t([],function(){return a}):o.async=a}()}).call(this,e("_process"))},{_process:19}],30:[function(t,e,i){function r(t,e){a.call(this),e=e||10,this.baseUrl=t||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=n.queue(this._boundLoadResource,e),this.resources={}}var n=t("async"),o=t("url"),s=t("./Resource"),a=t("eventemitter3");r.prototype=Object.create(a.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.add=r.prototype.enqueue=function(t,e,i,r){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if("object"==typeof t&&(r=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(r=i,i=null),this.resources[t])throw new Error('Resource with name "'+t+'" already exists.');return e=this._handleBaseUrl(e),this.resources[t]=new s(t,e,i),"function"==typeof r&&this.resources[t].once("afterMiddleware",r),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[t]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[t]),this._progressChunk=100/this._buffer.length),this},r.prototype._handleBaseUrl=function(t){var e=o.parse(t);return e.protocol||!e.pathname||0===e.pathname.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t},r.prototype.before=r.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},r.prototype.after=r.prototype.use=function(t){return this._afterMiddleware.push(t),this},r.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},r.prototype.load=function(t){if("function"==typeof t&&this.once("complete",t),this._queue.started)return this;this.emit("start",this);for(var e=0;e<this._buffer.length;++e)this._queue.push(this._buffer[e]);return this._buffer.length=0,this},r.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,this._runMiddleware(t,this._beforeMiddleware,function(){t.load(i._boundOnLoad)})},r.prototype._onComplete=function(){this.emit("complete",this,this.resources)},r.prototype._onLoad=function(t){this.progress+=this._progressChunk,this.emit("progress",this,t),this._runMiddleware(t,this._afterMiddleware,function(){t.emit("afterMiddleware",t),this._numToLoad--,t.error?this.emit("error",t.error,this,t):this.emit("load",this,t),0===this._numToLoad&&(this.progress=100,this._onComplete())}),t._dequeue()},r.prototype._runMiddleware=function(t,e,i){var r=this;n.eachSeries(e,function(e,i){e.call(r,t,i)},i.bind(this,t))},r.LOAD_TYPE=s.LOAD_TYPE,r.XHR_READY_STATE=s.XHR_READY_STATE,r.XHR_RESPONSE_TYPE=s.XHR_RESPONSE_TYPE},{"./Resource":31,async:29,eventemitter3:26,url:24}],31:[function(t,e,i){function r(t,e,i){if(s.call(this),i=i||{},"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");this.name=t,this.url=e,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=i.crossOrigin===!0?"anonymous":i.crossOrigin,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function n(t){return t.toString().replace("object ","")}function o(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}var s=t("eventemitter3"),a=t("url"),h=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),l=null;r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},r.prototype.load=function(t){switch(this.emit("start",this),t&&this.once("complete",t),this.crossOrigin!==!1&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this._loadImage();break;case r.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case r.LOAD_TYPE.VIDEO:this._loadElement("video");break;case r.LOAD_TYPE.XHR:default:h&&this.crossOrigin?this._loadXdr():this._loadXhr()}},r.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},r.prototype._loadElement=function(t){if("audio"===t&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(t),null===this.data)return this.error=new Error("Unsupported element "+t),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=0;e<this.url.length;++e)this.data.appendChild(this._createSource(t,this.url[e]));else this.data.appendChild(this._createSource(t,this.url));this["is"+t[0].toUpperCase()+t.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},r.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=r.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},r.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){t.send()},0)},r.prototype._createSource=function(t,e,i){i||(i=t+"/"+e.substr(e.lastIndexOf(".")+1));var r=document.createElement("source");return r.src=e,r.type=i,r},r.prototype._onError=function(t){this.error=new Error("Failed to load element using "+t.target.nodeName),this.complete()},r.prototype._onProgress=function(t){t&&t.lengthComputable&&this.emit("progress",this,t.loaded/t.total)},r.prototype._xhrOnError=function(){this.error=new Error(n(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},r.prototype._xhrOnAbort=function(){this.error=new Error(n(this.xhr)+" Request was aborted by the user."),this.complete()},r.prototype._xdrOnTimeout=function(){this.error=new Error(n(this.xhr)+" Request timed out."),this.complete()},r.prototype._xhrOnLoad=function(){var t=this.xhr,e=void 0!==t.status?t.status:200;if(200===e||204===e||0===e&&t.responseText.length>0)if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=t.responseText;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t.responseText),this.isJson=!0}catch(i){this.error=new Error("Error trying to parse loaded json:",i)}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(t.responseText,"text/xml")}else{var o=document.createElement("div");o.innerHTML=t.responseText,this.data=o}this.isXml=!0}catch(i){this.error=new Error("Error trying to parse loaded xml:",i)}else this.data=t.response||t.responseText;else this.error=new Error("["+t.status+"]"+t.statusText+":"+t.responseURL);this.complete()},r.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,l||(l=document.createElement("a")),l.href=t,t=a.parse(l.href);var i=!t.port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"},r.prototype._determineXhrType=function(){return r._xhrTypeMap[this._getExtension()]||r.XHR_RESPONSE_TYPE.TEXT},r.prototype._determineLoadType=function(){return r._loadTypeMap[this._getExtension()]||r.LOAD_TYPE.XHR},r.prototype._getExtension=function(){var t,e=this.url;if(this.isDataUrl){var i=e.indexOf("/");t=e.substring(i+1,e.indexOf(";",i))}else{var r=e.indexOf("?");-1!==r&&(e=e.substring(0,r)),t=e.substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},r.prototype._getMimeFromXhrType=function(t){switch(t){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},r.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},r._loadTypeMap={gif:r.LOAD_TYPE.IMAGE,png:r.LOAD_TYPE.IMAGE,bmp:r.LOAD_TYPE.IMAGE,jpg:r.LOAD_TYPE.IMAGE,jpeg:r.LOAD_TYPE.IMAGE,tif:r.LOAD_TYPE.IMAGE,tiff:r.LOAD_TYPE.IMAGE,webp:r.LOAD_TYPE.IMAGE,tga:r.LOAD_TYPE.IMAGE,"svg+xml":r.LOAD_TYPE.IMAGE},r._xhrTypeMap={xhtml:r.XHR_RESPONSE_TYPE.DOCUMENT,html:r.XHR_RESPONSE_TYPE.DOCUMENT,htm:r.XHR_RESPONSE_TYPE.DOCUMENT,xml:r.XHR_RESPONSE_TYPE.DOCUMENT,tmx:r.XHR_RESPONSE_TYPE.DOCUMENT,tsx:r.XHR_RESPONSE_TYPE.DOCUMENT,svg:r.XHR_RESPONSE_TYPE.DOCUMENT,gif:r.XHR_RESPONSE_TYPE.BLOB,png:r.XHR_RESPONSE_TYPE.BLOB,bmp:r.XHR_RESPONSE_TYPE.BLOB,jpg:r.XHR_RESPONSE_TYPE.BLOB,jpeg:r.XHR_RESPONSE_TYPE.BLOB,tif:r.XHR_RESPONSE_TYPE.BLOB,tiff:r.XHR_RESPONSE_TYPE.BLOB,webp:r.XHR_RESPONSE_TYPE.BLOB,tga:r.XHR_RESPONSE_TYPE.BLOB,json:r.XHR_RESPONSE_TYPE.JSON,text:r.XHR_RESPONSE_TYPE.TEXT,txt:r.XHR_RESPONSE_TYPE.TEXT},r.setExtensionLoadType=function(t,e){o(r._loadTypeMap,t,e)},r.setExtensionXhrType=function(t,e){o(r._xhrTypeMap,t,e)}},{eventemitter3:26,url:24}],32:[function(t,e,i){e.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(t){for(var e,i="",r=new Array(4),n=0,o=0,s=0;n<t.length;){for(e=new Array(3),o=0;o<e.length;o++)n<t.length?e[o]=255&t.charCodeAt(n++):e[o]=0;switch(r[0]=e[0]>>2,r[1]=(3&e[0])<<4|e[1]>>4,r[2]=(15&e[1])<<2|e[2]>>6,r[3]=63&e[2],s=n-(t.length-1)){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64}for(o=0;o<r.length;o++)i+=this._keyStr.charAt(r[o])}return i}}},{}],33:[function(t,e,i){e.exports=t("./Loader"),e.exports.Resource=t("./Resource"),e.exports.middleware={caching:{memory:t("./middlewares/caching/memory")},parsing:{blob:t("./middlewares/parsing/blob")}}},{"./Loader":30,"./Resource":31,"./middlewares/caching/memory":34,"./middlewares/parsing/blob":35}],34:[function(t,e,i){var r={};e.exports=function(){return function(t,e){r[t.url]?(t.data=r[t.url],t.complete()):t.once("complete",function(){r[this.url]=this.data}),e()}}},{}],35:[function(t,e,i){var r=t("../../Resource"),n=t("../../b64"),o=window.URL||window.webkitURL;e.exports=function(){return function(t,e){if(!t.data)return e();if(t.xhr&&t.xhrType===r.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=o.createObjectURL(t.data);t.blob=t.data,t.data=new Image,t.data.src=i,t.isImage=!0,t.data.onload=function(){o.revokeObjectURL(i),t.data.onload=null,e()}}}else{var s=t.xhr.getResponseHeader("content-type");s&&0===s.indexOf("image")&&(t.data=new Image,t.data.src="data:"+s+";base64,"+n.encodeBinary(t.xhr.responseText),t.isImage=!0,t.data.onload=function(){t.data.onload=null,e()})}else e()}}},{"../../Resource":31,"../../b64":32}],36:[function(t,e,i){function r(t){(o.tablet||o.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}var n=t("../core"),o=t("ismobilejs");Object.assign(n.DisplayObject.prototype,t("./accessibleTarget")),
r.prototype.constructor=r,e.exports=r,r.prototype.createTouchHook=function(){var t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2,t.style.backgroundColor="#FF0000",t.title="HOOK DIV",t.addEventListener("focus",function(){this.isMobileAccessabillity=!0,this.activate(),document.body.removeChild(t)}.bind(this)),document.body.appendChild(t)},r.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode.appendChild(this.div))},r.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode.removeChild(this.div))},r.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=e.length-1;i>=0;i--)this.updateAccessibleObjects(e[i])}},r.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,r=this.div;r.style.left=t.left+"px",r.style.top=t.top+"px",r.style.width=this.renderer.width+"px",r.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var s=this.children[o];if(s.renderId!==this.renderId)s._accessibleActive=!1,n.utils.removeItems(this.children,o,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,o--,0===this.children.length&&this.deactivate();else{r=s._accessibleDiv;var a=s.hitArea,h=s.worldTransform;s.hitArea?(r.style.left=(h.tx+a.x*h.a)*e+"px",r.style.top=(h.ty+a.y*h.d)*i+"px",r.style.width=a.width*h.a*e+"px",r.style.height=a.height*h.d*i+"px"):(a=s.getBounds(),this.capHitArea(a),r.style.left=a.x*e+"px",r.style.top=a.y*i+"px",r.style.width=a.width*e+"px",r.style.height=a.height*i+"px")}}this.renderId++}},r.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},r.prototype.addChild=function(t){var e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleTitle||t.accessibleHint||(e.title="displayObject "+this.tabIndex),t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},r.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},r.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},r.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},r.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},r.prototype._onMouseMove=function(){this.deactivate()},r.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},n.WebGLRenderer.registerPlugin("accessibility",r),n.CanvasRenderer.registerPlugin("accessibility",r)},{"../core":58,"./accessibleTarget":37,ismobilejs:27}],37:[function(t,e,i){var r={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1};e.exports=r},{}],38:[function(t,e,i){e.exports={accessibleTarget:t("./accessibleTarget"),AccessibilityManager:t("./AccessibilityManager")}},{"./AccessibilityManager":36,"./accessibleTarget":37}],39:[function(t,e,i){function r(t){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var e=t.slice(0);return e.unshift("precision "+o.PRECISION.DEFAULT+" float;"),e}}else if("precision"!==t.substring(0,9))return"precision "+o.PRECISION.DEFAULT+" float;\n"+t;return t}var n=t("pixi-gl-core").GLShader,o=t("./const"),s=function(t,e,i){n.call(this,t,r(e),r(i))};s.prototype=Object.create(n.prototype),s.prototype.constructor=s,e.exports=s},{"./const":40,"pixi-gl-core":1}],40:[function(t,e,i){var r={VERSION:"4.0.0",PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},WRAP_MODES:{DEFAULT:0,CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},GC_MODES:{DEFAULT:1,AUTO:0,MANUAL:1},MIPMAP_TEXTURES:!0,RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},PRECISION:{DEFAULT:"mediump",LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},SPRITE_BATCH_SIZE:4096,SPRITE_MAX_TEXTURES:t("./utils/maxRecommendedTextures")(32),TEXT_STYLE_CHANGED:"changed"};e.exports=r},{"./utils/maxRecommendedTextures":111}],41:[function(t,e,i){function r(){s.call(this),this.children=[]}var n=t("../math"),o=t("../utils"),s=t("./DisplayObject");r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;0!==e?this.scale.x=t/e:this.scale.x=1,this._width=t}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;0!==e?this.scale.y=t/e:this.scale.y=1,this._height=t}}}),r.prototype.onChildrenChange=function(){},r.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var i=0;e>i;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.children.push(t),this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},r.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.onChildrenChange(e),t.emit("added",this),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},r.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);if(0>i||0>r)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[i]=e,this.children[r]=t,this.onChildrenChange(r>i?i:r)}},r.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},r.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);o.removeItems(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},r.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[t]},r.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var i=0;e>i;i++)this.removeChild(arguments[i]);else{var r=this.children.indexOf(t);if(-1===r)return;t.parent=null,o.removeItems(this.children,r,1),this.onChildrenChange(r),t.emit("removed",this)}return t},r.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,o.removeItems(this.children,t,1),this.onChildrenChange(t),e.emit("removed",this),e},r.prototype.removeChildren=function(t,e){var i,r,n=t||0,o="number"==typeof e?e:this.children.length,s=o-n;if(s>0&&o>=s){for(i=this.children.splice(n,s),r=0;r<i.length;++r)i[r].parent=null;for(this.onChildrenChange(t),r=0;r<i.length;++r)i[r].emit("removed",this);return i}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},r.prototype.updateTransform=function(){if(this.visible){this.transform=this.parent.transform.updateChildTransform(this.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform();this._currentBounds=null}},r.prototype.containerUpdateTransform=r.prototype.updateTransform,r.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return n.Rectangle.EMPTY;for(var t,e,i,r=1/0,o=1/0,s=-(1/0),a=-(1/0),h=!1,l=0,c=this.children.length;c>l;++l){var u=this.children[l];u.visible&&(t=this.children[l].getBounds(),t!==n.Rectangle.EMPTY&&(h=!0,r=r<t.x?r:t.x,o=o<t.y?o:t.y,e=t.width+t.x,i=t.height+t.y,s=s>e?s:e,a=a>i?a:i))}if(!h)return this._currentBounds=n.Rectangle.EMPTY,this._currentBounds;var p=this._bounds;p.x=r,p.y=o,p.width=s-r,p.height=a-o,this._currentBounds=p}return this._currentBounds},r.prototype.containerGetBounds=r.prototype.getBounds,r.prototype.getLocalBounds=function(){var t=this.transform.worldTransform;this.transform.worldTransform=n.Matrix.IDENTITY;for(var e=0,i=this.children.length;i>e;++e)this.children[e].updateTransform();return this.transform.worldTransform=t,this._currentBounds=null,this.getBounds()},r.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var e,i;if(this._mask||this._filters){for(t.currentRenderer.flush(),this._filters&&this._filters.length&&t.filterManager.pushFilter(this,this._filters),this._mask&&t.maskManager.pushMask(this,this._mask),t.currentRenderer.start(),this._renderWebGL(t),e=0,i=this.children.length;i>e;e++)this.children[e].renderWebGL(t);t.currentRenderer.flush(),this._mask&&t.maskManager.popMask(this,this._mask),this._filters&&t.filterManager.popFilter(),t.currentRenderer.start()}else for(this._renderWebGL(t),e=0,i=this.children.length;i>e;++e)this.children[e].renderWebGL(t)}},r.prototype._renderWebGL=function(t){},r.prototype._renderCanvas=function(t){},r.prototype.renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,i=this.children.length;i>e;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},r.prototype.destroy=function(t){if(s.prototype.destroy.call(this),t)for(var e=0,i=this.children.length;i>e;++e)this.children[e].destroy(t);this.removeChildren(),this.children=null}},{"../math":62,"../utils":110,"./DisplayObject":42}],42:[function(t,e,i){function r(){o.call(this),this.transform=new s,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.filterArea=null,this._bounds=new n.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var n=t("../math"),o=t("eventemitter3"),s=t("./Transform"),a=new r;r.prototype=Object.create(o.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{x:{get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},worldTransform:{get:function(){return this.transform.worldTransform}},localTransform:{get:function(){return this.transform.localTransform}},position:{get:function(){return this.transform.position},set:function(t){this.transform.position=t}},scale:{get:function(){return this.transform.scale},set:function(t){this.transform.scale=t}},pivot:{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot=t}},skew:{get:function(){return this.transform.skew},set:function(t){this.transform.skew=t}},rotation:{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}}),r.prototype.updateTransform=function(){this.transform=this.parent.transform.updateChildTransform(this.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},r.prototype.displayObjectUpdateTransform=r.prototype.updateTransform,r.prototype.getBounds=function(){return n.Rectangle.EMPTY},r.prototype.getLocalBounds=function(){return this.getBounds(n.Matrix.IDENTITY)},r.prototype.toGlobal=function(t){return this.parent?this.displayObjectUpdateTransform():(this.parent=a,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(t)},r.prototype.toLocal=function(t,e,i){return e&&(t=e.toGlobal(t)),this.parent?this.displayObjectUpdateTransform():(this.parent=a,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(t,i)},r.prototype.renderWebGL=function(t){},r.prototype.renderCanvas=function(t){},r.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},r.prototype.setTransform=function(t,e,i,r,n,o,s,a,h){return this.position.x=t||0,this.position.y=e||0,this.scale.x=i?i:1,this.scale.y=r?r:1,this.rotation=n||0,this.skew.x=o||0,this.skew.y=s||0,this.pivot.x=a||0,this.pivot.y=h||0,this},r.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.skew=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null}},{"../math":62,"./Transform":44,eventemitter3:26}],43:[function(t,e,i){function r(t,e,i,r){this._x=i||0,this._y=r||0,this.cb=t,this.scope=e}r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.cb.call(this.scope)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.cb.call(this.scope)}}}),r.prototype.set=function(t,e){this._x=t||0,this._y=e||(0!==e?this._x:0),this.transform._versionLocal++}},{}],44:[function(t,e,i){function r(){this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this.position=new n.Point(0),this.scale=new n.Point(1,1),this.skew=new o(this.updateSkew,this,0,0),this.pivot=new n.Point(0),this._rotation=0,this._sr=Math.sin(0),this._cr=Math.cos(0),this._cy=Math.cos(0),this._sy=Math.sin(0),this._nsx=Math.sin(0),this._cx=Math.cos(0),this._dirty=!1,this.updated=!0}var n=t("../math"),o=t("./ObservablePoint");r.prototype.constructor=r,r.prototype.updateSkew=function(){this._cy=Math.cos(this.skew.y),this._sy=Math.sin(this.skew.y),this._nsx=Math.sin(this.skew.x),this._cx=Math.cos(this.skew.x)},r.prototype.updateTransform=function(t){var e,i,r,n,o=t.worldTransform,s=this.worldTransform,a=this.localTransform;e=this._cr*this.scale.x,i=this._sr*this.scale.x,r=-this._sr*this.scale.y,n=this._cr*this.scale.y,a.a=this._cy*e+this._sy*r,a.b=this._cy*i+this._sy*n,a.c=this._nsx*e+this._cx*r,a.d=this._nsx*i+this._cx*n,a.tx=this.position.x-(this.pivot.x*a.a+this.pivot.y*a.c),a.ty=this.position.y-(this.pivot.x*a.b+this.pivot.y*a.d),s.a=a.a*o.a+a.b*o.c,s.b=a.a*o.b+a.b*o.d,s.c=a.c*o.a+a.d*o.c,s.d=a.c*o.b+a.d*o.d,s.tx=a.tx*o.a+a.ty*o.c+o.tx,s.ty=a.tx*o.b+a.ty*o.d+o.ty},r.prototype.updateChildTransform=function(t){return t.updateTransform(this),t},Object.defineProperties(r.prototype,{rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this._sr=Math.sin(t),this._cr=Math.cos(t)}}}),e.exports=r},{"../math":62,"./ObservablePoint":43}],45:[function(t,e,i){function r(){this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this.position=new o(this,0),this.scale=new o(this,1,1),this.pivot=new o(this,0),this.skew=new o(this,0),this._rotation=0,this._sr=Math.sin(0),this._cr=Math.cos(0),this._dirtyLocal=0,this._versionLocal=0,this._versionGlobal=0}var n=t("../math"),o=t("./ObservablePoint");r.prototype.constructor=r,r.prototype.updateTransform=function(t){var e=t.worldTransform,i=this.worldTransform,r=this.localTransform;this._dirtyLocal!==this._versionLocal&&(r.a=this._cr*this.scale._x,r.b=this._sr*this.scale._x,r.c=-this._sr*this.scale._y,r.d=this._cr*this.scale._y,r.tx=this.position._x-(this.pivot._x*r.a+this.pivot._y*r.c),r.ty=this.position._y-(this.pivot._x*r.b+this.pivot._y*r.d),this._dirtyLocal=this._versionLocal),i.a=r.a*e.a+r.b*e.c,i.b=r.a*e.b+r.b*e.d,i.c=r.c*e.a+r.d*e.c,i.d=r.c*e.b+r.d*e.d,i.tx=r.tx*e.a+r.ty*e.c+e.tx,i.ty=r.tx*e.b+r.ty*e.d+e.ty,this._versionGlobal++,this.updated=!0},r.prototype.updateChildTransform=function(t){return t.updateTransform(this),t},Object.defineProperties(r.prototype,{rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this._sr=Math.sin(t),this._cr=Math.cos(t)}}}),e.exports=r},{"../math":62,"./ObservablePoint":43}],46:[function(t,e,i){function r(){o.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=u.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new c.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1,this._spriteRect=null,this._fastRect=!1}var n,o=t("../display/Container"),s=t("../textures/RenderTexture"),a=t("../textures/Texture"),h=t("./GraphicsData"),l=t("../sprites/Sprite"),c=t("../math"),u=t("../const"),p=t("./utils/bezierCurveTo"),d=t("../renderers/canvas/CanvasRenderer"),f=new c.Matrix,m=new c.Point;r._SPRITE_TEXTURE=null,r.prototype=Object.create(o.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){var t=new r;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=!0,t.glDirty=!0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},r.prototype.lineStyle=function(t,e,i){if(this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===i?1:i,this.currentPath)if(this.currentPath.shape.points.length){var r=new c.Polygon(this.currentPath.shape.points.slice(-2));r.closed=!1,this.drawShape(r)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},r.prototype.moveTo=function(t,e){var i=new c.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},r.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty=!0,this},r.prototype.quadraticCurveTo=function(t,e,i,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var n,o,s=20,a=this.currentPath.shape.points;0===a.length&&this.moveTo(0,0);for(var h=a[a.length-2],l=a[a.length-1],c=0,u=1;s>=u;++u)c=u/s,n=h+(t-h)*c,o=l+(e-l)*c,a.push(n+(t+(i-t)*c-n)*c,o+(e+(r-e)*c-o)*c);return this.dirty=this.boundsDirty=!0,this},r.prototype.bezierCurveTo=function(t,e,i,r,n,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,a=s[s.length-2],h=s[s.length-1];return s.length-=2,p(a,h,t,e,i,r,n,o,s),this.dirty=this.boundsDirty=!0,this},r.prototype.arcTo=function(t,e,i,r,n){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,s=o[o.length-2],a=o[o.length-1],h=a-e,l=s-t,c=r-e,u=i-t,p=Math.abs(h*u-l*c);if(1e-8>p||0===n)o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e);else{var d=h*h+l*l,f=c*c+u*u,m=h*c+l*u,g=n*Math.sqrt(d)/p,v=n*Math.sqrt(f)/p,y=g*m/d,x=v*m/f,_=g*u+v*l,b=g*c+v*h,w=l*(v+y),S=h*(v+y),T=u*(g+x),M=c*(g+x),E=Math.atan2(S-b,w-_),C=Math.atan2(M-b,T-_);this.arc(_+t,b+e,n,E,C,l*c>u*h)}return this.dirty=this.boundsDirty=!0,this},r.prototype.arc=function(t,e,i,r,n,o){if(o=o||!1,r===n)return this;!o&&r>=n?n+=2*Math.PI:o&&n>=r&&(r+=2*Math.PI);var s=o?-1*(r-n):n-r,a=40*Math.ceil(Math.abs(s)/(2*Math.PI));if(0===s)return this;var h=t+Math.cos(r)*i,l=e+Math.sin(r)*i;this.currentPath?this.currentPath.shape.points.push(h,l):this.moveTo(h,l);for(var c=this.currentPath.shape.points,u=s/(2*a),p=2*u,d=Math.cos(u),f=Math.sin(u),m=a-1,g=m%1/m,v=0;m>=v;v++){var y=v+g*v,x=u+r+p*y,_=Math.cos(x),b=-Math.sin(x);c.push((d*_+f*b)*i+t,(d*-b+f*_)*i+e)}return this.dirty=this.boundsDirty=!0,this},r.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},r.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},r.prototype.drawRect=function(t,e,i,r){return this.drawShape(new c.Rectangle(t,e,i,r)),this},r.prototype.drawRoundedRect=function(t,e,i,r,n){return this.drawShape(new c.RoundedRectangle(t,e,i,r,n)),this},r.prototype.drawCircle=function(t,e,i){return this.drawShape(new c.Circle(t,e,i)),this},r.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new c.Ellipse(t,e,i,r)),this},r.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof c.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var r=0;r<e.length;++r)e[r]=arguments[r]}var n=new c.Polygon(e);return n.closed=i,this.drawShape(n),this},r.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},r.prototype._renderWebGL=function(t){this.glDirty&&(this.dirty=!0,this.glDirty=!1,this._fastRect=1===this.graphicsData.length&&this.graphicsData[0].shape.type===u.SHAPES.RECT&&!this.graphicsData[0].lineWidth),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},r.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;if(!this._spriteRect){if(!r._SPRITE_TEXTURE){r._SPRITE_TEXTURE=s.create(10,10);var i=t._activeRenderTarget;t.bindRenderTexture(r._SPRITE_TEXTURE),t.clear([1,1,1,1]),t.bindRenderTarget(i)}this._spriteRect=new l(r._SPRITE_TEXTURE),this._spriteRect.tint=this.graphicsData[0].fillColor}this._spriteRect.worldAlpha=this.worldAlpha,r._SPRITE_TEXTURE._frame.width=e.width,r._SPRITE_TEXTURE._frame.height=e.height,this._spriteRect.transform.worldTransform=this.transform.worldTransform,this._spriteRect.anchor.x=-e.x/e.width,this._spriteRect.anchor.y=-e.y/e.height,this._spriteRect._renderWebGL(t)},r.prototype._renderCanvas=function(t){this.isMask!==!0&&t.plugins.graphics.render(this)},r.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return c.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var e=this._localBounds,i=e.x,r=e.width+e.x,n=e.y,o=e.height+e.y,s=t||this.worldTransform,a=s.a,h=s.b,l=s.c,u=s.d,p=s.tx,d=s.ty,f=a*r+l*o+p,m=u*o+h*r+d,g=a*i+l*o+p,v=u*o+h*i+d,y=a*i+l*n+p,x=u*n+h*i+d,_=a*r+l*n+p,b=u*n+h*r+d,w=f,S=m,T=f,M=m;T=T>g?g:T,T=T>y?y:T,T=T>_?_:T,M=M>v?v:M,M=M>x?x:M,M=M>b?b:M,w=g>w?g:w,w=y>w?y:w,w=_>w?_:w,S=v>S?v:S,S=x>S?x:S,S=b>S?b:S,this._bounds.x=T,this._bounds.width=w-T,this._bounds.y=M,this._bounds.height=S-M,this._currentBounds=this._bounds}return this._currentBounds},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,m);for(var e=this.graphicsData,i=0;i<e.length;i++){var r=e[i];if(r.fill&&r.shape&&r.shape.contains(m.x,m.y))return!0}return!1},r.prototype.updateLocalBounds=function(){var t=1/0,e=-(1/0),i=1/0,r=-(1/0);if(this.graphicsData.length)for(var n,o,s,a,h,l,c=0;c<this.graphicsData.length;c++){var p=this.graphicsData[c],d=p.type,f=p.lineWidth;if(n=p.shape,d===u.SHAPES.RECT||d===u.SHAPES.RREC)s=n.x-f/2,a=n.y-f/2,h=n.width+f,l=n.height+f,t=t>s?s:t,e=s+h>e?s+h:e,i=i>a?a:i,r=a+l>r?a+l:r;else if(d===u.SHAPES.CIRC)s=n.x,a=n.y,h=n.radius+f/2,l=n.radius+f/2,t=t>s-h?s-h:t,e=s+h>e?s+h:e,i=i>a-l?a-l:i,r=a+l>r?a+l:r;else if(d===u.SHAPES.ELIP)s=n.x,a=n.y,h=n.width+f/2,l=n.height+f/2,t=t>s-h?s-h:t,e=s+h>e?s+h:e,i=i>a-l?a-l:i,r=a+l>r?a+l:r;else{o=n.points;for(var m=0;m<o.length;m+=2)s=o[m],a=o[m+1],t=t>s-f?s-f:t,e=s+f>e?s+f:e,i=i>a-f?a-f:i,r=a+f>r?a+f:r}}else t=0,e=0,i=0,r=0;var g=this.boundsPadding;this._localBounds.x=t-g,this._localBounds.width=e-t+2*g,this._localBounds.y=i-g,this._localBounds.height=r-i+2*g},r.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new h(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===u.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty=this.boundsDirty=!0,e},r.prototype.generateCanvasTexture=function(t,e){e=e||1;var i=this.getLocalBounds(),r=new s.create(i.width*e,i.height*e);n||(n=new d),f.tx=-i.x,f.ty=-i.y,n.render(this,r,!1,f);var o=a.fromCanvas(r.baseTexture._canvasRenderTarget.canvas,t);return o.baseTexture.resolution=e,o},r.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},r.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},r.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var e in this._webgl)for(var i=0;i<this._webgl[e].data.length;++i)this._webgl[e].data[i].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null}},{"../const":40,"../display/Container":41,"../math":62,"../renderers/canvas/CanvasRenderer":69,"../sprites/Sprite":92,"../textures/RenderTexture":102,"../textures/Texture":103,"./GraphicsData":47,"./utils/bezierCurveTo":49}],47:[function(t,e,i){function r(t,e,i,r,n,o,s){this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=r,this.fillAlpha=n,this._fillTint=r,this.fill=o,this.holes=[],this.shape=s,this.type=s.type}r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},r.prototype.addHole=function(t){this.holes.push(t)},r.prototype.destroy=function(){this.shape=null,this.holes=null}},{}],48:[function(t,e,i){function r(t){this.renderer=t}var n=t("../../renderers/canvas/CanvasRenderer"),o=t("../../const");r.prototype.constructor=r,e.exports=r,n.registerPlugin("graphics",r),r.prototype.render=function(t){var e=this.renderer,i=e.context,r=t.worldAlpha,n=t.transform.worldTransform,s=e.resolution;this._prevTint!==this.tint&&(this.dirty=!0),i.setTransform(n.a*s,n.b*s,n.c*s,n.d*s,n.tx*s,n.ty*s),t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1),e.setBlendMode(t.blendMode);for(var a=0;a<t.graphicsData.length;a++){var h=t.graphicsData[a],l=h.shape,c=h._fillTint,u=h._lineTint;if(i.lineWidth=h.lineWidth,h.type===o.SHAPES.POLY){i.beginPath(),this.renderPolygon(l.points,l.closed,i);for(var p=0;p<h.holes.length;p++){var d=h.holes[p];this.renderPolygon(d.points,!0,i)}h.fill&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke())}else if(h.type===o.SHAPES.RECT)(h.fillColor||0===h.fillColor)&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.fillRect(l.x,l.y,l.width,l.height)),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.strokeRect(l.x,l.y,l.width,l.height));else if(h.type===o.SHAPES.CIRC)i.beginPath(),i.arc(l.x,l.y,l.radius,0,2*Math.PI),i.closePath(),h.fill&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke());else if(h.type===o.SHAPES.ELIP){var f=2*l.width,m=2*l.height,g=l.x-f/2,v=l.y-m/2;i.beginPath();var y=.5522848,x=f/2*y,_=m/2*y,b=g+f,w=v+m,S=g+f/2,T=v+m/2;i.moveTo(g,T),i.bezierCurveTo(g,T-_,S-x,v,S,v),i.bezierCurveTo(S+x,v,b,T-_,b,T),i.bezierCurveTo(b,T+_,S+x,w,S,w),i.bezierCurveTo(S-x,w,g,T+_,g,T),i.closePath(),h.fill&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke())}else if(h.type===o.SHAPES.RREC){var M=l.x,E=l.y,C=l.width,A=l.height,L=l.radius,P=Math.min(C,A)/2|0;L=L>P?P:L,i.beginPath(),i.moveTo(M,E+L),i.lineTo(M,E+A-L),i.quadraticCurveTo(M,E+A,M+L,E+A),i.lineTo(M+C-L,E+A),i.quadraticCurveTo(M+C,E+A,M+C,E+A-L),i.lineTo(M+C,E+L),i.quadraticCurveTo(M+C,E,M+C-L,E),i.lineTo(M+L,E),i.quadraticCurveTo(M,E,M,E+L),i.closePath(),(h.fillColor||0===h.fillColor)&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.stroke())}}},r.prototype.updateGraphicsTint=function(t){if(16777215!==t.tint||t._prevTint!==t.tint){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,r=(255&t.tint)/255,n=0;n<t.graphicsData.length;n++){var o=t.graphicsData[n],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*r*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*r*255}}},r.prototype.renderPolygon=function(t,e,i){i.moveTo(t[0],t[1]);for(var r=1;r<t.length/2;r++)i.lineTo(t[2*r],t[2*r+1]);e&&i.closePath()},r.prototype.destroy=function(){this.renderer=null}},{"../../const":40,"../../renderers/canvas/CanvasRenderer":69}],49:[function(t,e,i){var r=function(t,e,i,r,n,o,s,a,h){h=h||[];var l,c,u,p,d,f=20;h.push(t,e);for(var m=0,g=1;f>=g;++g)m=g/f,l=1-m,c=l*l,u=c*l,p=m*m,d=p*m,h.push(u*t+3*c*m*i+3*l*p*n+d*s,u*e+3*c*m*r+3*l*p*o+d*a);return h};e.exports=r},{}],50:[function(t,e,i){function r(t){s.call(this,t),this.graphicsDataPool=[],this.primitiveShader=null,this.gl=t.gl,this.CONTEXT_UID=0}var n=t("../../utils"),o=t("../../const"),s=t("../../renderers/webgl/utils/ObjectRenderer"),a=t("../../renderers/webgl/WebGLRenderer"),h=t("./WebGLGraphicsData"),l=t("./shaders/PrimitiveShader"),c=t("./utils/buildPoly"),u=t("./utils/buildRectangle"),p=t("./utils/buildRoundedRectangle"),d=t("./utils/buildCircle");
r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,a.registerPlugin("graphics",r),r.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new l(this.gl)},r.prototype.destroy=function(){s.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},r.prototype.render=function(t){var e,i=this.renderer,r=i.gl;!t.dirty&&t._webGL[this.CONTEXT_UID]||this.updateGraphics(t);var o=t._webGL[this.CONTEXT_UID],s=this.primitiveShader;i.bindShader(s),i.state.setBlendMode(t.blendMode);for(var a=0,h=o.data.length;h>a;a++){e=o.data[a];var l=e.shader;i.bindShader(l),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.tint=n.hex2rgb(t.tint),l.uniforms.alpha=t.worldAlpha,e.vao.bind().draw(r.TRIANGLE_STRIP,e.indices.length).unbind()}},r.prototype.updateGraphics=function(t){var e=this.renderer.gl,i=t._webGL[this.CONTEXT_UID];i||(i=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:e}),t.dirty=!1;var r;if(t.clearDirty){for(t.clearDirty=!1,r=0;r<i.data.length;r++){var n=i.data[r];this.graphicsDataPool.push(n)}i.data=[],i.lastIndex=0}var s;for(r=i.lastIndex;r<t.graphicsData.length;r++){var a=t.graphicsData[r];s=this.getWebGLData(i,0),a.type===o.SHAPES.POLY&&c(a,s),a.type===o.SHAPES.RECT?u(a,s):a.type===o.SHAPES.CIRC||a.type===o.SHAPES.ELIP?d(a,s):a.type===o.SHAPES.RREC&&p(a,s),i.lastIndex++}for(r=0;r<i.data.length;r++)s=i.data[r],s.dirty&&s.upload()},r.prototype.getWebGLData=function(t,e){var i=t.data[t.data.length-1];return(!i||i.points.length>32e4)&&(i=this.graphicsDataPool.pop()||new h(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),i.reset(e),t.data.push(i)),i.dirty=!0,i}},{"../../const":40,"../../renderers/webgl/WebGLRenderer":76,"../../renderers/webgl/utils/ObjectRenderer":86,"../../utils":110,"./WebGLGraphicsData":51,"./shaders/PrimitiveShader":52,"./utils/buildCircle":53,"./utils/buildPoly":55,"./utils/buildRectangle":56,"./utils/buildRoundedRectangle":57}],51:[function(t,e,i){function r(t,e,i){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=n.GLBuffer.createVertexBuffer(t),this.indexBuffer=n.GLBuffer.createIndexBuffer(t),this.dirty=!0,this.glPoints=null,this.glIndices=null,this.shader=e,this.vao=new n.VertexArrayObject(t,i).addIndex(this.indexBuffer).addAttribute(this.buffer,e.attributes.aVertexPosition,t.FLOAT,!1,24,0).addAttribute(this.buffer,e.attributes.aColor,t.FLOAT,!1,24,8)}var n=t("pixi-gl-core");r.prototype.constructor=r,e.exports=r,r.prototype.reset=function(){this.points.length=0,this.indices.length=0},r.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},r.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null}},{"pixi-gl-core":1}],52:[function(t,e,i){function r(t){n.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"))}var n=t("../../../Shader");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r},{"../../../Shader":39}],53:[function(t,e,i){var r=t("./buildLine"),n=t("../../../const"),o=t("../../../utils"),s=function(t,e){var i,s,a=t.shape,h=a.x,l=a.y;t.type===n.SHAPES.CIRC?(i=a.radius,s=a.radius):(i=a.width,s=a.height);var c=Math.floor(30*Math.sqrt(a.radius))||Math.floor(15*Math.sqrt(a.width+a.height)),u=2*Math.PI/c,p=0;if(t.fill){var d=o.hex2rgb(t.fillColor),f=t.fillAlpha,m=d[0]*f,g=d[1]*f,v=d[2]*f,y=e.points,x=e.indices,_=y.length/6;for(x.push(_),p=0;c+1>p;p++)y.push(h,l,m,g,v,f),y.push(h+Math.sin(u*p)*i,l+Math.cos(u*p)*s,m,g,v,f),x.push(_++,_++);x.push(_-1)}if(t.lineWidth){var b=t.points;for(t.points=[],p=0;c+1>p;p++)t.points.push(h+Math.sin(u*p)*i,l+Math.cos(u*p)*s);r(t,e),t.points=b}};e.exports=s},{"../../../const":40,"../../../utils":110,"./buildLine":54}],54:[function(t,e,i){var r=t("../../../math"),n=t("../../../utils"),o=function(t,e){var i=0,o=t.points;if(0!==o.length){var s=new r.Point(o[0],o[1]),a=new r.Point(o[o.length-2],o[o.length-1]);if(s.x===a.x&&s.y===a.y){o=o.slice(),o.pop(),o.pop(),a=new r.Point(o[o.length-2],o[o.length-1]);var h=a.x+.5*(s.x-a.x),l=a.y+.5*(s.y-a.y);o.unshift(h,l),o.push(h,l)}var c,u,p,d,f,m,g,v,y,x,_,b,w,S,T,M,E,C,A,L,P,R,O,I=e.points,D=e.indices,B=o.length/2,k=o.length,F=I.length/6,N=t.lineWidth/2,U=n.hex2rgb(t.lineColor),G=t.lineAlpha,z=U[0]*G,V=U[1]*G,j=U[2]*G;for(p=o[0],d=o[1],f=o[2],m=o[3],y=-(d-m),x=p-f,O=Math.sqrt(y*y+x*x),y/=O,x/=O,y*=N,x*=N,I.push(p-y,d-x,z,V,j,G),I.push(p+y,d+x,z,V,j,G),i=1;B-1>i;i++)p=o[2*(i-1)],d=o[2*(i-1)+1],f=o[2*i],m=o[2*i+1],g=o[2*(i+1)],v=o[2*(i+1)+1],y=-(d-m),x=p-f,O=Math.sqrt(y*y+x*x),y/=O,x/=O,y*=N,x*=N,_=-(m-v),b=f-g,O=Math.sqrt(_*_+b*b),_/=O,b/=O,_*=N,b*=N,T=-x+d-(-x+m),M=-y+f-(-y+p),E=(-y+p)*(-x+m)-(-y+f)*(-x+d),C=-b+v-(-b+m),A=-_+f-(-_+g),L=(-_+g)*(-b+m)-(-_+f)*(-b+v),P=T*A-C*M,Math.abs(P)<.1?(P+=10.1,I.push(f-y,m-x,z,V,j,G),I.push(f+y,m+x,z,V,j,G)):(c=(M*L-A*E)/P,u=(C*E-T*L)/P,R=(c-f)*(c-f)+(u-m)*(u-m),R>19600?(w=y-_,S=x-b,O=Math.sqrt(w*w+S*S),w/=O,S/=O,w*=N,S*=N,I.push(f-w,m-S),I.push(z,V,j,G),I.push(f+w,m+S),I.push(z,V,j,G),I.push(f-w,m-S),I.push(z,V,j,G),k++):(I.push(c,u),I.push(z,V,j,G),I.push(f-(c-f),m-(u-m)),I.push(z,V,j,G)));for(p=o[2*(B-2)],d=o[2*(B-2)+1],f=o[2*(B-1)],m=o[2*(B-1)+1],y=-(d-m),x=p-f,O=Math.sqrt(y*y+x*x),y/=O,x/=O,y*=N,x*=N,I.push(f-y,m-x),I.push(z,V,j,G),I.push(f+y,m+x),I.push(z,V,j,G),D.push(F),i=0;k>i;i++)D.push(F++);D.push(F-1)}};e.exports=o},{"../../../math":62,"../../../utils":110}],55:[function(t,e,i){var r=t("./buildLine"),n=t("../../../utils"),o=t("earcut"),s=function(t,e){t.points=t.shape.points.slice();var i=t.points;if(t.fill&&i.length>6){for(var s=[],a=t.holes,h=0;h<a.length;h++){var l=a[h];s.push(i.length/2),i=i.concat(l.points)}var c=e.points,u=e.indices,p=i.length/2,d=n.hex2rgb(t.fillColor),f=t.fillAlpha,m=d[0]*f,g=d[1]*f,v=d[2]*f,y=o(i,s,2);if(!y)return;var x=c.length/6;for(h=0;h<y.length;h+=3)u.push(y[h]+x),u.push(y[h]+x),u.push(y[h+1]+x),u.push(y[h+2]+x),u.push(y[h+2]+x);for(h=0;p>h;h++)c.push(i[2*h],i[2*h+1],m,g,v,f)}t.lineWidth>0&&r(t,e)};e.exports=s},{"../../../utils":110,"./buildLine":54,earcut:25}],56:[function(t,e,i){var r=t("./buildLine"),n=t("../../../utils"),o=function(t,e){var i=t.shape,o=i.x,s=i.y,a=i.width,h=i.height;if(t.fill){var l=n.hex2rgb(t.fillColor),c=t.fillAlpha,u=l[0]*c,p=l[1]*c,d=l[2]*c,f=e.points,m=e.indices,g=f.length/6;f.push(o,s),f.push(u,p,d,c),f.push(o+a,s),f.push(u,p,d,c),f.push(o,s+h),f.push(u,p,d,c),f.push(o+a,s+h),f.push(u,p,d,c),m.push(g,g,g+1,g+2,g+3,g+3)}if(t.lineWidth){var v=t.points;t.points=[o,s,o+a,s,o+a,s+h,o,s+h,o,s],r(t,e),t.points=v}};e.exports=o},{"../../../utils":110,"./buildLine":54}],57:[function(t,e,i){var r=t("earcut"),n=t("./buildLine"),o=t("../../../utils"),s=function(t,e){var i=t.shape,s=i.x,h=i.y,l=i.width,c=i.height,u=i.radius,p=[];if(p.push(s,h+u),a(s,h+c-u,s,h+c,s+u,h+c,p),a(s+l-u,h+c,s+l,h+c,s+l,h+c-u,p),a(s+l,h+u,s+l,h,s+l-u,h,p),a(s+u,h,s,h,s,h+u+1e-10,p),t.fill){var d=o.hex2rgb(t.fillColor),f=t.fillAlpha,m=d[0]*f,g=d[1]*f,v=d[2]*f,y=e.points,x=e.indices,_=y.length/6,b=r(p,null,2),w=0;for(w=0;w<b.length;w+=3)x.push(b[w]+_),x.push(b[w]+_),x.push(b[w+1]+_),x.push(b[w+2]+_),x.push(b[w+2]+_);for(w=0;w<p.length;w++)y.push(p[w],p[++w],m,g,v,f)}if(t.lineWidth){var S=t.points;t.points=p,n(t,e),t.points=S}},a=function(t,e,i,r,n,o,s){function a(t,e,i){var r=e-t;return t+r*i}for(var h,l,c,u,p,d,f=20,m=s||[],g=0,v=0;f>=v;v++)g=v/f,h=a(t,i,g),l=a(e,r,g),c=a(i,n,g),u=a(r,o,g),p=a(h,c,g),d=a(l,u,g),m.push(p,d);return m};e.exports=s},{"../../../utils":110,"./buildLine":54,earcut:25}],58:[function(t,e,i){var r=e.exports=Object.assign(t("./const"),t("./math"),{utils:t("./utils"),ticker:t("./ticker"),DisplayObject:t("./display/DisplayObject"),Container:t("./display/Container"),Transform:t("./display/Transform"),TransformStatic:t("./display/TransformStatic"),Sprite:t("./sprites/Sprite"),CanvasSpriteRender:t("./sprites/canvas/CanvasSpriteRenderer"),CanvasTinter:t("./sprites/canvas/CanvasTinter"),SpriteRenderer:t("./sprites/webgl/SpriteRenderer"),Text:t("./text/Text"),TextStyle:t("./text/TextStyle"),Graphics:t("./graphics/Graphics"),GraphicsData:t("./graphics/GraphicsData"),GraphicsRenderer:t("./graphics/webgl/GraphicsRenderer"),CanvasGraphicsRenderer:t("./graphics/canvas/CanvasGraphicsRenderer"),Texture:t("./textures/Texture"),BaseTexture:t("./textures/BaseTexture"),RenderTexture:t("./textures/RenderTexture"),BaseRenderTexture:t("./textures/BaseRenderTexture"),VideoBaseTexture:t("./textures/VideoBaseTexture"),TextureUvs:t("./textures/TextureUvs"),CanvasRenderer:t("./renderers/canvas/CanvasRenderer"),CanvasRenderTarget:t("./renderers/canvas/utils/CanvasRenderTarget"),Shader:t("./Shader"),WebGLRenderer:t("./renderers/webgl/WebGLRenderer"),WebGLManager:t("./renderers/webgl/managers/WebGLManager"),ObjectRenderer:t("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:t("./renderers/webgl/utils/RenderTarget"),Quad:t("./renderers/webgl/utils/Quad"),SpriteMaskFilter:t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter"),Filter:t("./renderers/webgl/filters/Filter"),glCore:t("pixi-gl-core"),autoDetectRenderer:function(t,e,i,n){return t=t||800,e=e||600,!n&&r.utils.isWebGLSupported()?new r.WebGLRenderer(t,e,i):new r.CanvasRenderer(t,e,i)}})},{"./Shader":39,"./const":40,"./display/Container":41,"./display/DisplayObject":42,"./display/Transform":44,"./display/TransformStatic":45,"./graphics/Graphics":46,"./graphics/GraphicsData":47,"./graphics/canvas/CanvasGraphicsRenderer":48,"./graphics/webgl/GraphicsRenderer":50,"./math":62,"./renderers/canvas/CanvasRenderer":69,"./renderers/canvas/utils/CanvasRenderTarget":71,"./renderers/webgl/WebGLRenderer":76,"./renderers/webgl/filters/Filter":78,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":81,"./renderers/webgl/managers/WebGLManager":85,"./renderers/webgl/utils/ObjectRenderer":86,"./renderers/webgl/utils/Quad":87,"./renderers/webgl/utils/RenderTarget":88,"./sprites/Sprite":92,"./sprites/canvas/CanvasSpriteRenderer":93,"./sprites/canvas/CanvasTinter":94,"./sprites/webgl/SpriteRenderer":96,"./text/Text":98,"./text/TextStyle":99,"./textures/BaseRenderTexture":100,"./textures/BaseTexture":101,"./textures/RenderTexture":102,"./textures/Texture":103,"./textures/TextureUvs":104,"./textures/VideoBaseTexture":105,"./ticker":107,"./utils":110,"pixi-gl-core":1}],59:[function(t,e,i){function r(t){return 0>t?-1:t>0?1:0}function n(){for(var t=0;16>t;t++){var e=[];u.push(e);for(var i=0;16>i;i++)for(var n=r(o[t]*o[i]+a[t]*s[i]),p=r(s[t]*o[i]+h[t]*s[i]),d=r(o[t]*a[i]+a[t]*h[i]),f=r(s[t]*a[i]+h[t]*h[i]),m=0;16>m;m++)if(o[m]===n&&s[m]===p&&a[m]===d&&h[m]===f){e.push(m);break}}for(t=0;16>t;t++){var g=new c;g.set(o[t],s[t],a[t],h[t],0,0),l.push(g)}}var o=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],s=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],a=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],h=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],l=[],c=t("./Matrix"),u=[];n();var p={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return o[t]},uY:function(t){return s[t]},vX:function(t){return a[t]},vY:function(t){return h[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return u[t][e]},sub:function(t,e){return u[t][p.inv(e)]},rotate180:function(t){return 4^t},isSwapWidthHeight:function(t){return 2===(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?p.S:p.N:2*Math.abs(e)<=Math.abs(t)?t>0?p.E:p.W:e>0?t>0?p.SE:p.SW:t>0?p.NE:p.NW},matrixAppendRotationInv:function(t,e,i,r){var n=l[p.inv(e)];i=i||0,r=r||0,n.tx=i,n.ty=r,t.append(n)}};e.exports=p},{"./Matrix":60}],60:[function(t,e,i){function r(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var n=t("./Point");r.prototype.constructor=r,e.exports=r,r.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},r.prototype.set=function(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this},r.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},r.prototype.apply=function(t,e){e=e||new n;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},r.prototype.applyInverse=function(t,e){e=e||new n;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,o=t.y;return e.x=this.d*i*r+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*o+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},r.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},r.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},r.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},r.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},r.prototype.setTransform=function(t,e,i,r,n,o,s,a,h){var l,c,u,p,d,f,m,g,v,y;return d=Math.sin(s),f=Math.cos(s),m=Math.cos(h),g=Math.sin(h),v=-Math.sin(a),y=Math.cos(a),l=f*n,c=d*n,u=-d*o,p=f*o,this.a=m*l+g*u,this.b=m*c+g*p,this.c=v*l+y*u,this.d=v*c+y*p,this.tx=t+(i*l+r*u),this.ty=e+(i*c+r*p),this},r.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},r.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},r.prototype.clone=function(){var t=new r;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.IDENTITY=new r,r.TEMP_MATRIX=new r},{"./Point":61}],61:[function(t,e,i){function r(t,e){this.x=t||0,this.y=e||0}r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copy=function(t){this.set(t.x,t.y)},r.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},r.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)}},{}],62:[function(t,e,i){e.exports={Point:t("./Point"),Matrix:t("./Matrix"),GroupD8:t("./GroupD8"),Circle:t("./shapes/Circle"),Ellipse:t("./shapes/Ellipse"),Polygon:t("./shapes/Polygon"),Rectangle:t("./shapes/Rectangle"),RoundedRectangle:t("./shapes/RoundedRectangle")}},{"./GroupD8":59,"./Matrix":60,"./Point":61,"./shapes/Circle":63,"./shapes/Ellipse":64,"./shapes/Polygon":65,"./shapes/Rectangle":66,"./shapes/RoundedRectangle":67}],63:[function(t,e,i){function r(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0,this.type=o.SHAPES.CIRC}var n=t("./Rectangle"),o=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,r=this.y-e,n=this.radius*this.radius;return i*=i,r*=r,n>=i+r},r.prototype.getBounds=function(){return new n(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":40,"./Rectangle":66}],64:[function(t,e,i){function r(t,e,i,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=r||0,this.type=o.SHAPES.ELIP}var n=t("./Rectangle"),o=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return i*=i,r*=r,1>=i+r},r.prototype.getBounds=function(){return new n(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":40,"./Rectangle":66}],65:[function(t,e,i){function r(t){var e=t;if(!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}if(e[0]instanceof n){for(var r=[],s=0,a=e.length;a>s;s++)r.push(e[s].x,e[s].y);e=r}this.closed=!0,this.points=e,this.type=o.SHAPES.POLY}var n=t("../Point"),o=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.points.slice())},r.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},r.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,o=r-1;r>n;o=n++){var s=this.points[2*n],a=this.points[2*n+1],h=this.points[2*o],l=this.points[2*o+1],c=a>e!=l>e&&(h-s)*(e-a)/(l-a)+s>t;c&&(i=!i)}return i}},{"../../const":40,"../Point":61}],66:[function(t,e,i){function r(t,e,i,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=r||0,this.type=n.SHAPES.RECT}var n=t("../../const");r.prototype.constructor=r,e.exports=r,r.EMPTY=new r(0,0,0,0),r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},r.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},r.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},r.prototype.enlarge=function(t){if(t!==r.EMPTY){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=n,this.height=o-n}}},{"../../const":40}],67:[function(t,e,i){function r(t,e,i,r,o){this.x=t||0,this.y=e||0,this.width=i||0,this.height=r||0,this.radius=o||20,this.type=n.SHAPES.RREC}var n=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height}},{"../../const":40}],68:[function(t,e,i){function r(t,e,i,r){if(l.call(this),n.sayHello(t),r)for(var o in s.DEFAULT_RENDER_OPTIONS)"undefined"==typeof r[o]&&(r[o]=s.DEFAULT_RENDER_OPTIONS[o]);else r=s.DEFAULT_RENDER_OPTIONS;this.type=s.RENDERER_TYPE.UNKNOWN,this.width=e||800,this.height=i||600,this.view=r.view||document.createElement("canvas"),this.resolution=r.resolution,this.transparent=r.transparent,this.autoResize=r.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=r.preserveDrawingBuffer,this.clearBeforeRender=r.clearBeforeRender,this.roundPixels=r.roundPixels,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=r.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new a,this._lastObjectRendered=this._tempDisplayObjectParent}var n=t("../utils"),o=t("../math"),s=t("../const"),a=t("../display/Container"),h=t("../textures/RenderTexture"),l=t("eventemitter3"),c=new o.Matrix;r.prototype=Object.create(l.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=n.hex2string(t),n.hex2rgb(t,this._backgroundColorRgba)}}}),r.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},r.prototype.generateTexture=function(t,e,i){var r=t.getLocalBounds(),n=h.create(0|r.width,0|r.height,e,i);return c.tx=-r.x,c.ty=-r.y,this.render(t,n,!1,c,!0),n},r.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=s.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this.backgroundColor=0,this._tempDisplayObjectParent=null,this._lastObjectRendered=null}},{"../const":40,"../display/Container":41,"../math":62,"../textures/RenderTexture":102,"../utils":110,eventemitter3:26}],69:[function(t,e,i){function r(t,e,i){i=i||{},n.call(this,"Canvas",t,e,i),this.type=l.RENDERER_TYPE.CANVAS,this.rootContext=this.view.getContext("2d",{alpha:this.transparent}),this.rootResolution=this.resolution,this.refresh=!0,this.maskManager=new o(this),this.smoothProperty="imageSmoothingEnabled",this.rootContext.imageSmoothingEnabled||(this.rootContext.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.rootContext.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.rootContext.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.rootContext.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this.blendModes=a(),this._activeBlendMode=null,this.context=null,this.renderingToScreen=!1,this.resize(t,e)}var n=t("../SystemRenderer"),o=t("./utils/CanvasMaskManager"),s=t("./utils/CanvasRenderTarget"),a=t("./utils/mapCanvasBlendModesToPixi"),h=t("../../utils"),l=t("../../const");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,h.pluginTarget.mixin(r),r.prototype.render=function(t,e,i,r,n){if(this.view){this.renderingToScreen=!e,this.emit("prerender"),e?(e=e.baseTexture||e,e._canvasRenderTarget||(e._canvasRenderTarget=new s(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):(this.context=this.rootContext,this.resolution=this.rootResolution);var o=this.context;if(e||(this._lastObjectRendered=t),!n){var a=t.parent,h=this._tempDisplayObjectParent.transform.worldTransform;r?r.copy(h):h.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=a}o.setTransform(1,0,0,1,0,0),o.globalAlpha=1,o.globalCompositeOperation=this.blendModes[l.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(o.fillStyle="black",o.clear()),(void 0!==i?i:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?o.clearRect(0,0,this.width,this.height):(o.fillStyle=this._backgroundColorString,o.fillRect(0,0,this.width,this.height)));var c=this.context;this.context=o,t.renderCanvas(this),this.context=c,this.emit("postrender")}},r.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this.context.globalCompositeOperation=this.blendModes[t])},r.prototype.destroy=function(t){this.destroyPlugins(),n.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},r.prototype.resize=function(t,e){n.prototype.resize.call(this,t,e),this.smoothProperty&&(this.rootContext[this.smoothProperty]=l.SCALE_MODES.DEFAULT===l.SCALE_MODES.LINEAR)}},{"../../const":40,"../../utils":110,"../SystemRenderer":68,"./utils/CanvasMaskManager":70,"./utils/CanvasRenderTarget":71,"./utils/mapCanvasBlendModesToPixi":73}],70:[function(t,e,i){function r(t){this.renderer=t}var n=t("../../../const");r.prototype.constructor=r,e.exports=r,r.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var i=t.alpha,r=t.transform.worldTransform,n=e.resolution;e.context.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=i},r.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,i=t.graphicsData.length;if(0!==i){e.beginPath();for(var r=0;i>r;r++){var o=t.graphicsData[r],s=o.shape;if(o.type===n.SHAPES.POLY){var a=s.points;e.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)e.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(o.type===n.SHAPES.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(o.type===n.SHAPES.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(o.type===n.SHAPES.ELIP){var l=2*s.width,c=2*s.height,u=s.x-l/2,p=s.y-c/2,d=.5522848,f=l/2*d,m=c/2*d,g=u+l,v=p+c,y=u+l/2,x=p+c/2;e.moveTo(u,x),e.bezierCurveTo(u,x-m,y-f,p,y,p),e.bezierCurveTo(y+f,p,g,x-m,g,x),e.bezierCurveTo(g,x+m,y+f,v,y,v),e.bezierCurveTo(y-f,v,u,x+m,u,x),e.closePath()}else if(o.type===n.SHAPES.RREC){var _=s.x,b=s.y,w=s.width,S=s.height,T=s.radius,M=Math.min(w,S)/2|0;T=T>M?M:T,e.moveTo(_,b+T),e.lineTo(_,b+S-T),e.quadraticCurveTo(_,b+S,_+T,b+S),e.lineTo(_+w-T,b+S),e.quadraticCurveTo(_+w,b+S,_+w,b+S-T),e.lineTo(_+w,b+T),e.quadraticCurveTo(_+w,b,_+w-T,b),e.lineTo(_+T,b),e.quadraticCurveTo(_,b,_,b+T),e.closePath()}}}},r.prototype.popMask=function(t){t.context.restore()},r.prototype.destroy=function(){}},{"../../../const":40}],71:[function(t,e,i){function r(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||n.RESOLUTION,this.resize(t,e)}var n=t("../../../const");r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}}),r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},r.prototype.destroy=function(){this.context=null,this.canvas=null}},{"../../../const":40}],72:[function(t,e,i){var r=function(){if("undefined"==typeof document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",i=new Image;i.src=t+"AP804Oa6"+e;var r=new Image;r.src=t+"/wCKxvRF"+e;var n=document.createElement("canvas");n.width=6,n.height=1;var o=n.getContext("2d");o.globalCompositeOperation="multiply",o.drawImage(i,0,0),o.drawImage(r,2,0);var s=o.getImageData(2,0,1,1).data;return 255===s[0]&&0===s[1]&&0===s[2]};e.exports=r},{}],73:[function(t,e,i){function r(t){return t=t||[],o()?(t[n.BLEND_MODES.NORMAL]="source-over",t[n.BLEND_MODES.ADD]="lighter",t[n.BLEND_MODES.MULTIPLY]="multiply",t[n.BLEND_MODES.SCREEN]="screen",t[n.BLEND_MODES.OVERLAY]="overlay",t[n.BLEND_MODES.DARKEN]="darken",t[n.BLEND_MODES.LIGHTEN]="lighten",t[n.BLEND_MODES.COLOR_DODGE]="color-dodge",t[n.BLEND_MODES.COLOR_BURN]="color-burn",t[n.BLEND_MODES.HARD_LIGHT]="hard-light",t[n.BLEND_MODES.SOFT_LIGHT]="soft-light",t[n.BLEND_MODES.DIFFERENCE]="difference",t[n.BLEND_MODES.EXCLUSION]="exclusion",t[n.BLEND_MODES.HUE]="hue",t[n.BLEND_MODES.SATURATION]="saturate",t[n.BLEND_MODES.COLOR]="color",t[n.BLEND_MODES.LUMINOSITY]="luminosity"):(t[n.BLEND_MODES.NORMAL]="source-over",t[n.BLEND_MODES.ADD]="lighter",t[n.BLEND_MODES.MULTIPLY]="source-over",t[n.BLEND_MODES.SCREEN]="source-over",t[n.BLEND_MODES.OVERLAY]="source-over",t[n.BLEND_MODES.DARKEN]="source-over",t[n.BLEND_MODES.LIGHTEN]="source-over",t[n.BLEND_MODES.COLOR_DODGE]="source-over",t[n.BLEND_MODES.COLOR_BURN]="source-over",t[n.BLEND_MODES.HARD_LIGHT]="source-over",t[n.BLEND_MODES.SOFT_LIGHT]="source-over",t[n.BLEND_MODES.DIFFERENCE]="source-over",t[n.BLEND_MODES.EXCLUSION]="source-over",t[n.BLEND_MODES.HUE]="source-over",t[n.BLEND_MODES.SATURATION]="source-over",t[n.BLEND_MODES.COLOR]="source-over",t[n.BLEND_MODES.LUMINOSITY]="source-over"),t}var n=t("../../../const"),o=t("./canUseNewCanvasBlendModes");e.exports=r},{"../../../const":40,"./canUseNewCanvasBlendModes":72}],74:[function(t,e,i){function r(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=3600,this.checkCountMax=600,this.mode=n.GC_MODES.DEFAULT}var n=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.update=function(){this.count++,this.mode!==n.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},r.prototype.run=function(){var t,e,i=this.renderer.textureManager,r=i._managedTextures,n=!1;for(t=0;t<r.length;t++){var o=r[t];!o._glRenderTargets&&this.count-o.touched>this.maxIdle&&(i.destroyTexture(o,!0),r[t]=null,n=!0)}if(n){for(e=0,t=0;t<r.length;t++)null!==r[t]&&(r[e++]=r[t]);r.length=e}},r.prototype.unload=function(t){var e=this.renderer.textureManager;t._texture&&e.destroyTexture(t._texture,!0);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])}},{"../../const":40}],75:[function(t,e,i){var r=t("pixi-gl-core").GLTexture,n=t("../../const"),o=t("./utils/RenderTarget"),s=t("../../utils"),a=function(t){this.renderer=t,this.gl=t.gl,this._managedTextures=[]};a.prototype.bindTexture=function(){},a.prototype.getTexture=function(){},a.prototype.updateTexture=function(t){t=t.baseTexture||t;var e=!!t._glRenderTargets;if(t.hasLoaded){var i=t._glTextures[this.renderer.CONTEXT_UID];if(i)e?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):i.upload(t.source);else{if(e){var s=new o(this.gl,t.width,t.height,t.scaleMode,t.resolution);s.resize(t.width,t.height),t._glRenderTargets[this.renderer.CONTEXT_UID]=s,i=s.texture}else i=new r(this.gl),i.premultiplyAlpha=!0,i.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=i,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&i.enableMipmap(),t.wrapMode===n.WRAP_MODES.CLAMP?i.enableWrapClamp():t.wrapMode===n.WRAP_MODES.REPEAT?i.enableWrapRepeat():i.enableWrapMirrorRepeat()):i.enableWrapClamp(),t.scaleMode===n.SCALE_MODES.NEAREST?i.enableNearestScaling():i.enableLinearScaling()}return i}},a.prototype.destroyTexture=function(t,e){if(t=t.baseTexture||t,t.hasLoaded&&t._glTextures[this.renderer.CONTEXT_UID]&&(t._glTextures[this.renderer.CONTEXT_UID].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.renderer.CONTEXT_UID],!e)){var i=this._managedTextures.indexOf(t);-1!==i&&s.removeItems(this._managedTextures,i,1)}},a.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},a.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),
e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},e.exports=a},{"../../const":40,"../../utils":110,"./utils/RenderTarget":88,"pixi-gl-core":1}],76:[function(t,e,i){function r(t,e,i){i=i||{},n.call(this,"WebGL",t,e,i),this.type=v.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._contextOptions={alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer},this._backgroundColorRgba[3]=this.transparent?0:1,this.maskManager=new o(this),this.stencilManager=new s(this),this.emptyRenderer=new l(this),this.currentRenderer=this.emptyRenderer,this.initPlugins(),this.gl=i.context||d(this.view,this._contextOptions),this.CONTEXT_UID=y++,this.state=new p(this.gl),this.renderingToScreen=!0,this._initContext(),this.filterManager=new a(this),this.drawModes=f(this.gl),this._activeShader=null,this._activeRenderTarget=null,this._activeTextureLocation=999,this._activeTexture=null,this.setBlendMode(0)}var n=t("../SystemRenderer"),o=t("./managers/MaskManager"),s=t("./managers/StencilManager"),a=t("./managers/FilterManager"),h=t("./utils/RenderTarget"),l=t("./utils/ObjectRenderer"),c=t("./TextureManager"),u=t("./TextureGarbageCollector"),p=t("./WebGLState"),d=t("pixi-gl-core").createContext,f=t("./utils/mapWebGLDrawModesToPixi"),m=t("../../utils"),g=t("pixi-gl-core"),v=t("../../const"),y=0;r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,m.pluginTarget.mixin(r),r.prototype._initContext=function(){var t=this.gl;this.textureManager=new c(this),this.textureGC=new u(this),this.state.resetToDefault(),this.rootRenderTarget=new h(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget),this.emit("context",t),this.resize(this.width,this.height)},r.prototype.render=function(t,e,i,r,n){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(e||(this._lastObjectRendered=t),!n){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.bindRenderTexture(e,r),this.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},r.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},r.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.resize=function(t,e){n.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},r.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},r.prototype.clear=function(t){this._activeRenderTarget.clear(t)},r.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},r.prototype.bindRenderTexture=function(t,e){var i;if(t){var r=t.baseTexture,n=this.gl;r._glRenderTargets[this.CONTEXT_UID]?(this._activeTextureLocation=r._id,n.activeTexture(n.TEXTURE0+r._id),n.bindTexture(n.TEXTURE_2D,null)):(this.textureManager.updateTexture(r),n.bindTexture(n.TEXTURE_2D,null)),i=r._glRenderTargets[this.CONTEXT_UID],i.setFrame(t.frame)}else i=this.rootRenderTarget;return i.transform=e,this.bindRenderTarget(i),this},r.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&(this._activeRenderTarget=t,t.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},r.prototype.bindShader=function(t){return this._activeShader!==t&&(this._activeShader=t,t.bind(),t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0)),this},r.prototype.bindTexture=function(t,e){t=t.baseTexture||t;var i=this.gl;return e=e||0,this._activeTextureLocation!==e&&(this._activeTextureLocation=e,i.activeTexture(i.TEXTURE0+e)),this._activeTexture=t,t._glTextures[this.CONTEXT_UID]?(t.touched=this.textureGC.count,t._glTextures[this.CONTEXT_UID].bind()):this.textureManager.updateTexture(t),this},r.prototype.createVao=function(){return new g.VertexArrayObject(this.gl,this.state.attribState)},r.prototype.reset=function(){return this.setObjectRenderer(this.emptyRenderer),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this._activeTextureLocation=999,this._activeTexture=null,this.rootRenderTarget.activate(),this.state.resetToDefault(),this},r.prototype.handleContextLost=function(t){t.preventDefault()},r.prototype.handleContextRestored=function(){this._initContext(),this.textureManager.removeAll()},r.prototype.destroy=function(t){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),n.prototype.destroy.call(this,t),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null}},{"../../const":40,"../../utils":110,"../SystemRenderer":68,"./TextureGarbageCollector":74,"./TextureManager":75,"./WebGLState":77,"./managers/FilterManager":82,"./managers/MaskManager":83,"./managers/StencilManager":84,"./utils/ObjectRenderer":86,"./utils/RenderTarget":88,"./utils/mapWebGLDrawModesToPixi":91,"pixi-gl-core":1}],77:[function(t,e,i){var r=t("./utils/mapWebGLBlendModesToPixi"),n=function(t){this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=t,this.maxAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=r(t),this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")};n.prototype.push=function(){var t=this.state[++this.stackIndex];t||(t=this.state[this.stackIndex]=new Uint8Array(16));for(var e=0;e<this.activeState.length;e++)this.activeState[e]=t[e]};var o=0,s=1,a=2,h=3,l=4;n.prototype.pop=function(){var t=this.state[--this.stackIndex];this.setState(t)},n.prototype.setState=function(t){this.setBlend(t[o]),this.setDepthTest(t[s]),this.setFrontFace(t[a]),this.setCullFace(t[h]),this.setBlendMode(t[l])},n.prototype.setBlend=function(t){if(!(this.activeState[o]===t|0)){this.activeState[o]=0|t;var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND)}},n.prototype.setBlendMode=function(t){t!==this.activeState[l]&&(this.activeState[l]=t,this.gl.blendFunc(this.blendModes[t][0],this.blendModes[t][1]))},n.prototype.setDepthTest=function(t){if(!(this.activeState[s]===t|0)){this.activeState[s]=0|t;var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)}},n.prototype.setCullFace=function(t){if(!(this.activeState[h]===t|0)){this.activeState[h]=0|t;var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)}},n.prototype.setFrontFace=function(t){if(!(this.activeState[a]===t|0)){this.activeState[a]=0|t;var e=this.gl;t?e.frontFace(e.CW):e.frontFace(e.CCW)}},n.prototype.resetAttributes=function(){var t;for(t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(t=0;t<this.attribState.attribState.length;t++)this.attribState.attribState[t]=0;var e=this.gl;for(t=1;t<this.maxAttribs;t++)e.disableVertexAttribArray(t)},n.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;t++)this.activeState[t]=2;var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},e.exports=n},{"./utils/mapWebGLBlendModesToPixi":90}],78:[function(t,e,i){function r(t,e,i){this.vertexSrc=t||r.defaultVertexSrc,this.fragmentSrc=e||r.defaultFragmentSrc,this.blendMode=s.BLEND_MODES.NORMAL,this.uniformData=i||n(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={};for(var h in this.uniformData)this.uniforms[h]=this.uniformData[h].value;this.glShaders=[],a[this.vertexSrc+this.fragmentSrc]||(a[this.vertexSrc+this.fragmentSrc]=o.uid()),this.glShaderKey=a[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=1}var n=t("./extractUniformsFromSrc"),o=t("../../../utils"),s=t("../../../const"),a={};e.exports=r,r.prototype.apply=function(t,e,i,r){t.applyFilter(this,e,i,r)},r.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n"),r.defaultFragmentSrc=["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")},{"../../../const":40,"../../../utils":110,"./extractUniformsFromSrc":79}],79:[function(t,e,i){function r(t,e,i){var r=n(t,i),o=n(e,i);return Object.assign(r,o)}function n(t){for(var e,i=new RegExp("^(projectionMatrix|uSampler|filterArea)$"),r={},n=t.replace(/\s+/g," ").split(/\s*;\s*/),a=0;a<n.length;a++){var h=n[a].trim();if(h.indexOf("uniform")>-1){var l=h.split(" "),c=l[1],u=l[2],p=s(c);u.indexOf("[")>-1&&(e=u.split(/\[|\]/),u=e[0],p*=Number(e[1])),u.match(i)||(r[u]={value:o(c,p),name:u,type:c})}}return r}var o=t("pixi-gl-core/lib/shader/defaultValue"),s=t("pixi-gl-core/lib/shader/mapSize");e.exports=r},{"pixi-gl-core/lib/shader/defaultValue":10,"pixi-gl-core/lib/shader/mapSize":14}],80:[function(t,e,i){var r=t("../../../math"),n=function(t,e,i){var r=t.identity();return r.translate(e.x/i.width,e.y/i.height),r.scale(i.width,i.height),r},o=function(t,e,i){var r=t.identity();r.translate(e.x/i.width,e.y/i.height);var n=i.width/e.width,o=i.height/e.height;return r.scale(n,o),r},s=function(t,e,i,n){var o=n.worldTransform.copy(r.Matrix.TEMP_MATRIX),s=n._texture.baseTexture,a=t.identity(),h=i.height/i.width;a.translate(e.x/i.width,e.y/i.height),a.scale(1,h);var l=i.width/s.width,c=i.height/s.height;return o.tx/=s.width*l,o.ty/=s.width*l,o.invert(),a.prepend(o),a.scale(1,1/h),a.scale(l,c),a.translate(n.anchor.x,n.anchor.y),a};e.exports={calculateScreenSpaceMatrix:n,calculateNormalizedScreenSpaceMatrix:o,calculateSpriteMatrix:s}},{"../../../math":62}],81:[function(t,e,i){function r(t){var e=new o.Matrix;n.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","#define GLSLIFY 1\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n"),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}var n=t("../Filter"),o=t("../../../../math");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i){var r=this.maskSprite;this.uniforms.mask=r._texture,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r),this.uniforms.alpha=r.worldAlpha,t.applyFilter(this,e,i)}},{"../../../../math":62,"../Filter":78}],82:[function(t,e,i){function r(t){n.call(this,t),this.gl=this.renderer.gl,this.quad=new s(this.gl,t.state.attribState),this.shaderCache={},this.pool={}}var n=t("./WebGLManager"),o=t("../utils/RenderTarget"),s=t("../utils/Quad"),a=t("../../../math"),h=t("../../../Shader"),l=t("../filters/filterTransforms"),c=t("bit-twiddle"),u=function(){this.renderTarget=null,this.sourceFrame=new a.Rectangle,this.destinationFrame=new a.Rectangle,this.filters=[],this.target=null,this.resolution=1};r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.pushFilter=function(t,e){var i=this.renderer,r=this.filterData;if(!r){r=this.renderer._activeRenderTarget.filterStack;var n=new u;n.sourceFrame=n.destinationFrame=this.renderer._activeRenderTarget.size,n.renderTarget=i._activeRenderTarget,this.renderer._activeRenderTarget.filterData=r={index:0,stack:[n]},this.filterData=r}var o=r.stack[++r.index];o||(o=r.stack[r.index]=new u);var s=e[0].resolution,a=e[0].padding,h=t.filterArea||t.getBounds(),l=o.sourceFrame,c=o.destinationFrame;l.x=((h.x-a)*s|0)/s,l.y=((h.y-a)*s|0)/s,l.width=((h.width+2*a)*s|0)/s,l.height=((h.height+2*a)*s|0)/s,l.fit(r.stack[0].destinationFrame),c.width=l.width,c.height=l.height;var p=this.getPotRenderTarget(i.gl,l.width,l.height,s);o.target=t,o.filters=e,o.resolution=s,o.renderTarget=p,p.setFrame(c,l),i.bindRenderTarget(p),i.clear()},r.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],i=t.stack[t.index];this.quad.map(i.renderTarget.size,i.sourceFrame).upload();var r=i.filters;if(1===r.length)r[0].apply(this,i.renderTarget,e.renderTarget,!1),this.freePotRenderTarget(i.renderTarget);else{var n=i.renderTarget,o=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,1);o.setFrame(i.destinationFrame,i.sourceFrame);for(var s=0;s<r.length-1;s++){r[s].apply(this,n,o,!0);var a=n;n=o,o=a}r[s].apply(this,n,e.renderTarget,!1),this.freePotRenderTarget(n),this.freePotRenderTarget(o)}t.index--,0===t.index&&(this.filterData=null)},r.prototype.applyFilter=function(t,e,i,r){var n=this.renderer,o=t.glShaders[n.CONTEXT_UID];if(o||(t.glShaderKey?(o=this.shaderCache[t.glShaderKey],o||(o=t.glShaders[n.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=new h(this.gl,t.vertexSrc,t.fragmentSrc))):o=t.glShaders[n.CONTEXT_UID]=new h(this.gl,t.vertexSrc,t.fragmentSrc),this.quad.initVao(o)),n.bindRenderTarget(i),r){var s=n.gl;s.disable(s.SCISSOR_TEST),n.clear(),s.enable(s.SCISSOR_TEST)}i===n.maskManager.scissorRenderTarget&&n.maskManager.pushScissorMask(null,n.maskManager.scissorData),n.bindShader(o),this.syncUniforms(o,t),e.texture.bind(0),n.state.setBlendMode(t.blendMode),this.quad.draw()},r.prototype.syncUniforms=function(t,e){var i,r=e.uniformData,n=e.uniforms,o=1;if(t.uniforms.data.filterArea){i=this.filterData.stack[this.filterData.index];var s=t.uniforms.filterArea;s[0]=i.renderTarget.size.width,s[1]=i.renderTarget.size.height,s[2]=i.sourceFrame.x,s[3]=i.sourceFrame.y,t.uniforms.filterArea=s}if(t.uniforms.data.filterClamp){i=this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=.5/i.renderTarget.size.width,a[1]=.5/i.renderTarget.size.height,a[2]=(i.sourceFrame.width-.5)/i.renderTarget.size.width,a[3]=(i.sourceFrame.height-.5)/i.renderTarget.size.height,t.uniforms.filterClamp=a}var h;for(var l in r)"sampler2D"===r[l].type?(t.uniforms[l]=o,this.renderer.bindTexture(n[l].baseTexture,o),o++):"mat3"===r[l].type?void 0!==n[l].a?t.uniforms[l]=n[l].toArray(!0):t.uniforms[l]=n[l]:"vec2"===r[l].type?void 0!==n[l].x?(h=t.uniforms[l],h[0]=n[l].x,h[1]=n[l].y,t.uniforms[l]=h):t.uniforms[l]=n[l]:"float"===r[l].type?t.uniforms.data[l].value!==r[l]&&(t.uniforms[l]=n[l]):t.uniforms[l]=n[l]},r.prototype.getRenderTarget=function(){var t=this.filterData.stack[this.filterData.index],e=this.getPotRenderTarget(this.renderer.gl,t.sourceFrame.width,t.sourceFrame.height,t.resolution);return e.setFrame(t.destinationFrame,t.sourceFrame),e},r.prototype.returnRenderTarget=function(t){return this.freePotRenderTarget(t)},r.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return l.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},r.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return l.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},r.prototype.calculateSpriteMatrix=function(t,e){var i=this.filterData.stack[this.filterData.index];return l.calculateSpriteMatrix(t,i.sourceFrame,i.renderTarget.size,e)},r.prototype.destroy=function(){this.shaderCache=[],this.emptyPool()},r.prototype.getPotRenderTarget=function(t,e,i,r){e=c.nextPow2(e*r),i=c.nextPow2(i*r);var n=(65535&e)<<16|65535&i;this.pool[n]||(this.pool[n]=[]);var s=this.pool[n].pop()||new o(t,e,i,null,1);return s.resolution=r,s.defaultFrame.width=s.size.width=e/r,s.defaultFrame.height=s.size.height=i/r,s},r.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.pool={}},r.prototype.freePotRenderTarget=function(t){var e=t.size.width*t.resolution,i=t.size.height*t.resolution,r=(65535&e)<<16|65535&i;this.pool[r].push(t)}},{"../../../Shader":39,"../../../math":62,"../filters/filterTransforms":80,"../utils/Quad":87,"../utils/RenderTarget":88,"./WebGLManager":85,"bit-twiddle":17}],83:[function(t,e,i){function r(t){n.call(this,t),this.scissor=!1,this.scissorData=null,this.scissorRenderTarget=null,this.enableScissor=!0,this.alphaMaskPool=[],this.alphaMaskIndex=0}var n=t("./WebGLManager"),o=t("../filters/spriteMask/SpriteMaskFilter");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(!this.enableScissor||this.scissor||this.renderer.stencilManager.stencilMaskStack.length||1!==e.graphicsData[0].shape.type)this.pushStencilMask(e);else{var i=e.worldTransform,r=Math.atan2(i.b,i.a);r=Math.round(r*(180/Math.PI)),r%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}},r.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},r.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new o(e)]),i[0].maskSprite=e,t.filterArea=e.getBounds(),this.renderer.filterManager.pushFilter(t,i),this.alphaMaskIndex++},r.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},r.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},r.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},r.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,r=e.getBounds();r.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var n=this.renderer.resolution;this.renderer.gl.scissor(r.x*n,(i.root?i.size.height-r.y-r.height:r.y)*n,r.width*n,r.height*n),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},r.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)}},{"../filters/spriteMask/SpriteMaskFilter":81,"./WebGLManager":85}],84:[function(t,e,i){function r(t){n.call(this,t),this.stencilMaskStack=null}var n=t("./WebGLManager");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},r.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,i=this.stencilMaskStack;0===i.length&&(e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.stencilFunc(e.ALWAYS,1,1)),i.push(t),e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,i.length),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},r.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,e=this.stencilMaskStack,i=e.pop();0===e.length?t.disable(t.STENCIL_TEST):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(i),t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.NOTEQUAL,0,e.length),t.stencilOp(t.KEEP,t.KEEP,t.KEEP))},r.prototype.destroy=function(){n.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null}},{"./WebGLManager":85}],85:[function(t,e,i){function r(t){this.renderer=t,this.renderer.on("context",this.onContextChange,this)}r.prototype.constructor=r,e.exports=r,r.prototype.onContextChange=function(){},r.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null}},{}],86:[function(t,e,i){function r(t){n.call(this,t)}var n=t("../managers/WebGLManager");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.start=function(){},r.prototype.stop=function(){this.flush()},r.prototype.flush=function(){},r.prototype.render=function(t){}},{"../managers/WebGLManager":85}],87:[function(t,e,i){function r(t,e){this.gl=t,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var i=0;4>i;i++)this.interleaved[4*i]=this.vertices[2*i],this.interleaved[4*i+1]=this.vertices[2*i+1],this.interleaved[4*i+2]=this.uvs[2*i],this.interleaved[4*i+3]=this.uvs[2*i+1];this.indices=o(1),this.vertexBuffer=n.GLBuffer.createVertexBuffer(t,this.interleaved,t.STATIC_DRAW),this.indexBuffer=n.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.vao=new n.VertexArrayObject(t,e)}var n=t("pixi-gl-core"),o=t("../../../utils/createIndicesForQuads");r.prototype.constructor=r,r.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},r.prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this},r.prototype.draw=function(){return this.vao.bind().draw(this.gl.TRIANGLES,6,0).unbind(),this},r.prototype.upload=function(){for(var t=0;4>t;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},r.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},e.exports=r},{"../../../utils/createIndicesForQuads":108,"pixi-gl-core":1}],88:[function(t,e,i){var r=t("../../../math"),n=t("../../../const"),o=t("pixi-gl-core").GLFramebuffer,s=function(t,e,i,s,a,h){this.gl=t,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new r.Rectangle(0,0,1,1),this.resolution=a||n.RESOLUTION,this.projectionMatrix=new r.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new r.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=s||n.SCALE_MODES.DEFAULT,this.root=h,this.root?(this.frameBuffer=new o(t,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=o.createRGBA(t,100,100),this.scaleMode===n.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(e,i)};s.prototype.constructor=s,e.exports=s,s.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},s.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},s.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t},s.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},s.prototype.calculateProjection=function(t,e){var i=this.projectionMatrix;e=e||t,i.identity(),this.root?(i.a=1/t.width*2,i.d=-1/t.height*2,i.tx=-1-e.x*i.a,i.ty=1-e.y*i.d):(i.a=1/t.width*2,i.d=1/t.height*2,i.tx=-1-e.x*i.a,i.ty=-1-e.y*i.d)},s.prototype.resize=function(t,e){if(t=0|t,e=0|e,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution);var i=this.frame||this.size;this.calculateProjection(i)}},s.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null}},{"../../../const":40,"../../../math":62,"pixi-gl-core":1}],89:[function(t,e,i){function r(t){for(var e="",i=0;t>i;i++)i>0&&(e+="\nelse "),t-1>i&&(e+="if(test == "+i+".0){}");return e}var n=t("pixi-gl-core"),o=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n"),s=function(t,e){var i=!e;if(i){var s=document.createElement("canvas");s.width=1,s.height=1,e=n.createContext(s)}for(var a=e.createShader(e.FRAGMENT_SHADER);;){var h=o.replace(/%forloop%/gi,r(t));if(e.shaderSource(a,h),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS))break;t=t/2|0}return i&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),t};e.exports=s},{"pixi-gl-core":1}],90:[function(t,e,i){function r(t,e){return e=e||[],e[n.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[n.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e}var n=t("../../../const");e.exports=r},{"../../../const":40}],91:[function(t,e,i){function r(t,e){e=e||{},e[n.DRAW_MODES.POINTS]=t.POINTS,e[n.DRAW_MODES.LINES]=t.LINES,e[n.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[n.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[n.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[n.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[n.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN}var n=t("../../../const");e.exports=r},{"../../../const":40}],92:[function(t,e,i){function r(t){s.call(this),this.anchor=new n.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=h.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t||o.EMPTY,this.textureDirty=!0,this.vertexData=new Float32Array(8)}var n=t("../math"),o=t("../textures/Texture"),s=t("../display/Container"),a=t("../utils"),h=t("../const"),l=new n.Point;r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return Math.abs(this.scale.x)*(this.texture.trim||this.texture.orig).width},set:function(t){var e=a.sign(this.scale.x)||1;this.scale.x=e*t/(this.texture.trim||this.texture.orig).width,this._width=t}},height:{get:function(){return Math.abs(this.scale.y)*(this.texture.trim||this.texture.orig).height},set:function(t){var e=a.sign(this.scale.y)||1;this.scale.y=e*t/(this.texture.trim||this.texture.orig).height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,this.textureDirty=!0,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),r.prototype._onTextureUpdate=function(){this.textureDirty=!0,this._width&&(this.scale.x=a.sign(this.scale.x)*this._width/(this.texture.trim||this.texture.orig).width),this._height&&(this.scale.y=a.sign(this.scale.y)*this._height/(this.texture.trim||this.texture.orig).height)},r.prototype.calculateVertices=function(){var t,e,i,r,n=this._texture,o=this.transform.worldTransform,s=o.a,a=o.b,h=o.c,l=o.d,c=o.tx,u=o.ty,p=this.vertexData,d=n.trim,f=n.orig;d?(e=d.x-this.anchor.x*f.width,t=e+d.width,r=d.y-this.anchor.y*f.height,i=r+d.height):(t=f.width*(1-this.anchor.x),e=f.width*-this.anchor.x,i=f.height*(1-this.anchor.y),r=f.height*-this.anchor.y),p[0]=s*e+h*r+c,p[1]=l*r+a*e+u,p[2]=s*t+h*r+c,p[3]=l*r+a*t+u,p[4]=s*t+h*i+c,p[5]=l*i+a*t+u,p[6]=s*e+h*i+c,p[7]=l*i+a*e+u},r.prototype._renderWebGL=function(t){(this.transform.updated||this.textureDirty)&&(this.textureDirty=!1,this.calculateVertices()),t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},r.prototype._renderCanvas=function(t){t.plugins.sprite.render(this)},r.prototype.getBounds=function(){if(!this._currentBounds){this.vertexDirty=!1,this.calculateVertices();var t,e,i,r,n,o,s,a,h=this.vertexData,l=h[0],c=h[1],u=h[2],p=h[3],d=h[4],f=h[5],m=h[6],g=h[7];if(t=l,t=t>u?u:t,t=t>d?d:t,t=t>m?m:t,i=c,i=i>p?p:i,i=i>f?f:i,i=i>g?g:i,e=l,e=u>e?u:e,e=d>e?d:e,e=m>e?m:e,r=c,r=p>r?p:r,r=f>r?f:r,r=g>r?g:r,this.children.length){var v=this.containerGetBounds();n=v.x,o=v.x+v.width,s=v.y,a=v.y+v.height,t=n>t?t:n,i=s>i?i:s,e=e>o?e:o,r=r>a?r:a}var y=this._bounds;
y.x=t,y.width=e-t,y.y=i,y.height=r-i,this._currentBounds=y}return this._currentBounds},r.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture.orig.width*this.anchor.x,this._bounds.y=-this._texture.orig.height*this.anchor.y,this._bounds.width=this._texture.orig.width,this._bounds.height=this._texture.orig.height,this._bounds},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,l);var e,i=this._texture.orig.width,r=this._texture.orig.height,n=-i*this.anchor.x;return l.x>n&&l.x<n+i&&(e=-r*this.anchor.y,l.y>e&&l.y<e+r)},r.prototype.destroy=function(t,e){s.prototype.destroy.call(this),this.anchor=null,t&&this._texture.destroy(e),this._texture=null,this.shader=null},r.from=function(t){return new r(o.from(t))},r.fromFrame=function(t){var e=a.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new r(e)},r.fromImage=function(t,e,i){return new r(o.fromImage(t,e,i))}},{"../const":40,"../display/Container":41,"../math":62,"../textures/Texture":103,"../utils":110}],93:[function(t,e,i){function r(t){this.renderer=t}var n=t("../../renderers/canvas/CanvasRenderer"),o=t("../../const"),s=t("../../math"),a=new s.Matrix,h=t("./CanvasTinter");r.prototype.constructor=r,e.exports=r,n.registerPlugin("sprite",r),r.prototype.render=function(t){var e,i,r=t._texture,n=this.renderer,l=t.transform.worldTransform,c=r._frame.width,u=r._frame.height;if(!(r.orig.width<=0||r.orig.height<=0)&&r.baseTexture.source&&(n.setBlendMode(t.blendMode),r.valid)){n.context.globalAlpha=t.worldAlpha;var p=r.baseTexture.scaleMode===o.SCALE_MODES.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==p&&(n.context[n.smoothProperty]=p),r.trim?(e=r.trim.width/2+r.trim.x-t.anchor.x*r.orig.width,i=r.trim.height/2+r.trim.y-t.anchor.y*r.orig.height):(e=(.5-t.anchor.x)*r.orig.width,i=(.5-t.anchor.y)*r.orig.height),r.rotate&&(l.copy(a),l=a,s.GroupD8.matrixAppendRotationInv(l,r.rotate,e,i),e=0,i=0),e-=c/2,i-=u/2,n.roundPixels?(n.context.setTransform(l.a,l.b,l.c,l.d,l.tx*n.resolution|0,l.ty*n.resolution|0),e=0|e,i=0|i):n.context.setTransform(l.a,l.b,l.c,l.d,l.tx*n.resolution,l.ty*n.resolution);var d=r.baseTexture.resolution;16777215!==t.tint?(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=h.getTintedTexture(t,t.tint)),n.context.drawImage(t.tintedTexture,0,0,c*d,u*d,e*n.resolution,i*n.resolution,c*n.resolution,u*n.resolution)):n.context.drawImage(r.baseTexture.source,r._frame.x*d,r._frame.y*d,c*d,u*d,e*n.resolution,i*n.resolution,c*n.resolution,u*n.resolution)}},r.prototype.destroy=function(){this.renderer=null}},{"../../const":40,"../../math":62,"../../renderers/canvas/CanvasRenderer":69,"./CanvasTinter":94}],94:[function(t,e,i){var r=t("../../utils"),n=t("../../renderers/canvas/utils/canUseNewCanvasBlendModes"),o={};e.exports=o,o.getTintedTexture=function(t,e){var i=t.texture;e=o.roundColor(e);var r="#"+("00000"+(0|e).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[r])return i.tintCache[r];var n=o.canvas||document.createElement("canvas");if(o.tintMethod(i,e,n),o.convertTintToImage){var s=new Image;s.src=n.toDataURL(),i.tintCache[r]=s}else i.tintCache[r]=n,o.canvas=null;return n},o.tintWithMultiply=function(t,e,i){var r=i.getContext("2d"),n=t._frame;i.width=n.width,i.height=n.height,r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,n.width,n.height),r.globalCompositeOperation="multiply",r.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height)},o.tintWithOverlay=function(t,e,i){var r=i.getContext("2d"),n=t._frame;i.width=n.width,i.height=n.height,r.globalCompositeOperation="copy",r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,n.width,n.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height)},o.tintWithPerPixel=function(t,e,i){var n=i.getContext("2d"),o=t._frame;i.width=o.width,i.height=o.height,n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height);for(var s=r.hex2rgb(e),a=s[0],h=s[1],l=s[2],c=n.getImageData(0,0,o.width,o.height),u=c.data,p=0;p<u.length;p+=4)u[p+0]*=a,u[p+1]*=h,u[p+2]*=l;n.putImageData(c,0,0)},o.roundColor=function(t){var e=o.cacheStepsPerColorChannel,i=r.hex2rgb(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),r.rgb2hex(i)},o.cacheStepsPerColorChannel=8,o.convertTintToImage=!1,o.canUseMultiply=n(),o.tintMethod=o.canUseMultiply?o.tintWithMultiply:o.tintWithPerPixel},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":72,"../../utils":110}],95:[function(t,e,i){var r=function(t){this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)};e.exports=r,r.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null}},{}],96:[function(t,e,i){function r(t){n.call(this,t),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=c.SPRITE_BATCH_SIZE,this.buffers=[];for(var e=1;e<=p.nextPow2(this.size);e*=2){var i=4*e*this.vertByteSize;this.buffers.push(new l(i))}this.indices=s(this.size),this.shaders=null,this.textureCount=0,this.currentIndex=0,this.tick=0,this.groups=[];for(var r=0;r<this.size;r++)this.groups[r]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};this.sprites=[],this.vertexBuffers=[],this.vaos=[],this.vaoMax=2,this.vertexCount=0,this.renderer.on("prerender",this.onPrerender,this)}var n=t("../../renderers/webgl/utils/ObjectRenderer"),o=t("../../renderers/webgl/WebGLRenderer"),s=t("../../utils/createIndicesForQuads"),a=t("./generateMultiTextureShader"),h=t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),l=t("./BatchBuffer"),c=t("../../const"),u=t("pixi-gl-core"),p=t("bit-twiddle");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,o.registerPlugin("sprite",r),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),c.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=h(this.MAX_TEXTURES,t),this.shaders=new Array(this.MAX_TEXTURES),this.shaders[0]=a(t,1),this.shaders[1]=a(t,2),this.indexBuffer=u.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW);for(var e=this.shaders[1],i=0;i<this.vaoMax;i++)this.vertexBuffers[i]=u.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),this.vaos[i]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[i],e.attributes.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[i],e.attributes.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[i],e.attributes.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12).addAttribute(this.vertexBuffers[i],e.attributes.aTextureId,t.FLOAT,!1,this.vertByteSize,16);this.vao=this.vaos[0],this.currentBlendMode=99999},r.prototype.onPrerender=function(){this.vertexCount=0},r.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t.texture._uvs&&(this.sprites[this.currentIndex++]=t)},r.prototype.flush=function(){if(0!==this.currentIndex){var t,e,i,r,n,o,s,h=this.renderer.gl,l=p.nextPow2(this.currentIndex),c=p.log2(l),d=this.buffers[c],f=this.sprites,m=this.groups,g=d.float32View,v=d.uint32View,y=0,x=1,_=0,b=m[0],w=f[0].blendMode;b.textureCount=0,b.start=0,b.blend=w,this.tick++;for(var S=0;S<this.currentIndex;S++){var T=f[S];t=T._texture.baseTexture,w!==T.blendMode&&(w=T.blendMode,e=null,_=this.MAX_TEXTURES,this.tick++),e!==t&&(e=t,t._enabled!==this.tick&&(_===this.MAX_TEXTURES&&(this.tick++,_=0,b.size=S-b.start,b=m[x++],b.textureCount=0,b.blend=w,b.start=S),t._enabled=this.tick,t._id=_,b.textures[b.textureCount++]=t,_++)),i=T.vertexData,r=(T.tint>>16)+(65280&T.tint)+((255&T.tint)<<16)+(255*T.worldAlpha<<24),n=T._texture._uvs.uvsUint32,o=t._id,g[y++]=i[0],g[y++]=i[1],v[y++]=n[0],v[y++]=r,g[y++]=o,g[y++]=i[2],g[y++]=i[3],v[y++]=n[1],v[y++]=r,g[y++]=o,g[y++]=i[4],g[y++]=i[5],v[y++]=n[2],v[y++]=r,g[y++]=o,g[y++]=i[6],g[y++]=i[7],v[y++]=n[3],v[y++]=r,g[y++]=o}for(b.size=S-b.start,this.vertexCount++,this.vaoMax<=this.vertexCount&&(this.vaoMax++,s=this.shaders[1],this.vertexBuffers[this.vertexCount]=u.GLBuffer.createVertexBuffer(h,null,h.STREAM_DRAW),this.vaos[this.vertexCount]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[this.vertexCount],s.attributes.aVertexPosition,h.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[this.vertexCount],s.attributes.aTextureCoord,h.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[this.vertexCount],s.attributes.aColor,h.UNSIGNED_BYTE,!0,this.vertByteSize,12).addAttribute(this.vertexBuffers[this.vertexCount],s.attributes.aTextureId,h.FLOAT,!1,this.vertByteSize,16)),this.vertexBuffers[this.vertexCount].upload(d.vertices,0),this.vao=this.vaos[this.vertexCount].bind(),S=0;x>S;S++){var M=m[S],E=M.textureCount;s=this.shaders[E-1],s||(s=this.shaders[E-1]=a(h,E)),this.renderer.bindShader(s);for(var C=0;E>C;C++)this.renderer.bindTexture(M.textures[C],C);this.renderer.state.setBlendMode(M.blend),h.drawElements(h.TRIANGLES,6*M.size,h.UNSIGNED_SHORT,6*M.start*2)}this.currentIndex=0}},r.prototype.start=function(){this.tick%=1e3},r.prototype.stop=function(){this.flush(),this.vao.unbind()},r.prototype.destroy=function(){for(var t=0;t<this.vertexCount;t++)this.vertexBuffers[t].destroy(),this.vaos[t].destroy();for(this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),n.prototype.destroy.call(this),t=0;t<this.shaders.length;t++)this.shaders[t]&&this.shaders[t].destroy();for(this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null,t=0;t<this.buffers.length;t++)this.buffers[t].destroy()}},{"../../const":40,"../../renderers/webgl/WebGLRenderer":76,"../../renderers/webgl/utils/ObjectRenderer":86,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":89,"../../utils/createIndicesForQuads":108,"./BatchBuffer":95,"./generateMultiTextureShader":97,"bit-twiddle":17,"pixi-gl-core":1}],97:[function(t,e,i){function r(t,e){var i="#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vTextureId = aTextureId;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n",r=s;r=r.replace(/%count%/gi,e),r=r.replace(/%forloop%/gi,n(e));for(var a=new o(t,i,r),h=[],l=0;e>l;l++)h[l]=l;return a.bind(),a.uniforms.uSamplers=h,a}function n(t){var e="";e+="\n",e+="\n";for(var i=0;t>i;i++)i>0&&(e+="\nelse "),t-1>i&&(e+="if(vTextureId == "+i+".0)"),e+="\n{",e+="\n	color = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}var o=t("../../Shader"),s=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join("\n");e.exports=r},{"../../Shader":39}],98:[function(t,e,i){function r(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||a.RESOLUTION,this._text=null,this._style=null,this._styleListener=null,this._font="";var r=o.fromCanvas(this.canvas);r.trim=new s.Rectangle,n.call(this,r),this.text=t,this.style=e}var n=t("../sprites/Sprite"),o=t("../textures/Texture"),s=t("../math"),a=t("../const"),h=t("./TextStyle");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.fontPropertiesCache={},r.fontPropertiesCanvas=document.createElement("canvas"),r.fontPropertiesContext=r.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(r.prototype,{width:{get:function(){return this.updateText(!0),this.scale.x*this._texture._frame.width},set:function(t){this.updateText(!0),this.scale.x=t/this._texture._frame.width,this._width=t}},height:{get:function(){return this.updateText(!0),this.scale.y*this._texture._frame.height},set:function(t){this.updateText(!0),this.scale.y=t/this._texture._frame.height,this._height=t}},style:{get:function(){return this._style},set:function(t){this._style&&this._style.off(a.TEXT_STYLE_CHANGED,this._onStyleChange,this),t=t||{},t instanceof h?this._style=t:this._style=new h(t),this._style.on(a.TEXT_STYLE_CHANGED,this._onStyleChange,this),this.dirty=!0}},text:{get:function(){return this._text},set:function(t){t=t||" ",t=t.toString(),this._text!==t&&(this._text=t,this.dirty=!0)}}}),r.prototype.updateText=function(t){if(this.dirty||!t){var e=this._style,i="number"==typeof e.fontSize?e.fontSize+"px":e.fontSize;this._font=e.fontStyle+" "+e.fontVariant+" "+e.fontWeight+" "+i+" "+e.fontFamily,this.context.font=this._font;var r,n=e.wordWrap?this.wordWrap(this._text):this._text,o=n.split(/(?:\r\n|\r|\n)/),s=new Array(o.length),a=0,h=this.determineFontProperties(this._font);for(r=0;r<o.length;r++){var l=this.context.measureText(o[r]).width+(o[r].length-1)*e.letterSpacing;s[r]=l,a=Math.max(a,l)}var c=a+e.strokeThickness;e.dropShadow&&(c+=e.dropShadowDistance),this.canvas.width=Math.ceil((c+this.context.lineWidth)*this.resolution);var u=this.style.lineHeight||h.fontSize+e.strokeThickness,p=u*o.length;e.dropShadow&&(p+=e.dropShadowDistance),this.canvas.height=Math.ceil((p+2*this._style.padding)*this.resolution),this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this._font,this.context.strokeStyle=e.stroke,this.context.lineWidth=e.strokeThickness,this.context.textBaseline=e.textBaseline,this.context.lineJoin=e.lineJoin,this.context.miterLimit=e.miterLimit;var d,f;if(e.dropShadow){e.dropShadowBlur>0?(this.context.shadowColor=e.dropShadowColor,this.context.shadowBlur=e.dropShadowBlur):this.context.fillStyle=e.dropShadowColor;var m=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,g=Math.sin(e.dropShadowAngle)*e.dropShadowDistance;for(r=0;r<o.length;r++)d=e.strokeThickness/2,f=e.strokeThickness/2+r*u+h.ascent,"right"===e.align?d+=a-s[r]:"center"===e.align&&(d+=(a-s[r])/2),e.fill&&this.drawLetterSpacing(o[r],d+m,f+g+e.padding)}for(this.context.fillStyle=e.fill,r=0;r<o.length;r++)d=e.strokeThickness/2,f=e.strokeThickness/2+r*u+h.ascent,"right"===e.align?d+=a-s[r]:"center"===e.align&&(d+=(a-s[r])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(o[r],d,f+e.padding,!0),e.fill&&this.drawLetterSpacing(o[r],d,f+e.padding);this.updateTexture()}},r.prototype.drawLetterSpacing=function(t,e,i,r){var n=this._style,o=n.letterSpacing;if(0===o)return void(r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i));for(var s,a=String.prototype.split.call(t,""),h=0,l=e;h<t.length;)s=a[h++],r?this.context.strokeText(s,l,i):this.context.fillText(s,l,i),l+=this.context.measureText(s).width+o},r.prototype.updateTexture=function(){var t=this._texture,e=this._style;t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution,t.orig.width=t._frame.width=this.canvas.width/this.resolution,t.orig.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=0,t.trim.y=-e.padding,t.trim.width=t._frame.width,t.trim.height=t._frame.height-2*e.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,t.baseTexture.emit("update",t.baseTexture),this.dirty=!1},r.prototype.renderWebGL=function(t){this.updateText(!0),n.prototype.renderWebGL.call(this,t)},r.prototype._renderCanvas=function(t){this.updateText(!0),n.prototype._renderCanvas.call(this,t)},r.prototype.determineFontProperties=function(t){var e=r.fontPropertiesCache[t];if(!e){e={};var i=r.fontPropertiesCanvas,n=r.fontPropertiesContext;n.font=t;var o=Math.ceil(n.measureText("|Mq").width),s=Math.ceil(n.measureText("M").width),a=2*s;s=1.4*s|0,i.width=o,i.height=a,n.fillStyle="#f00",n.fillRect(0,0,o,a),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText("|Mq",0,s);var h,l,c=n.getImageData(0,0,o,a).data,u=c.length,p=4*o,d=0,f=!1;for(h=0;s>h;h++){for(l=0;p>l;l+=4)if(255!==c[d+l]){f=!0;break}if(f)break;d+=p}for(e.ascent=s-h,d=u-p,f=!1,h=a;h>s;h--){for(l=0;p>l;l+=4)if(255!==c[d+l]){f=!0;break}if(f)break;d-=p}e.descent=h-s,e.fontSize=e.ascent+e.descent,r.fontPropertiesCache[t]=e}return e},r.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),r=this._style.wordWrapWidth,n=0;n<i.length;n++){for(var o=r,s=i[n].split(" "),a=0;a<s.length;a++){var h=this.context.measureText(s[a]).width;if(this._style.breakWords&&h>r)for(var l=s[a].split(""),c=0;c<l.length;c++){var u=this.context.measureText(l[c]).width;u>o?(e+="\n"+l[c],o=r-u):(0===c&&(e+=" "),e+=l[c],o-=u)}else{var p=h+this.context.measureText(" ").width;0===a||p>o?(a>0&&(e+="\n"),e+=s[a],o=r-h):(o-=p,e+=" "+s[a])}}n<i.length-1&&(e+="\n")}return e},r.prototype.getBounds=function(t){return this.updateText(!0),n.prototype.getBounds.call(this,t)},r.prototype._onStyleChange=function(){this.dirty=!0},r.prototype.destroy=function(t){this.context=null,this.canvas=null,this._style.off(a.TEXT_STYLE_CHANGED,this._onStyleChange,this),this._style=null,this._texture.destroy(void 0===t?!0:t)}},{"../const":40,"../math":62,"../sprites/Sprite":92,"../textures/Texture":103,"./TextStyle":99}],99:[function(t,e,i){function r(t){o.call(this),Object.assign(this,this._defaults,t)}function n(t){return"number"==typeof t?a.hex2string(t):t}var o=t("eventemitter3"),s=t("../const"),a=t("../utils");r.prototype=Object.create(o.prototype),r.prototype.constructor=r,e.exports=r,r.prototype._defaults={align:"left",breakWords:!1,dropShadow:!1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"#000000",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",wordWrap:!1,wordWrapWidth:100},r.prototype.clone=function(){var t={};for(var e in this._defaults)t[e]=this[e];return new r(t)},r.prototype.reset=function(){Object.assign(this,this._defaults)},Object.defineProperties(r.prototype,{align:{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.emit(s.TEXT_STYLE_CHANGED))}},breakWords:{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.emit(s.TEXT_STYLE_CHANGED))}},dropShadow:{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.emit(s.TEXT_STYLE_CHANGED))}},dropShadowAngle:{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.emit(s.TEXT_STYLE_CHANGED))}},dropShadowBlur:{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.emit(s.TEXT_STYLE_CHANGED))}},dropShadowColor:{get:function(){return this._dropShadowColor},set:function(t){var e=n(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.emit(s.TEXT_STYLE_CHANGED))}},dropShadowDistance:{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.emit(s.TEXT_STYLE_CHANGED))}},fill:{get:function(){return this._fill},set:function(t){var e=n(t);this._fill!==e&&(this._fill=e,this.emit(s.TEXT_STYLE_CHANGED))}},fontFamily:{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.emit(s.TEXT_STYLE_CHANGED))}},fontSize:{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.emit(s.TEXT_STYLE_CHANGED))}},fontStyle:{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.emit(s.TEXT_STYLE_CHANGED))}},fontVariant:{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.emit(s.TEXT_STYLE_CHANGED))}},fontWeight:{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.emit(s.TEXT_STYLE_CHANGED))}},letterSpacing:{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.emit(s.TEXT_STYLE_CHANGED))}},lineHeight:{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.emit(s.TEXT_STYLE_CHANGED))}},lineJoin:{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.emit(s.TEXT_STYLE_CHANGED))}},miterLimit:{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.emit(s.TEXT_STYLE_CHANGED))}},padding:{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.emit(s.TEXT_STYLE_CHANGED))}},stroke:{get:function(){return this._stroke},set:function(t){var e=n(t);this._stroke!==e&&(this._stroke=e,this.emit(s.TEXT_STYLE_CHANGED))}},strokeThickness:{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.emit(s.TEXT_STYLE_CHANGED))}},textBaseline:{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.emit(s.TEXT_STYLE_CHANGED))}},wordWrap:{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.emit(s.TEXT_STYLE_CHANGED))}},wordWrapWidth:{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.emit(s.TEXT_STYLE_CHANGED))}}})},{"../const":40,"../utils":110,eventemitter3:26}],100:[function(t,e,i){function r(t,e,i,r){n.call(this,null,i),this.width=t||100,this.height=e||100,this.resolution=r||o.RESOLUTION,this.scaleMode=i||o.SCALE_MODES.DEFAULT,this.hasLoaded=!0,this._glRenderTargets=[],this._canvasRenderTarget=null,this.valid=!1}var n=t("./BaseTexture"),o=t("../const");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.resize=function(t,e){t===this.width&&e===this.height||(this.valid=t>0&&e>0,this.width=t,this.height=e,this.valid&&(this.emit("update",this),this.filterManager&&this.filterManager.resize(this.width,this.height)))},r.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.filterManager&&this.filterManager.destroy(),this.renderer=null}},{"../const":40,"./BaseTexture":101}],101:[function(t,e,i){function r(t,e,i){s.call(this),this.uid=n.uid(),this.touched=0,this.resolution=i||o.RESOLUTION,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=e||o.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=o.MIPMAP_TEXTURES,this.wrapMode=o.WRAP_MODES.DEFAULT,this._glTextures=[],this._enabled=0,this._id=0,t&&this.loadSource(t)}var n=t("../utils"),o=t("../const"),s=t("eventemitter3"),a=t("../utils/determineCrossOrigin"),h=t("bit-twiddle");r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=h.isPow2(this.realWidth)&&h.isPow2(this.realHeight),this.emit("update",this)},r.prototype.loadSource=function(t){var e=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=t,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!t.getContext){this.isLoading=!0;var i=this;t.onload=function(){t.onload=null,t.onerror=null,i.isLoading&&(i.isLoading=!1,i._sourceLoaded(),i.emit("loaded",i))},t.onerror=function(){t.onload=null,t.onerror=null,i.isLoading&&(i.isLoading=!1,i.emit("error",i))},t.complete&&t.src&&(this.isLoading=!1,t.onload=null,t.onerror=null,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this))}},r.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},r.prototype.destroy=function(){this.imageUrl?(delete n.BaseTextureCache[this.imageUrl],delete n.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete n.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},r.prototype.dispose=function(){this.emit("dispose",this)},r.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},r.fromImage=function(t,e,i){var o=n.BaseTextureCache[t];if(!o){var s=new Image;void 0===e&&0!==t.indexOf("data:")&&(s.crossOrigin=a(t)),o=new r(s,i),o.imageUrl=t,s.src=t,n.BaseTextureCache[t]=o,o.resolution=n.getResolutionOfUrl(t)}return o},r.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+n.uid());var i=n.BaseTextureCache[t._pixiId];return i||(i=new r(t,e),n.BaseTextureCache[t._pixiId]=i),i}},{"../const":40,"../utils":110,"../utils/determineCrossOrigin":109,"bit-twiddle":17,eventemitter3:26}],102:[function(t,e,i){function r(t,e){if(this.legacyRenderer=null,!(t instanceof n)){var i=arguments[1],r=arguments[2],s=arguments[3]||0,a=arguments[4]||1;this.legacyRenderer=arguments[0],e=null,t=new n(i,r,s,a)}o.call(this,t,e),this.valid=!0,this._updateUvs()}var n=t("./BaseRenderTexture"),o=t("./Texture");r.prototype=Object.create(o.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.resize=function(t,e,i){this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i||this.baseTexture.resize(t,e),this._updateUvs()},r.create=function(t,e,i,o){return new r(new n(t,e,i,o))}},{"./BaseRenderTexture":100,"./Texture":103}],103:[function(t,e,i){function r(t,e,i,n,o){if(a.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new h.Rectangle(0,0,1,1)),t instanceof r&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=n,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.orig=i||e,this._rotate=+(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw"attempt to use diamond-shaped UVs. If you are sure, set rotation manually";t.hasLoaded?(this.noFrame&&(e=new h.Rectangle(0,0,t.width,t.height),t.on("update",this.onBaseTextureUpdated,this)),this.frame=e):t.once("loaded",this.onBaseTextureLoaded,this)}var n=t("./BaseTexture"),o=t("./VideoBaseTexture"),s=t("./TextureUvs"),a=t("eventemitter3"),h=t("../math"),l=t("../utils");r.prototype=Object.create(a.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{frame:{get:function(){return this._frame},set:function(t){if(this._frame=t,this.noFrame=!1,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},rotate:{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},width:{get:function(){return this.orig?this.orig.width:0}},height:{get:function(){return this.orig?this.orig.height:0}}}),r.prototype.update=function(){this.baseTexture.update()},r.prototype.onBaseTextureLoaded=function(t){this.noFrame?this.frame=new h.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},r.prototype.onBaseTextureUpdated=function(t){this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},r.prototype.destroy=function(t){this.baseTexture&&(t&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},r.prototype.clone=function(){return new r(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},r.prototype._updateUvs=function(){this._uvs||(this._uvs=new s),this._uvs.set(this._frame,this.baseTexture,this.rotate)},r.fromImage=function(t,e,i){var o=l.TextureCache[t];return o||(o=new r(n.fromImage(t,e,i)),l.TextureCache[t]=o),o},r.fromFrame=function(t){var e=l.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},r.fromCanvas=function(t,e){return new r(n.fromCanvas(t,e))},r.fromVideo=function(t,e){return"string"==typeof t?r.fromVideoUrl(t,e):new r(o.fromVideo(t,e))},r.fromVideoUrl=function(t,e){return new r(o.fromUrl(t,e))},r.from=function(t){if("string"==typeof t){var e=l.TextureCache[t];if(!e){var i=null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/);return i?r.fromVideoUrl(t):r.fromImage(t)}return e}return t instanceof HTMLCanvasElement?r.fromCanvas(t):t instanceof HTMLVideoElement?r.fromVideo(t):t instanceof n?new r(n):void 0},r.addTextureToCache=function(t,e){l.TextureCache[e]=t},r.removeTextureFromCache=function(t){var e=l.TextureCache[t];return delete l.TextureCache[t],delete l.BaseTextureCache[t],e},r.EMPTY=new r(new n),r.EMPTY.destroy=function(){},r.EMPTY.on=function(){},r.EMPTY.once=function(){},r.EMPTY.emit=function(){}},{"../math":62,"../utils":110,"./BaseTexture":101,"./TextureUvs":104,"./VideoBaseTexture":105,eventemitter3:26}],104:[function(t,e,i){function r(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}e.exports=r;var n=t("../math/GroupD8");r.prototype.set=function(t,e,i){var r=e.width,o=e.height;if(i){var s=t.width/2/r,a=t.height/2/o,h=t.x/r+s,l=t.y/o+a;i=n.add(i,n.NW),this.x0=h+s*n.uX(i),this.y0=l+a*n.uY(i),i=n.add(i,2),this.x1=h+s*n.uX(i),this.y1=l+a*n.uY(i),i=n.add(i,2),this.x2=h+s*n.uX(i),this.y2=l+a*n.uY(i),i=n.add(i,2),this.x3=h+s*n.uX(i),this.y3=l+a*n.uY(i)}else this.x0=t.x/r,this.y0=t.y/o,this.x1=(t.x+t.width)/r,this.y1=t.y/o,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/o,this.x3=t.x/r,this.y3=(t.y+t.height)/o;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535}},{"../math/GroupD8":59}],105:[function(t,e,i){function r(t,e){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),o.call(this,t,e),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),t.complete||(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function n(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=t,i.type=e,i}var o=t("./BaseTexture"),s=t("../utils");r.prototype=Object.create(o.prototype),r.prototype.constructor=r,e.exports=r,r.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},r.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},r.prototype._onPlayStop=function(){this.autoUpdate=!1;
},r.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},r.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete s.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),o.prototype.destroy.call(this)},r.fromVideo=function(t,e){t._pixiId||(t._pixiId="video_"+s.uid());var i=s.BaseTextureCache[t._pixiId];return i||(i=new r(t,e),s.BaseTextureCache[t._pixiId]=i),i},r.fromUrl=function(t,e){var i=document.createElement("video");if(Array.isArray(t))for(var o=0;o<t.length;++o)i.appendChild(n(t[o].src||t[o],t[o].mime));else i.appendChild(n(t.src||t,t.mime));return i.load(),i.play(),r.fromVideo(i,e)},r.fromUrls=r.fromUrl},{"../utils":110,"./BaseTexture":101}],106:[function(t,e,i){function r(){var t=this;this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._emitter.listeners(s,!0)&&(t._requestId=requestAnimationFrame(t._tick)))},this._emitter=new o,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/n.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var n=t("../const"),o=t("eventemitter3"),s="tick";Object.defineProperties(r.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,n.TARGET_FPMS);this._maxElapsedMS=1/e}}}),r.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(s,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},r.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},r.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},r.prototype.add=function(t,e){return this._emitter.on(s,t,e),this._startIfPossible(),this},r.prototype.addOnce=function(t,e){return this._emitter.once(s,t,e),this._startIfPossible(),this},r.prototype.remove=function(t,e){return this._emitter.off(s,t,e),this._emitter.listeners(s,!0)||this._cancelIfNeeded(),this},r.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},r.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},r.prototype.update=function(t){var e;t=t||performance.now(),Math.max(0,e=this.elapsedMS=t-this.lastTime),e>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*n.TARGET_FPMS*this.speed,this._emitter.emit(s,this.deltaTime),this.lastTime=t},e.exports=r},{"../const":40,eventemitter3:26}],107:[function(t,e,i){var r=t("./Ticker"),n=new r;n.autoStart=!0,e.exports={shared:n,Ticker:r}},{"./Ticker":106}],108:[function(t,e,i){var r=function(t){for(var e=6*t,i=new Uint16Array(e),r=0,n=0;e>r;r+=6,n+=4)i[r+0]=n+0,i[r+1]=n+1,i[r+2]=n+2,i[r+3]=n+0,i[r+4]=n+2,i[r+5]=n+3;return i};e.exports=r},{}],109:[function(t,e,i){var r,n=t("url"),o=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,r||(r=document.createElement("a")),r.href=t,t=n.parse(r.href);var i=!t.port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"};e.exports=o},{url:24}],110:[function(t,e,i){var r=t("../const"),n=e.exports={_uid:0,_saidHello:!1,EventEmitter:t("eventemitter3"),pluginTarget:t("./pluginTarget"),uid:function(){return++n._uid},hex2rgb:function(t,e){return e=e||[],e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},hex2string:function(t){return t=t.toString(16),t="000000".substr(0,6-t.length)+t,"#"+t},rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},getResolutionOfUrl:function(t){var e=r.RETINA_PREFIX.exec(t);return e?parseFloat(e[1]):1},sayHello:function(t){if(!n._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c Pixi.js "+r.VERSION+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("Pixi.js "+r.VERSION+" - "+t+" - http://www.pixijs.com/");n._saidHello=!0}},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch(o){return!1}},sign:function(t){return t?0>t?-1:1:0},removeItems:function(t,e,i){var r=t.length;if(!(e>=r||0===i)){i=e+i>r?r-e:i;for(var n=e,o=r-i;o>n;++n)t[n]=t[n+i];t.length=o}},TextureCache:{},BaseTextureCache:{}}},{"../const":40,"./pluginTarget":112,eventemitter3:26}],111:[function(t,e,i){var r=t("ismobilejs"),n=function(t){return r.tablet||r.phone?2:t};e.exports=n},{ismobilejs:27}],112:[function(t,e,i){function r(t){t.__plugins={},t.registerPlugin=function(e,i){t.__plugins[e]=i},t.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var e in t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}e.exports={mixin:function(t){r(t)}}},{}],113:[function(t,e,i){function r(t){var e=(new Error).stack;"undefined"==typeof e||(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed)}var n=t("./core"),o=t("./mesh"),s=t("./particles"),a=t("./extras"),h=t("./filters"),l=t("./core/const");n.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},n.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(n,{Stage:{get:function(){return r("You do not need to use a PIXI Stage any more, you can simply render any container."),n.Container}},DisplayObjectContainer:{get:function(){return r("DisplayObjectContainer has been shortened to Container, please use Container from now on."),n.Container}},Strip:{get:function(){return r("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),o.Mesh}},Rope:{get:function(){return r("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),o.Rope}},ParticleContainer:{get:function(){return r("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),s.ParticleContainer}},MovieClip:{get:function(){return r("The MovieClip class has been moved to extras.MovieClip, please use extras.MovieClip from now on."),a.MovieClip}},TilingSprite:{get:function(){return r("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),a.TilingSprite}},BitmapText:{get:function(){return r("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),a.BitmapText}},blendModes:{get:function(){return r("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),n.BLEND_MODES}},scaleModes:{get:function(){return r("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),n.SCALE_MODES}},BaseTextureCache:{get:function(){return r("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),n.utils.BaseTextureCache}},TextureCache:{get:function(){return r("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),n.utils.TextureCache}},math:{get:function(){return r("The math namespace is deprecated, please access members already accessible on PIXI."),n}},AbstractFilter:{get:function(){return r("AstractFilter has been renamed to Filter, please use PIXI.Filter"),n.Filter}}}),n.DisplayObject.prototype.generateTexture=function(t,e,i){return r("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,i)},n.Graphics.prototype.generateTexture=function(t,e){return r("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},n.RenderTexture.prototype.render=function(t,e,i,n){this.legacyRenderer.render(t,this,i,e,!n),r("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},n.RenderTexture.prototype.getImage=function(t){return r("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},n.RenderTexture.prototype.getBase64=function(t){return r("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},n.RenderTexture.prototype.getCanvas=function(t){return r("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},n.RenderTexture.prototype.getPixels=function(t){return r("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},n.Sprite.prototype.setTexture=function(t){this.texture=t,r("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},a.BitmapText.prototype.setText=function(t){this.text=t,r("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")},n.Text.prototype.setText=function(t){this.text=t,r("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},n.Text.prototype.setStyle=function(t){this.style=t,r("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},Object.defineProperties(n.TextStyle.prototype,{font:{get:function(){r("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on");var t="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){r("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),t.indexOf("italic")>1?this._fontStyle="italic":t.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",t.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var e,i=t.split(" "),n=-1;for(this._fontSize=26,e=0;e<i.length;++e)if(i[e].match(/(px|pt|em|%)/)){n=e,this._fontSize=i[e];break}for(this._fontWeight="normal",e=0;n>e;++e)if(i[e].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=i[e];break}if(n>-1&&n<i.length-1){for(this._fontFamily="",e=n+1;e<i.length;++e)this._fontFamily+=i[e]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.emit(l.TEXT_STYLE_CHANGED)}}}),n.Texture.prototype.setFrame=function(t){this.frame=t,r("setFrame is now deprecated, please use the frame property, e.g : myTexture.frame = frame;")},Object.defineProperties(h,{AbstractFilter:{get:function(){return r("AstractFilter has been renamed to Filter, please use PIXI.Filter"),n.AbstractFilter}},FXAAFilter:{get:function(){return r("filters.FXAAFilter is an undocumented alias, please use FXAAFilter from now on."),n.FXAAFilter}},SpriteMaskFilter:{get:function(){return r("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),n.SpriteMaskFilter}}}),n.utils.uuid=function(){return r("utils.uuid() is deprecated, please use utils.uid() from now on."),n.utils.uid()},n.utils.canUseNewCanvasBlendModes=function(){return r("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),n.CanvasTinter.canUseMultiply}},{"./core":58,"./core/const":40,"./extras":123,"./filters":135,"./mesh":151,"./particles":154}],114:[function(t,e,i){function r(t){this.renderer=t,t.extract=this}var n=t("../../core"),o=new n.Rectangle;r.prototype.constructor=r,e.exports=r,r.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},r.prototype.base64=function(t){return this.canvas(t).toDataURL()},r.prototype.canvas=function(t){var e,i,r,s,a=this.renderer;t&&(s=t instanceof n.RenderTexture?t:a.generateTexture(t)),s?(e=s.baseTexture._canvasRenderTarget.context,i=s.baseTexture._canvasRenderTarget.resolution,r=s.frame):(e=a.rootContext,i=a.rootResolution,r=o,r.width=this.renderer.width,r.height=this.renderer.height);var h=r.width*i,l=r.height*i,c=new n.CanvasRenderTarget(h,l),u=e.getImageData(r.x*i,r.y*i,h,l);return c.context.putImageData(u,0,0),c.canvas},r.prototype.pixels=function(t){var e,i,r,s,a=this.renderer;return t&&(s=t instanceof n.RenderTexture?t:a.generateTexture(t)),s?(e=s.baseTexture._canvasRenderTarget.context,i=s.baseTexture._canvasRenderTarget.resolution,r=s.frame):(e=a.rootContext,i=a.rootResolution,r=o,r.width=a.width,r.height=a.height),e.getImageData(0,0,r.width*i,r.height*i).data},r.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},n.CanvasRenderer.registerPlugin("extract",r)},{"../../core":58}],115:[function(t,e,i){e.exports={webGL:t("./webgl/WebGLExtract"),canvas:t("./canvas/CanvasExtract")}},{"./canvas/CanvasExtract":114,"./webgl/WebGLExtract":116}],116:[function(t,e,i){function r(t){this.renderer=t,t.extract=this}var n=t("../../core"),o=new n.Rectangle;r.prototype.constructor=r,e.exports=r,r.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},r.prototype.base64=function(t){return this.canvas(t).toDataURL()},r.prototype.canvas=function(t){var e,i,r,s,a=this.renderer,h=!1;t&&(s=t instanceof n.RenderTexture?t:this.renderer.generateTexture(t)),s?(e=s.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],i=e.resolution,r=s.frame,h=!1):(e=this.renderer.rootRenderTarget,i=e.resolution,h=!0,r=o,r.width=e.size.width,r.height=e.size.height);var l=r.width*i,c=r.height*i,u=new n.CanvasRenderTarget(l,c);if(e){a.bindRenderTarget(e);var p=new Uint8Array(4*l*c),d=a.gl;d.readPixels(r.x*i,r.y*i,l,c,d.RGBA,d.UNSIGNED_BYTE,p);var f=u.context.getImageData(0,0,l,c);f.data.set(p),u.context.putImageData(f,0,0),h&&(u.context.scale(1,-1),u.context.drawImage(u.canvas,0,-c))}return u.canvas},r.prototype.pixels=function(t){var e,i,r,s,a=this.renderer;t&&(s=t instanceof n.RenderTexture?t:this.renderer.generateTexture(t)),s?(e=s.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],i=e.resolution,r=s.frame):(e=this.renderer.rootRenderTarget,i=e.resolution,r=o,r.width=e.size.width,r.height=e.size.height);var h=r.width*i,l=r.height*i,c=new Uint8Array(4*h*l);if(e){a.bindRenderTarget(e);var u=a.gl;u.readPixels(r.x*i,r.y*i,h,l,u.RGBA,u.UNSIGNED_BYTE,c)}return c},r.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},n.WebGLRenderer.registerPlugin("extract",r)},{"../../core":58}],117:[function(t,e,i){function r(t,e){n.Container.call(this),e=e||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==e.tint?e.tint:16777215,align:e.align||"left",name:null,size:0},this.font=e.font,this._text=t,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var n=t("../core");r.prototype=Object.create(n.Container.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{tint:{get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):r.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),r.prototype.updateText=function(){for(var t=r.fonts[this._font.name],e=new n.Point,i=null,o=[],s=0,a=0,h=[],l=0,c=this._font.size/t.size,u=-1,p=0,d=0;d<this.text.length;d++){var f=this.text.charCodeAt(d);if(u=/(\s)/.test(this.text.charAt(d))?d:u,/(?:\r\n|\r|\n)/.test(this.text.charAt(d)))h.push(s),a=Math.max(a,s),l++,e.x=0,e.y+=t.lineHeight,i=null;else if(-1!==u&&this.maxWidth>0&&e.x*c>this.maxWidth)n.utils.removeItems(o,u,d-u),d=u,u=-1,h.push(s),a=Math.max(a,s),l++,e.x=0,e.y+=t.lineHeight,i=null;else{var m=t.chars[f];m&&(i&&m.kerning[i]&&(e.x+=m.kerning[i]),o.push({texture:m.texture,line:l,charCode:f,position:new n.Point(e.x+m.xOffset,e.y+m.yOffset)}),s=e.x+(m.texture.width+m.xOffset),e.x+=m.xAdvance,p=Math.max(p,m.yOffset+m.texture.height),i=f)}}h.push(s),a=Math.max(a,s);var g=[];for(d=0;l>=d;d++){var v=0;"right"===this._font.align?v=a-h[d]:"center"===this._font.align&&(v=(a-h[d])/2),g.push(v)}var y=o.length,x=this.tint;for(d=0;y>d;d++){var _=this._glyphs[d];_?_.texture=o[d].texture:(_=new n.Sprite(o[d].texture),this._glyphs.push(_)),_.position.x=(o[d].position.x+g[o[d].line])*c,_.position.y=o[d].position.y*c,_.scale.x=_.scale.y=c,_.tint=x,_.parent||this.addChild(_)}for(d=y;d<this._glyphs.length;++d)this.removeChild(this._glyphs[d]);this.textWidth=a*c,this.textHeight=(e.y+t.lineHeight)*c,this.maxLineHeight=p*c},r.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},r.prototype.getLocalBounds=function(){return this.validate(),n.Container.prototype.getLocalBounds.call(this)},r.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},r.fonts={}},{"../core":58}],118:[function(t,e,i){function r(t){n.Sprite.call(this,t[0]instanceof n.Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var n=t("../core");r.prototype=Object.create(n.Sprite.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(t){if(t[0]instanceof n.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}}},currentFrame:{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return 0>t&&(t+=this._textures.length),t}}}),r.prototype.stop=function(){this.playing&&(this.playing=!1,n.ticker.shared.remove(this.update,this))},r.prototype.play=function(){this.playing||(this.playing=!0,n.ticker.shared.add(this.update,this))},r.prototype.gotoAndStop=function(t){this.stop(),this._currentTime=t,this._texture=this._textures[this.currentFrame]},r.prototype.gotoAndPlay=function(t){this._currentTime=t,this.play()},r.prototype.update=function(t){var e=this.animationSpeed*t;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;0>i;)this._currentTime--,i+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},r.prototype.destroy=function(){this.stop(),n.Sprite.prototype.destroy.call(this)},r.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new n.Texture.fromFrame(t[i]));return new r(e)},r.fromImages=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new n.Texture.fromImage(t[i]));return new r(e)}},{"../core":58}],119:[function(t,e,i){function r(t,e,i){n.Sprite.call(this,t),this.tileScale=new n.Point(1,1),this.tilePosition=new n.Point(0,0),this._width=e||100,this._height=i||100,this._uvs=new n.TextureUvs,this._canvasPattern=null,this._glDatas=[]}var n=t("../core"),o=new n.Point,s=t("../core/sprites/canvas/CanvasTinter"),a=t("./webgl/TilingShader"),h=new Float32Array(4);r.prototype=Object.create(n.Sprite.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t}},height:{get:function(){return this._height},set:function(t){this._height=t}}}),r.prototype._onTextureUpdate=function(){},r.prototype._renderWebGL=function(t){var e=this._texture;if(e&&e._uvs){t.flush();var i=t.gl,r=this._glDatas[t.CONTEXT_UID];r||(r={shader:new a(i),quad:new n.Quad(i)},this._glDatas[t.CONTEXT_UID]=r,r.quad.initVao(r.shader));var o=r.quad.vertices;o[0]=o[6]=this._width*-this.anchor.x,o[1]=o[3]=this._height*-this.anchor.y,o[2]=o[4]=this._width*(1-this.anchor.x),o[5]=o[7]=this._height*(1-this.anchor.y),r.quad.upload(),t.bindShader(r.shader);var s=e._uvs,l=e._frame.width,c=e._frame.height,u=e.baseTexture.width,p=e.baseTexture.height,d=r.shader.uniforms.uPixelSize;d[0]=1/u,d[1]=1/p,r.shader.uniforms.uPixelSize=d;var f=r.shader.uniforms.uFrame;f[0]=s.x0,f[1]=s.y0,f[2]=s.x1-s.x0,f[3]=s.y2-s.y0,r.shader.uniforms.uFrame=f;var m=r.shader.uniforms.uTransform;m[0]=this.tilePosition.x%(l*this.tileScale.x)/this._width,m[1]=this.tilePosition.y%(c*this.tileScale.y)/this._height,m[2]=u/this._width*this.tileScale.x,m[3]=p/this._height*this.tileScale.y,r.shader.uniforms.uTransform=m,r.shader.uniforms.translationMatrix=this.worldTransform.toArray(!0);var g=h;n.utils.hex2rgb(this.tint,g),g[3]=this.worldAlpha,r.shader.uniforms.uColor=g,t.bindTexture(this._texture,0),t.state.setBlendMode(this.blendMode),r.quad.draw()}},r.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,r=this.worldTransform,o=t.resolution,a=e.baseTexture,h=this.tilePosition.x/this.tileScale.x%e._frame.width,l=this.tilePosition.y/this.tileScale.y%e._frame.height;if(!this._canvasPattern){var c=new n.CanvasRenderTarget(e._frame.width,e._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=s.getTintedTexture(this,this.tint)),c.context.drawImage(this.tintedTexture,0,0)):c.context.drawImage(a.source,-e._frame.x,-e._frame.y),this._canvasPattern=c.context.createPattern(c.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(r.a*o,r.b*o,r.c*o,r.d*o,r.tx*o,r.ty*o),i.scale(this.tileScale.x,this.tileScale.y),i.translate(h+this.anchor.x*-this._width,l+this.anchor.y*-this._height);var u=t.blendModes[this.blendMode];u!==t.context.globalCompositeOperation&&(i.globalCompositeOperation=u),i.fillStyle=this._canvasPattern,i.fillRect(-h,-l,this._width/this.tileScale.x,this._height/this.tileScale.y)}},r.prototype.getBounds=function(){var t,e,i,r,n=this._width,o=this._height,s=n*(1-this.anchor.x),a=n*-this.anchor.x,h=o*(1-this.anchor.y),l=o*-this.anchor.y,c=this.worldTransform,u=c.a,p=c.b,d=c.c,f=c.d,m=c.tx,g=c.ty,v=u*a+d*l+m,y=f*l+p*a+g,x=u*s+d*l+m,_=f*l+p*s+g,b=u*s+d*h+m,w=f*h+p*s+g,S=u*a+d*h+m,T=f*h+p*a+g;t=v,t=t>x?x:t,t=t>b?b:t,t=t>S?S:t,i=y,i=i>_?_:i,i=i>w?w:i,i=i>T?T:i,e=v,e=x>e?x:e,e=b>e?b:e,e=S>e?S:e,r=y,r=_>r?_:r,r=w>r?w:r,r=T>r?T:r;var M=this._bounds;return M.x=t,M.width=e-t,M.y=i,M.height=r-i,this._currentBounds=M,M},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,o);var e,i=this._width,r=this._height,n=-i*this.anchor.x;return o.x>n&&o.x<n+i&&(e=-r*this.anchor.y,o.y>e&&o.y<e+r)},r.prototype.destroy=function(){n.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},r.fromFrame=function(t,e,i){var o=n.utils.TextureCache[t];if(!o)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new r(o,e,i)},r.fromImage=function(t,e,i,o,s){return new r(n.Texture.fromImage(t,o,s),e,i)}},{"../core":58,"../core/sprites/canvas/CanvasTinter":94,"./webgl/TilingShader":124}],120:[function(t,e,i){var r=t("../core"),n=r.DisplayObject,o=new r.Matrix;n.prototype._cacheAsBitmap=!1,n.prototype._originalRenderWebGL=null,n.prototype._originalRenderCanvas=null,n.prototype._originalUpdateTransform=null,n.prototype._originalHitTest=null,n.prototype._originalDestroy=null,n.prototype._cachedSprite=null,Object.defineProperties(n.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),n.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cachedSprite.transform.updated=!0,this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite._renderWebGL(t))},n.prototype._initCachedDisplayObject=function(t){if(!this._cachedSprite){t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters){var i=this._filters[0].padding;e.x-=i,e.y-=i,e.width+=2*i,e.height+=2*i}var n=t._activeRenderTarget,s=t.filterManager.filterStack,a=r.RenderTexture.create(0|e.width,0|e.height),h=o;h.tx=-e.x,h.ty=-e.y,this.renderWebGL=this._originalRenderWebGL,t.render(this,a,!0,h,!0),t.bindRenderTarget(n),t.filterManager.filterStack=s,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new r.Sprite(a),this._cachedSprite.transform.worldTransform=this.transform.worldTransform,this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},n.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(t))},n.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cachedSprite){var e=this.getLocalBounds(),i=t.context,n=new r.RenderTexture.create(0|e.width,0|e.height),s=o;this.transform.worldTransform.copy(s),s.invert(),s.tx-=e.x,s.ty-=e.y,this.renderCanvas=this._originalRenderCanvas,t.render(this,n,!0,s,!1),t.context=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new r.Sprite(n),this._cachedSprite.transform.worldTransform=this.transform.worldTransform,this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},n.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds(r.Matrix.IDENTITY)},n.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(!0),this._cachedSprite=null},n.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()}},{"../core":58}],121:[function(t,e,i){var r=t("../core");r.DisplayObject.prototype.name=null,r.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":58}],122:[function(t,e,i){var r=t("../core");r.DisplayObject.prototype.getGlobalPosition=function(t){return t=t||new r.Point,this.parent?(this.displayObjectUpdateTransform(),t.x=this.worldTransform.tx,t.y=this.worldTransform.ty):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":58}],123:[function(t,e,i){t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition"),e.exports={MovieClip:t("./MovieClip"),TilingSprite:t("./TilingSprite"),BitmapText:t("./BitmapText")}},{"./BitmapText":117,"./MovieClip":118,"./TilingSprite":119,"./cacheAsBitmap":120,"./getChildByName":121,"./getGlobalPosition":122}],124:[function(t,e,i){function r(t){n.call(this,t,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nuniform vec4 uFrame;\nuniform vec4 uTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vec2 coord = aTextureCoord;\n    coord -= uTransform.xy;\n    coord /= uTransform.zw;\n    vTextureCoord = coord;\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform vec4 uFrame;\nuniform vec2 uPixelSize;\n\nvoid main(void)\n{\n\n   	vec2 coord = mod(vTextureCoord, uFrame.zw);\n   	coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);\n   	coord += uFrame.xy;\n\n   	vec4 sample = texture2D(uSampler, coord);\n  	vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n\n   	gl_FragColor = sample * color ;\n}\n")}var n=t("../../core/Shader");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r},{"../../core/Shader":39}],125:[function(t,e,i){function r(){n.Filter.call(this),this.blurXFilter=new o,this.blurYFilter=new s,this.resolution=.5,this.blurYFilter.passes=this.blurXFilter.passes=1,this.blurYFilter.strength=this.blurXFilter.strength=4,this.padding=40,this.passes=2}var n=t("../../core"),o=t("./BlurXFilter"),s=t("./BlurYFilter");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i){var r=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,r,!0),this.blurYFilter.apply(t,r,i,!1),t.returnRenderTarget(r)},Object.defineProperties(r.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.padding=2*Math.max(Math.abs(this.blurYFilter.strength),Math.abs(this.blurYFilter.strength)),this.blurXFilter.blur=this.blurYFilter.blur=t}},passes:{get:function(){return this.blurXFilter.passes},set:function(t){this.blurXFilter.passes=this.blurYFilter.passes=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurYFilter.strength),Math.abs(this.blurYFilter.strength))}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurYFilter.strength),Math.abs(this.blurYFilter.strength));
}}})},{"../../core":58,"./BlurXFilter":126,"./BlurYFilter":127}],126:[function(t,e,i){function r(){var t=o(5,!0),e=s(5);n.Filter.call(this,t,e),this.passes=1,this.resolution=1,this.strength=4,this.firstRun=!0}var n=t("../../core"),o=t("./generateBlurVertSource"),s=t("./generateBlurFragSource"),a=t("./getMaxBlurKernelSize");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i,r){if(this.firstRun){var n=t.renderer.gl,h=a(n);this.vertexSrc=o(h,!0),this.fragmentSrc=s(h),this.firstRun=!1}if(this.uniforms.strength=1/i.size.width*(i.size.width/e.size.width),this.uniforms.strength*=this.strength,1===this.passes)t.applyFilter(this,e,i,r);else{for(var l=t.getRenderTarget(!0),c=e,u=l,p=0;p<this.passes-1;p++){t.applyFilter(this,c,u,!0);var d=u;u=c,c=d}t.applyFilter(this,c,i,r),t.returnRenderTarget(l)}},Object.defineProperties(r.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}}})},{"../../core":58,"./generateBlurFragSource":128,"./generateBlurVertSource":129,"./getMaxBlurKernelSize":130}],127:[function(t,e,i){function r(){var t=o(5,!1),e=s(5);n.Filter.call(this,t,e),this.passes=1,this.resolution=1,this.strength=4,this.firstRun=!0}var n=t("../../core"),o=t("./generateBlurVertSource"),s=t("./generateBlurFragSource"),a=t("./getMaxBlurKernelSize");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i,r){if(this.firstRun){var n=t.renderer.gl,h=a(n);this.vertexSrc=o(h,!1),this.fragmentSrc=s(h),this.firstRun=!1}if(this.uniforms.strength=1/i.size.height*(i.size.height/e.size.height),this.uniforms.strength*=this.strength,1===this.passes)t.applyFilter(this,e,i,r);else{for(var l=t.getRenderTarget(!0),c=e,u=l,p=0;p<this.passes-1;p++){t.applyFilter(this,c,u,!0);var d=u;u=c,c=d}t.applyFilter(this,c,i,r),t.returnRenderTarget(l)}},Object.defineProperties(r.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}}})},{"../../core":58,"./generateBlurFragSource":128,"./generateBlurVertSource":129,"./getMaxBlurKernelSize":130}],128:[function(t,e,i){var r={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},n=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","	gl_FragColor = vec4(0.0);","	%blur%","}"].join("\n"),o=function(t){for(var e,i=r[t],o=i.length,s=n,a="",h="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",l=0;t>l;l++){var c=h.replace("%index%",l);e=l,l>=o&&(e=t-l-1),c=c.replace("%value%",i[e]),a+=c,a+="\n"}return s=s.replace("%blur%",a),s=s.replace("%size%",t)};e.exports=o},{}],129:[function(t,e,i){var r=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n"),n=function(t,e){var i,n,o=Math.ceil(t/2),s=r,a="";i=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var h=0;t>h;h++){var l=i.replace("%index%",h);n=h,h>=o&&(n=t-h-1),l=l.replace("%sampleIndex%",h-(o-1)+".0"),a+=l,a+="\n"}return s=s.replace("%blur%",a),s=s.replace("%size%",t)};e.exports=n},{}],130:[function(t,e,i){var r=function(t){for(var e=t.getParameter(t.MAX_VARYING_VECTORS),i=15;i>e;)i-=2;return i};e.exports=r},{}],131:[function(t,e,i){function r(){n.Filter.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4] * c.a;\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9] * c.a;\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14] * c.a;\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19] * c.a;\n\n//    gl_FragColor = vec4(m[0]);\n}\n"),this.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}var n=t("../../core");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype._loadMatrix=function(t,e){e=!!e;var i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},r.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19],t},r.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},r.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},r.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},r.prototype.grayscale=r.prototype.greyscale,r.prototype.blackAndWhite=function(t){var e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=.213,o=.715,s=.072,a=[n+i*(1-n)+r*-n,o+i*-o+r*-o,s+i*-s+r*(1-s),0,0,n+i*-n+.143*r,o+i*(1-o)+.14*r,s+i*-s+r*-.283,0,0,n+i*-n+r*-(1-n),o+i*-o+r*o,s+i*(1-s)+r*s,0,0,0,0,0,1,0];this._loadMatrix(a,e)},r.prototype.contrast=function(t,e){var i=(t||0)+1,r=-128*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)},r.prototype.saturate=function(t,e){var i=2*(t||0)/3+1,r=(i-1)*-.5,n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)},r.prototype.desaturate=function(){this.saturate(-1)},r.prototype.negative=function(t){var e=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.sepia=function(t){var e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.technicolor=function(t){var e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.polaroid=function(t){var e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.toBGR=function(t){var e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.kodachrome=function(t){var e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.browni=function(t){var e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.vintage=function(t){var e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.colorTone=function(t,e,i,r,n){t=t||.2,e=e||.15,i=i||16770432,r=r||3375104;var o=(i>>16&255)/255,s=(i>>8&255)/255,a=(255&i)/255,h=(r>>16&255)/255,l=(r>>8&255)/255,c=(255&r)/255,u=[.3,.59,.11,0,0,o,s,a,t,0,h,l,c,e,0,o-h,s-l,a-c,0,0];this._loadMatrix(u,n)},r.prototype.night=function(t,e){t=t||.1;var i=[-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},r.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},r.prototype.lsd=function(t){var e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)},r.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},Object.defineProperties(r.prototype,{matrix:{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}}})},{"../../core":58}],132:[function(t,e,i){function r(t,e){var i=new n.Matrix;t.renderable=!1,n.Filter.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","#define GLSLIFY 1\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"),this.maskSprite=t,this.maskMatrix=i,this.uniforms.mapSampler=t.texture,this.uniforms.otherMatrix=i.toArray(!0),this.uniforms.scale={x:1,y:1},null!==e&&void 0!==e||(e=20),this.scale=new n.Point(e,e)}var n=t("../../core");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i){var r=1/i.destinationFrame.width*(i.size.width/e.size.width);this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x*r,this.uniforms.scale.y=this.scale.y*r,t.applyFilter(this,e,i)},Object.defineProperties(r.prototype,{map:{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}})},{"../../core":58}],133:[function(t,e,i){function r(){n.Filter.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform float exposure;\nuniform float decay;\nuniform float density;\nuniform float weight;\nuniform vec2 lightPositionOnScreen;\nuniform sampler2D uSampler;\n\nconst int NUM_SAMPLES = 100;\n\nvoid main()\n{\n    vec2 deltaTextCoord = vec2( vTextureCoord - lightPositionOnScreen.xy );\n    vec2 textCoo = vTextureCoord;\n    deltaTextCoord *= 1.0 /  float(NUM_SAMPLES) * density;\n    float illuminationDecay = 1.0;\n\n    for(int i=0; i < NUM_SAMPLES ; i++)\n    {\n             textCoo -= deltaTextCoord;\n             vec4 sample = texture2D(uSampler, textCoo );\n\n             sample *= illuminationDecay * weight;\n\n             gl_FragColor += sample;\n\n             illuminationDecay *= decay;\n     }\n\n     gl_FragColor *= exposure;\n}\n"),this.uniforms.exposure=.0034,this.uniforms.decay=1,this.uniforms.density=.84,this.uniforms.weight=5.65,this.uniforms.lightPositionOnScreen[0]=.5,this.uniforms.lightPositionOnScreen[1]=.5}var n=t("../../core");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i,r){t.applyFilter(this,e,i,r)},Object.defineProperties(r.prototype,{offset:{get:function(){return this.uniforms.offset},set:function(t){this.uniforms.offset=t}},radius:{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t}},angle:{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t}}})},{"../../core":58}],134:[function(t,e,i){function r(){n.Filter.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n"),this.uniforms.gray=1,this.glShaderKey="gray"}var n=t("../../core");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{gray:{get:function(){return this.uniforms.gray},set:function(t){this.uniforms.gray=t}}})},{"../../core":58}],135:[function(t,e,i){e.exports={DisplacementFilter:t("./displacement/DisplacementFilter"),BlurFilter:t("./blur/BlurFilter"),BlurXFilter:t("./blur/BlurXFilter"),BlurYFilter:t("./blur/BlurYFilter"),ColorMatrixFilter:t("./colormatrix/ColorMatrixFilter"),TwistFilter:t("./twist/TwistFilter"),GrayFilter:t("./gray/GrayFilter"),GodrayFilter:t("./godray/GodrayFilter"),VoidFilter:t("./void/VoidFilter")}},{"./blur/BlurFilter":125,"./blur/BlurXFilter":126,"./blur/BlurYFilter":127,"./colormatrix/ColorMatrixFilter":131,"./displacement/DisplacementFilter":132,"./godray/GodrayFilter":133,"./gray/GrayFilter":134,"./twist/TwistFilter":136,"./void/VoidFilter":137}],136:[function(t,e,i){function r(){n.Filter.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n"),this.uniforms.radius=400,this.uniforms.angle=3,this.uniforms.offset=[400,300],this.transform=new n.math.Matrix,this.padding=200}var n=t("../../core");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.apply=function(t,e,i,r){t.applyFilter(this,e,i,r)},Object.defineProperties(r.prototype,{offset:{get:function(){return this.uniforms.offset},set:function(t){this.uniforms.offset=t}},radius:{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t}},angle:{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t}}})},{"../../core":58}],137:[function(t,e,i){function r(){n.Filter.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"),this.glShaderKey="void"}var n=t("../../core");r.prototype=Object.create(n.Filter.prototype),r.prototype.constructor=r,e.exports=r},{"../../core":58}],138:[function(t,i,r){(function(e){t("./polyfill");var r=i.exports=t("./core");r.extras=t("./extras"),r.filters=t("./filters"),r.interaction=t("./interaction"),r.loaders=t("./loaders"),r.mesh=t("./mesh"),r.particles=t("./particles"),r.accessibility=t("./accessibility"),r.extract=t("./extract"),r.loader=new r.loaders.Loader,Object.assign(r,t("./deprecation")),e.PIXI=r}).call(this,"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":38,"./core":58,"./deprecation":113,"./extract":115,"./extras":123,"./filters":135,"./interaction":141,"./loaders":144,"./mesh":151,"./particles":154,"./polyfill":160}],139:[function(t,e,i){function r(){this.global=new n.Point,this.target=null,this.originalEvent=null}var n=t("../core");r.prototype.constructor=r,e.exports=r,r.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}},{"../core":58}],140:[function(t,e,i){function r(t,e){e=e||{},this.renderer=t,this.autoPreventDefault=void 0!==e.autoPreventDefault?e.autoPreventDefault:!0,this.interactionFrequency=e.interactionFrequency||10,this.mouse=new o,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.defaultCursorStyle="inherit",this.currentCursorStyle="inherit",this._tempPoint=new n.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var n=t("../core"),o=t("./InteractionData");Object.assign(n.DisplayObject.prototype,t("./interactiveTarget")),r.prototype.constructor=r,e.exports=r,r.prototype.setTargetElement=function(t,e){this.removeEvents(),this.interactionDOMElement=t,this.resolution=e||1,this.addEvents()},r.prototype.addEvents=function(){this.interactionDOMElement&&(n.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},r.prototype.removeEvents=function(){this.interactionDOMElement&&(n.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},r.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor=this.defaultCursorStyle,this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},r.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.target=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},r.prototype.mapPositionToPoint=function(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0},t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)/this.resolution,t.y=(i-r.top)*(this.interactionDOMElement.height/r.height)/this.resolution},r.prototype.processInteractive=function(t,e,i,r,n){if(!e||!e.visible)return!1;var o=!1,s=n=e.interactive||n;if(e.hitArea&&(s=!1),r&&e._mask&&(e._mask.containsPoint(t)||(r=!1)),r&&e.filterArea&&(e.filterArea.contains(t.x,t.y)||(r=!1)),e.interactiveChildren)for(var a=e.children,h=a.length-1;h>=0;h--){var l=a[h];if(this.processInteractive(t,l,i,r,s)){if(!l.parent)continue;o=!0,s=!1,r=!1}}return n&&(r&&!o&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),o=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):e.containsPoint&&(o=e.containsPoint(t))),e.interactive&&i(e,o)),o},r.prototype.onMouseDown=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},r.prototype.processMouseDown=function(t,e){var i=this.mouse.originalEvent,r=2===i.button||3===i.which;e&&(t[r?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(t,r?"rightdown":"mousedown",this.eventData))},r.prototype.onMouseUp=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},r.prototype.processMouseUp=function(t,e){var i=this.mouse.originalEvent,r=2===i.button||3===i.which,n=r?"_isRightDown":"_isLeftDown";e?(this.dispatchEvent(t,r?"rightup":"mouseup",this.eventData),t[n]&&(t[n]=!1,this.dispatchEvent(t,r?"rightclick":"click",this.eventData))):t[n]&&(t[n]=!1,this.dispatchEvent(t,r?"rightupoutside":"mouseupoutside",this.eventData))},r.prototype.onMouseMove=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.didMove=!0,this.cursor=this.defaultCursorStyle,this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},r.prototype.processMouseMove=function(t,e){this.processMouseOverOut(t,e),this.moveWhenInside&&!e||this.dispatchEvent(t,"mousemove",this.eventData)},r.prototype.onMouseOut=function(t){this.mouse.originalEvent=t,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.interactionDOMElement.style.cursor=this.defaultCursorStyle,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},r.prototype.processMouseOverOut=function(t,e){e?(t._over||(t._over=!0,this.dispatchEvent(t,"mouseover",this.eventData)),t.buttonMode&&(this.cursor=t.defaultCursor)):t._over&&(t._over=!1,this.dispatchEvent(t,"mouseout",this.eventData))},r.prototype.onTouchStart=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,r=0;i>r;r++){var n=e[r],o=this.getTouchData(n);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(o)}},r.prototype.processTouchStart=function(t,e){e&&(t._touchDown=!0,this.dispatchEvent(t,"touchstart",this.eventData))},r.prototype.onTouchEnd=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,r=0;i>r;r++){var n=e[r],o=this.getTouchData(n);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(o)}},r.prototype.processTouchEnd=function(t,e){e?(this.dispatchEvent(t,"touchend",this.eventData),t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"tap",this.eventData))):t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"touchendoutside",this.eventData))},r.prototype.onTouchMove=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,r=0;i>r;r++){var n=e[r],o=this.getTouchData(n);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchMove,this.moveWhenInside),this.returnTouchData(o)}},r.prototype.processTouchMove=function(t,e){this.moveWhenInside&&!e||this.dispatchEvent(t,"touchmove",this.eventData)},r.prototype.getTouchData=function(t){var e=this.interactiveDataPool.pop();return e||(e=new o),e.identifier=t.identifier,this.mapPositionToPoint(e.global,t.clientX,t.clientY),navigator.isCocoonJS&&(e.global.x=e.global.x/this.resolution,e.global.y=e.global.y/this.resolution),t.globalX=e.global.x,t.globalY=e.global.y,e},r.prototype.returnTouchData=function(t){this.interactiveDataPool.push(t)},r.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null},n.WebGLRenderer.registerPlugin("interaction",r),n.CanvasRenderer.registerPlugin("interaction",r)},{"../core":58,"./InteractionData":139,"./interactiveTarget":142}],141:[function(t,e,i){e.exports={InteractionData:t("./InteractionData"),InteractionManager:t("./InteractionManager"),interactiveTarget:t("./interactiveTarget")}},{"./InteractionData":139,"./InteractionManager":140,"./interactiveTarget":142}],142:[function(t,e,i){var r={interactive:!1,interactiveChildren:!0,hitArea:null,buttonMode:!1,defaultCursor:"pointer",_over:!1,_isLeftDown:!1,_isRightDown:!1,_touchDown:!1};e.exports=r},{}],143:[function(t,e,i){function r(t,e){var i={},r=t.data.getElementsByTagName("info")[0],n=t.data.getElementsByTagName("common")[0];i.font=r.getAttribute("face"),i.size=parseInt(r.getAttribute("size"),10),i.lineHeight=parseInt(n.getAttribute("lineHeight"),10),i.chars={};for(var a=t.data.getElementsByTagName("char"),h=0;h<a.length;h++){var l=parseInt(a[h].getAttribute("id"),10),c=new o.Rectangle(parseInt(a[h].getAttribute("x"),10)+e.frame.x,parseInt(a[h].getAttribute("y"),10)+e.frame.y,parseInt(a[h].getAttribute("width"),10),parseInt(a[h].getAttribute("height"),10));i.chars[l]={xOffset:parseInt(a[h].getAttribute("xoffset"),10),yOffset:parseInt(a[h].getAttribute("yoffset"),10),xAdvance:parseInt(a[h].getAttribute("xadvance"),10),kerning:{},texture:new o.Texture(e.baseTexture,c)}}var u=t.data.getElementsByTagName("kerning");for(h=0;h<u.length;h++){var p=parseInt(u[h].getAttribute("first"),10),d=parseInt(u[h].getAttribute("second"),10),f=parseInt(u[h].getAttribute("amount"),10);i.chars[d]&&(i.chars[d].kerning[p]=f)}t.bitmapFont=i,s.BitmapText.fonts[i.font]=i}var n=t("resource-loader").Resource,o=t("../core"),s=t("../extras"),a=t("path");e.exports=function(){return function(t,e){if(!t.data||!t.isXml)return e();if(0===t.data.getElementsByTagName("page").length||0===t.data.getElementsByTagName("info").length||null===t.data.getElementsByTagName("info")[0].getAttribute("face"))return e();var i=a.dirname(t.url);"."===i&&(i=""),this.baseUrl&&i&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/"),i=i.replace(this.baseUrl,"")),i&&"/"!==i.charAt(i.length-1)&&(i+="/");var s=i+t.data.getElementsByTagName("page")[0].getAttribute("file");if(o.utils.TextureCache[s])r(t,o.utils.TextureCache[s]),e();else{var h={crossOrigin:t.crossOrigin,loadType:n.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata};this.add(t.name+"_image",s,h,function(i){r(t,i.texture),e()})}}}},{"../core":58,"../extras":123,path:18,"resource-loader":33}],144:[function(t,e,i){e.exports={Loader:t("./loader"),bitmapFontParser:t("./bitmapFontParser"),spritesheetParser:t("./spritesheetParser"),textureParser:t("./textureParser"),Resource:t("resource-loader").Resource}},{"./bitmapFontParser":143,"./loader":145,"./spritesheetParser":146,"./textureParser":147,"resource-loader":33}],145:[function(t,e,i){function r(t,e){n.call(this,t,e);for(var i=0;i<r._pixiMiddleware.length;++i)this.use(r._pixiMiddleware[i]())}var n=t("resource-loader"),o=t("./textureParser"),s=t("./spritesheetParser"),a=t("./bitmapFontParser");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r._pixiMiddleware=[n.middleware.parsing.blob,o,s,a],
r.addPixiMiddleware=function(t){r._pixiMiddleware.push(t)};var h=n.Resource;h.setExtensionXhrType("fnt",h.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":143,"./spritesheetParser":146,"./textureParser":147,"resource-loader":33}],146:[function(t,e,i){var r=t("resource-loader").Resource,n=t("path"),o=t("../core"),s=t("async"),a=1e3;e.exports=function(){return function(t,e){var i,h=t.name+"_image";if(!t.data||!t.isJson||!t.data.frames||this.resources[h])return e();var l={crossOrigin:t.crossOrigin,loadType:r.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata};i=t.isDataUrl?t.data.meta.image:n.dirname(t.url.replace(this.baseUrl,""))+"/"+t.data.meta.image,this.add(h,i,l,function(i){function r(e,r){for(var n=e;r>n-e&&n<c.length;){var s=c[n],a=l[s].frame;if(a){var h=null,p=null,d=new o.Rectangle(0,0,l[s].sourceSize.w/u,l[s].sourceSize.h/u);h=l[s].rotated?new o.Rectangle(a.x/u,a.y/u,a.h/u,a.w/u):new o.Rectangle(a.x/u,a.y/u,a.w/u,a.h/u),l[s].trimmed&&(p=new o.Rectangle(l[s].spriteSourceSize.x/u,l[s].spriteSourceSize.y/u,l[s].spriteSourceSize.w/u,l[s].spriteSourceSize.h/u)),t.textures[s]=new o.Texture(i.texture.baseTexture,h,d,p,l[s].rotated?2:0),o.utils.TextureCache[s]=t.textures[s]}n++}}function n(){return p*a<c.length}function h(t){r(p*a,a),p++,setTimeout(t,0)}t.textures={};var l=t.data.frames,c=Object.keys(l),u=o.utils.getResolutionOfUrl(t.url),p=0;c.length<=a?(r(0,a),e()):s.whilst(n,h,e)})}}},{"../core":58,async:16,path:18,"resource-loader":33}],147:[function(t,e,i){var r=t("../core");e.exports=function(){return function(t,e){if(t.data&&t.isImage){var i=new r.BaseTexture(t.data,null,r.utils.getResolutionOfUrl(t.url));i.imageUrl=t.url,t.texture=new r.Texture(i),r.utils.BaseTextureCache[t.url]=i,r.utils.TextureCache[t.url]=t.texture}e()}}},{"../core":58}],148:[function(t,e,i){function r(t,e,i,o,s){n.Container.call(this),this._texture=null,this.uvs=i||new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=o||new Uint16Array([0,1,3,2]),this.dirty=!0,this.indexDirty=!0,this.blendMode=n.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=s||r.DRAW_MODES.TRIANGLE_MESH,this.texture=t,this.shader=null,this._glDatas=[]}var n=t("../core"),o=t("pixi-gl-core"),s=t("./webgl/MeshShader"),a=new n.Point,h=new n.Polygon;r.prototype=Object.create(n.Container.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),r.prototype._renderWebGL=function(t){t.flush();var e=t.gl,i=this._glDatas[t.CONTEXT_UID];i||(i={shader:new s(e),vertexBuffer:o.GLBuffer.createVertexBuffer(e,this.vertices,e.STREAM_DRAW),uvBuffer:o.GLBuffer.createVertexBuffer(e,this.uvs,e.STREAM_DRAW),indexBuffer:o.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),vao:new o.VertexArrayObject(e)},i.vao=new o.VertexArrayObject(e).addIndex(i.indexBuffer).addAttribute(i.vertexBuffer,i.shader.attributes.aVertexPosition,e.FLOAT,!1,8,0).addAttribute(i.uvBuffer,i.shader.attributes.aTextureCoord,e.FLOAT,!1,8,0),this._glDatas[t.CONTEXT_UID]=i,this.indexDirty=!1),this.dirty&&(this.dirty=!1,i.uvBuffer.upload()),this.indexDirty&&(this.indexDirty=!1,i.indexBuffer.upload()),i.vertexBuffer.upload(),t.bindShader(i.shader),t.bindTexture(this._texture,0),i.shader.uniforms.translationMatrix=this.worldTransform.toArray(!0),i.shader.uniforms.alpha=this.worldAlpha;var n=this.drawMode===r.DRAW_MODES.TRIANGLE_MESH?e.TRIANGLE_STRIP:e.TRIANGLES;i.vao.bind().draw(n,this.indices.length).unbind()},r.prototype._renderCanvas=function(t){var e=t.context,i=this.worldTransform,n=t.resolution;t.roundPixels?e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n|0,i.ty*n|0):e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n,i.ty*n),this.drawMode===r.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(e):this._renderCanvasTriangles(e)},r.prototype._renderCanvasTriangleMesh=function(t){for(var e=this.vertices,i=this.uvs,r=e.length/2,n=0;r-2>n;n++){var o=2*n;this._renderCanvasDrawTriangle(t,e,i,o,o+2,o+4)}},r.prototype._renderCanvasTriangles=function(t){for(var e=this.vertices,i=this.uvs,r=this.indices,n=r.length,o=0;n>o;o+=3){var s=2*r[o],a=2*r[o+1],h=2*r[o+2];this._renderCanvasDrawTriangle(t,e,i,s,a,h)}},r.prototype._renderCanvasDrawTriangle=function(t,e,i,r,n,o){var s=this._texture.baseTexture,a=s.source,h=s.width,l=s.height,c=e[r],u=e[n],p=e[o],d=e[r+1],f=e[n+1],m=e[o+1],g=i[r]*s.width,v=i[n]*s.width,y=i[o]*s.width,x=i[r+1]*s.height,_=i[n+1]*s.height,b=i[o+1]*s.height;if(this.canvasPadding>0){var w=this.canvasPadding/this.worldTransform.a,S=this.canvasPadding/this.worldTransform.d,T=(c+u+p)/3,M=(d+f+m)/3,E=c-T,C=d-M,A=Math.sqrt(E*E+C*C);c=T+E/A*(A+w),d=M+C/A*(A+S),E=u-T,C=f-M,A=Math.sqrt(E*E+C*C),u=T+E/A*(A+w),f=M+C/A*(A+S),E=p-T,C=m-M,A=Math.sqrt(E*E+C*C),p=T+E/A*(A+w),m=M+C/A*(A+S)}t.save(),t.beginPath(),t.moveTo(c,d),t.lineTo(u,f),t.lineTo(p,m),t.closePath(),t.clip();var L=g*_+x*y+v*b-_*y-x*v-g*b,P=c*_+x*p+u*b-_*p-x*u-c*b,R=g*u+c*y+v*p-u*y-c*v-g*p,O=g*_*p+x*u*y+c*v*b-c*_*y-x*v*p-g*u*b,I=d*_+x*m+f*b-_*m-x*f-d*b,D=g*f+d*y+v*m-f*y-d*v-g*m,B=g*_*m+x*f*y+d*v*b-d*_*y-x*v*m-g*f*b;t.transform(P/L,I/L,R/L,D/L,O/L,B/L),t.drawImage(a,0,0,h*s.resolution,l*s.resolution,0,0,h,l),t.restore()},r.prototype.renderMeshFlat=function(t){var e=this.context,i=t.vertices,r=i.length/2;e.beginPath();for(var n=1;r-2>n;n++){var o=2*n,s=i[o],a=i[o+2],h=i[o+4],l=i[o+1],c=i[o+3],u=i[o+5];e.moveTo(s,l),e.lineTo(a,c),e.lineTo(h,u)}e.fillStyle="#FF0000",e.fill(),e.closePath()},r.prototype._onTextureUpdate=function(){this.updateFrame=!0},r.prototype.getBounds=function(t){if(!this._currentBounds){for(var e=t||this.worldTransform,i=e.a,r=e.b,o=e.c,s=e.d,a=e.tx,h=e.ty,l=-(1/0),c=-(1/0),u=1/0,p=1/0,d=this.vertices,f=0,m=d.length;m>f;f+=2){var g=d[f],v=d[f+1],y=i*g+o*v+a,x=s*v+r*g+h;u=u>y?y:u,p=p>x?x:p,l=y>l?y:l,c=x>c?x:c}if(u===-(1/0)||c===1/0)return n.Rectangle.EMPTY;var _=this._bounds;_.x=u,_.width=l-u,_.y=p,_.height=c-p,this._currentBounds=_}return this._currentBounds},r.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,a);var e,i,n=this.vertices,o=h.points;if(this.drawMode===r.DRAW_MODES.TRIANGLES){var s=this.indices;for(i=this.indices.length,e=0;i>e;e+=3){var l=2*s[e],c=2*s[e+1],u=2*s[e+2];if(o[0]=n[l],o[1]=n[l+1],o[2]=n[c],o[3]=n[c+1],o[4]=n[u],o[5]=n[u+1],h.contains(a.x,a.y))return!0}}else for(i=n.length,e=0;i>e;e+=6)if(o[0]=n[e],o[1]=n[e+1],o[2]=n[e+2],o[3]=n[e+3],o[4]=n[e+4],o[5]=n[e+5],h.contains(a.x,a.y))return!0;return!1},r.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":58,"./webgl/MeshShader":152,"pixi-gl-core":1}],149:[function(t,e,i){function r(t,e,i){n.call(this,t),this._ready=!0,this.segmentsX=e||10,this.segmentsY=i||10,this.drawMode=n.DRAW_MODES.TRIANGLES,this.refresh()}var n=t("./Mesh");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.refresh=function(){var t=this.segmentsX*this.segmentsY,e=[],i=[],r=[],n=[],o=this.texture,s=this.segmentsX-1,a=this.segmentsY-1,h=0,l=o.width/s,c=o.height/a;for(h=0;t>h;h++){var u=h%this.segmentsX,p=h/this.segmentsX|0;e.push(u*l,p*c),r.push(o._uvs.x0+(o._uvs.x1-o._uvs.x0)*(u/(this.segmentsX-1)),o._uvs.y0+(o._uvs.y3-o._uvs.y0)*(p/(this.segmentsY-1)))}var d=s*a;for(h=0;d>h;h++){var f=h%s,m=h/s|0,g=m*this.segmentsX+f,v=m*this.segmentsX+f+1,y=(m+1)*this.segmentsX+f,x=(m+1)*this.segmentsX+f+1;n.push(g,v,y),n.push(v,x,y)}this.vertices=new Float32Array(e),this.uvs=new Float32Array(r),this.colors=new Float32Array(i),this.indices=new Uint16Array(n),this.indexDirty=!0},r.prototype._onTextureUpdate=function(){n.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()}},{"./Mesh":148}],150:[function(t,e,i){function r(t,e){n.call(this,t),this.points=e,this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length),this._ready=!0,this.refresh()}var n=t("./Mesh"),o=t("../core");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){var e=this.uvs,i=this.indices,r=this.colors,n=this._texture._uvs,s=new o.Point(n.x0,n.y0),a=new o.Point(n.x2-n.x0,n.y2-n.y0);e[0]=0+s.x,e[1]=0+s.y,e[2]=0+s.x,e[3]=1*a.y+s.y,r[0]=1,r[1]=1,i[0]=0,i[1]=1;for(var h,l,c,u=t.length,p=1;u>p;p++)h=t[p],l=4*p,c=p/(u-1),e[l]=c*a.x+s.x,e[l+1]=0+s.y,e[l+2]=c*a.x+s.x,e[l+3]=1*a.y+s.y,l=2*p,r[l]=1,r[l+1]=1,l=2*p,i[l]=l,i[l+1]=l+1;this.dirty=!0,this.indexDirty=!0}},r.prototype._onTextureUpdate=function(){n.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},r.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e,i,r,n,o,s,a=t[0],h=0,l=0,c=this.vertices,u=t.length,p=0;u>p;p++)i=t[p],r=4*p,e=p<t.length-1?t[p+1]:i,l=-(e.x-a.x),h=e.y-a.y,n=10*(1-p/(u-1)),n>1&&(n=1),o=Math.sqrt(h*h+l*l),s=this._texture.height/2,h/=o,l/=o,h*=s,l*=s,c[r]=i.x+h,c[r+1]=i.y+l,c[r+2]=i.x-h,c[r+3]=i.y-l,a=i;this.containerUpdateTransform()}}},{"../core":58,"./Mesh":148}],151:[function(t,e,i){e.exports={Mesh:t("./Mesh"),Plane:t("./Plane"),Rope:t("./Rope"),MeshShader:t("./webgl/MeshShader")}},{"./Mesh":148,"./Plane":149,"./Rope":150,"./webgl/MeshShader":152}],152:[function(t,e,i){function r(t){n.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"))}var n=t("../../core/Shader");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r},{"../../core/Shader":39}],153:[function(t,e,i){function r(t,e,i){n.Container.call(this),i=i||15e3,t=t||15e3;var r=16384;i>r&&(i=r),i>t&&(i=t),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._glBuffers=[],this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=n.BLEND_MODES.NORMAL,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e)}var n=t("../core");r.prototype=Object.create(n.Container.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},r.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},r.prototype.renderWebGL=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){this.onChildrenChange(0)},this)),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},r.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},r.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,r=!0,n=0,o=0,s=0,a=0,h=t.blendModes[this.blendMode];h!==e.globalCompositeOperation&&(e.globalCompositeOperation=h),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var c=this.children[l];if(c.visible){var u=c.texture.frame;if(e.globalAlpha=this.worldAlpha*c.alpha,c.rotation%(2*Math.PI)===0)r&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),r=!1),n=c.anchor.x*(-u.width*c.scale.x)+c.position.x+.5,o=c.anchor.y*(-u.height*c.scale.y)+c.position.y+.5,s=u.width*c.scale.x,a=u.height*c.scale.y;else{r||(r=!0),c.displayObjectUpdateTransform();var p=c.worldTransform;t.roundPixels?e.setTransform(p.a,p.b,p.c,p.d,0|p.tx,0|p.ty):e.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),n=c.anchor.x*-u.width+.5,o=c.anchor.y*-u.height+.5,s=u.width,a=u.height}e.drawImage(c.texture.baseTexture.source,u.x,u.y,u.width,u.height,n,o,s,a)}}}},r.prototype.destroy=function(){if(n.Container.prototype.destroy.apply(this,arguments),this._buffers)for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._properties=null,this._buffers=null}},{"../core":58}],154:[function(t,e,i){e.exports={ParticleContainer:t("./ParticleContainer"),ParticleRenderer:t("./webgl/ParticleRenderer")}},{"./ParticleContainer":153,"./webgl/ParticleRenderer":156}],155:[function(t,e,i){function r(t,e,i,r){this.gl=t,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var n=0;n<e.length;n++){var o=e[n];i[n]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}var n=t("pixi-gl-core"),o=t("../../core/utils/createIndicesForQuads");r.prototype.constructor=r,e.exports=r,r.prototype.initBuffers=function(){var t,e,i=this.gl,r=0;for(this.indices=o(this.size),this.indexBuffer=n.GLBuffer.createIndexBuffer(i,this.indices,i.STATIC_DRAW),this.dynamicStride=0,t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],e.offset=r,r+=e.size,this.dynamicStride+=e.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=n.GLBuffer.createVertexBuffer(i,this.dynamicData,i.STREAM_DRAW);var s=0;for(this.staticStride=0,t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],e.offset=s,s+=e.size,this.staticStride+=e.size;for(this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=n.GLBuffer.createVertexBuffer(i,this.staticData,i.STATIC_DRAW),this.vao=new n.VertexArrayObject(i).addIndex(this.indexBuffer),t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],this.vao.addAttribute(this.dynamicBuffer,e.attribute,i.FLOAT,!1,4*this.dynamicStride,4*e.offset);for(t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],this.vao.addAttribute(this.staticBuffer,e.attribute,i.FLOAT,!1,4*this.staticStride,4*e.offset)},r.prototype.uploadDynamic=function(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var n=this.dynamicProperties[r];n.uploadFunction(t,e,i,this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer.upload()},r.prototype.uploadStatic=function(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var n=this.staticProperties[r];n.uploadFunction(t,e,i,this.staticData,this.staticStride,n.offset)}this.staticBuffer.upload()},r.prototype.bind=function(){this.vao.bind()},r.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.dynamicBuffer.destroy(),this.staticProperties=null,this.staticData=null,this.staticBuffer.destroy()}},{"../../core/utils/createIndicesForQuads":108,"pixi-gl-core":1}],156:[function(t,e,i){function r(t){n.ObjectRenderer.call(this,t),this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new n.Matrix,this.CONTEXT_UID=0}var n=t("../../core"),o=t("./ParticleShader"),s=t("./ParticleBuffer");r.prototype=Object.create(n.ObjectRenderer.prototype),r.prototype.constructor=r,e.exports=r,n.WebGLRenderer.registerPlugin("particle",r),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new o(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},r.prototype.start=function(){this.renderer.bindShader(this.shader)},r.prototype.render=function(t){var e=t.children,i=e.length,r=t._maxSize,n=t._batchSize;if(0!==i){i>r&&(i=r);var o=t._glBuffers[this.renderer.CONTEXT_UID];o||(o=t._glBuffers[this.renderer.CONTEXT_UID]=this.generateBuffers(t)),this.renderer.setBlendMode(t.blendMode);var s=this.renderer.gl,a=t.worldTransform.copy(this.tempMatrix);a.prepend(this.renderer._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=a.toArray(!0),this.shader.uniforms.uAlpha=t.worldAlpha;var h=e[0]._texture.baseTexture;this.renderer.bindTexture(h);for(var l=0,c=0;i>l;l+=n,c+=1){var u=i-l;u>n&&(u=n);var p=o[c];p.uploadDynamic(e,l,u),t._bufferToUpdate===c&&(p.uploadStatic(e,l,u),t._bufferToUpdate=c+1),p.vao.bind().draw(s.TRIANGLES,6*u).unbind()}}},r.prototype.generateBuffers=function(t){var e,i=this.renderer.gl,r=[],n=t._maxSize,o=t._batchSize,a=t._properties;for(e=0;n>e;e+=o)r.push(new s(i,this.properties,a,o));return r},r.prototype.uploadVertices=function(t,e,i,r,n,o){for(var s,a,h,l,c,u,p,d,f,m,g=0;i>g;g++)s=t[e+g],a=s._texture,c=s.scale.x,u=s.scale.y,h=a.trim,l=a.orig,h?(d=h.x-s.anchor.x*l.width,p=d+h.width,m=h.y-s.anchor.y*l.height,f=m+h.height):(p=l.width*(1-s.anchor.x),d=l.width*-s.anchor.x,f=l.height*(1-s.anchor.y),m=l.height*-s.anchor.y),r[o]=d*c,r[o+1]=m*u,r[o+n]=p*c,r[o+n+1]=m*u,r[o+2*n]=p*c,r[o+2*n+1]=f*u,r[o+3*n]=d*c,r[o+3*n+1]=f*u,o+=4*n},r.prototype.uploadPosition=function(t,e,i,r,n,o){for(var s=0;i>s;s++){var a=t[e+s].position;r[o]=a.x,r[o+1]=a.y,r[o+n]=a.x,r[o+n+1]=a.y,r[o+2*n]=a.x,r[o+2*n+1]=a.y,r[o+3*n]=a.x,r[o+3*n+1]=a.y,o+=4*n}},r.prototype.uploadRotation=function(t,e,i,r,n,o){for(var s=0;i>s;s++){var a=t[e+s].rotation;r[o]=a,r[o+n]=a,r[o+2*n]=a,r[o+3*n]=a,o+=4*n}},r.prototype.uploadUvs=function(t,e,i,r,n,o){for(var s=0;i>s;s++){var a=t[e+s]._texture._uvs;a?(r[o]=a.x0,r[o+1]=a.y0,r[o+n]=a.x1,r[o+n+1]=a.y1,r[o+2*n]=a.x2,r[o+2*n+1]=a.y2,r[o+3*n]=a.x3,r[o+3*n+1]=a.y3,o+=4*n):(r[o]=0,r[o+1]=0,r[o+n]=0,r[o+n+1]=0,r[o+2*n]=0,r[o+2*n+1]=0,r[o+3*n]=0,r[o+3*n+1]=0,o+=4*n)}},r.prototype.uploadAlpha=function(t,e,i,r,n,o){for(var s=0;i>s;s++){var a=t[e+s].alpha;r[o]=a,r[o+n]=a,r[o+2*n]=a,r[o+3*n]=a,o+=4*n}},r.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),n.ObjectRenderer.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null}},{"../../core":58,"./ParticleBuffer":155,"./ParticleShader":157}],157:[function(t,e,i){function r(t){n.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"))}var n=t("../../core/Shader");r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r},{"../../core/Shader":39}],158:[function(t,e,i){Math.sign||(Math.sign=function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1})},{}],159:[function(t,e,i){Object.assign||(Object.assign=t("object-assign"))},{"object-assign":28}],160:[function(t,e,i){t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":158,"./Object.assign":159,"./requestAnimationFrame":161}],161:[function(t,i,r){(function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var i=Date.now(),r=["ms","moz","webkit","o"],n=0;n<r.length&&!t.requestAnimationFrame;++n)t.requestAnimationFrame=t[r[n]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[r[n]+"CancelAnimationFrame"]||t[r[n]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),r=16+i-e;return 0>r&&(r=0),i=e,setTimeout(function(){i=Date.now(),t(performance.now())},r)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}).call(this,"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[138])(138)})}).call(e,function(){return this}(),i(8).setImmediate)},function(t,e,i){(function(t,r){function n(t,e){this._id=t,this._clearFn=e}var o=i(9).nextTick,s=Function.prototype.apply,a=Array.prototype.slice,h={},l=0;e.setTimeout=function(){return new n(s.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new n(s.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var i=l++,r=arguments.length<2?!1:a.call(arguments,1);return h[i]=!0,o(function(){h[i]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(i))}),i},e.clearImmediate="function"==typeof r?r:function(t){delete h[t]}}).call(e,i(8).setImmediate,i(8).clearImmediate)},function(t,e){function i(){l=!1,s.length?h=s.concat(h):c=-1,h.length&&r()}function r(){if(!l){var t=setTimeout(i);l=!0;for(var e=h.length;e;){for(s=h,h=[];++c<e;)s&&s[c].run();c=-1,e=h.length}s=null,l=!1,clearTimeout(t)}}function n(t,e){this.fun=t,this.array=e}function o(){}var s,a=t.exports={},h=[],l=!1,c=-1;a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new n(t,e)),1!==h.length||l||setTimeout(r,0)},n.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=o,a.addListener=o,a.once=o,a.off=o,a.removeListener=o,a.removeAllListeners=o,a.emit=o,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(t,e,i){var r,n,o={REVISION:"75"};r=o,n="function"==typeof r?r.call(e,i,e,t):r,!(void 0!==n&&(t.exports=n)),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),i=1,r=arguments.length;i!==r;++i){var n=arguments[i];if(void 0!==n&&null!==n){n=Object(n);for(var o=Object.keys(n),s=0,a=o.length;s!==a;++s){var h=o[s],l=Object.getOwnPropertyDescriptor(n,h);void 0!==l&&l.enumerable&&(e[h]=n[h])}}}return e}}),o.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},o.CullFaceNone=0,o.CullFaceBack=1,o.CullFaceFront=2,o.CullFaceFrontBack=3,o.FrontFaceDirectionCW=0,o.FrontFaceDirectionCCW=1,o.BasicShadowMap=0,o.PCFShadowMap=1,o.PCFSoftShadowMap=2,o.FrontSide=0,o.BackSide=1,o.DoubleSide=2,o.FlatShading=1,o.SmoothShading=2,o.NoColors=0,o.FaceColors=1,o.VertexColors=2,o.NoBlending=0,o.NormalBlending=1,o.AdditiveBlending=2,o.SubtractiveBlending=3,o.MultiplyBlending=4,o.CustomBlending=5,o.AddEquation=100,o.SubtractEquation=101,o.ReverseSubtractEquation=102,o.MinEquation=103,o.MaxEquation=104,o.ZeroFactor=200,o.OneFactor=201,o.SrcColorFactor=202,o.OneMinusSrcColorFactor=203,o.SrcAlphaFactor=204,o.OneMinusSrcAlphaFactor=205,o.DstAlphaFactor=206,o.OneMinusDstAlphaFactor=207,o.DstColorFactor=208,o.OneMinusDstColorFactor=209,o.SrcAlphaSaturateFactor=210,o.NeverDepth=0,o.AlwaysDepth=1,o.LessDepth=2,o.LessEqualDepth=3,o.EqualDepth=4,o.GreaterEqualDepth=5,o.GreaterDepth=6,o.NotEqualDepth=7,o.MultiplyOperation=0,o.MixOperation=1,o.AddOperation=2,o.NoToneMapping=0,o.LinearToneMapping=1,o.ReinhardToneMapping=2,o.Uncharted2ToneMapping=3,o.CineonToneMapping=4,o.UVMapping=300,o.CubeReflectionMapping=301,o.CubeRefractionMapping=302,o.EquirectangularReflectionMapping=303,o.EquirectangularRefractionMapping=304,o.SphericalReflectionMapping=305,o.CubeUVReflectionMapping=306,o.CubeUVRefractionMapping=307,o.RepeatWrapping=1e3,o.ClampToEdgeWrapping=1001,o.MirroredRepeatWrapping=1002,o.NearestFilter=1003,o.NearestMipMapNearestFilter=1004,o.NearestMipMapLinearFilter=1005,o.LinearFilter=1006,o.LinearMipMapNearestFilter=1007,o.LinearMipMapLinearFilter=1008,o.UnsignedByteType=1009,o.ByteType=1010,o.ShortType=1011,o.UnsignedShortType=1012,o.IntType=1013,o.UnsignedIntType=1014,o.FloatType=1015,o.HalfFloatType=1025,o.UnsignedShort4444Type=1016,o.UnsignedShort5551Type=1017,o.UnsignedShort565Type=1018,o.AlphaFormat=1019,o.RGBFormat=1020,o.RGBAFormat=1021,o.LuminanceFormat=1022,o.LuminanceAlphaFormat=1023,o.RGBEFormat=o.RGBAFormat,o.RGB_S3TC_DXT1_Format=2001,o.RGBA_S3TC_DXT1_Format=2002,o.RGBA_S3TC_DXT3_Format=2003,o.RGBA_S3TC_DXT5_Format=2004,o.RGB_PVRTC_4BPPV1_Format=2100,o.RGB_PVRTC_2BPPV1_Format=2101,o.RGBA_PVRTC_4BPPV1_Format=2102,o.RGBA_PVRTC_2BPPV1_Format=2103,o.RGB_ETC1_Format=2151,o.LoopOnce=2200,o.LoopRepeat=2201,o.LoopPingPong=2202,o.InterpolateDiscrete=2300,o.InterpolateLinear=2301,o.InterpolateSmooth=2302,o.ZeroCurvatureEnding=2400,o.ZeroSlopeEnding=2401,o.WrapAroundEnding=2402,o.TrianglesDrawMode=0,o.TriangleStripDrawMode=1,o.TriangleFanDrawMode=2,o.LinearEncoding=3e3,o.sRGBEncoding=3001,o.GammaEncoding=3007,o.RGBEEncoding=3002,o.LogLuvEncoding=3003,o.RGBM7Encoding=3004,o.RGBM16Encoding=3005,o.RGBDEncoding=3006,o.Color=function(t){return 3===arguments.length?this.fromArray(arguments):this.set(t)},o.Color.prototype={constructor:o.Color,r:1,g:1,b:1,set:function(t){return t instanceof o.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){this.r=t,this.g=t,this.b=t},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+6*(e-t)*(2/3-i):t}return function(e,i,r){if(e=o.Math.euclideanModulo(e,1),i=o.Math.clamp(i,0,1),r=o.Math.clamp(r,0,1),0===i)this.r=this.g=this.b=r;else{var n=.5>=r?r*(1+i):r+i-r*i,s=2*r-n;this.r=t(s,n,e+1/3),this.g=t(s,n,e),this.b=t(s,n,e-1/3)}return this}}(),setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)<1}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,n=i[1],s=i[2];switch(n){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){var a=parseFloat(r[1])/360,h=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,h,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=i[1],u=c.length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(t&&t.length>0){var c=o.ColorKeywords[t];void 0!==c&&this.setHex(c)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,r=t||{h:0,s:0,l:0},n=this.r,o=this.g,s=this.b,a=Math.max(n,o,s),h=Math.min(n,o,s),l=(h+a)/2;if(h===a)e=0,i=0;else{var c=a-h;switch(i=.5>=l?c/(a+h):c/(2-a-h),a){case n:e=(o-s)/c+(s>o?6:0);break;case o:e=(s-n)/c+2;break;case s:e=(n-o)/c+4}e/=6}return r.h=e,r.s=i,r.l=l,r},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var r=this.getHSL();return r.h+=t,r.s+=e,r.l+=i,this.setHSL(r.h,r.s,r.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},o.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,
darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},o.Quaternion=function(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==r?r:1},o.Quaternion.prototype={constructor:o.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(t instanceof o.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),r=Math.cos(t._y/2),n=Math.cos(t._z/2),s=Math.sin(t._x/2),a=Math.sin(t._y/2),h=Math.sin(t._z/2),l=t.order;return"XYZ"===l?(this._x=s*r*n+i*a*h,this._y=i*a*n-s*r*h,this._z=i*r*h+s*a*n,this._w=i*r*n-s*a*h):"YXZ"===l?(this._x=s*r*n+i*a*h,this._y=i*a*n-s*r*h,this._z=i*r*h-s*a*n,this._w=i*r*n+s*a*h):"ZXY"===l?(this._x=s*r*n-i*a*h,this._y=i*a*n+s*r*h,this._z=i*r*h+s*a*n,this._w=i*r*n-s*a*h):"ZYX"===l?(this._x=s*r*n-i*a*h,this._y=i*a*n+s*r*h,this._z=i*r*h-s*a*n,this._w=i*r*n+s*a*h):"YZX"===l?(this._x=s*r*n+i*a*h,this._y=i*a*n+s*r*h,this._z=i*r*h-s*a*n,this._w=i*r*n-s*a*h):"XZY"===l&&(this._x=s*r*n-i*a*h,this._y=i*a*n-s*r*h,this._z=i*r*h+s*a*n,this._w=i*r*n+s*a*h),e!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,r=Math.sin(i);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,r=i[0],n=i[4],o=i[8],s=i[1],a=i[5],h=i[9],l=i[2],c=i[6],u=i[10],p=r+a+u;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(c-h)*e,this._y=(o-l)*e,this._z=(s-n)*e):r>a&&r>u?(e=2*Math.sqrt(1+r-a-u),this._w=(c-h)/e,this._x=.25*e,this._y=(n+s)/e,this._z=(o+l)/e):a>u?(e=2*Math.sqrt(1+a-r-u),this._w=(o-l)/e,this._x=(n+s)/e,this._y=.25*e,this._z=(h+c)/e):(e=2*Math.sqrt(1+u-r-a),this._w=(s-n)/e,this._x=(o+l)/e,this._y=(h+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e,i=1e-6;return function(r,n){return void 0===t&&(t=new o.Vector3),e=r.dot(n)+1,i>e?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var i=t._x,r=t._y,n=t._z,o=t._w,s=e._x,a=e._y,h=e._z,l=e._w;return this._x=i*l+o*s+r*h-n*a,this._y=r*l+o*a+n*s-i*h,this._z=n*l+o*h+i*a-r*s,this._w=o*l-i*s-r*a-n*h,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,r=this._y,n=this._z,o=this._w,s=o*t._w+i*t._x+r*t._y+n*t._z;if(0>s?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=i,this._y=r,this._z=n,this;var a=Math.sqrt(1-s*s);if(Math.abs(a)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(r+this._y),this._z=.5*(n+this._z),this;var h=Math.atan2(a,s),l=Math.sin((1-e)*h)/a,c=Math.sin(e*h)/a;return this._w=o*l+this._w*c,this._x=i*l+this._x*c,this._y=r*l+this._y*c,this._z=n*l+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(o.Quaternion,{slerp:function(t,e,i,r){return i.copy(t).slerp(e,r)},slerpFlat:function(t,e,i,r,n,o,s){var a=i[r+0],h=i[r+1],l=i[r+2],c=i[r+3],u=n[o+0],p=n[o+1],d=n[o+2],f=n[o+3];if(c!==f||a!==u||h!==p||l!==d){var m=1-s,g=a*u+h*p+l*d+c*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),_=Math.atan2(x,g*v);m=Math.sin(m*_)/x,s=Math.sin(s*_)/x}var b=s*v;if(a=a*m+u*b,h=h*m+p*b,l=l*m+d*b,c=c*m+f*b,m===1-s){var w=1/Math.sqrt(a*a+h*h+l*l+c*c);a*=w,h*=w,l*=w,c*=w}}t[e]=a,t[e+1]=h,t[e+2]=l,t[e+3]=c}}),o.Vector2=function(t,e){this.x=t||0,this.y=e||0},o.Vector2.prototype={constructor:o.Vector2,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(i,r){return void 0===t&&(t=new o.Vector2,e=new o.Vector2),t.set(i,i),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=this.x-t.x,o=this.y-t.y;return this.x=n*i-o*r+t.x,this.y=n*r+o*i+t.y,this}},o.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},o.Vector3.prototype={constructor:o.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return e instanceof o.Euler==!1,void 0===t&&(t=new o.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,i){return void 0===t&&(t=new o.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,i)),this}}(),applyMatrix3:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6]*r,this.y=n[1]*e+n[4]*i+n[7]*r,this.z=n[2]*e+n[5]*i+n[8]*r,this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[4]*i+n[8]*r+n[12],this.y=n[1]*e+n[5]*i+n[9]*r+n[13],this.z=n[2]*e+n[6]*i+n[10]*r+n[14],this},applyProjection:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements,o=1/(n[3]*e+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*e+n[4]*i+n[8]*r+n[12])*o,this.y=(n[1]*e+n[5]*i+n[9]*r+n[13])*o,this.z=(n[2]*e+n[6]*i+n[10]*r+n[14])*o,this},applyQuaternion:function(t){var e=this.x,i=this.y,r=this.z,n=t.x,o=t.y,s=t.z,a=t.w,h=a*e+o*r-s*i,l=a*i+s*e-n*r,c=a*r+n*i-o*e,u=-n*e-o*i-s*r;return this.x=h*a+u*-n+l*-s-c*-o,this.y=l*a+u*-o+c*-n-h*-s,this.z=c*a+u*-s+h*-o-l*-n,this},project:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[4]*i+n[8]*r,this.y=n[1]*e+n[5]*i+n[9]*r,this.z=n[2]*e+n[6]*i+n[10]*r,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(i,r){return void 0===t&&(t=new o.Vector3,e=new o.Vector3),t.set(i,i,i),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},cross:function(t,e){if(void 0!==e)return this.crossVectors(t,e);var i=this.x,r=this.y,n=this.z;return this.x=r*t.z-n*t.y,this.y=n*t.x-i*t.z,this.z=i*t.y-r*t.x,this},crossVectors:function(t,e){var i=t.x,r=t.y,n=t.z,o=e.x,s=e.y,a=e.z;return this.x=r*a-n*s,this.y=n*o-i*a,this.z=i*s-r*o,this},projectOnVector:function(){var t,e;return function(i){return void 0===t&&(t=new o.Vector3),t.copy(i).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e)}}(),projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new o.Vector3),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new o.Vector3),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(o.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return e*e+i*i+r*r},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=r,this},setFromMatrixColumn:function(t,e){return"number"==typeof t&&(t=arguments[1],e=arguments[0]),this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},o.Vector4=function(t,e,i,r){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1},o.Vector4.prototype={constructor:o.Vector4,set:function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=this.w,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*r+o[12]*n,this.y=o[1]*e+o[5]*i+o[9]*r+o[13]*n,this.z=o[2]*e+o[6]*i+o[10]*r+o[14]*n,this.w=o[3]*e+o[7]*i+o[11]*r+o[15]*n,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,r,n,o=.01,s=.1,a=t.elements,h=a[0],l=a[4],c=a[8],u=a[1],p=a[5],d=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(l-u)<o&&Math.abs(c-f)<o&&Math.abs(d-m)<o){if(Math.abs(l+u)<s&&Math.abs(c+f)<s&&Math.abs(d+m)<s&&Math.abs(h+p+g-3)<s)return this.set(1,0,0,0),this;e=Math.PI;var v=(h+1)/2,y=(p+1)/2,x=(g+1)/2,_=(l+u)/4,b=(c+f)/4,w=(d+m)/4;return v>y&&v>x?o>v?(i=0,r=.707106781,n=.707106781):(i=Math.sqrt(v),r=_/i,n=b/i):y>x?o>y?(i=.707106781,r=0,n=.707106781):(r=Math.sqrt(y),i=_/r,n=w/r):o>x?(i=.707106781,r=.707106781,n=0):(n=Math.sqrt(x),i=b/n,r=w/n),this.set(i,r,n,e),this}var S=Math.sqrt((m-d)*(m-d)+(c-f)*(c-f)+(u-l)*(u-l));return Math.abs(S)<.001&&(S=1),this.x=(m-d)/S,this.y=(c-f)/S,this.z=(u-l)/S,this.w=Math.acos((h+p+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,r){return void 0===t&&(t=new o.Vector4,e=new o.Vector4),t.set(i,i,i,i),e.set(r,r,r,r),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},o.Euler=function(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._order=r||o.Euler.DefaultOrder},o.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],o.Euler.DefaultOrder="XYZ",o.Euler.prototype={constructor:o.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var r=o.Math.clamp,n=t.elements,s=n[0],a=n[4],h=n[8],l=n[1],c=n[5],u=n[9],p=n[2],d=n[6],f=n[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(h,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-p,s),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-p,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s))):"ZYX"===e?(this._y=Math.asin(-r(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(h,f))):"XZY"===e&&(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(h,s)):(this._x=Math.atan2(-u,f),this._y=0)),this._order=e,i!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,i,r){return void 0===t&&(t=new o.Matrix4),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,r),this}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new o.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new o.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},o.Line3=function(t,e){this.start=void 0!==t?t:new o.Vector3,this.end=void 0!==e?e:new o.Vector3},o.Line3.prototype={constructor:o.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){var e=t||new o.Vector3;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new o.Vector3;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new o.Vector3;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new o.Vector3,e=new o.Vector3;return function(i,r){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var n=e.dot(e),s=e.dot(t),a=s/n;return r&&(a=o.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,i){var r=this.closestPointToPointParameter(t,e),n=i||new o.Vector3;return this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},o.Box2=function(t,e){this.min=void 0!==t?t:new o.Vector2(+(1/0),+(1/0)),this.max=void 0!==e?e:new o.Vector2(-(1/0),-(1/0))},o.Box2.prototype={constructor:o.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;i>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new o.Vector2;return function(e,i){var r=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=+(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){var e=t||new o.Vector2;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new o.Vector2;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){var i=e||new o.Vector2;return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){var i=e||new o.Vector2;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new o.Vector2;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},o.Box3=function(t,e){this.min=void 0!==t?t:new o.Vector3(+(1/0),+(1/0),+(1/0)),this.max=void 0!==e?e:new o.Vector3(-(1/0),-(1/0),-(1/0))},o.Box3.prototype={constructor:o.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){this.makeEmpty();for(var e=+(1/0),i=+(1/0),r=+(1/0),n=-(1/0),o=-(1/0),s=-(1/0),a=0,h=t.length;h>a;a+=3){var l=t[a],c=t[a+1],u=t[a+2];e>l&&(e=l),i>c&&(i=c),r>u&&(r=u),l>n&&(n=l),c>o&&(o=c),u>s&&(s=u)}this.min.set(e,i,r),this.max.set(n,o,s)},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;i>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new o.Vector3;return function(e,i){var r=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(){var t;return function(e){void 0===t&&(t=new o.Box3);var i=this;return this.makeEmpty(),e.updateMatrixWorld(!0),e.traverse(function(e){var r=e.geometry;void 0!==r&&(null===r.boundingBox&&r.computeBoundingBox(),r.boundingBox.isEmpty()===!1&&(t.copy(r.boundingBox),t.applyMatrix4(e.matrixWorld),i.union(t)))}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){var e=t||new o.Vector3;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new o.Vector3;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z);
},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){var i=e||new o.Vector3;return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new o.Vector3),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},clampPoint:function(t,e){var i=e||new o.Vector3;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new o.Vector3;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new o.Vector3;return function(e){var i=e||new o.Sphere;return i.center=this.center(),i.radius=.5*this.size(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},o.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0},o.Matrix3.prototype={constructor:o.Matrix3,set:function(t,e,i,r,n,o,s,a,h){var l=this.elements;return l[0]=t,l[1]=r,l[2]=s,l[3]=e,l[4]=n,l[5]=a,l[6]=i,l[7]=o,l[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(){var t;return function(e,i,r){void 0===t&&(t=new o.Vector3),void 0===i&&(i=0),void 0===r&&(r=e.length);for(var n=0,s=i;r>n;n+=3,s+=3)t.fromArray(e,s),t.applyMatrix3(this),t.toArray(e,s);return e}}(),applyToBuffer:function(){var t;return function(e,i,r){void 0===t&&(t=new o.Vector3),void 0===i&&(i=0),void 0===r&&(r=e.length/e.itemSize);for(var n=0,s=i;r>n;n++,s++)t.x=e.getX(s),t.y=e.getY(s),t.z=e.getZ(s),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],s=t[5],a=t[6],h=t[7],l=t[8];return e*o*l-e*s*h-i*n*l+i*s*a+r*n*h-r*o*a},getInverse:function(t,e){t instanceof o.Matrix4;var i=t.elements,r=this.elements,n=i[0],s=i[1],a=i[2],h=i[3],l=i[4],c=i[5],u=i[6],p=i[7],d=i[8],f=d*l-c*p,m=c*u-d*h,g=p*h-l*u,v=n*f+s*m+a*g;if(0===v){var y="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(y);return this.identity()}return r[0]=f,r[1]=a*p-d*s,r[2]=c*s-a*l,r[3]=m,r[4]=d*n-a*u,r[5]=a*h-c*n,r[6]=g,r[7]=s*u-p*n,r[8]=l*n-s*h,this.multiplyScalar(1/v)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},o.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0},o.Matrix4.prototype={constructor:o.Matrix4,set:function(t,e,i,r,n,o,s,a,h,l,c,u,p,d,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=r,g[1]=n,g[5]=o,g[9]=s,g[13]=a,g[2]=h,g[6]=l,g[10]=c,g[14]=u,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new o.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new o.Vector3);var i=this.elements,r=e.elements,n=1/t.setFromMatrixColumn(e,0).length(),s=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[8]=r[8]*a,i[9]=r[9]*a,i[10]=r[10]*a,this}}(),makeRotationFromEuler:function(t){t instanceof o.Euler==!1;var e=this.elements,i=t.x,r=t.y,n=t.z,s=Math.cos(i),a=Math.sin(i),h=Math.cos(r),l=Math.sin(r),c=Math.cos(n),u=Math.sin(n);if("XYZ"===t.order){var p=s*c,d=s*u,f=a*c,m=a*u;e[0]=h*c,e[4]=-h*u,e[8]=l,e[1]=d+f*l,e[5]=p-m*l,e[9]=-a*h,e[2]=m-p*l,e[6]=f+d*l,e[10]=s*h}else if("YXZ"===t.order){var g=h*c,v=h*u,y=l*c,x=l*u;e[0]=g+x*a,e[4]=y*a-v,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-a,e[2]=v*a-y,e[6]=x+g*a,e[10]=s*h}else if("ZXY"===t.order){var g=h*c,v=h*u,y=l*c,x=l*u;e[0]=g-x*a,e[4]=-s*u,e[8]=y+v*a,e[1]=v+y*a,e[5]=s*c,e[9]=x-g*a,e[2]=-s*l,e[6]=a,e[10]=s*h}else if("ZYX"===t.order){var p=s*c,d=s*u,f=a*c,m=a*u;e[0]=h*c,e[4]=f*l-d,e[8]=p*l+m,e[1]=h*u,e[5]=m*l+p,e[9]=d*l-f,e[2]=-l,e[6]=a*h,e[10]=s*h}else if("YZX"===t.order){var _=s*h,b=s*l,w=a*h,S=a*l;e[0]=h*c,e[4]=S-_*u,e[8]=w*u+b,e[1]=u,e[5]=s*c,e[9]=-a*c,e[2]=-l*c,e[6]=b*u+w,e[10]=_-S*u}else if("XZY"===t.order){var _=s*h,b=s*l,w=a*h,S=a*l;e[0]=h*c,e[4]=-u,e[8]=l*c,e[1]=_*u+S,e[5]=s*c,e[9]=b*u-w,e[2]=w*u-b,e[6]=a*c,e[10]=S*u+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z,o=t.w,s=i+i,a=r+r,h=n+n,l=i*s,c=i*a,u=i*h,p=r*a,d=r*h,f=n*h,m=o*s,g=o*a,v=o*h;return e[0]=1-(p+f),e[4]=c-v,e[8]=u+g,e[1]=c+v,e[5]=1-(l+f),e[9]=d-m,e[2]=u-g,e[6]=d+m,e[10]=1-(l+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,i;return function(r,n,s){void 0===t&&(t=new o.Vector3),void 0===e&&(e=new o.Vector3),void 0===i&&(i=new o.Vector3);var a=this.elements;return i.subVectors(r,n).normalize(),0===i.lengthSq()&&(i.z=1),t.crossVectors(s,i).normalize(),0===t.lengthSq()&&(i.x+=1e-4,t.crossVectors(s,i).normalize()),e.crossVectors(i,t),a[0]=t.x,a[4]=e.x,a[8]=i.x,a[1]=t.y,a[5]=e.y,a[9]=i.y,a[2]=t.z,a[6]=e.z,a[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,r=e.elements,n=this.elements,o=i[0],s=i[4],a=i[8],h=i[12],l=i[1],c=i[5],u=i[9],p=i[13],d=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],x=i[11],_=i[15],b=r[0],w=r[4],S=r[8],T=r[12],M=r[1],E=r[5],C=r[9],A=r[13],L=r[2],P=r[6],R=r[10],O=r[14],I=r[3],D=r[7],B=r[11],k=r[15];return n[0]=o*b+s*M+a*L+h*I,n[4]=o*w+s*E+a*P+h*D,n[8]=o*S+s*C+a*R+h*B,n[12]=o*T+s*A+a*O+h*k,n[1]=l*b+c*M+u*L+p*I,n[5]=l*w+c*E+u*P+p*D,n[9]=l*S+c*C+u*R+p*B,n[13]=l*T+c*A+u*O+p*k,n[2]=d*b+f*M+m*L+g*I,n[6]=d*w+f*E+m*P+g*D,n[10]=d*S+f*C+m*R+g*B,n[14]=d*T+f*A+m*O+g*k,n[3]=v*b+y*M+x*L+_*I,n[7]=v*w+y*E+x*P+_*D,n[11]=v*S+y*C+x*R+_*B,n[15]=v*T+y*A+x*O+_*k,this},multiplyToArray:function(t,e,i){var r=this.elements;return this.multiplyMatrices(t,e),i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,i,r){void 0===t&&(t=new o.Vector3),void 0===i&&(i=0),void 0===r&&(r=e.length);for(var n=0,s=i;r>n;n+=3,s+=3)t.fromArray(e,s),t.applyMatrix4(this),t.toArray(e,s);return e}}(),applyToBuffer:function(){var t;return function(e,i,r){void 0===t&&(t=new o.Vector3),void 0===i&&(i=0),void 0===r&&(r=e.length/e.itemSize);for(var n=0,s=i;r>n;n++,s++)t.x=e.getX(s),t.y=e.getY(s),t.z=e.getZ(s),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],r=t[8],n=t[12],o=t[1],s=t[5],a=t[9],h=t[13],l=t[2],c=t[6],u=t[10],p=t[14],d=t[3],f=t[7],m=t[11],g=t[15];return d*(+n*a*c-r*h*c-n*s*u+i*h*u+r*s*p-i*a*p)+f*(+e*a*p-e*h*u+n*o*u-r*o*p+r*h*l-n*a*l)+m*(+e*h*c-e*s*p-n*o*c+i*o*p+n*s*l-i*h*l)+g*(-r*s*l-e*a*c+e*s*u+r*o*c-i*o*u+i*a*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},getPosition:function(){var t;return function(){return void 0===t&&(t=new o.Vector3),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,r=t.elements,n=r[0],o=r[1],s=r[2],a=r[3],h=r[4],l=r[5],c=r[6],u=r[7],p=r[8],d=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],x=r[15],_=d*y*u-v*f*u+v*c*m-l*y*m-d*c*x+l*f*x,b=g*f*u-p*y*u-g*c*m+h*y*m+p*c*x-h*f*x,w=p*v*u-g*d*u+g*l*m-h*v*m-p*l*x+h*d*x,S=g*d*c-p*v*c-g*l*f+h*v*f+p*l*y-h*d*y,T=n*_+o*b+s*w+a*S;if(0===T){var M="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(M);return this.identity()}return i[0]=_,i[1]=v*f*a-d*y*a-v*s*m+o*y*m+d*s*x-o*f*x,i[2]=l*y*a-v*c*a+v*s*u-o*y*u-l*s*x+o*c*x,i[3]=d*c*a-l*f*a-d*s*u+o*f*u+l*s*m-o*c*m,i[4]=b,i[5]=p*y*a-g*f*a+g*s*m-n*y*m-p*s*x+n*f*x,i[6]=g*c*a-h*y*a-g*s*u+n*y*u+h*s*x-n*c*x,i[7]=h*f*a-p*c*a+p*s*u-n*f*u-h*s*m+n*c*m,i[8]=w,i[9]=g*d*a-p*v*a-g*o*m+n*v*m+p*o*x-n*d*x,i[10]=h*v*a-g*l*a+g*o*u-n*v*u-h*o*x+n*l*x,i[11]=p*l*a-h*d*a-p*o*u+n*d*u+h*o*m-n*l*m,i[12]=S,i[13]=p*v*s-g*d*s+g*o*f-n*v*f-p*o*y+n*d*y,i[14]=g*l*s-h*v*s-g*o*c+n*v*c+h*o*y-n*l*y,i[15]=h*d*s-p*l*s+p*o*c-n*d*c-h*o*f+n*l*f,this.multiplyScalar(1/T)},scale:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z;return e[0]*=i,e[4]*=r,e[8]*=n,e[1]*=i,e[5]*=r,e[9]*=n,e[2]*=i,e[6]*=r,e[10]*=n,e[3]*=i,e[7]*=r,e[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=1-i,o=t.x,s=t.y,a=t.z,h=n*o,l=n*s;return this.set(h*o+i,h*s-r*a,h*a+r*s,0,h*s+r*a,l*s+i,l*a-r*o,0,h*a-r*s,l*a+r*o,n*a*a+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t,e;return function(i,r,n){void 0===t&&(t=new o.Vector3),void 0===e&&(e=new o.Matrix4);var s=this.elements,a=t.set(s[0],s[1],s[2]).length(),h=t.set(s[4],s[5],s[6]).length(),l=t.set(s[8],s[9],s[10]).length(),c=this.determinant();0>c&&(a=-a),i.x=s[12],i.y=s[13],i.z=s[14],e.elements.set(this.elements);var u=1/a,p=1/h,d=1/l;return e.elements[0]*=u,e.elements[1]*=u,e.elements[2]*=u,e.elements[4]*=p,e.elements[5]*=p,e.elements[6]*=p,e.elements[8]*=d,e.elements[9]*=d,e.elements[10]*=d,r.setFromRotationMatrix(e),n.x=a,n.y=h,n.z=l,this}}(),makeFrustum:function(t,e,i,r,n,o){var s=this.elements,a=2*n/(e-t),h=2*n/(r-i),l=(e+t)/(e-t),c=(r+i)/(r-i),u=-(o+n)/(o-n),p=-2*o*n/(o-n);return s[0]=a,s[4]=0,s[8]=l,s[12]=0,s[1]=0,s[5]=h,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=u,s[14]=p,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makePerspective:function(t,e,i,r){var n=i*Math.tan(o.Math.degToRad(.5*t)),s=-n,a=s*e,h=n*e;return this.makeFrustum(a,h,s,n,i,r)},makeOrthographic:function(t,e,i,r,n,o){var s=this.elements,a=1/(e-t),h=1/(i-r),l=1/(o-n),c=(e+t)*a,u=(i+r)*h,p=(o+n)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*h,s[9]=0,s[13]=-u,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-p,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,r=0;16>r;r++)if(e[r]!==i[r])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}},o.Ray=function(t,e){this.origin=void 0!==t?t:new o.Vector3,this.direction=void 0!==e?e:new o.Vector3},o.Ray.prototype={constructor:o.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var i=e||new o.Vector3;return i.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){this.direction.copy(t).sub(this.origin).normalize()},recast:function(){var t=new o.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new o.Vector3;i.subVectors(t,this.origin);var r=i.dot(this.direction);return 0>r?i.copy(this.origin):i.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new o.Vector3;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return 0>i?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Vector3;return function(r,n,o,s){t.copy(r).add(n).multiplyScalar(.5),e.copy(n).sub(r).normalize(),i.copy(this.origin).sub(t);var a,h,l,c,u=.5*r.distanceTo(n),p=-this.direction.dot(e),d=i.dot(this.direction),f=-i.dot(e),m=i.lengthSq(),g=Math.abs(1-p*p);if(g>0)if(a=p*f-d,h=p*d-f,c=u*g,a>=0)if(h>=-c)if(c>=h){var v=1/g;a*=v,h*=v,l=a*(a+p*h+2*d)+h*(p*a+h+2*f)+m}else h=u,a=Math.max(0,-(p*h+d)),l=-a*a+h*(h+2*f)+m;else h=-u,a=Math.max(0,-(p*h+d)),l=-a*a+h*(h+2*f)+m;else-c>=h?(a=Math.max(0,-(-p*u+d)),h=a>0?-u:Math.min(Math.max(-u,-f),u),l=-a*a+h*(h+2*f)+m):c>=h?(a=0,h=Math.min(Math.max(-u,-f),u),l=h*(h+2*f)+m):(a=Math.max(0,-(p*u+d)),h=a>0?u:Math.min(Math.max(-u,-f),u),l=-a*a+h*(h+2*f)+m);else h=p>0?-u:u,a=Math.max(0,-(p*h+d)),l=-a*a+h*(h+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(a).add(this.origin),s&&s.copy(e).multiplyScalar(h).add(t),l}}(),intersectSphere:function(){var t=new o.Vector3;return function(e,i){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),n=t.dot(t)-r*r,o=e.radius*e.radius;if(n>o)return null;var s=Math.sqrt(o-n),a=r-s,h=r+s;return 0>a&&0>h?null:0>a?this.at(h,i):this.at(a,i)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var i=t.normal.dot(this.direction);return 0>i*e},intersectBox:function(t,e){var i,r,n,o,s,a,h=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,u=this.origin;return h>=0?(i=(t.min.x-u.x)*h,r=(t.max.x-u.x)*h):(i=(t.max.x-u.x)*h,r=(t.min.x-u.x)*h),l>=0?(n=(t.min.y-u.y)*l,o=(t.max.y-u.y)*l):(n=(t.max.y-u.y)*l,o=(t.min.y-u.y)*l),i>o||n>r?null:((n>i||i!==i)&&(i=n),(r>o||r!==r)&&(r=o),c>=0?(s=(t.min.z-u.z)*c,a=(t.max.z-u.z)*c):(s=(t.max.z-u.z)*c,a=(t.min.z-u.z)*c),i>a||s>r?null:((s>i||i!==i)&&(i=s),(r>a||r!==r)&&(r=a),0>r?null:this.at(i>=0?i:r,e)))},intersectsBox:function(){var t=new o.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Vector3,r=new o.Vector3;return function(n,o,s,a,h){e.subVectors(o,n),i.subVectors(s,n),r.crossVectors(e,i);var l,c=this.direction.dot(r);if(c>0){if(a)return null;l=1}else{if(!(0>c))return null;l=-1,c=-c}t.subVectors(this.origin,n);var u=l*this.direction.dot(i.crossVectors(t,i));if(0>u)return null;var p=l*this.direction.dot(e.cross(t));if(0>p)return null;if(u+p>c)return null;var d=-l*t.dot(r);return 0>d?null:this.at(d/c,h)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},o.Sphere=function(t,e){this.center=void 0!==t?t:new o.Vector3,this.radius=void 0!==e?e:0},o.Sphere.prototype={constructor:o.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new o.Box3;return function(e,i){var r=this.center;void 0!==i?r.copy(i):t.setFromPoints(e).center(r);for(var n=0,o=0,s=e.length;s>o;o++)n=Math.max(n,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),r=e||new o.Vector3;return r.copy(t),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){var e=t||new o.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},o.Frustum=function(t,e,i,r,n,s){this.planes=[void 0!==t?t:new o.Plane,void 0!==e?e:new o.Plane,void 0!==i?i:new o.Plane,void 0!==r?r:new o.Plane,void 0!==n?n:new o.Plane,void 0!==s?s:new o.Plane]},o.Frustum.prototype={constructor:o.Frustum,set:function(t,e,i,r,n,o){var s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(i),s[3].copy(r),s[4].copy(n),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;6>i;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],h=i[5],l=i[6],c=i[7],u=i[8],p=i[9],d=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(s-r,c-a,f-u,y-m).normalize(),e[1].setComponents(s+r,c+a,f+u,y+m).normalize(),e[2].setComponents(s+n,c+h,f+p,y+g).normalize(),e[3].setComponents(s-n,c-h,f-p,y-g).normalize(),e[4].setComponents(s-o,c-l,f-d,y-v).normalize(),e[5].setComponents(s+o,c+l,f+d,y+v).normalize(),this},intersectsObject:function(){var t=new o.Sphere;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,r=-t.radius,n=0;6>n;n++){var o=e[n].distanceToPoint(i);if(r>o)return!1}return!0},intersectsBox:function(){var t=new o.Vector3,e=new o.Vector3;return function(i){for(var r=this.planes,n=0;6>n;n++){var o=r[n];t.x=o.normal.x>0?i.min.x:i.max.x,e.x=o.normal.x>0?i.max.x:i.min.x,t.y=o.normal.y>0?i.min.y:i.max.y,e.y=o.normal.y>0?i.max.y:i.min.y,t.z=o.normal.z>0?i.min.z:i.max.z,e.z=o.normal.z>0?i.max.z:i.min.z;var s=o.distanceToPoint(t),a=o.distanceToPoint(e);if(0>s&&0>a)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;6>i;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}},o.Plane=function(t,e){this.normal=void 0!==t?t:new o.Vector3(1,0,0),this.constant=void 0!==e?e:0},o.Plane.prototype={constructor:o.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,r){return this.normal.set(t,e,i),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new o.Vector3,e=new o.Vector3;return function(i,r,n){var o=t.subVectors(n,r).cross(e.subVectors(i,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t),r=e||new o.Vector3;return r.copy(this.normal).multiplyScalar(i)},intersectLine:function(){var t=new o.Vector3;return function(e,i){var r=i||new o.Vector3,n=e.delta(t),s=this.normal.dot(n);if(0!==s){var a=-(e.start.dot(this.normal)+this.constant)/s;if(!(0>a||a>1))return r.copy(n).multiplyScalar(a).add(e.start)}else if(0===this.distanceToPoint(e.start))return r.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return 0>e&&i>0||0>i&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){var e=t||new o.Vector3;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Matrix3;return function(r,n){var o=n||i.getNormalMatrix(r),s=t.copy(this.normal).applyMatrix3(o),a=this.coplanarPoint(e);return a.applyMatrix4(r),this.setFromNormalAndCoplanarPoint(s,a),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},o.Spherical=function(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this},o.Spherical.prototype={constructor:o.Spherical,set:function(t,e,i){this.radius=t,this.phi=e,this.theta=i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius.copy(t.radius),this.phi.copy(t.phi),this.theta.copy(t.theta),this},makeSafe:function(){var t=1e-6;this.phi=Math.max(t,Math.min(Math.PI-t,this.phi))},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(o.Math.clamp(t.y/this.radius,-1,1))),this}},o.Math={generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),r=0;return function(){for(var n=0;36>n;n++)8===n||13===n||18===n||23===n?i[n]="-":14===n?i[n]="4":(2>=r&&(r=33554432+16777216*Math.random()|0),t=15&r,r>>=4,i[n]=e[19===n?3&t|8:t]);return i.join("")}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,r,n){return r+(t-e)*(n-r)/(i-e)},smoothstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}(),isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}},o.Spline=function(t){function e(t,e,i,r,n,o,s){var a=.5*(i-t),h=.5*(r-e);return(2*(e-i)+a+h)*s+(-3*(e-i)-2*a-h)*o+a*n+e}this.points=t;var i,r,n,s,a,h,l,c,u,p=[],d={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,r=Math.floor(i),n=i-r,p[0]=0===r?r:r-1,p[1]=r,p[2]=r>this.points.length-2?this.points.length-1:r+1,p[3]=r>this.points.length-3?this.points.length-1:r+2,h=this.points[p[0]],l=this.points[p[1]],c=this.points[p[2]],u=this.points[p[3]],s=n*n,a=n*s,d.x=e(h.x,l.x,c.x,u.x,n,s,a),d.y=e(h.y,l.y,c.y,u.y,n,s,a),d.z=e(h.z,l.z,c.z,u.z,n,s,a),d},this.getControlPointsArray=function(){var t,e,i=this.points.length,r=[];for(t=0;i>t;t++)e=this.points[t],r[t]=[e.x,e.y,e.z];return r},this.getLength=function(t){var e,i,r,n,s=0,a=0,h=0,l=new o.Vector3,c=new o.Vector3,u=[],p=0;for(u[0]=0,t||(t=100),r=this.points.length*t,l.copy(this.points[0]),e=1;r>e;e++)i=e/r,n=this.getPoint(i),c.copy(n),p+=c.distanceTo(l),l.copy(n),s=(this.points.length-1)*i,a=Math.floor(s),a!==h&&(u[a]=p,h=a);return u[u.length]=p,{chunks:u,total:p}},this.reparametrizeByArcLength=function(t){var e,i,r,n,s,a,h,l,c=[],u=new o.Vector3,p=this.getLength();for(c.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=p.chunks[e]-p.chunks[e-1],h=Math.ceil(t*a/p.total),n=(e-1)/(this.points.length-1),s=e/(this.points.length-1),i=1;h-1>i;i++)r=n+i*(1/h)*(s-n),l=this.getPoint(r),c.push(u.copy(l).clone());c.push(u.copy(this.points[e]).clone())}this.points=c}},o.Triangle=function(t,e,i){this.a=void 0!==t?t:new o.Vector3,this.b=void 0!==e?e:new o.Vector3,this.c=void 0!==i?i:new o.Vector3},o.Triangle.normal=function(){var t=new o.Vector3;return function(e,i,r,n){var s=n||new o.Vector3;s.subVectors(r,i),t.subVectors(e,i),s.cross(t);var a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}}(),o.Triangle.barycoordFromPoint=function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Vector3;return function(r,n,s,a,h){t.subVectors(a,n),e.subVectors(s,n),i.subVectors(r,n);var l=t.dot(t),c=t.dot(e),u=t.dot(i),p=e.dot(e),d=e.dot(i),f=l*p-c*c,m=h||new o.Vector3;if(0===f)return m.set(-2,-1,-1);var g=1/f,v=(p*u-c*d)*g,y=(l*d-c*u)*g;return m.set(1-v-y,y,v)}}(),o.Triangle.containsPoint=function(){var t=new o.Vector3;return function(e,i,r,n){var s=o.Triangle.barycoordFromPoint(e,i,r,n,t);return s.x>=0&&s.y>=0&&s.x+s.y<=1}}(),o.Triangle.prototype={constructor:o.Triangle,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,r){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new o.Vector3,e=new o.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new o.Vector3;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return o.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new o.Plane;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return o.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return o.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},o.Interpolant=function(t,e,i,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(i),this.sampleValues=e,this.valueSize=i},o.Interpolant.prototype={constructor:o.Interpolant,evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,r=e[i],n=e[i-1];t:{e:{var o;i:{r:if(!(r>t)){for(var s=i+2;;){if(void 0===r){if(n>t)break r;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,n)}if(i===s)break;if(n=r,r=e[++i],r>t)break e}o=e.length;break i}{if(t>=n)break t;var a=e[1];a>t&&(i=2,n=a);for(var s=i-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(i===s)break;if(r=n,n=e[--i-1],t>=n)break e}o=i,i=0}}for(;o>i;){var h=i+o>>>1;t<e[h]?o=h:i=h+1}if(r=e[i],n=e[i-1],void 0===n)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,n,t)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=t*r,o=0;o!==r;++o)e[o]=i[n+o];return e},interpolate_:function(t,e,i,r){throw new Error("call to abstract method")},intervalChanged_:function(t,e,i){}},Object.assign(o.Interpolant.prototype,{beforeStart_:o.Interpolant.prototype.copySampleValue_,afterEnd_:o.Interpolant.prototype.copySampleValue_}),o.CubicInterpolant=function(t,e,i,r){o.Interpolant.call(this,t,e,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0},o.CubicInterpolant.prototype=Object.assign(Object.create(o.Interpolant.prototype),{constructor:o.CubicInterpolant,DefaultSettings_:{endingStart:o.ZeroCurvatureEnding,endingEnd:o.ZeroCurvatureEnding},intervalChanged_:function(t,e,i){var r=this.parameterPositions,n=t-2,s=t+1,a=r[n],h=r[s];if(void 0===a)switch(this.getSettings_().endingStart){
case o.ZeroSlopeEnding:n=t,a=2*e-i;break;case o.WrapAroundEnding:n=r.length-2,a=e+r[n]-r[n+1];break;default:n=t,a=i}if(void 0===h)switch(this.getSettings_().endingEnd){case o.ZeroSlopeEnding:s=t,h=2*i-e;break;case o.WrapAroundEnding:s=1,h=i+r[1]-r[0];break;default:s=t-1,h=e}var l=.5*(i-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(h-i),this._offsetPrev=n*c,this._offsetNext=s*c},interpolate_:function(t,e,i,r){for(var n=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,h=a-s,l=this._offsetPrev,c=this._offsetNext,u=this._weightPrev,p=this._weightNext,d=(i-e)/(r-e),f=d*d,m=f*d,g=-u*m+2*u*f-u*d,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,x=p*m-p*f,_=0;_!==s;++_)n[_]=g*o[l+_]+v*o[h+_]+y*o[a+_]+x*o[c+_];return n}}),o.DiscreteInterpolant=function(t,e,i,r){o.Interpolant.call(this,t,e,i,r)},o.DiscreteInterpolant.prototype=Object.assign(Object.create(o.Interpolant.prototype),{constructor:o.DiscreteInterpolant,interpolate_:function(t,e,i,r){return this.copySampleValue_(t-1)}}),o.LinearInterpolant=function(t,e,i,r){o.Interpolant.call(this,t,e,i,r)},o.LinearInterpolant.prototype=Object.assign(Object.create(o.Interpolant.prototype),{constructor:o.LinearInterpolant,interpolate_:function(t,e,i,r){for(var n=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,h=a-s,l=(i-e)/(r-e),c=1-l,u=0;u!==s;++u)n[u]=o[h+u]*c+o[a+u]*l;return n}}),o.QuaternionLinearInterpolant=function(t,e,i,r){o.Interpolant.call(this,t,e,i,r)},o.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(o.Interpolant.prototype),{constructor:o.QuaternionLinearInterpolant,interpolate_:function(t,e,i,r){for(var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,h=t*a,l=(i-e)/(r-e),c=h+a;h!==c;h+=4)o.Quaternion.slerpFlat(n,0,s,h-a,s,h,l);return n}}),o.Clock=function(t){this.autoStart=void 0!==t?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},o.Clock.prototype={constructor:o.Clock,start:function(){this.startTime=performance.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=performance.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},o.EventDispatcher=function(){},o.EventDispatcher.prototype={constructor:o.EventDispatcher,apply:function(t){t.addEventListener=o.EventDispatcher.prototype.addEventListener,t.hasEventListener=o.EventDispatcher.prototype.hasEventListener,t.removeEventListener=o.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=o.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,r=i[t];if(void 0!==r){var n=r.indexOf(e);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;for(var r=[],n=i.length,o=0;n>o;o++)r[o]=i[o];for(var o=0;n>o;o++)r[o].call(this,t)}}}},o.Layers=function(){this.mask=1},o.Layers.prototype={constructor:o.Layers,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}},function(t){function e(t,e){return t.distance-e.distance}function i(t,e,r,n){if(t.visible!==!1&&(t.raycast(e,r),n===!0))for(var o=t.children,s=0,a=o.length;a>s;s++)i(o[s],e,r,!0)}t.Raycaster=function(e,i,r,n){this.ray=new t.Ray(e,i),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})},t.Raycaster.prototype={constructor:t.Raycaster,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,i){i instanceof t.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize()):i instanceof t.OrthographicCamera&&(this.ray.origin.set(e.x,e.y,-1).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld))},intersectObject:function(t,r){var n=[];return i(t,this,n,r),n.sort(e),n},intersectObjects:function(t,r){var n=[];if(Array.isArray(t)===!1)return n;for(var o=0,s=t.length;s>o;o++)i(t[o],this,n,r);return n.sort(e),n}}}(o),o.Object3D=function(){function t(){n.setFromEuler(r,!1)}function e(){r.setFromQuaternion(n,void 0,!1)}Object.defineProperty(this,"id",{value:o.Object3DIdCount++}),this.uuid=o.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=o.Object3D.DefaultUp.clone();var i=new o.Vector3,r=new o.Euler,n=new o.Quaternion,s=new o.Vector3(1,1,1);r.onChange(t),n.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:i},rotation:{enumerable:!0,value:r},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:s},modelViewMatrix:{value:new o.Matrix4},normalMatrix:{value:new o.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new o.Matrix4,this.matrixWorld=new o.Matrix4,this.matrixAutoUpdate=o.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new o.Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},o.Object3D.DefaultUp=new o.Vector3(0,1,0),o.Object3D.DefaultMatrixAutoUpdate=!0,o.Object3D.prototype={constructor:o.Object3D,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new o.Quaternion;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new o.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new o.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new o.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new o.Vector3;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new o.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new o.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new o.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new o.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new o.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?this:(t instanceof o.Object3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);-1!==i&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i],o=n.getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){var e=t||new o.Vector3;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new o.Vector3,e=new o.Vector3;return function(i){var r=i||new o.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,r,e),r}}(),getWorldRotation:function(){var t=new o.Quaternion;return function(e){var i=e||new o.Euler;return this.getWorldQuaternion(t),i.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new o.Vector3,e=new o.Quaternion;return function(i){var r=i||new o.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,r),r}}(),getWorldDirection:function(){var t=new o.Quaternion;return function(e){var i=e||new o.Vector3;return this.getWorldQuaternion(t),i.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,r=e.length;r>i;i++)e[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,i=0,r=e.length;r>i;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&t!==!0||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var i in t){var r=t[i];delete r.metadata,e.push(r)}return e}var i=void 0===t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{}},r.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var n={};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),n.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),n.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),n.material=this.material.uuid),this.children.length>0){n.children=[];for(var o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(t).object)}if(i){var s=e(t.geometries),a=e(t.materials),h=e(t.textures),l=e(t.images);s.length>0&&(r.geometries=s),a.length>0&&(r.materials=a),h.length>0&&(r.textures=h),l.length>0&&(r.images=l)}return r.object=n,r},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var i=0;i<t.children.length;i++){var r=t.children[i];this.add(r.clone())}return this}},o.EventDispatcher.prototype.apply(o.Object3D.prototype),o.Object3DIdCount=0,o.Face3=function(t,e,i,r,n,s){this.a=t,this.b=e,this.c=i,this.normal=r instanceof o.Vector3?r:new o.Vector3,this.vertexNormals=Array.isArray(r)?r:[],this.color=n instanceof o.Color?n:new o.Color,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==s?s:0},o.Face3.prototype={constructor:o.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;i>e;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,i=t.vertexColors.length;i>e;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},o.BufferAttribute=function(t,e){this.uuid=o.Math.generateUUID(),this.array=t,this.itemSize=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},o.BufferAttribute.prototype={constructor:o.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var r=0,n=this.itemSize;n>r;r++)this.array[t+r]=e.array[i+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;n>r;r++){var s=t[r];void 0===s&&(s=new o.Color),e[i++]=s.r,e[i++]=s.g,e[i++]=s.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;n>r;r++){var o=t[r];e[i++]=o.a,e[i++]=o.b,e[i++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;n>r;r++){var s=t[r];void 0===s&&(s=new o.Vector2),e[i++]=s.x,e[i++]=s.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;n>r;r++){var s=t[r];void 0===s&&(s=new o.Vector3),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;n>r;r++){var s=t[r];void 0===s&&(s=new o.Vector4),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z,e[i++]=s.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=n,this},clone:function(){return(new this.constructor).copy(this)}},o.Int8Attribute=function(t,e){return new o.BufferAttribute(new Int8Array(t),e)},o.Uint8Attribute=function(t,e){return new o.BufferAttribute(new Uint8Array(t),e)},o.Uint8ClampedAttribute=function(t,e){return new o.BufferAttribute(new Uint8ClampedArray(t),e)},o.Int16Attribute=function(t,e){return new o.BufferAttribute(new Int16Array(t),e)},o.Uint16Attribute=function(t,e){return new o.BufferAttribute(new Uint16Array(t),e)},o.Int32Attribute=function(t,e){return new o.BufferAttribute(new Int32Array(t),e)},o.Uint32Attribute=function(t,e){return new o.BufferAttribute(new Uint32Array(t),e)},o.Float32Attribute=function(t,e){return new o.BufferAttribute(new Float32Array(t),e)},o.Float64Attribute=function(t,e){return new o.BufferAttribute(new Float64Array(t),e)},o.DynamicBufferAttribute=function(t,e){return new o.BufferAttribute(t,e).setDynamic(!0)},o.InstancedBufferAttribute=function(t,e,i){o.BufferAttribute.call(this,t,e),this.meshPerAttribute=i||1},o.InstancedBufferAttribute.prototype=Object.create(o.BufferAttribute.prototype),o.InstancedBufferAttribute.prototype.constructor=o.InstancedBufferAttribute,o.InstancedBufferAttribute.prototype.copy=function(t){return o.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},o.InterleavedBuffer=function(t,e){this.uuid=o.Math.generateUUID(),this.array=t,this.stride=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},o.InterleavedBuffer.prototype={constructor:o.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var r=0,n=this.stride;n>r;r++)this.array[t+r]=e.array[i+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},o.InstancedInterleavedBuffer=function(t,e,i){o.InterleavedBuffer.call(this,t,e),this.meshPerAttribute=i||1},o.InstancedInterleavedBuffer.prototype=Object.create(o.InterleavedBuffer.prototype),o.InstancedInterleavedBuffer.prototype.constructor=o.InstancedInterleavedBuffer,o.InstancedInterleavedBuffer.prototype.copy=function(t){return o.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},o.InterleavedBufferAttribute=function(t,e,i){this.uuid=o.Math.generateUUID(),this.data=t,this.itemSize=e,this.offset=i},o.InterleavedBufferAttribute.prototype={constructor:o.InterleavedBufferAttribute,get length(){return this.array.length},get count(){return this.data.count},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this.data.array[t+3]=n,this}},o.Geometry=function(){Object.defineProperty(this,"id",{value:o.GeometryIdCount++}),this.uuid=o.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},o.Geometry.prototype={constructor:o.Geometry,applyMatrix:function(t){for(var e=(new o.Matrix3).getNormalMatrix(t),i=0,r=this.vertices.length;r>i;i++){var n=this.vertices[i];n.applyMatrix4(t)}for(var i=0,r=this.faces.length;r>i;i++){var s=this.faces[i];s.normal.applyMatrix3(e).normalize();for(var a=0,h=s.vertexNormals.length;h>a;a++)s.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,r){return void 0===t&&(t=new o.Matrix4),t.makeTranslation(e,i,r),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,r){return void 0===t&&(t=new o.Matrix4),t.makeScale(e,i,r),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new o.Object3D),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,r,n){var s=void 0!==a?[u[t].clone(),u[e].clone(),u[r].clone()]:[],f=void 0!==h?[i.colors[t].clone(),i.colors[e].clone(),i.colors[r].clone()]:[],m=new o.Face3(t,e,r,s,f,n);i.faces.push(m),void 0!==l&&i.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[r].clone()]),void 0!==c&&i.faceVertexUvs[1].push([d[t].clone(),d[e].clone(),d[r].clone()])}var i=this,r=null!==t.index?t.index.array:void 0,n=t.attributes,s=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,h=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var u=[],p=[],d=[],f=0,m=0;f<s.length;f+=3,m+=2)i.vertices.push(new o.Vector3(s[f],s[f+1],s[f+2])),void 0!==a&&u.push(new o.Vector3(a[f],a[f+1],a[f+2])),void 0!==h&&i.colors.push(new o.Color(h[f],h[f+1],h[f+2])),void 0!==l&&p.push(new o.Vector2(l[m],l[m+1])),void 0!==c&&d.push(new o.Vector2(c[m],c[m+1]));if(void 0!==r){var g=t.groups;if(g.length>0)for(var f=0;f<g.length;f++)for(var v=g[f],y=v.start,x=v.count,m=y,_=y+x;_>m;m+=3)e(r[m],r[m+1],r[m+2],v.materialIndex);else for(var f=0;f<r.length;f+=3)e(r[f],r[f+1],r[f+2])}else for(var f=0;f<s.length/3;f+=3)e(f,f+1,f+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,r=new o.Matrix4;return r.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new o.Vector3,e=new o.Vector3,i=0,r=this.faces.length;r>i;i++){var n=this.faces[i],s=this.vertices[n.a],a=this.vertices[n.b],h=this.vertices[n.c];t.subVectors(h,a),e.subVectors(s,a),t.cross(e),t.normalize(),n.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,i,r,n,s,a;for(a=new Array(this.vertices.length),e=0,i=this.vertices.length;i>e;e++)a[e]=new o.Vector3;if(t){var h,l,c,u=new o.Vector3,p=new o.Vector3;for(r=0,n=this.faces.length;n>r;r++)s=this.faces[r],h=this.vertices[s.a],l=this.vertices[s.b],c=this.vertices[s.c],u.subVectors(c,l),p.subVectors(h,l),u.cross(p),a[s.a].add(u),a[s.b].add(u),a[s.c].add(u)}else for(r=0,n=this.faces.length;n>r;r++)s=this.faces[r],a[s.a].add(s.normal),a[s.b].add(s.normal),a[s.c].add(s.normal);for(e=0,i=this.vertices.length;i>e;e++)a[e].normalize();for(r=0,n=this.faces.length;n>r;r++){s=this.faces[r];var d=s.vertexNormals;3===d.length?(d[0].copy(a[s.a]),d[1].copy(a[s.b]),d[2].copy(a[s.c])):(d[0]=a[s.a].clone(),d[1]=a[s.b].clone(),d[2]=a[s.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,r,n;for(i=0,r=this.faces.length;r>i;i++)for(n=this.faces[i],n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),t=0,e=n.vertexNormals.length;e>t;t++)n.__originalVertexNormals[t]?n.__originalVertexNormals[t].copy(n.vertexNormals[t]):n.__originalVertexNormals[t]=n.vertexNormals[t].clone();var s=new o.Geometry;for(s.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a,h,l=this.morphNormals[t].faceNormals,c=this.morphNormals[t].vertexNormals;for(i=0,r=this.faces.length;r>i;i++)a=new o.Vector3,h={a:new o.Vector3,b:new o.Vector3,c:new o.Vector3},l.push(a),c.push(h)}var u=this.morphNormals[t];s.vertices=this.morphTargets[t].vertices,s.computeFaceNormals(),s.computeVertexNormals();var a,h;for(i=0,r=this.faces.length;r>i;i++)n=this.faces[i],a=u.faceNormals[i],h=u.vertexNormals[i],a.copy(n.normal),h.a.copy(n.vertexNormals[0]),h.b.copy(n.vertexNormals[1]),h.c.copy(n.vertexNormals[2])}for(i=0,r=this.faces.length;r>i;i++)n=this.faces[i],n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeTangents:function(){},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,r=e.length;r>i;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new o.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new o.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t instanceof o.Geometry!=!1){var r,n=this.vertices.length,s=this.vertices,a=t.vertices,h=this.faces,l=t.faces,c=this.faceVertexUvs[0],u=t.faceVertexUvs[0];void 0===i&&(i=0),void 0!==e&&(r=(new o.Matrix3).getNormalMatrix(e));for(var p=0,d=a.length;d>p;p++){var f=a[p],m=f.clone();void 0!==e&&m.applyMatrix4(e),s.push(m)}for(p=0,d=l.length;d>p;p++){var g,v,y,x=l[p],_=x.vertexNormals,b=x.vertexColors;g=new o.Face3(x.a+n,x.b+n,x.c+n),g.normal.copy(x.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var w=0,S=_.length;S>w;w++)v=_[w].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(x.color);for(var w=0,S=b.length;S>w;w++)y=b[w],g.vertexColors.push(y.clone());g.materialIndex=x.materialIndex+i,h.push(g)}for(p=0,d=u.length;d>p;p++){var T=u[p],M=[];if(void 0!==T){for(var w=0,S=T.length;S>w;w++)M.push(T[w].clone());c.push(M)}}}},mergeMesh:function(t){t instanceof o.Mesh!=!1&&(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,i,r,n,o,s,a,h={},l=[],c=[],u=4,p=Math.pow(10,u);for(i=0,r=this.vertices.length;r>i;i++)t=this.vertices[i],e=Math.round(t.x*p)+"_"+Math.round(t.y*p)+"_"+Math.round(t.z*p),void 0===h[e]?(h[e]=i,l.push(this.vertices[i]),c[i]=l.length-1):c[i]=c[h[e]];var d=[];for(i=0,r=this.faces.length;r>i;i++){n=this.faces[i],n.a=c[n.a],n.b=c[n.b],n.c=c[n.c],o=[n.a,n.b,n.c];for(var f=-1,m=0;3>m;m++)if(o[m]===o[(m+1)%3]){f=m,d.push(i);break}}for(i=d.length-1;i>=0;i--){var g=d[i];for(this.faces.splice(g,1),s=0,a=this.faceVertexUvs.length;a>s;s++)this.faceVertexUvs[s].splice(g,1)}var v=this.vertices.length-l.length;return this.vertices=l,v},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,i=e.length,r=0;i>r;r++)e[r]._id=r;e.sort(t);var n,o,s=this.faceVertexUvs[0],a=this.faceVertexUvs[1];s&&s.length===i&&(n=[]),a&&a.length===i&&(o=[]);for(var r=0;i>r;r++){var h=e[r]._id;n&&n.push(s[h]),o&&o.push(a[h])}n&&(this.faceVertexUvs[0]=n),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==p[e]?p[e]:(p[e]=u.length/3,u.push(t.x,t.y,t.z),p[e])}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==f[e]?f[e]:(f[e]=d.length,d.push(t.getHex()),f[e])}function r(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=m.length/2,m.push(t.x,t.y),g[e])}var n={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var s in o)void 0!==o[s]&&(n[s]=o[s]);return n}for(var a=[],h=0;h<this.vertices.length;h++){var l=this.vertices[h];a.push(l.x,l.y,l.z)}for(var c=[],u=[],p={},d=[],f={},m=[],g={},h=0;h<this.faces.length;h++){var v=this.faces[h],y=!0,x=!1,_=void 0!==this.faceVertexUvs[0][h],b=v.normal.length()>0,w=v.vertexNormals.length>0,S=1!==v.color.r||1!==v.color.g||1!==v.color.b,T=v.vertexColors.length>0,M=0;if(M=t(M,0,0),M=t(M,1,y),M=t(M,2,x),M=t(M,3,_),M=t(M,4,b),M=t(M,5,w),M=t(M,6,S),M=t(M,7,T),c.push(M),c.push(v.a,v.b,v.c),c.push(v.materialIndex),_){var E=this.faceVertexUvs[0][h];c.push(r(E[0]),r(E[1]),r(E[2]))}if(b&&c.push(e(v.normal)),w){var C=v.vertexNormals;c.push(e(C[0]),e(C[1]),e(C[2]))}if(S&&c.push(i(v.color)),T){var A=v.vertexColors;c.push(i(A[0]),i(A[1]),i(A[2]))}}return n.data={},n.data.vertices=a,n.data.normals=u,d.length>0&&(n.data.colors=d),m.length>0&&(n.data.uvs=[m]),n.data.faces=c,n},clone:function(){return(new o.Geometry).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,i=0,r=e.length;r>i;i++)this.vertices.push(e[i].clone());for(var n=t.faces,i=0,r=n.length;r>i;i++)this.faces.push(n[i].clone());for(var i=0,r=t.faceVertexUvs.length;r>i;i++){var o=t.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var s=0,a=o.length;a>s;s++){for(var h=o[s],l=[],c=0,u=h.length;u>c;c++){var p=h[c];l.push(p.clone())}this.faceVertexUvs[i].push(l)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},o.EventDispatcher.prototype.apply(o.Geometry.prototype),o.GeometryIdCount=0,o.DirectGeometry=function(){Object.defineProperty(this,"id",{value:o.GeometryIdCount++}),this.uuid=o.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},o.DirectGeometry.prototype={constructor:o.DirectGeometry,computeBoundingBox:o.Geometry.prototype.computeBoundingBox,computeBoundingSphere:o.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){},computeVertexNormals:function(){},computeGroups:function(t){for(var e,i,r=[],n=t.faces,o=0;o<n.length;o++){var s=n[o];s.materialIndex!==i&&(i=s.materialIndex,void 0!==e&&(e.count=3*o-e.start,r.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,r.push(e)),this.groups=r},fromGeometry:function(t){var e,i=t.faces,r=t.vertices,n=t.faceVertexUvs,s=n[0]&&n[0].length>0,a=n[1]&&n[1].length>0,h=t.morphTargets,l=h.length;if(l>0){e=[];for(var c=0;l>c;c++)e[c]=[];this.morphTargets.position=e}var u,p=t.morphNormals,d=p.length;if(d>0){u=[];for(var c=0;d>c;c++)u[c]=[];this.morphTargets.normal=u}for(var f=t.skinIndices,m=t.skinWeights,g=f.length===r.length,v=m.length===r.length,c=0;c<i.length;c++){var y=i[c];this.vertices.push(r[y.a],r[y.b],r[y.c]);var x=y.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{var _=y.normal;this.normals.push(_,_,_)}var b=y.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=y.color;this.colors.push(w,w,w)}if(s===!0){var S=n[0][c];void 0!==S?this.uvs.push(S[0],S[1],S[2]):this.uvs.push(new o.Vector2,new o.Vector2,new o.Vector2)}if(a===!0){var S=n[1][c];void 0!==S?this.uvs2.push(S[0],S[1],S[2]):this.uvs2.push(new o.Vector2,new o.Vector2,new o.Vector2)}for(var T=0;l>T;T++){var M=h[T].vertices;e[T].push(M[y.a],M[y.b],M[y.c])}for(var T=0;d>T;T++){var E=p[T].vertexNormals[c];u[T].push(E.a,E.b,E.c)}g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,
this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},o.EventDispatcher.prototype.apply(o.DirectGeometry.prototype),o.BufferGeometry=function(){Object.defineProperty(this,"id",{value:o.GeometryIdCount++}),this.uuid=o.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},o.BufferGeometry.prototype={constructor:o.BufferGeometry,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return e instanceof o.BufferAttribute==!1&&e instanceof o.InterleavedBufferAttribute==!1?void this.addAttribute(t,new o.BufferAttribute(arguments[1],arguments[2])):"index"===t?void this.setIndex(e):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var r=(new o.Matrix3).getNormalMatrix(t);r.applyToVector3Array(i.array),i.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new o.Matrix4),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,r){return void 0===t&&(t=new o.Matrix4),t.makeTranslation(e,i,r),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,r){return void 0===t&&(t=new o.Matrix4),t.makeScale(e,i,r),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new o.Object3D),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t instanceof o.Points||t instanceof o.Line){var i=new o.Float32Attribute(3*e.vertices.length,3),r=new o.Float32Attribute(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var n=new o.Float32Attribute(e.lineDistances.length,1);this.addAttribute("lineDistance",n.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t instanceof o.Mesh&&e instanceof o.Geometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t instanceof o.Mesh){var i=e.__directGeometry;if(void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}if(e.verticesNeedUpdate===!0){var r=this.attributes.position;void 0!==r&&(r.copyVector3sArray(e.vertices),r.needsUpdate=!0),e.verticesNeedUpdate=!1}if(e.normalsNeedUpdate===!0){var r=this.attributes.normal;void 0!==r&&(r.copyVector3sArray(e.normals),r.needsUpdate=!0),e.normalsNeedUpdate=!1}if(e.colorsNeedUpdate===!0){var r=this.attributes.color;void 0!==r&&(r.copyColorsArray(e.colors),r.needsUpdate=!0),e.colorsNeedUpdate=!1}if(e.uvsNeedUpdate){var r=this.attributes.uv;void 0!==r&&(r.copyVector2sArray(e.uvs),r.needsUpdate=!0),e.uvsNeedUpdate=!1}if(e.lineDistancesNeedUpdate){var r=this.attributes.lineDistance;void 0!==r&&(r.copyArray(e.lineDistances),r.needsUpdate=!0),e.lineDistancesNeedUpdate=!1}return e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new o.DirectGeometry).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new o.BufferAttribute(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new o.BufferAttribute(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new o.BufferAttribute(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var n=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new o.BufferAttribute(n,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var s=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new o.BufferAttribute(s,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var a=t.vertices.length>65535?Uint32Array:Uint16Array,h=new a(3*t.indices.length);this.setIndex(new o.BufferAttribute(h,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var l in t.morphTargets){for(var c=[],u=t.morphTargets[l],p=0,d=u.length;d>p;p++){var f=u[p],m=new o.Float32Attribute(3*f.length,3);c.push(m.copyVector3sArray(f))}this.morphAttributes[l]=c}if(t.skinIndices.length>0){var g=new o.Float32Attribute(4*t.skinIndices.length,4);this.addAttribute("skinIndex",g.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var v=new o.Float32Attribute(4*t.skinWeights.length,4);this.addAttribute("skinWeight",v.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){new o.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new o.Box3);var t=this.attributes.position.array;t&&this.boundingBox.setFromArray(t),void 0!==t&&0!==t.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}(),computeBoundingSphere:function(){var t=new o.Box3,e=new o.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new o.Sphere);var i=this.attributes.position.array;if(i){var r=this.boundingSphere.center;t.setFromArray(i),t.center(r);for(var n=0,s=0,a=i.length;a>s;s+=3)e.fromArray(i,s),n=Math.max(n,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new o.BufferAttribute(new Float32Array(r.length),3));else for(var n=e.normal.array,s=0,a=n.length;a>s;s++)n[s]=0;var h,l,c,u=e.normal.array,p=new o.Vector3,d=new o.Vector3,f=new o.Vector3,m=new o.Vector3,g=new o.Vector3;if(t){var v=t.array;0===i.length&&this.addGroup(0,v.length);for(var y=0,x=i.length;x>y;++y)for(var _=i[y],b=_.start,w=_.count,s=b,a=b+w;a>s;s+=3)h=3*v[s+0],l=3*v[s+1],c=3*v[s+2],p.fromArray(r,h),d.fromArray(r,l),f.fromArray(r,c),m.subVectors(f,d),g.subVectors(p,d),m.cross(g),u[h]+=m.x,u[h+1]+=m.y,u[h+2]+=m.z,u[l]+=m.x,u[l+1]+=m.y,u[l+2]+=m.z,u[c]+=m.x,u[c+1]+=m.y,u[c+2]+=m.z}else for(var s=0,a=r.length;a>s;s+=9)p.fromArray(r,s),d.fromArray(r,s+3),f.fromArray(r,s+6),m.subVectors(f,d),g.subVectors(p,d),m.cross(g),u[s]=m.x,u[s+1]=m.y,u[s+2]=m.z,u[s+3]=m.x,u[s+4]=m.y,u[s+5]=m.z,u[s+6]=m.x,u[s+7]=m.y,u[s+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t instanceof o.BufferGeometry!=!1){void 0===e&&(e=0);var i=this.attributes;for(var r in i)if(void 0!==t.attributes[r])for(var n=i[r],s=n.array,a=t.attributes[r],h=a.array,l=a.itemSize,c=0,u=l*e;c<h.length;c++,u++)s[u]=h[c];return this}},normalizeNormals:function(){for(var t,e,i,r,n=this.attributes.normal.array,o=0,s=n.length;s>o;o+=3)t=n[o],e=n[o+1],i=n[o+2],r=1/Math.sqrt(t*t+e*e+i*i),n[o]*=r,n[o+1]*=r,n[o+2]*=r},toNonIndexed:function(){if(null===this.index)return this;var t=new o.BufferGeometry,e=this.index.array,i=this.attributes;for(var r in i){for(var n=i[r],s=n.array,a=n.itemSize,h=new s.constructor(e.length*a),l=0,c=0,u=0,p=e.length;p>u;u++){l=e[u]*a;for(var d=0;a>d;d++)h[c++]=s[l++]}t.addAttribute(r,new o.BufferAttribute(h,a))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var n=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:n}}var o=this.attributes;for(var i in o){var s=o[i],n=Array.prototype.slice.call(s.array);t.data.attributes[i]={itemSize:s.itemSize,type:s.array.constructor.name,array:n}}var a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));var h=this.boundingSphere;return null!==h&&(t.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),t},clone:function(){return(new o.BufferGeometry).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var r in i){var n=i[r];this.addAttribute(r,n.clone())}for(var o=t.groups,s=0,a=o.length;a>s;s++){var h=o[s];this.addGroup(h.start,h.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},o.EventDispatcher.prototype.apply(o.BufferGeometry.prototype),o.BufferGeometry.MaxIndex=65535,o.InstancedBufferGeometry=function(){o.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},o.InstancedBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.InstancedBufferGeometry.prototype.constructor=o.InstancedBufferGeometry,o.InstancedBufferGeometry.prototype.addGroup=function(t,e,i){this.groups.push({start:t,count:e,instances:i})},o.InstancedBufferGeometry.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var r in i){var n=i[r];this.addAttribute(r,n.clone())}for(var o=t.groups,s=0,a=o.length;a>s;s++){var h=o[s];this.addGroup(h.start,h.count,h.instances)}return this},o.EventDispatcher.prototype.apply(o.InstancedBufferGeometry.prototype),o.Uniform=function(t,e){this.type=t,this.value=e,this.dynamic=!1},o.Uniform.prototype={constructor:o.Uniform,onUpdate:function(t){return this.dynamic=!0,this.onUpdateCallback=t,this}},o.AnimationClip=function(t,e,i){this.name=t||o.Math.generateUUID(),this.tracks=i,this.duration=void 0!==e?e:-1,this.duration<0&&this.resetDuration(),this.trim(),this.optimize()},o.AnimationClip.prototype={constructor:o.AnimationClip,resetDuration:function(){for(var t=this.tracks,e=0,i=0,r=t.length;i!==r;++i){var n=this.tracks[i];e=Math.max(e,n.times[n.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(o.AnimationClip,{parse:function(t){for(var e=[],i=t.tracks,r=1/(t.fps||1),n=0,s=i.length;n!==s;++n)e.push(o.KeyframeTrack.parse(i[n]).scale(r));return new o.AnimationClip(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,r={name:t.name,duration:t.duration,tracks:e},n=0,s=i.length;n!==s;++n)e.push(o.KeyframeTrack.toJSON(i[n]));return r},CreateFromMorphTargetSequence:function(t,e,i){for(var r=e.length,n=[],s=0;r>s;s++){var a=[],h=[];a.push((s+r-1)%r,s,(s+1)%r),h.push(0,1,0);var l=o.AnimationUtils.getKeyframeOrder(a);a=o.AnimationUtils.sortedArray(a,1,l),h=o.AnimationUtils.sortedArray(h,1,l),0===a[0]&&(a.push(r),h.push(h[0])),n.push(new o.NumberKeyframeTrack(".morphTargetInfluences["+e[s].name+"]",a,h).scale(1/i))}return new o.AnimationClip(t,-1,n)},findByName:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return t[i];return null},CreateClipsFromMorphTargetSequences:function(t,e){for(var i={},r=/^([\w-]*?)([\d]+)$/,n=0,s=t.length;s>n;n++){var a=t[n],h=a.name.match(r);if(h&&h.length>1){var l=h[1],c=i[l];c||(i[l]=c=[]),c.push(a)}}var u=[];for(var l in i)u.push(o.AnimationClip.CreateFromMorphTargetSequence(l,i[l],e));return u},parseAnimation:function(t,e,i){if(!t)return null;for(var r=function(t,e,i,r,n){if(0!==i.length){var s=[],a=[];o.AnimationUtils.flattenJSON(i,s,a,r),0!==s.length&&n.push(new t(e,s,a))}},n=[],s=t.name||"default",a=t.length||-1,h=t.fps||30,l=t.hierarchy||[],c=0;c<l.length;c++){var u=l[c].keys;if(u&&0!=u.length)if(u[0].morphTargets){for(var p={},d=0;d<u.length;d++)if(u[d].morphTargets)for(var f=0;f<u[d].morphTargets.length;f++)p[u[d].morphTargets[f]]=-1;for(var m in p){for(var g=[],v=[],f=0;f!==u[d].morphTargets.length;++f){var y=u[d];g.push(y.time),v.push(y.morphTarget===m?1:0)}n.push(new o.NumberKeyframeTrack(".morphTargetInfluence["+m+"]",g,v))}a=p.length*(h||1)}else{var x=".bones["+e[c].name+"]";r(o.VectorKeyframeTrack,x+".position",u,"pos",n),r(o.QuaternionKeyframeTrack,x+".quaternion",u,"rot",n),r(o.VectorKeyframeTrack,x+".scale",u,"scl",n)}}if(0===n.length)return null;var _=new o.AnimationClip(s,a,n);return _}}),o.AnimationMixer=function(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1},o.AnimationMixer.prototype={constructor:o.AnimationMixer,clipAction:function(t,e){var i,r=e||this._root,n=r.uuid,s="string"==typeof t?t:t.name,a=t!==s?t:null,h=this._actionsByClip[s];if(void 0!==h){var l=h.actionByRoot[n];if(void 0!==l)return l;if(i=h.knownActions[0],a=i._clip,t!==s&&t!==a)throw new Error("Different clips with the same name detected!")}if(null===a)return null;var c=new o.AnimationMixer._Action(this,a,e);return this._bindAction(c,i),this._addInactiveAction(c,s,n),c},existingAction:function(t,e){var i=e||this._root,r=i.uuid,n="string"==typeof t?t:t.name,o=this._actionsByClip[n];return void 0!==o?o.actionByRoot[r]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var n=0;n!==e;++n)t[n].reset();for(var n=0;n!==r;++n)i[n].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,r=this.time+=t,n=Math.sign(t),o=this._accuIndex^=1,s=0;s!==i;++s){var a=e[s];a.enabled&&a._update(r,t,n,o)}for(var h=this._bindings,l=this._nActiveBindings,s=0;s!==l;++s)h[s].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.name,r=this._actionsByClip,n=r[i];if(void 0!==n){for(var o=n.knownActions,s=0,a=o.length;s!==a;++s){var h=o[s];this._deactivateAction(h);var l=h._cacheIndex,c=e[e.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,c._cacheIndex=l,e[l]=c,e.pop(),this._removeInactiveBindingsForAction(h)}delete r[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var r in i){var n=i[r].actionByRoot,o=n[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var s=this._bindingsByRootAndName,a=s[e];if(void 0!==a)for(var h in a){var l=a[h];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}},o.EventDispatcher.prototype.apply(o.AnimationMixer.prototype),o.AnimationMixer._Action=function(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var r=e.tracks,n=r.length,s=new Array(n),a={endingStart:o.ZeroCurvatureEnding,endingEnd:o.ZeroCurvatureEnding},h=0;h!==n;++h){var l=r[h].createInterpolant(null);s[h]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=s,this._propertyBindings=new Array(n),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=o.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},o.AnimationMixer._Action.prototype={constructor:o.AnimationMixer._Action,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){this._startTime;return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){this._mixer;if(t.fadeOut(e),this.fadeIn(e),i){var r=this._clip.duration,n=t._clip.duration,o=n/r,s=r/n;t.warp(1,o,e),this.warp(s,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._currentTimeScale,0,t)},warp:function(t,e,i){var r=this._mixer,n=r.time,o=this._timeScaleInterpolant,s=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var a=o.parameterPositions,h=o.sampleValues;return a[0]=n,a[1]=n+i,h[0]=t/s,h[1]=e/s,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,r){var n=this._startTime;if(null!==n){var o=(t-n)*i;if(0>o||0===i)return;this._startTime=null,e=i*o}e*=this._updateTimeScale(t);var s=this._updateTime(e),a=this._updateWeight(t);if(a>0)for(var h=this._interpolants,l=this._propertyBindings,c=0,u=h.length;c!==u;++c)h[c].evaluate(s),l[c].accumulate(r,a)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var r=i.evaluate(t)[0];e*=r,t>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i){var r=i.evaluate(t)[0];e*=r,t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.pause=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,r=this.loop,n=this._loopCount,s=!1;switch(r){case o.LoopOnce:if(-1===n&&(this.loopCount=0,this._setEndings(!0,!0,!1)),e>=i)e=i;else{if(!(0>e))break;e=0}this.clampWhenFinished?this.pause=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1});break;case o.LoopPingPong:s=!0;case o.LoopRepeat:if(-1===n&&(t>0?(n=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),e>=i||0>e){var a=Math.floor(e/i);e-=i*a,n+=Math.abs(a);var h=this.repetitions-n;if(0>h){this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});break}if(0===h){var l=0>t;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}if(r===o.LoopPingPong&&1===(1&n))return this.time=e,i-e}return this.time=e,e},_setEndings:function(t,e,i){var r=this._interpolantSettings;i?(r.endingStart=o.ZeroSlopeEnding,r.endingEnd=o.ZeroSlopeEnding):(t?r.endingStart=this.zeroSlopeAtStart?o.ZeroSlopeEnding:o.ZeroCurvatureEnding:r.endingStart=o.WrapAroundEnding,e?r.endingEnd=this.zeroSlopeAtEnd?o.ZeroSlopeEnding:o.ZeroCurvatureEnding:r.endingEnd=o.WrapAroundEnding)},_scheduleFading:function(t,e,i){var r=this._mixer,n=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var s=o.parameterPositions,a=o.sampleValues;return s[0]=n,a[0]=e,s[1]=n+t,a[1]=i,this}},Object.assign(o.AnimationMixer.prototype,{_bindAction:function(t,e){var i=t._localRoot||this._root,r=t._clip.tracks,n=r.length,s=t._propertyBindings,a=t._interpolants,h=i.uuid,l=this._bindingsByRootAndName,c=l[h];void 0===c&&(c={},l[h]=c);for(var u=0;u!==n;++u){var p=r[u],d=p.name,f=c[d];if(void 0!==f)s[u]=f;else{if(f=s[u],void 0!==f){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,h,d));continue}var m=e&&e._propertyBindings[u].binding.parsedPath;f=new o.PropertyMixer(o.PropertyBinding.create(i,d,m),p.ValueTypeName,p.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,h,d),s[u]=f}a[u].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.name,r=this._actionsByClip[i];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,i,e)}for(var n=t._propertyBindings,o=0,s=n.length;o!==s;++o){var a=n[o];0===a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,r=e.length;i!==r;++i){var n=e[i];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var r=this._actions,n=this._actionsByClip,o=n[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,n[e]=o;else{var s=o.knownActions;t._byClipCacheIndex=s.length,s.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],r=t._cacheIndex;i._cacheIndex=r,e[r]=i,e.pop(),t._cacheIndex=null;var n=t._clip.name,o=this._actionsByClip,s=o[n],a=s.knownActions,h=a[a.length-1],l=t._byClipCacheIndex;h._byClipCacheIndex=l,a[l]=h,a.pop(),t._byClipCacheIndex=null;var c=s.actionByRoot,u=(e._localRoot||this._root).uuid;delete c[u],0===a.length&&delete o[n],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,r=e.length;i!==r;++i){var n=e[i];0===--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,r=this._nActiveActions++,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,r=--this._nActiveActions,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n},_addInactiveBinding:function(t,e,i){var r=this._bindingsByRootAndName,n=r[e],o=this._bindings;void 0===n&&(n={},r[e]=n),n[i]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,r=i.rootNode.uuid,n=i.path,o=this._bindingsByRootAndName,s=o[r],a=e[e.length-1],h=t._cacheIndex;a._cacheIndex=h,e[h]=a,e.pop(),delete s[n];t:{for(var l in s)break t;delete o[r]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,r=this._nActiveBindings++,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,r=--this._nActiveBindings,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new o.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,r=--this._nActiveControlInterpolants,n=e[r];t.__cacheIndex=r,e[r]=t,n.__cacheIndex=i,e[i]=n},_controlInterpolantsResultBuffer:new Float32Array(1)}),o.AnimationObjectGroup=function(t){this.uuid=o.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}},o.AnimationObjectGroup.prototype={constructor:o.AnimationObjectGroup,add:function(t){for(var e=this._objects,i=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,s=this._paths,a=this._parsedPaths,h=this._bindings,l=h.length,c=0,u=arguments.length;c!==u;++c){var p=arguments[c],d=p.uuid,f=n[d];if(void 0===f){f=i++,n[d]=f,e.push(p);for(var m=0,g=l;m!==g;++m)h[m].push(new o.PropertyBinding(p,s[m],a[m]))}else if(r>f){var v=e[f],y=--r,x=e[y];n[x.uuid]=f,e[f]=x,n[d]=y,e[y]=p;for(var m=0,g=l;m!==g;++m){var _=h[m],b=_[y],w=_[f];_[f]=b,void 0===w&&(w=new o.PropertyBinding(p,s[m],a[m])),_[y]=w}}else e[f]!==v}this.nCachedObjects_=r},remove:function(t){for(var e=this._objects,i=(e.length,this.nCachedObjects_),r=this._indicesByUUID,n=this._bindings,o=n.length,s=0,a=arguments.length;s!==a;++s){var h=arguments[s],l=h.uuid,c=r[l];if(void 0!==c&&c>=i){var u=i++,p=e[u];r[p.uuid]=c,e[c]=p,r[l]=u,e[u]=h;for(var d=0,f=o;d!==f;++d){var m=n[d],g=m[u],v=m[c];m[c]=g,m[u]=v}}}this.nCachedObjects_=i},uncache:function(t){for(var e=this._objects,i=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,o=this._bindings,s=o.length,a=0,h=arguments.length;a!==h;++a){var l=arguments[a],c=l.uuid,u=n[c];if(void 0!==u)if(delete n[c],r>u){var p=--r,d=e[p],f=--i,m=e[f];n[d.uuid]=u,e[u]=d,n[m.uuid]=p,e[p]=m,e.pop();for(var g=0,v=s;g!==v;++g){var y=o[g],x=y[p],_=y[f];y[u]=x,y[p]=_,y.pop()}}else{var f=--i,m=e[f];n[m.uuid]=u,e[u]=m,e.pop();for(var g=0,v=s;g!==v;++g){var y=o[g];y[u]=y[f],y.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,r=i[t],n=this._bindings;if(void 0!==r)return n[r];var s=this._paths,a=this._parsedPaths,h=this._objects,l=h.length,c=this.nCachedObjects_,u=new Array(l);r=n.length,i[t]=r,s.push(t),a.push(e),n.push(u);for(var p=c,d=h.length;p!==d;++p){var f=h[p];u[p]=new o.PropertyBinding(f,t,e)}return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var r=this._paths,n=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s],h=t[s];e[h]=i,o[i]=a,o.pop(),n[i]=n[s],n.pop(),r[i]=r[s],r.pop()}}},o.AnimationUtils={arraySlice:function(t,e,i){return o.AnimationUtils.isTypedArray(t)?new t.constructor(t.subarray(e,i)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,i){return t[e]-t[i]}for(var i=t.length,r=new Array(i),n=0;n!==i;++n)r[n]=n;return r.sort(e),r},sortedArray:function(t,e,i){for(var r=t.length,n=new t.constructor(r),o=0,s=0;s!==r;++o)for(var a=i[o]*e,h=0;h!==e;++h)n[s++]=t[a+h];return n},flattenJSON:function(t,e,i,r){for(var n=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[n++];if(void 0!==o){var s=o[r];if(void 0!==s)if(Array.isArray(s)){do s=o[r],void 0!==s&&(e.push(o.time),i.push.apply(i,s)),o=t[n++];while(void 0!==o)}else if(void 0!==s.toArray){do s=o[r],void 0!==s&&(e.push(o.time),s.toArray(i,i.length)),o=t[n++];while(void 0!==o)}else do s=o[r],void 0!==s&&(e.push(o.time),i.push(s)),o=t[n++];while(void 0!==o)}}},o.KeyframeTrack=function(t,e,i,r){if(void 0===t)throw new Error("track name is undefined");if(void 0===e||0===e.length)throw new Error("no keyframes in track named "+t);this.name=t,this.times=o.AnimationUtils.convertArray(e,this.TimeBufferType),this.values=o.AnimationUtils.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()},o.KeyframeTrack.prototype={constructor:o.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:o.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(t){return new o.DiscreteInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new o.LinearInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new o.CubicInterpolant(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e=void 0;switch(t){case o.InterpolateDiscrete:e=this.InterpolantFactoryMethodDiscrete;break;case o.InterpolateLinear:e=this.InterpolantFactoryMethodLinear;break;case o.InterpolateSmooth:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return o.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return o.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return o.InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,r=e.length;i!==r;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,r=e.length;i!==r;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,r=i.length,n=0,s=r-1;n!==r&&i[n]<t;)++n;for(;-1!==s&&i[s]>e;)--s;if(++s,0!==n||s!==r){n>=s&&(s=Math.max(s,1),n=s-1);var a=this.getValueSize();this.times=o.AnimationUtils.arraySlice(i,n,s),this.values=o.AnimationUtils.arraySlice(this.values,n*a,s*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(t=!1);var i=this.times,r=this.values,n=i.length;0===n&&(t=!1);for(var s=null,a=0;a!==n;a++){var h=i[a];if("number"==typeof h&&isNaN(h)){t=!1;break}if(null!==s&&s>h){t=!1;break}s=h}if(void 0!==r&&o.AnimationUtils.isTypedArray(r))for(var a=0,l=r.length;a!==l;++a){var c=r[a];if(isNaN(c)){t=!1;break}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),r=1,n=1,s=t.length-1;s>=n;++n){
var a=!1,h=t[n],l=t[n+1];if(h!==l&&(1!==n||h!==h[0]))for(var c=n*i,u=c-i,p=c+i,d=0;d!==i;++d){var f=e[c+d];if(f!==e[u+d]||f!==e[p+d]){a=!0;break}}if(a){if(n!==r){t[r]=t[n];for(var m=n*i,g=r*i,d=0;d!==i;++d)e[g+d]=e[m+d]}++r}}return r!==t.length&&(this.times=o.AnimationUtils.arraySlice(t,0,r),this.values=o.AnimationUtils.arraySlice(e,0,r*i)),this}},Object.assign(o.KeyframeTrack,{parse:function(t){if(void 0===t.type)throw new Error("track type undefined, can not parse");var e=o.KeyframeTrack._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],r=[];o.AnimationUtils.flattenJSON(t.keys,i,r,"value"),t.times=i,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:o.AnimationUtils.convertArray(t.times,Array),values:o.AnimationUtils.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return o.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return o.VectorKeyframeTrack;case"color":return o.ColorKeyframeTrack;case"quaternion":return o.QuaternionKeyframeTrack;case"bool":case"boolean":return o.BooleanKeyframeTrack;case"string":return o.StringKeyframeTrack}throw new Error("Unsupported typeName: "+t)}}),o.PropertyBinding=function(t,e,i){this.path=e,this.parsedPath=i||o.PropertyBinding.parseTrackName(e),this.node=o.PropertyBinding.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t},o.PropertyBinding.prototype={constructor:o.PropertyBinding,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,r=e.propertyName,n=e.propertyIndex;if(t||(t=o.PropertyBinding.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var s=e.objectIndex;switch(i){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===s){s=a;break}break;default:if(void 0===t[i])return;t=t[i]}if(void 0!==s){if(void 0===t[s])return;t=t[s]}}var h=t[r];if(h){var l=this.Versioning.None;void 0!==t.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var c=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===r){if(!t.geometry)return;if(!t.geometry.morphTargets)return;for(var a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===n){n=a;break}}c=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=n}else void 0!==h.fromArray&&void 0!==h.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=h):void 0!==h.length?(c=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{e.nodeName}}},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(o.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:o.PropertyBinding.prototype.getValue,_setValue_unbound:o.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)t[e++]=i[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++]},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),o.PropertyBinding.Composite=function(t,e,i){var r=i||o.PropertyBinding.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)},o.PropertyBinding.Composite.prototype={constructor:o.PropertyBinding.Composite,getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,r=this._bindings[i];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},o.PropertyBinding.create=function(t,e,i){return t instanceof o.AnimationObjectGroup?new o.PropertyBinding.Composite(t,e,i):new o.PropertyBinding(t,e,i)},o.PropertyBinding.parseTrackName=function(t){var e=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,i=e.exec(t);if(!i)throw new Error("cannot parse trackName at all: "+t);i.index===e.lastIndex&&e.lastIndex++;var r={nodeName:i[3],objectName:i[5],objectIndex:i[7],propertyName:i[9],propertyIndex:i[11]};if(null===r.propertyName||0===r.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return r},o.PropertyBinding.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var i=0;i<t.bones.length;i++){var r=t.bones[i];if(r.name===e)return r}return null},r=i(t.skeleton);if(r)return r}if(t.children){var n=function(t){for(var i=0;i<t.length;i++){var r=t[i];if(r.name===e||r.uuid===e)return r;var o=n(r.children);if(o)return o}return null},o=n(t.children);if(o)return o}return null},o.PropertyMixer=function(t,e,i){this.binding=t,this.valueSize=i;var r,n=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":n=Array,r=this._select;break;default:r=this._lerp}this.buffer=new n(4*i),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0},o.PropertyMixer.prototype={constructor:o.PropertyMixer,accumulate:function(t,e){var i=this.buffer,r=this.valueSize,n=t*r+r,o=this.cumulativeWeight;if(0===o){for(var s=0;s!==r;++s)i[n+s]=i[s];o=e}else{o+=e;var a=e/o;this._mixBufferRegion(i,n,0,a,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,i=this.buffer,r=t*e+e,n=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,1>n){var s=3*e;this._mixBufferRegion(i,r,s,1-n,e)}for(var a=e,h=e+e;a!==h;++a)if(i[a]!==i[a+e]){o.setValue(i,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,r=3*i;t.getValue(e,r);for(var n=i,o=r;n!==o;++n)e[n]=e[r+n%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,r,n){if(r>=.5)for(var o=0;o!==n;++o)t[e+o]=t[i+o]},_slerp:function(t,e,i,r,n){o.Quaternion.slerpFlat(t,e,t,e,t,i,r)},_lerp:function(t,e,i,r,n){for(var o=1-r,s=0;s!==n;++s){var a=e+s;t[a]=t[a]*o+t[i+s]*r}}},o.BooleanKeyframeTrack=function(t,e,i){o.KeyframeTrack.call(this,t,e,i)},o.BooleanKeyframeTrack.prototype=Object.assign(Object.create(o.KeyframeTrack.prototype),{constructor:o.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:o.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),o.NumberKeyframeTrack=function(t,e,i,r){o.KeyframeTrack.call(this,t,e,i,r)},o.NumberKeyframeTrack.prototype=Object.assign(Object.create(o.KeyframeTrack.prototype),{constructor:o.NumberKeyframeTrack,ValueTypeName:"number"}),o.QuaternionKeyframeTrack=function(t,e,i,r){o.KeyframeTrack.call(this,t,e,i,r)},o.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(o.KeyframeTrack.prototype),{constructor:o.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:o.InterpolateLinear,InterpolantFactoryMethodLinear:function(t){return new o.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),o.StringKeyframeTrack=function(t,e,i,r){o.KeyframeTrack.call(this,t,e,i,r)},o.StringKeyframeTrack.prototype=Object.assign(Object.create(o.KeyframeTrack.prototype),{constructor:o.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:o.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),o.VectorKeyframeTrack=function(t,e,i,r){o.KeyframeTrack.call(this,t,e,i,r)},o.VectorKeyframeTrack.prototype=Object.assign(Object.create(o.KeyframeTrack.prototype),{constructor:o.VectorKeyframeTrack,ValueTypeName:"vector"}),o.Audio=function(t){o.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filter=null},o.Audio.prototype=Object.create(o.Object3D.prototype),o.Audio.prototype.constructor=o.Audio,o.Audio.prototype.getOutput=function(){return this.gain},o.Audio.prototype.load=function(t){var e=new o.AudioBuffer(this.context);return e.load(t),this.setBuffer(e),this},o.Audio.prototype.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},o.Audio.prototype.setBuffer=function(t){var e=this;return t.onReady(function(t){e.source.buffer=t,e.sourceType="buffer",e.autoplay&&e.play()}),this},o.Audio.prototype.play=function(){if(this.isPlaying!==!0&&this.hasPlaybackControl!==!1){var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()}},o.Audio.prototype.pause=function(){this.hasPlaybackControl!==!1&&(this.source.stop(),this.startTime=this.context.currentTime)},o.Audio.prototype.stop=function(){this.hasPlaybackControl!==!1&&(this.source.stop(),this.startTime=0)},o.Audio.prototype.connect=function(){null!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.getOutput())):this.source.connect(this.getOutput())},o.Audio.prototype.disconnect=function(){null!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput())):this.source.disconnect(this.getOutput())},o.Audio.prototype.getFilter=function(){return this.filter},o.Audio.prototype.setFilter=function(t){void 0===t&&(t=null),this.isPlaying===!0?(this.disconnect(),this.filter=t,this.connect()):this.filter=t},o.Audio.prototype.setPlaybackRate=function(t){this.hasPlaybackControl!==!1&&(this.playbackRate=t,this.isPlaying===!0&&(this.source.playbackRate.value=this.playbackRate))},o.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},o.Audio.prototype.onEnded=function(){this.isPlaying=!1},o.Audio.prototype.setLoop=function(t){this.hasPlaybackControl!==!1&&(this.source.loop=t)},o.Audio.prototype.getLoop=function(){return this.hasPlaybackControl===!1?!1:this.source.loop},o.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},o.Audio.prototype.getVolume=function(){return this.gain.gain.value},o.AudioAnalyser=function(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)},o.AudioAnalyser.prototype={constructor:o.AudioAnalyser,getData:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},o.AudioBuffer=function(t){this.context=t,this.ready=!1,this.readyCallbacks=[]},o.AudioBuffer.prototype.load=function(t){var e=this,i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(t){e.context.decodeAudioData(this.response,function(t){e.buffer=t,e.ready=!0;for(var i=0;i<e.readyCallbacks.length;i++)e.readyCallbacks[i](e.buffer);e.readyCallbacks=[]})},i.send(),this},o.AudioBuffer.prototype.onReady=function(t){this.ready?t(this.buffer):this.readyCallbacks.push(t)},o.PositionalAudio=function(t){o.Audio.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},o.PositionalAudio.prototype=Object.create(o.Audio.prototype),o.PositionalAudio.prototype.constructor=o.PositionalAudio,o.PositionalAudio.prototype.getOutput=function(){return this.panner},o.PositionalAudio.prototype.setRefDistance=function(t){this.panner.refDistance=t},o.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance},o.PositionalAudio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},o.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},o.PositionalAudio.prototype.setDistanceModel=function(t){this.panner.distanceModel=t},o.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel},o.PositionalAudio.prototype.setMaxDistance=function(t){this.panner.maxDistance=t},o.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance},o.PositionalAudio.prototype.updateMatrixWorld=function(){var t=new o.Vector3;return function(e){o.Object3D.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}(),o.AudioListener=function(){o.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},o.AudioListener.prototype=Object.create(o.Object3D.prototype),o.AudioListener.prototype.constructor=o.AudioListener,o.AudioListener.prototype.getInput=function(){return this.gain},o.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},o.AudioListener.prototype.setFilter=function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},o.AudioListener.prototype.getFilter=function(){return this.filter},o.AudioListener.prototype.setMasterVolume=function(t){this.gain.gain.value=t},o.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value},o.AudioListener.prototype.updateMatrixWorld=function(){var t=new o.Vector3,e=new o.Quaternion,i=new o.Vector3,r=new o.Vector3;return function(n){o.Object3D.prototype.updateMatrixWorld.call(this,n);var s=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,i),r.set(0,0,-1).applyQuaternion(e),s.setPosition(t.x,t.y,t.z),s.setOrientation(r.x,r.y,r.z,a.x,a.y,a.z)}}(),o.Camera=function(){o.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new o.Matrix4,this.projectionMatrix=new o.Matrix4},o.Camera.prototype=Object.create(o.Object3D.prototype),o.Camera.prototype.constructor=o.Camera,o.Camera.prototype.getWorldDirection=function(){var t=new o.Quaternion;return function(e){var i=e||new o.Vector3;return this.getWorldQuaternion(t),i.set(0,0,-1).applyQuaternion(t)}}(),o.Camera.prototype.lookAt=function(){var t=new o.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),o.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},o.Camera.prototype.copy=function(t){return o.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},o.CubeCamera=function(t,e,i){o.Object3D.call(this),this.type="CubeCamera";var r=90,n=1,s=new o.PerspectiveCamera(r,n,t,e);s.up.set(0,-1,0),s.lookAt(new o.Vector3(1,0,0)),this.add(s);var a=new o.PerspectiveCamera(r,n,t,e);a.up.set(0,-1,0),a.lookAt(new o.Vector3(-1,0,0)),this.add(a);var h=new o.PerspectiveCamera(r,n,t,e);h.up.set(0,0,1),h.lookAt(new o.Vector3(0,1,0)),this.add(h);var l=new o.PerspectiveCamera(r,n,t,e);l.up.set(0,0,-1),l.lookAt(new o.Vector3(0,-1,0)),this.add(l);var c=new o.PerspectiveCamera(r,n,t,e);c.up.set(0,-1,0),c.lookAt(new o.Vector3(0,0,1)),this.add(c);var u=new o.PerspectiveCamera(r,n,t,e);u.up.set(0,-1,0),u.lookAt(new o.Vector3(0,0,-1)),this.add(u);var p={format:o.RGBFormat,magFilter:o.LinearFilter,minFilter:o.LinearFilter};this.renderTarget=new o.WebGLRenderTargetCube(i,i,p),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,r=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,s,i),i.activeCubeFace=1,t.render(e,a,i),i.activeCubeFace=2,t.render(e,h,i),i.activeCubeFace=3,t.render(e,l,i),i.activeCubeFace=4,t.render(e,c,i),i.texture.generateMipmaps=r,i.activeCubeFace=5,t.render(e,u,i),t.setRenderTarget(null)}},o.CubeCamera.prototype=Object.create(o.Object3D.prototype),o.CubeCamera.prototype.constructor=o.CubeCamera,o.OrthographicCamera=function(t,e,i,r,n,s){o.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=i,this.bottom=r,this.near=void 0!==n?n:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},o.OrthographicCamera.prototype=Object.create(o.Camera.prototype),o.OrthographicCamera.prototype.constructor=o.OrthographicCamera,o.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(i-t,i+t,r+e,r-e,this.near,this.far)},o.OrthographicCamera.prototype.copy=function(t){return o.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},o.OrthographicCamera.prototype.toJSON=function(t){var e=o.Object3D.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,e},o.PerspectiveCamera=function(t,e,i,r){o.Camera.call(this),this.type="PerspectiveCamera",this.focalLength=10,this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()},o.PerspectiveCamera.prototype=Object.create(o.Camera.prototype),o.PerspectiveCamera.prototype.constructor=o.PerspectiveCamera,o.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*o.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},o.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,r,n,o){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=r,this.width=n,this.height=o,this.updateProjectionMatrix()},o.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=o.Math.radToDeg(2*Math.atan(Math.tan(.5*o.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=this.fullWidth/this.fullHeight,i=Math.tan(o.Math.degToRad(.5*t))*this.near,r=-i,n=e*r,s=e*i,a=Math.abs(s-n),h=Math.abs(i-r);this.projectionMatrix.makeFrustum(n+this.x*a/this.fullWidth,n+(this.x+this.width)*a/this.fullWidth,i-(this.y+this.height)*h/this.fullHeight,i-this.y*h/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},o.PerspectiveCamera.prototype.copy=function(t){return o.Camera.prototype.copy.call(this,t),this.focalLength=t.focalLength,this.zoom=t.zoom,this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this},o.PerspectiveCamera.prototype.toJSON=function(t){var e=o.Object3D.prototype.toJSON.call(this,t);return e.object.focalLength=this.focalLength,e.object.zoom=this.zoom,e.object.fov=this.fov,e.object.aspect=this.aspect,e.object.near=this.near,e.object.far=this.far,e},o.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new o.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new o.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},o.StereoCamera.prototype={constructor:o.StereoCamera,update:function(){var t,e,i,r,n,s=new o.Matrix4,a=new o.Matrix4;return function(h){var l=t!==h.focalLength||e!==h.fov||i!==h.aspect*this.aspect||r!==h.near||n!==h.far;if(l){t=h.focalLength,e=h.fov,i=h.aspect*this.aspect,r=h.near,n=h.far;var c,u,p=h.projectionMatrix.clone(),d=.032,f=d*r/t,m=r*Math.tan(o.Math.degToRad(.5*e));a.elements[12]=-d,s.elements[12]=d,c=-m*i+f,u=m*i+f,p.elements[0]=2*r/(u-c),p.elements[8]=(u+c)/(u-c),this.cameraL.projectionMatrix.copy(p),c=-m*i-f,u=m*i-f,p.elements[0]=2*r/(u-c),p.elements[8]=(u+c)/(u-c),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(h.matrixWorld).multiply(a),this.cameraR.matrixWorld.copy(h.matrixWorld).multiply(s)}}()},o.Light=function(t,e){o.Object3D.call(this),this.type="Light",this.color=new o.Color(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0},o.Light.prototype=Object.create(o.Object3D.prototype),o.Light.prototype.constructor=o.Light,o.Light.prototype.copy=function(t){return o.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},o.Light.prototype.toJSON=function(t){var e=o.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),e},o.LightShadow=function(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new o.Vector2(512,512),this.map=null,this.matrix=new o.Matrix4},o.LightShadow.prototype={constructor:o.LightShadow,copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)}},o.AmbientLight=function(t,e){o.Light.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0},o.AmbientLight.prototype=Object.create(o.Light.prototype),o.AmbientLight.prototype.constructor=o.AmbientLight,o.DirectionalLight=function(t,e){o.Light.call(this,t,e),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new o.Object3D,this.shadow=new o.LightShadow(new o.OrthographicCamera(-5,5,5,-5,.5,500))},o.DirectionalLight.prototype=Object.create(o.Light.prototype),o.DirectionalLight.prototype.constructor=o.DirectionalLight,o.DirectionalLight.prototype.copy=function(t){return o.Light.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},o.HemisphereLight=function(t,e,i){o.Light.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new o.Color(e)},o.HemisphereLight.prototype=Object.create(o.Light.prototype),o.HemisphereLight.prototype.constructor=o.HemisphereLight,o.HemisphereLight.prototype.copy=function(t){return o.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this},o.PointLight=function(t,e,i,r){o.Light.call(this,t,e),this.type="PointLight",this.distance=void 0!==i?i:0,this.decay=void 0!==r?r:1,this.shadow=new o.LightShadow(new o.PerspectiveCamera(90,1,.5,500))},o.PointLight.prototype=Object.create(o.Light.prototype),o.PointLight.prototype.constructor=o.PointLight,Object.defineProperty(o.PointLight.prototype,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),o.PointLight.prototype.copy=function(t){return o.Light.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this},o.SpotLight=function(t,e,i,r,n,s){o.Light.call(this,t,e),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new o.Object3D,this.distance=void 0!==i?i:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==n?n:0,this.decay=void 0!==s?s:1,this.shadow=new o.LightShadow(new o.PerspectiveCamera(50,1,.5,500))},o.SpotLight.prototype=Object.create(o.Light.prototype),o.SpotLight.prototype.constructor=o.SpotLight,Object.defineProperty(o.SpotLight.prototype,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),o.SpotLight.prototype.copy=function(t){return o.Light.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},o.Cache={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){return this.enabled!==!1?this.files[t]:void 0},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},o.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},o.Loader.prototype={constructor:o.Loader,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,i){for(var r=[],n=0;n<t.length;++n)r[n]=this.createMaterial(t[n],e,i);return r},createMaterial:function(){var t,e,i;return function(r,n,s){function a(t,i,r,a,l){var c,u=n+t,p=o.Loader.Handlers.get(u);null!==p?c=p.load(u):(e.setCrossOrigin(s),c=e.load(u)),void 0!==i&&(c.repeat.fromArray(i),1!==i[0]&&(c.wrapS=o.RepeatWrapping),1!==i[1]&&(c.wrapT=o.RepeatWrapping)),void 0!==r&&c.offset.fromArray(r),void 0!==a&&("repeat"===a[0]&&(c.wrapS=o.RepeatWrapping),"mirror"===a[0]&&(c.wrapS=o.MirroredRepeatWrapping),"repeat"===a[1]&&(c.wrapT=o.RepeatWrapping),"mirror"===a[1]&&(c.wrapT=o.MirroredRepeatWrapping)),void 0!==l&&(c.anisotropy=l);var d=o.Math.generateUUID();return h[d]=c,d}void 0===t&&(t=new o.Color),void 0===e&&(e=new o.TextureLoader),void 0===i&&(i=new o.MaterialLoader);var h={},l={uuid:o.Math.generateUUID(),type:"MeshLambertMaterial"};for(var c in r){var u=r[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=u;break;case"blending":l.blending=o[u];break;case"colorAmbient":case"mapAmbient":break;case"colorDiffuse":l.color=t.fromArray(u).getHex();break;case"colorSpecular":l.specular=t.fromArray(u).getHex();break;case"colorEmissive":l.emissive=t.fromArray(u).getHex();break;case"specularCoef":l.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(l.type="MeshPhongMaterial");break;case"mapDiffuse":l.map=a(u,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":l.lightMap=a(u,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=a(u,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=a(u,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=a(u,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=a(u,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":l.alphaMap=a(u,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=o.BackSide;break;case"doubleSided":l.side=o.DoubleSide;break;case"transparency":l.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[c]=u;break;case"vertexColors":u===!0&&(l.vertexColors=o.VertexColors),"face"===u&&(l.vertexColors=o.FaceColors)}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),i.setTextures(h),i.parse(l)}}()},o.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,r=e.length;r>i;i+=2){var n=e[i],o=e[i+1];if(n.test(t))return o}return null}},o.XHRLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager},o.XHRLoader.prototype={constructor:o.XHRLoader,load:function(t,e,i,r){void 0!==this.path&&(t=this.path+t);var n=this,s=o.Cache.get(t);if(void 0!==s)return e&&setTimeout(function(){e(s)},0),s;var a=new XMLHttpRequest;return a.overrideMimeType("text/plain"),a.open("GET",t,!0),a.addEventListener("load",function(i){var s=i.target.response;o.Cache.add(t,s),200===this.status?(e&&e(s),n.manager.itemEnd(t)):0===this.status?(e&&e(s),n.manager.itemEnd(t)):(r&&r(i),n.manager.itemError(t))},!1),void 0!==i&&a.addEventListener("progress",function(t){i(t)},!1),a.addEventListener("error",function(e){r&&r(e),n.manager.itemError(t)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),n.manager.itemStart(t),a},setPath:function(t){this.path=t},setResponseType:function(t){this.responseType=t},setWithCredentials:function(t){this.withCredentials=t}},o.FontLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager},o.FontLoader.prototype={constructor:o.FontLoader,load:function(t,e,i,r){var n=new o.XHRLoader(this.manager);n.load(t,function(t){e(new o.Font(JSON.parse(t.substring(65,t.length-2))))},i,r)}},o.ImageLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager},o.ImageLoader.prototype={constructor:o.ImageLoader,load:function(t,e,i,r){void 0!==this.path&&(t=this.path+t);var n=this,s=o.Cache.get(t);if(void 0!==s)return n.manager.itemStart(t),e?setTimeout(function(){e(s),n.manager.itemEnd(t)},0):n.manager.itemEnd(t),s;var a=document.createElement("img");return a.addEventListener("load",function(i){o.Cache.add(t,this),e&&e(this),n.manager.itemEnd(t)},!1),void 0!==i&&a.addEventListener("progress",function(t){i(t)},!1),
a.addEventListener("error",function(e){r&&r(e),n.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},o.JSONLoader=function(t){"boolean"==typeof t&&(t=void 0),this.manager=void 0!==t?t:o.DefaultLoadingManager,this.withCredentials=!1},o.JSONLoader.prototype={constructor:o.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),this._statusDomElement},load:function(t,e,i,r){var n=this,s=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:o.Loader.prototype.extractUrlBase(t),a=new o.XHRLoader(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(t){var i=JSON.parse(t),r=i.metadata;if(void 0!==r){var o=r.type;if(void 0!==o){if("object"===o.toLowerCase())return;if("scene"===o.toLowerCase())return}}var a=n.parse(i,s);e(a.geometry,a.materials)},i,r)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){function i(e){function i(t,e){return t&1<<e}var r,n,s,h,l,c,u,p,d,f,m,g,v,y,x,_,b,w,S,T,M,E,C,A,L,P,R,O=t.faces,I=t.vertices,D=t.normals,B=t.colors,k=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&k++;for(r=0;k>r;r++)a.faceVertexUvs[r]=[]}for(h=0,l=I.length;l>h;)w=new o.Vector3,w.x=I[h++]*e,w.y=I[h++]*e,w.z=I[h++]*e,a.vertices.push(w);for(h=0,l=O.length;l>h;)if(f=O[h++],m=i(f,0),g=i(f,1),v=i(f,3),y=i(f,4),x=i(f,5),_=i(f,6),b=i(f,7),m){if(T=new o.Face3,T.a=O[h],T.b=O[h+1],T.c=O[h+3],M=new o.Face3,M.a=O[h+1],M.b=O[h+2],M.c=O[h+3],h+=4,g&&(d=O[h++],T.materialIndex=d,M.materialIndex=d),s=a.faces.length,v)for(r=0;k>r;r++)for(A=t.uvs[r],a.faceVertexUvs[r][s]=[],a.faceVertexUvs[r][s+1]=[],n=0;4>n;n++)p=O[h++],P=A[2*p],R=A[2*p+1],L=new o.Vector2(P,R),2!==n&&a.faceVertexUvs[r][s].push(L),0!==n&&a.faceVertexUvs[r][s+1].push(L);if(y&&(u=3*O[h++],T.normal.set(D[u++],D[u++],D[u]),M.normal.copy(T.normal)),x)for(r=0;4>r;r++)u=3*O[h++],C=new o.Vector3(D[u++],D[u++],D[u]),2!==r&&T.vertexNormals.push(C),0!==r&&M.vertexNormals.push(C);if(_&&(c=O[h++],E=B[c],T.color.setHex(E),M.color.setHex(E)),b)for(r=0;4>r;r++)c=O[h++],E=B[c],2!==r&&T.vertexColors.push(new o.Color(E)),0!==r&&M.vertexColors.push(new o.Color(E));a.faces.push(T),a.faces.push(M)}else{if(S=new o.Face3,S.a=O[h++],S.b=O[h++],S.c=O[h++],g&&(d=O[h++],S.materialIndex=d),s=a.faces.length,v)for(r=0;k>r;r++)for(A=t.uvs[r],a.faceVertexUvs[r][s]=[],n=0;3>n;n++)p=O[h++],P=A[2*p],R=A[2*p+1],L=new o.Vector2(P,R),a.faceVertexUvs[r][s].push(L);if(y&&(u=3*O[h++],S.normal.set(D[u++],D[u++],D[u])),x)for(r=0;3>r;r++)u=3*O[h++],C=new o.Vector3(D[u++],D[u++],D[u]),S.vertexNormals.push(C);if(_&&(c=O[h++],S.color.setHex(B[c])),b)for(r=0;3>r;r++)c=O[h++],S.vertexColors.push(new o.Color(B[c]));a.faces.push(S)}}function r(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,r=t.skinWeights.length;r>i;i+=e){var n=t.skinWeights[i],s=e>1?t.skinWeights[i+1]:0,h=e>2?t.skinWeights[i+2]:0,l=e>3?t.skinWeights[i+3]:0;a.skinWeights.push(new o.Vector4(n,s,h,l))}if(t.skinIndices)for(var i=0,r=t.skinIndices.length;r>i;i+=e){var c=t.skinIndices[i],u=e>1?t.skinIndices[i+1]:0,p=e>2?t.skinIndices[i+2]:0,d=e>3?t.skinIndices[i+3]:0;a.skinIndices.push(new o.Vector4(c,u,p,d))}a.bones=t.bones,a.bones&&a.bones.length>0&&(a.skinWeights.length!==a.skinIndices.length||a.skinIndices.length!==a.vertices.length)}function n(e){if(void 0!==t.morphTargets)for(var i=0,r=t.morphTargets.length;r>i;i++){a.morphTargets[i]={},a.morphTargets[i].name=t.morphTargets[i].name,a.morphTargets[i].vertices=[];for(var n=a.morphTargets[i].vertices,s=t.morphTargets[i].vertices,h=0,l=s.length;l>h;h+=3){var c=new o.Vector3;c.x=s[h]*e,c.y=s[h+1]*e,c.z=s[h+2]*e,n.push(c)}}if(void 0!==t.morphColors&&t.morphColors.length>0)for(var u=a.faces,p=t.morphColors[0].colors,i=0,r=u.length;r>i;i++)u[i].color.fromArray(p,3*i)}function s(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var r=0;r<i.length;r++){var n=o.AnimationClip.parseAnimation(i[r],a.bones);n&&e.push(n)}if(a.morphTargets){var s=o.AnimationClip.CreateClipsFromMorphTargetSequences(a.morphTargets,10);e=e.concat(s)}e.length>0&&(a.animations=e)}var a=new o.Geometry,h=void 0!==t.scale?1/t.scale:1;if(i(h),r(),n(h),s(),a.computeFaceNormals(),a.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:a};var l=o.Loader.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:a,materials:l}}},o.LoadingManager=function(t,e,i){var r=this,n=!1,o=0,s=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){s++,n===!1&&void 0!==r.onStart&&r.onStart(t,o,s),n=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,s),o===s&&(n=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)}},o.DefaultLoadingManager=new o.LoadingManager,o.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager},o.BufferGeometryLoader.prototype={constructor:o.BufferGeometryLoader,load:function(t,e,i,r){var n=this,s=new o.XHRLoader(n.manager);s.load(t,function(t){e(n.parse(JSON.parse(t)))},i,r)},parse:function(t){var e=new o.BufferGeometry,i=t.data.index,r={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==i){var n=new r[i.type](i.array);e.setIndex(new o.BufferAttribute(n,1))}var s=t.data.attributes;for(var a in s){var h=s[a],n=new r[h.type](h.array);e.addAttribute(a,new o.BufferAttribute(n,h.itemSize))}var l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(var c=0,u=l.length;c!==u;++c){var p=l[c];e.addGroup(p.start,p.count,p.materialIndex)}var d=t.data.boundingSphere;if(void 0!==d){var f=new o.Vector3;void 0!==d.center&&f.fromArray(d.center),e.boundingSphere=new o.Sphere(f,d.radius)}return e}},o.MaterialLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager,this.textures={}},o.MaterialLoader.prototype={constructor:o.MaterialLoader,load:function(t,e,i,r){var n=this,s=new o.XHRLoader(n.manager);s.load(t,function(t){e(n.parse(JSON.parse(t)))},i,r)},setTextures:function(t){this.textures=t},getTexture:function(t){var e=this.textures;return void 0===e[t],e[t]},parse:function(t){var e=new o[t.type];if(void 0!==t.uuid&&(e.uuid=t.uuid),void 0!==t.name&&(e.name=t.name),void 0!==t.color&&e.color.setHex(t.color),void 0!==t.roughness&&(e.roughness=t.roughness),void 0!==t.metalness&&(e.metalness=t.metalness),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.alphaTest&&(e.alphaTest=t.alphaTest),void 0!==t.depthTest&&(e.depthTest=t.depthTest),void 0!==t.depthWrite&&(e.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(e.colorWrite=t.colorWrite),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(e.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(e.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(e.alphaMap=this.getTexture(t.alphaMap),e.transparent=!0),void 0!==t.bumpMap&&(e.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(e.bumpScale=t.bumpScale),void 0!==t.normalMap&&(e.normalMap=this.getTexture(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;Array.isArray(i)===!1&&(i=[i,i]),e.normalScale=(new o.Vector2).fromArray(i)}if(void 0!==t.displacementMap&&(e.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(e.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(e.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(e.roughnessMap=this.getTexture(t.roughnessMap)),void 0!==t.metalnessMap&&(e.metalnessMap=this.getTexture(t.metalnessMap)),void 0!==t.emissiveMap&&(e.emissiveMap=this.getTexture(t.emissiveMap)),void 0!==t.emissiveIntensity&&(e.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(e.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(e.envMap=this.getTexture(t.envMap),e.combine=o.MultiplyOperation),t.reflectivity&&(e.reflectivity=t.reflectivity),void 0!==t.lightMap&&(e.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(e.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(e.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(e.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var r=0,n=t.materials.length;n>r;r++)e.materials.push(this.parse(t.materials[r]));return e}},o.ObjectLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager,this.texturePath=""},o.ObjectLoader.prototype={constructor:o.ObjectLoader,load:function(t,e,i,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var n=this,s=new o.XHRLoader(n.manager);s.load(t,function(t){n.parse(JSON.parse(t),e)},i,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseGeometries(t.geometries),r=this.parseImages(t.images,function(){void 0!==e&&e(s)}),n=this.parseTextures(t.textures,r),o=this.parseMaterials(t.materials,n),s=this.parseObject(t.object,i,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new o.JSONLoader,r=new o.BufferGeometryLoader,n=0,s=t.length;s>n;n++){var a,h=t[n];switch(h.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new o[h.type](h.width,h.height,h.widthSegments,h.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new o[h.type](h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new o[h.type](h.radius,h.segments,h.thetaStart,h.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new o[h.type](h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new o[h.type](h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case"DodecahedronGeometry":a=new o.DodecahedronGeometry(h.radius,h.detail);break;case"IcosahedronGeometry":a=new o.IcosahedronGeometry(h.radius,h.detail);break;case"OctahedronGeometry":a=new o.OctahedronGeometry(h.radius,h.detail);break;case"TetrahedronGeometry":a=new o.TetrahedronGeometry(h.radius,h.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new o[h.type](h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new o[h.type](h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new o[h.type](h.radius,h.tube,h.tubularSegments,h.radialSegments,h.p,h.q);break;case"LatheGeometry":a=new o.LatheGeometry(h.points,h.segments,h.phiStart,h.phiLength);break;case"BufferGeometry":a=r.parse(h);break;case"Geometry":a=i.parse(h.data,this.texturePath).geometry;break;default:continue}a.uuid=h.uuid,void 0!==h.name&&(a.name=h.name),e[h.uuid]=a}return e},parseMaterials:function(t,e){var i={};if(void 0!==t){var r=new o.MaterialLoader;r.setTextures(e);for(var n=0,s=t.length;s>n;n++){var a=r.parse(t[n]);i[a.uuid]=a}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var r=o.AnimationClip.parse(t[i]);e.push(r)}return e},parseImages:function(t,e){function i(t){return r.manager.itemStart(t),a.load(t,function(){r.manager.itemEnd(t)})}var r=this,n={};if(void 0!==t&&t.length>0){var s=new o.LoadingManager(e),a=new o.ImageLoader(s);a.setCrossOrigin(this.crossOrigin);for(var h=0,l=t.length;l>h;h++){var c=t[h],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:r.texturePath+c.url;n[c.uuid]=i(u)}}return n},parseTextures:function(t,e){function i(t){return"number"==typeof t?t:o[t]}var r={};if(void 0!==t)for(var n=0,s=t.length;s>n;n++){var a=t[n];void 0===a.image,void 0===e[a.image];var h=new o.Texture(e[a.image]);h.needsUpdate=!0,h.uuid=a.uuid,void 0!==a.name&&(h.name=a.name),void 0!==a.mapping&&(h.mapping=i(a.mapping)),void 0!==a.offset&&(h.offset=new o.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(h.repeat=new o.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(h.minFilter=i(a.minFilter)),void 0!==a.magFilter&&(h.magFilter=i(a.magFilter)),void 0!==a.anisotropy&&(h.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(h.wrapS=i(a.wrap[0]),h.wrapT=i(a.wrap[1])),r[a.uuid]=h}return r},parseObject:function(){var t=new o.Matrix4;return function(e,i,r){function n(t){return void 0===i[t],i[t]}function s(t){return void 0!==t?(void 0===r[t],r[t]):void 0}var a;switch(e.type){case"Scene":a=new o.Scene;break;case"PerspectiveCamera":a=new o.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":a=new o.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new o.AmbientLight(e.color,e.intensity);break;case"DirectionalLight":a=new o.DirectionalLight(e.color,e.intensity);break;case"PointLight":a=new o.PointLight(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new o.SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new o.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":var h=n(e.geometry),l=s(e.material);a=h.bones&&h.bones.length>0?new o.SkinnedMesh(h,l):new o.Mesh(h,l);break;case"LOD":a=new o.LOD;break;case"Line":a=new o.Line(n(e.geometry),s(e.material),e.mode);break;case"PointCloud":case"Points":a=new o.Points(n(e.geometry),s(e.material));break;case"Sprite":a=new o.Sprite(s(e.material));break;case"Group":a=new o.Group;break;default:a=new o.Object3D}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var c in e.children)a.add(this.parseObject(e.children[c],i,r));if("LOD"===e.type)for(var u=e.levels,p=0;p<u.length;p++){var d=u[p],c=a.getObjectByProperty("uuid",d.object);void 0!==c&&a.addLevel(c,d.distance)}return a}}()},o.TextureLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager},o.TextureLoader.prototype={constructor:o.TextureLoader,load:function(t,e,i,r){var n=new o.Texture,s=new o.ImageLoader(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(t){n.image=t,n.needsUpdate=!0,void 0!==e&&e(n)},i,r),n},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},o.CubeTextureLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager},o.CubeTextureLoader.prototype={constructor:o.CubeTextureLoader,load:function(t,e,i,r){function n(i){a.load(t[i],function(t){s.images[i]=t,h++,6===h&&(s.needsUpdate=!0,e&&e(s))},void 0,r)}var s=new o.CubeTexture,a=new o.ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);for(var h=0,l=0;l<t.length;++l)n(l);return s},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},o.DataTextureLoader=o.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager,this._parser=null},o.BinaryTextureLoader.prototype={constructor:o.BinaryTextureLoader,load:function(t,e,i,r){var n=this,s=new o.DataTexture,a=new o.XHRLoader(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var i=n._parser(t);i&&(void 0!==i.image?s.image=i.image:void 0!==i.data&&(s.image.width=i.width,s.image.height=i.height,s.image.data=i.data),s.wrapS=void 0!==i.wrapS?i.wrapS:o.ClampToEdgeWrapping,s.wrapT=void 0!==i.wrapT?i.wrapT:o.ClampToEdgeWrapping,s.magFilter=void 0!==i.magFilter?i.magFilter:o.LinearFilter,s.minFilter=void 0!==i.minFilter?i.minFilter:o.LinearMipMapLinearFilter,s.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(s.format=i.format),void 0!==i.type&&(s.type=i.type),void 0!==i.mipmaps&&(s.mipmaps=i.mipmaps),1===i.mipmapCount&&(s.minFilter=o.LinearFilter),s.needsUpdate=!0,e&&e(s,i))},i,r),s}},o.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:o.DefaultLoadingManager,this._parser=null},o.CompressedTextureLoader.prototype={constructor:o.CompressedTextureLoader,load:function(t,e,i,r){function n(n){l.load(t[n],function(t){var i=s._parser(t,!0);a[n]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},c+=1,6===c&&(1===i.mipmapCount&&(h.minFilter=o.LinearFilter),h.format=i.format,h.needsUpdate=!0,e&&e(h))},i,r)}var s=this,a=[],h=new o.CompressedTexture;h.image=a;var l=new o.XHRLoader(this.manager);if(l.setPath(this.path),l.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,u=0,p=t.length;p>u;++u)n(u);else l.load(t,function(t){var i=s._parser(t,!0);if(i.isCubemap)for(var r=i.mipmaps.length/i.mipmapCount,n=0;r>n;n++){a[n]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)a[n].mipmaps.push(i.mipmaps[n*i.mipmapCount+l]),a[n].format=i.format,a[n].width=i.width,a[n].height=i.height}else h.image.width=i.width,h.image.height=i.height,h.mipmaps=i.mipmaps;1===i.mipmapCount&&(h.minFilter=o.LinearFilter),h.format=i.format,h.needsUpdate=!0,e&&e(h)},i,r);return h},setPath:function(t){this.path=t}},o.Material=function(){Object.defineProperty(this,"id",{value:o.MaterialIdCount++}),this.uuid=o.Math.generateUUID(),this.name="",this.type="Material",this.side=o.FrontSide,this.opacity=1,this.transparent=!1,this.blending=o.NormalBlending,this.blendSrc=o.SrcAlphaFactor,this.blendDst=o.OneMinusSrcAlphaFactor,this.blendEquation=o.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=o.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},o.Material.prototype={constructor:o.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){var r=this[e];void 0!==r&&(r instanceof o.Color?r.set(i):r instanceof o.Vector3&&i instanceof o.Vector3?r.copy(i):"overdraw"===e?this[e]=Number(i):this[e]=i)}}},toJSON:function(t){function e(t){var e=[];for(var i in t){var r=t[i];delete r.metadata,e.push(r)}return e}var i=void 0===t;i&&(t={textures:{},images:{}});var r={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color instanceof o.Color&&(r.color=this.color.getHex()),.5!==this.roughness&&(r.roughness=this.roughness),.5!==this.metalness&&(r.metalness=this.metalness),this.emissive instanceof o.Color&&(r.emissive=this.emissive.getHex()),this.specular instanceof o.Color&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),this.map instanceof o.Texture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap instanceof o.Texture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof o.Texture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof o.Texture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap instanceof o.Texture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap instanceof o.Texture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap instanceof o.Texture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap instanceof o.Texture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap instanceof o.Texture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap instanceof o.Texture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof o.Texture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==o.NoColors&&(r.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==o.SmoothShading&&(r.shading=this.shading),void 0!==this.blending&&this.blending!==o.NormalBlending&&(r.blending=this.blending),void 0!==this.side&&this.side!==o.FrontSide&&(r.side=this.side),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),i){var n=e(t.textures),s=e(t.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},o.EventDispatcher.prototype.apply(o.Material.prototype),o.MaterialIdCount=0,o.LineBasicMaterial=function(t){o.Material.call(this),this.type="LineBasicMaterial",this.color=new o.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.blending=o.NormalBlending,this.vertexColors=o.NoColors,this.fog=!0,this.setValues(t)},o.LineBasicMaterial.prototype=Object.create(o.Material.prototype),o.LineBasicMaterial.prototype.constructor=o.LineBasicMaterial,o.LineBasicMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this},o.LineDashedMaterial=function(t){o.Material.call(this),this.type="LineDashedMaterial",this.color=new o.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.blending=o.NormalBlending,this.vertexColors=o.NoColors,this.fog=!0,this.setValues(t)},o.LineDashedMaterial.prototype=Object.create(o.Material.prototype),o.LineDashedMaterial.prototype.constructor=o.LineDashedMaterial,o.LineDashedMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this},o.MeshBasicMaterial=function(t){o.Material.call(this),this.type="MeshBasicMaterial",this.color=new o.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=o.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=o.SmoothShading,this.blending=o.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=o.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},o.MeshBasicMaterial.prototype=Object.create(o.Material.prototype),o.MeshBasicMaterial.prototype.constructor=o.MeshBasicMaterial,o.MeshBasicMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},o.MeshLambertMaterial=function(t){o.Material.call(this),this.type="MeshLambertMaterial",this.color=new o.Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new o.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=o.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.blending=o.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=o.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},o.MeshLambertMaterial.prototype=Object.create(o.Material.prototype),o.MeshLambertMaterial.prototype.constructor=o.MeshLambertMaterial,o.MeshLambertMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},o.MeshPhongMaterial=function(t){o.Material.call(this),this.type="MeshPhongMaterial",this.color=new o.Color(16777215),this.specular=new o.Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new o.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new o.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=o.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=o.SmoothShading,this.blending=o.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=o.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},o.MeshPhongMaterial.prototype=Object.create(o.Material.prototype),o.MeshPhongMaterial.prototype.constructor=o.MeshPhongMaterial,o.MeshPhongMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},o.MeshStandardMaterial=function(t){o.Material.call(this),this.type="MeshStandardMaterial",this.color=new o.Color(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new o.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new o.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.fog=!0,this.shading=o.SmoothShading,this.blending=o.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=o.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},o.MeshStandardMaterial.prototype=Object.create(o.Material.prototype),o.MeshStandardMaterial.prototype.constructor=o.MeshStandardMaterial,o.MeshStandardMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},o.MeshDepthMaterial=function(t){o.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},o.MeshDepthMaterial.prototype=Object.create(o.Material.prototype),
o.MeshDepthMaterial.prototype.constructor=o.MeshDepthMaterial,o.MeshDepthMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},o.MeshNormalMaterial=function(t){o.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},o.MeshNormalMaterial.prototype=Object.create(o.Material.prototype),o.MeshNormalMaterial.prototype.constructor=o.MeshNormalMaterial,o.MeshNormalMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},o.MultiMaterial=function(t){this.uuid=o.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0},o.MultiMaterial.prototype={constructor:o.MultiMaterial,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},i=this.materials,r=0,n=i.length;n>r;r++){var o=i[r].toJSON(t);delete o.metadata,e.materials.push(o)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},o.PointsMaterial=function(t){o.Material.call(this),this.type="PointsMaterial",this.color=new o.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.blending=o.NormalBlending,this.vertexColors=o.NoColors,this.fog=!0,this.setValues(t)},o.PointsMaterial.prototype=Object.create(o.Material.prototype),o.PointsMaterial.prototype.constructor=o.PointsMaterial,o.PointsMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this},o.ShaderMaterial=function(t){o.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=o.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=o.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes,this.setValues(t))},o.ShaderMaterial.prototype=Object.create(o.Material.prototype),o.ShaderMaterial.prototype.constructor=o.ShaderMaterial,o.ShaderMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=o.UniformsUtils.clone(t.uniforms),this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},o.ShaderMaterial.prototype.toJSON=function(t){var e=o.Material.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},o.RawShaderMaterial=function(t){o.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},o.RawShaderMaterial.prototype=Object.create(o.ShaderMaterial.prototype),o.RawShaderMaterial.prototype.constructor=o.RawShaderMaterial,o.SpriteMaterial=function(t){o.Material.call(this),this.type="SpriteMaterial",this.color=new o.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},o.SpriteMaterial.prototype=Object.create(o.Material.prototype),o.SpriteMaterial.prototype.constructor=o.SpriteMaterial,o.SpriteMaterial.prototype.copy=function(t){return o.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this},o.Texture=function(t,e,i,r,n,s,a,h,l){Object.defineProperty(this,"id",{value:o.TextureIdCount++}),this.uuid=o.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:o.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:o.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:o.ClampToEdgeWrapping,this.wrapT=void 0!==r?r:o.ClampToEdgeWrapping,this.magFilter=void 0!==n?n:o.LinearFilter,this.minFilter=void 0!==s?s:o.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:o.RGBAFormat,this.type=void 0!==h?h:o.UnsignedByteType,this.offset=new o.Vector2(0,0),this.repeat=new o.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=o.LinearEncoding,this.version=0,this.onUpdate=null},o.Texture.DEFAULT_IMAGE=void 0,o.Texture.DEFAULT_MAPPING=o.UVMapping,o.Texture.prototype={constructor:o.Texture,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){function e(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElement("canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=o.Math.generateUUID()),void 0===t.images[r.uuid]&&(t.images[r.uuid]={uuid:r.uuid,url:e(r)}),i.image=r.uuid}return t.textures[this.uuid]=i,i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===o.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case o.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case o.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case o.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case o.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case o.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case o.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},o.EventDispatcher.prototype.apply(o.Texture.prototype),o.TextureIdCount=0,o.CanvasTexture=function(t,e,i,r,n,s,a,h,l){o.Texture.call(this,t,e,i,r,n,s,a,h,l),this.needsUpdate=!0},o.CanvasTexture.prototype=Object.create(o.Texture.prototype),o.CanvasTexture.prototype.constructor=o.CanvasTexture,o.CubeTexture=function(t,e,i,r,n,s,a,h,l){t=void 0!==t?t:[],e=void 0!==e?e:o.CubeReflectionMapping,o.Texture.call(this,t,e,i,r,n,s,a,h,l),this.flipY=!1},o.CubeTexture.prototype=Object.create(o.Texture.prototype),o.CubeTexture.prototype.constructor=o.CubeTexture,Object.defineProperty(o.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),o.CompressedTexture=function(t,e,i,r,n,s,a,h,l,c,u){o.Texture.call(this,null,s,a,h,l,c,r,n,u),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1},o.CompressedTexture.prototype=Object.create(o.Texture.prototype),o.CompressedTexture.prototype.constructor=o.CompressedTexture,o.DataTexture=function(t,e,i,r,n,s,a,h,l,c,u){o.Texture.call(this,null,s,a,h,l,c,r,n,u),this.image={data:t,width:e,height:i},this.magFilter=void 0!==l?l:o.NearestFilter,this.minFilter=void 0!==c?c:o.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},o.DataTexture.prototype=Object.create(o.Texture.prototype),o.DataTexture.prototype.constructor=o.DataTexture,o.VideoTexture=function(t,e,i,r,n,s,a,h,l){function c(){requestAnimationFrame(c),t.readyState===t.HAVE_ENOUGH_DATA&&(u.needsUpdate=!0)}o.Texture.call(this,t,e,i,r,n,s,a,h,l),this.generateMipmaps=!1;var u=this;c()},o.VideoTexture.prototype=Object.create(o.Texture.prototype),o.VideoTexture.prototype.constructor=o.VideoTexture,o.Group=function(){o.Object3D.call(this),this.type="Group"},o.Group.prototype=Object.create(o.Object3D.prototype),o.Group.prototype.constructor=o.Group,o.Points=function(t,e){o.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new o.Geometry,this.material=void 0!==e?e:new o.PointsMaterial({color:16777215*Math.random()})},o.Points.prototype=Object.create(o.Object3D.prototype),o.Points.prototype.constructor=o.Points,o.Points.prototype.raycast=function(){var t=new o.Matrix4,e=new o.Ray,i=new o.Sphere;return function(r,n){function s(t,i){var o=e.distanceSqToPoint(t);if(p>o){var s=e.closestPointToPoint(t);s.applyMatrix4(l);var h=r.ray.origin.distanceTo(s);if(h<r.near||h>r.far)return;n.push({distance:h,distanceToRay:Math.sqrt(o),point:s.clone(),index:i,face:null,object:a})}}var a=this,h=this.geometry,l=this.matrixWorld,c=r.params.Points.threshold;if(null===h.boundingSphere&&h.computeBoundingSphere(),i.copy(h.boundingSphere),i.applyMatrix4(l),r.ray.intersectsSphere(i)!==!1){t.getInverse(l),e.copy(r.ray).applyMatrix4(t);var u=c/((this.scale.x+this.scale.y+this.scale.z)/3),p=u*u,d=new o.Vector3;if(h instanceof o.BufferGeometry){var f=h.index,m=h.attributes,g=m.position.array;if(null!==f)for(var v=f.array,y=0,x=v.length;x>y;y++){var _=v[y];d.fromArray(g,3*_),s(d,_)}else for(var y=0,b=g.length/3;b>y;y++)d.fromArray(g,3*y),s(d,y)}else for(var w=h.vertices,y=0,b=w.length;b>y;y++)s(w[y],y)}}}(),o.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},o.Line=function(t,e,i){return 1===i?new o.LineSegments(t,e):(o.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new o.Geometry,void(this.material=void 0!==e?e:new o.LineBasicMaterial({color:16777215*Math.random()})))},o.Line.prototype=Object.create(o.Object3D.prototype),o.Line.prototype.constructor=o.Line,o.Line.prototype.raycast=function(){var t=new o.Matrix4,e=new o.Ray,i=new o.Sphere;return function(r,n){var s=r.linePrecision,a=s*s,h=this.geometry,l=this.matrixWorld;if(null===h.boundingSphere&&h.computeBoundingSphere(),i.copy(h.boundingSphere),i.applyMatrix4(l),r.ray.intersectsSphere(i)!==!1){t.getInverse(l),e.copy(r.ray).applyMatrix4(t);var c=new o.Vector3,u=new o.Vector3,p=new o.Vector3,d=new o.Vector3,f=this instanceof o.LineSegments?2:1;if(h instanceof o.BufferGeometry){var m=h.index,g=h.attributes,v=g.position.array;if(null!==m)for(var y=m.array,x=0,_=y.length-1;_>x;x+=f){var b=y[x],w=y[x+1];c.fromArray(v,3*b),u.fromArray(v,3*w);var S=e.distanceSqToSegment(c,u,d,p);if(!(S>a)){d.applyMatrix4(this.matrixWorld);var T=r.ray.origin.distanceTo(d);T<r.near||T>r.far||n.push({distance:T,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else for(var x=0,_=v.length/3-1;_>x;x+=f){c.fromArray(v,3*x),u.fromArray(v,3*x+3);var S=e.distanceSqToSegment(c,u,d,p);if(!(S>a)){d.applyMatrix4(this.matrixWorld);var T=r.ray.origin.distanceTo(d);T<r.near||T>r.far||n.push({distance:T,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else if(h instanceof o.Geometry)for(var M=h.vertices,E=M.length,x=0;E-1>x;x+=f){var S=e.distanceSqToSegment(M[x],M[x+1],d,p);if(!(S>a)){d.applyMatrix4(this.matrixWorld);var T=r.ray.origin.distanceTo(d);T<r.near||T>r.far||n.push({distance:T,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}}}(),o.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},o.LineStrip=0,o.LinePieces=1,o.LineSegments=function(t,e){o.Line.call(this,t,e),this.type="LineSegments"},o.LineSegments.prototype=Object.create(o.Line.prototype),o.LineSegments.prototype.constructor=o.LineSegments,o.Mesh=function(t,e){o.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new o.Geometry,this.material=void 0!==e?e:new o.MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=o.TrianglesDrawMode,this.updateMorphTargets()},o.Mesh.prototype=Object.create(o.Object3D.prototype),o.Mesh.prototype.constructor=o.Mesh,o.Mesh.prototype.setDrawMode=function(t){this.drawMode=t},o.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},o.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:0},o.Mesh.prototype.raycast=function(){function t(t,e,i,r,n,s,a){return o.Triangle.barycoordFromPoint(t,e,i,r,g),n.multiplyScalar(g.x),s.multiplyScalar(g.y),a.multiplyScalar(g.z),n.add(s).add(a),n.clone()}function e(t,e,i,r,n,s,a){var h,l=t.material;if(h=l.side===o.BackSide?i.intersectTriangle(s,n,r,!0,a):i.intersectTriangle(r,n,s,l.side!==o.DoubleSide,a),null===h)return null;y.copy(a),y.applyMatrix4(t.matrixWorld);var c=e.ray.origin.distanceTo(y);return c<e.near||c>e.far?null:{distance:c,point:y.clone(),object:t}}function i(i,r,n,s,c,u,p,g){a.fromArray(s,3*u),h.fromArray(s,3*p),l.fromArray(s,3*g);var y=e(i,r,n,a,h,l,v);return y&&(c&&(d.fromArray(c,2*u),f.fromArray(c,2*p),m.fromArray(c,2*g),y.uv=t(v,a,h,l,d,f,m)),y.face=new o.Face3(u,p,g,o.Triangle.normal(a,h,l)),y.faceIndex=u),y}var r=new o.Matrix4,n=new o.Ray,s=new o.Sphere,a=new o.Vector3,h=new o.Vector3,l=new o.Vector3,c=new o.Vector3,u=new o.Vector3,p=new o.Vector3,d=new o.Vector2,f=new o.Vector2,m=new o.Vector2,g=new o.Vector3,v=new o.Vector3,y=new o.Vector3;return function(g,y){var x=this.geometry,_=this.material,b=this.matrixWorld;if(void 0!==_&&(null===x.boundingSphere&&x.computeBoundingSphere(),s.copy(x.boundingSphere),s.applyMatrix4(b),g.ray.intersectsSphere(s)!==!1&&(r.getInverse(b),n.copy(g.ray).applyMatrix4(r),null===x.boundingBox||n.intersectsBox(x.boundingBox)!==!1))){var w,S;if(x instanceof o.BufferGeometry){var T,M,E,C=x.index,A=x.attributes,L=A.position.array;if(void 0!==A.uv&&(w=A.uv.array),null!==C)for(var P=C.array,R=0,O=P.length;O>R;R+=3)T=P[R],M=P[R+1],E=P[R+2],S=i(this,g,n,L,w,T,M,E),S&&(S.faceIndex=Math.floor(R/3),y.push(S));else for(var R=0,O=L.length;O>R;R+=9)T=R/3,M=T+1,E=T+2,S=i(this,g,n,L,w,T,M,E),S&&(S.index=T,y.push(S))}else if(x instanceof o.Geometry){var I,D,B,k=_ instanceof o.MultiMaterial,F=k===!0?_.materials:null,N=x.vertices,U=x.faces,G=x.faceVertexUvs[0];G.length>0&&(w=G);for(var z=0,V=U.length;V>z;z++){var j=U[z],H=k===!0?F[j.materialIndex]:_;if(void 0!==H){if(I=N[j.a],D=N[j.b],B=N[j.c],H.morphTargets===!0){var W=x.morphTargets,X=this.morphTargetInfluences;a.set(0,0,0),h.set(0,0,0),l.set(0,0,0);for(var Y=0,q=W.length;q>Y;Y++){var K=X[Y];if(0!==K){var Z=W[Y].vertices;a.addScaledVector(c.subVectors(Z[j.a],I),K),h.addScaledVector(u.subVectors(Z[j.b],D),K),l.addScaledVector(p.subVectors(Z[j.c],B),K)}}a.add(I),h.add(D),l.add(B),I=a,D=h,B=l}if(S=e(this,g,n,I,D,B,v)){if(w){var J=w[z];d.copy(J[0]),f.copy(J[1]),m.copy(J[2]),S.uv=t(v,I,D,B,d,f,m)}S.face=j,S.faceIndex=z,y.push(S)}}}}}}}(),o.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},o.Bone=function(t){o.Object3D.call(this),this.type="Bone",this.skin=t},o.Bone.prototype=Object.create(o.Object3D.prototype),o.Bone.prototype.constructor=o.Bone,o.Bone.prototype.copy=function(t){return o.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this},o.Skeleton=function(t,e,i){if(this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new o.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var r=Math.sqrt(4*this.bones.length);r=o.Math.nextPowerOfTwo(Math.ceil(r)),r=Math.max(r,4),this.boneTextureWidth=r,this.boneTextureHeight=r,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new o.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,o.RGBAFormat,o.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{this.boneInverses=[];for(var n=0,s=this.bones.length;s>n;n++)this.boneInverses.push(new o.Matrix4)}},o.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;e>t;t++){var i=new o.Matrix4;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},o.Skeleton.prototype.pose=function(){for(var t,e=0,i=this.bones.length;i>e;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,i=this.bones.length;i>e;e++)t=this.bones[e],t&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},o.Skeleton.prototype.update=function(){var t=new o.Matrix4;return function(){for(var e=0,i=this.bones.length;i>e;e++){var r=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(r,this.boneInverses[e]),t.flattenToArrayOffset(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),o.Skeleton.prototype.clone=function(){return new o.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},o.SkinnedMesh=function(t,e,i){o.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new o.Matrix4,this.bindMatrixInverse=new o.Matrix4;var r=[];if(this.geometry&&void 0!==this.geometry.bones){for(var n,s,a=0,h=this.geometry.bones.length;h>a;++a)s=this.geometry.bones[a],n=new o.Bone(this),r.push(n),n.name=s.name,n.position.fromArray(s.pos),n.quaternion.fromArray(s.rotq),void 0!==s.scl&&n.scale.fromArray(s.scl);for(var a=0,h=this.geometry.bones.length;h>a;++a)s=this.geometry.bones[a],-1!==s.parent&&null!==s.parent?r[s.parent].add(r[a]):this.add(r[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new o.Skeleton(r,void 0,i),this.matrixWorld)},o.SkinnedMesh.prototype=Object.create(o.Mesh.prototype),o.SkinnedMesh.prototype.constructor=o.SkinnedMesh,o.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},o.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},o.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof o.Geometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0)}else if(this.geometry instanceof o.BufferGeometry)for(var r=new o.Vector4,n=this.geometry.attributes.skinWeight,t=0;t<n.count;t++){r.x=n.getX(t),r.y=n.getY(t),r.z=n.getZ(t),r.w=n.getW(t);var i=1/r.lengthManhattan();i!==1/0?r.multiplyScalar(i):r.set(1,0,0,0),n.setXYZW(t,r.x,r.y,r.z,r.w)}},o.SkinnedMesh.prototype.updateMatrixWorld=function(t){o.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode&&this.bindMatrixInverse.getInverse(this.bindMatrix)},o.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},o.LOD=function(){o.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return this.levels}}})},o.LOD.prototype=Object.create(o.Object3D.prototype),o.LOD.prototype.constructor=o.LOD,o.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,r=0;r<i.length&&!(e<i[r].distance);r++);i.splice(r,0,{distance:e,object:t}),this.add(t)},o.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,i=1,r=e.length;r>i&&!(t<e[i].distance);i++);return e[i-1].object},o.LOD.prototype.raycast=function(){var t=new o.Vector3;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(t);this.getObjectForDistance(r).raycast(e,i)}}(),o.LOD.prototype.update=function(){var t=new o.Vector3,e=new o.Vector3;return function(i){var r=this.levels;if(r.length>1){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var n=t.distanceTo(e);r[0].object.visible=!0;for(var o=1,s=r.length;s>o&&n>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;s>o;o++)r[o].object.visible=!1}}}(),o.LOD.prototype.copy=function(t){o.Object3D.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,r=e.length;r>i;i++){var n=e[i];this.addLevel(n.object.clone(),n.distance)}return this},o.LOD.prototype.toJSON=function(t){var e=o.Object3D.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,r=0,n=i.length;n>r;r++){var s=i[r];e.object.levels.push({object:s.object.uuid,distance:s.distance})}return e},o.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),e=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),i=new Float32Array([0,0,1,0,1,1,0,1]),r=new o.BufferGeometry;return r.setIndex(new o.BufferAttribute(t,1)),r.addAttribute("position",new o.BufferAttribute(e,3)),r.addAttribute("uv",new o.BufferAttribute(i,2)),function(t){o.Object3D.call(this),this.type="Sprite",this.geometry=r,this.material=void 0!==t?t:new o.SpriteMaterial}}(),o.Sprite.prototype=Object.create(o.Object3D.prototype),o.Sprite.prototype.constructor=o.Sprite,o.Sprite.prototype.raycast=function(){var t=new o.Vector3;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.distanceSqToPoint(t),n=this.scale.x*this.scale.y;r>n||i.push({distance:Math.sqrt(r),point:this.position,face:null,object:this})}}(),o.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},o.Particle=o.Sprite,o.LensFlare=function(t,e,i,r,n){o.Object3D.call(this),this.lensFlares=[],this.positionScreen=new o.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,r,n)},o.LensFlare.prototype=Object.create(o.Object3D.prototype),o.LensFlare.prototype.constructor=o.LensFlare,o.LensFlare.prototype.add=function(t,e,i,r,n,s){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=1),void 0===n&&(n=new o.Color(16777215)),void 0===r&&(r=o.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:s,color:n,blending:r})},o.LensFlare.prototype.updateLensFlares=function(){var t,e,i=this.lensFlares.length,r=2*-this.positionScreen.x,n=2*-this.positionScreen.y;for(t=0;i>t;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+r*e.distance,e.y=this.positionScreen.y+n*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},o.LensFlare.prototype.copy=function(t){o.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;i>e;e++)this.lensFlares.push(t.lensFlares[e]);return this},o.Scene=function(){o.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},o.Scene.prototype=Object.create(o.Object3D.prototype),o.Scene.prototype.constructor=o.Scene,o.Scene.prototype.copy=function(t,e){return o.Object3D.prototype.copy.call(this,t,e),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},o.Fog=function(t,e,i){this.name="",this.color=new o.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3},o.Fog.prototype.clone=function(){return new o.Fog(this.color.getHex(),this.near,this.far)},o.FogExp2=function(t,e){this.name="",this.color=new o.Color(t),this.density=void 0!==e?e:25e-5},o.FogExp2.prototype.clone=function(){return new o.FogExp2(this.color.getHex(),this.density)},o.ShaderChunk={},o.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",o.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif\n",o.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n	if ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",o.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n	#endif\n#endif\n",o.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",o.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",o.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",o.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n	return any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n		if( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n			float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n			float maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n			return distanceFalloff * maxDistanceCutoffFactor;\n#else\n			return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n		}\n		return 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	return 1.0 / ( gl * gv );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_GGX_Smith( alpha, dotNL, dotNV );\n	float D = D_GGX( alpha, dotNH );\n	return F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n	return specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",o.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 );\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif\n",o.ShaderChunk.color_fragment="#ifdef USE_COLOR\n	diffuseColor.rgb *= vColor;\n#endif",o.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif\n",o.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif",o.ShaderChunk.color_vertex="#ifdef USE_COLOR\n	vColor.xyz = color.xyz;\n#endif",o.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	float distance = dot( planeNormal, point - pointOnPlane );\n	return - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",
o.ShaderChunk.cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\nconst float cubeUV_textureSize = 1024.0;\nint getFaceFromDirection(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    int face = -1;\n    if( absDirection.x > absDirection.z ) {\n        if(absDirection.x > absDirection.y )\n            face = direction.x > 0.0 ? 0 : 3;\n        else\n            face = direction.y > 0.0 ? 1 : 4;\n    }\n    else {\n        if(absDirection.z > absDirection.y )\n            face = direction.z > 0.0 ? 2 : 5;\n        else\n            face = direction.y > 0.0 ? 1 : 4;\n    }\n    return face;\n}\nconst float cubeUV_maxLods1 = log2(cubeUV_textureSize*0.25) - 1.0;\nconst float cubeUV_rangeClamp = exp2((6.0 - 1.0) * 2.0);\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n    float scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n    float dxRoughness = dFdx(roughness);\n    float dyRoughness = dFdy(roughness);\n    vec3 dx = dFdx( vec * scale * dxRoughness );\n    vec3 dy = dFdy( vec * scale * dyRoughness );\n    float d = max( dot( dx, dx ), dot( dy, dy ) );\n    d = clamp(d, 1.0, cubeUV_rangeClamp);\n    float mipLevel = 0.5 * log2(d);\n    return vec2(floor(mipLevel), fract(mipLevel));\n}\nconst float cubeUV_maxLods2 = log2(cubeUV_textureSize*0.25) - 2.0;\nconst float cubeUV_rcpTextureSize = 1.0 / cubeUV_textureSize;\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n    mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n    float a = 16.0 * cubeUV_rcpTextureSize;\n    vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n    vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n    float powScale = exp2_packed.x * exp2_packed.y;\n    float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n    float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n    bool bRes = mipLevel == 0.0;\n    scale =  bRes && (scale < a) ? a : scale;\n    vec3 r;\n    vec2 offset;\n    int face = getFaceFromDirection(direction);\n    float rcpPowScale = 1.0 / powScale;\n    if( face == 0) {\n        r = vec3(direction.x, -direction.z, direction.y);\n        offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 1) {\n        r = vec3(direction.y, direction.x, direction.z);\n        offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 2) {\n        r = vec3(direction.z, direction.x, direction.y);\n        offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 3) {\n        r = vec3(direction.x, direction.z, direction.y);\n        offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    else if( face == 4) {\n        r = vec3(direction.y, direction.x, -direction.z);\n        offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    else {\n        r = vec3(direction.z, -direction.x, direction.y);\n        offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    r = normalize(r);\n    float texelOffset = 0.5 * cubeUV_rcpTextureSize;\n    vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n    vec2 base = offset + vec2( texelOffset );\n    return base + s * ( scale - 2.0 * texelOffset );\n}\nconst float cubeUV_maxLods3 = log2(cubeUV_textureSize*0.25) - 3.0;\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n    float roughnessVal = roughness* cubeUV_maxLods3;\n    float r1 = floor(roughnessVal);\n    float r2 = r1 + 1.0;\n    float t = fract(roughnessVal);\n    vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n    float s = mipInfo.y;\n    float level0 = mipInfo.x;\n    float level1 = level0 + 1.0;\n    level1 = level1 > 5.0 ? 5.0 : level1;\n    level0 += min( floor( s + 0.5 ), 5.0 );\n    vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n    vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n    vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n    vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n    vec4 result = mix(color10, color20, t);\n    return vec4(result.rgb, 1.0);\n}\n#endif\n",o.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n	objectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",o.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n	transformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",o.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif\n",o.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",o.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif\n",o.ShaderChunk.encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",o.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",o.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef DOUBLE_SIDED\n		float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#else\n		float flipNormal = 1.0;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n	envColor = envMapTexelToLinear( envColor );\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif\n",o.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( STANDARD )\n	uniform float reflectivity;\n	uniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( STANDARD )\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif\n",o.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n	varying vec3 vReflect;\n	uniform float refractionRatio;\n#endif\n",o.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n	vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	#ifdef ENVMAP_MODE_REFLECTION\n		vReflect = reflect( cameraToVertex, worldNormal );\n	#else\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n	#endif\n#endif\n",o.ShaderChunk.fog_fragment="#ifdef USE_FOG\n	#ifdef USE_LOGDEPTHBUF_EXT\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n	#else\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n	#endif\n	#ifdef FOG_EXP2\n		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",o.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n	uniform vec3 fogColor;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",o.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",o.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",o.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n	vLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		directLight = getPointDirectLightIrradiance( pointLights[ i ], geometry );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		directLight = getSpotDirectLightIrradiance( spotLights[ i ], geometry );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_DIR_LIGHTS > 0\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directLight = getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n		vLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		#ifdef DOUBLE_SIDED\n			vLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n		#endif\n	}\n#endif\n",o.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	return irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	IncidentLight getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry ) {\n		IncidentLight directLight;\n		directLight.color = directionalLight.color;\n		directLight.direction = directionalLight.direction;\n		directLight.visible = true;\n		return directLight;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	IncidentLight getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry ) {\n		IncidentLight directLight;\n		vec3 lVector = pointLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		if ( testLightInRange( lightDistance, pointLight.distance ) ) {\n			directLight.color = pointLight.color;\n			directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n		return directLight;\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	IncidentLight getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry ) {\n		IncidentLight directLight;\n		vec3 lVector = spotLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		float angleCos = dot( directLight.direction, spotLight.direction );\n		if ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n			directLight.color = spotLight.color;\n			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n		return directLight;\n	}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n		float dotNL = dot( geometry.normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			irradiance *= PI;\n		#endif\n		return irradiance;\n	}\n#endif\n#if defined( USE_ENVMAP ) && defined( STANDARD )\n	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n		#ifdef DOUBLE_SIDED\n			float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		#else\n			float flipNormal = 1.0;\n		#endif\n		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n			#endif\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			vec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n		#else\n			vec4 envMapColor = vec4( 0.0 );\n		#endif\n		envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		return PI * envMapColor.rgb * envMapIntensity;\n	}\n	float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n		float maxMIPLevelScalar = float( maxMIPLevel );\n		float desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n	}\n	vec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n		#else\n			vec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n		#endif\n		#ifdef DOUBLE_SIDED\n			float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		#else\n			float flipNormal = 1.0;\n		#endif\n		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n		float specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n			#endif\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			vec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n		#elif defined( ENVMAP_TYPE_EQUIREC )\n			vec2 sampleUV;\n			sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n			sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n			#else\n				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n			#endif\n		#elif defined( ENVMAP_TYPE_SPHERE )\n			vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n			#else\n				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n			#endif\n		#endif\n		envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		return envMapColor.rgb * envMapIntensity;\n	}\n#endif\n",o.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",o.ShaderChunk.lights_phong_pars_fragment="#ifdef USE_ENVMAP\n	varying vec3 vWorldPosition;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n	vec3	diffuseColor;\n	vec3	specularColor;\n	float	specularShininess;\n	float	specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )	(0)\n",o.ShaderChunk.lights_phong_pars_vertex="#ifdef USE_ENVMAP\n	varying vec3 vWorldPosition;\n#endif\n",o.ShaderChunk.lights_phong_vertex="#ifdef USE_ENVMAP\n	vWorldPosition = worldPosition.xyz;\n#endif\n",o.ShaderChunk.lights_standard_fragment="StandardMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\nmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n",o.ShaderChunk.lights_standard_pars_fragment="struct StandardMaterial {\n	vec3	diffuseColor;\n	float	specularRoughness;\n	vec3	specularColor;\n};\nvoid RE_Direct_Standard( const in IncidentLight directLight, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Standard( const in vec3 irradiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Standard( const in vec3 radiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct				RE_Direct_Standard\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Standard\n#define RE_IndirectSpecular		RE_IndirectSpecular_Standard\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",o.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		directLight = getPointDirectLightIrradiance( pointLight, geometry );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		directLight = getSpotDirectLightIrradiance( spotLight, geometry );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		directLight = getDirectionalDirectLightIrradiance( directionalLight, geometry );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#ifdef USE_LIGHTMAP\n		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			lightMapIrradiance *= PI;\n		#endif\n		irradiance += lightMapIrradiance;\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		}\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n	 	irradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n	#endif\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	vec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n	RE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n",o.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",o.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n	uniform float logDepthBufFC;\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n	#endif\n#endif\n",o.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n	#endif\n	uniform float logDepthBufFC;\n#endif",o.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n	#else\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n	#endif\n#endif\n",o.ShaderChunk.map_fragment="#ifdef USE_MAP\n	vec4 texelColor = texture2D( map, vUv );\n	texelColor = mapTexelToLinear( texelColor );\n	diffuseColor *= texelColor;\n#endif\n",o.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n",o.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n	vec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n	diffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",o.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n#endif\n",o.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vUv );\n	metalnessFactor *= texelMetalness.r;\n#endif\n",o.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",o.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",o.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n	#ifndef USE_MORPHNORMALS\n	uniform float morphTargetInfluences[ 8 ];\n	#else\n	uniform float morphTargetInfluences[ 4 ];\n	#endif\n#endif",o.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n	#ifndef USE_MORPHNORMALS\n	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n	#endif\n#endif\n",o.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n	#endif\n#endif\n#ifdef USE_NORMALMAP\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",o.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n	}\n#endif\n",
o.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",o.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n	vec4 mvPosition = modelViewMatrix * skinned;\n#else\n	vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",o.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vUv );\n	roughnessFactor *= texelRoughness.r;\n#endif\n",o.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",o.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n	#endif\n	float unpackDepth( const in vec4 rgba_depth ) {\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		return dot( rgba_depth, bit_shift );\n	}\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackDepth( texture2D( depths, uv ) ) );\n	}\n	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n		const vec2 offset = vec2( 0.0, 1.0 );\n		vec2 texelSize = vec2( 1.0 ) / size;\n		vec2 centroidUV = floor( uv * size + 0.5 ) / size;\n		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n		vec2 f = fract( uv * size + 0.5 );\n		float a = mix( lb, lt, f.y );\n		float b = mix( rb, rt, f.y );\n		float c = mix( a, b, f.x );\n		return c;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n		bool frustumTest = all( frustumTestVec );\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			return (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			return (\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return 1.0;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		vec3 bd3D = normalize( lightToPosition );\n		float dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif\n",o.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n	#endif\n#endif\n",o.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n#endif\n",o.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n	DirectionalLight directionalLight;\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		shadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n	SpotLight spotLight;\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		shadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n	PointLight pointLight;\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		shadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#endif\n	return shadow;\n}\n",o.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",o.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	#ifdef BONE_TEXTURE\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n		mat4 getBoneMatrix( const in float i ) {\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n			y = dy * ( y + 0.5 );\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n			mat4 bone = mat4( v1, v2, v3, v4 );\n			return bone;\n		}\n	#else\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n		mat4 getBoneMatrix( const in float i ) {\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n		}\n	#endif\n#endif\n",o.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n#endif\n",o.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",o.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",o.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",o.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",o.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",o.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	varying vec2 vUv2;\n#endif",o.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n#endif",o.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	vUv2 = uv2;\n#endif",o.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	varying vec2 vUv;\n#endif",o.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n#endif\n",o.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",o.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( STANDARD ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n	#ifdef USE_SKINNING\n		vec4 worldPosition = modelMatrix * skinned;\n	#else\n		vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n	#endif\n#endif\n",o.UniformsUtils={merge:function(t){for(var e={},i=0;i<t.length;i++){var r=this.clone(t[i]);for(var n in r)e[n]=r[n]}return e},clone:function(t){var e={};for(var i in t){e[i]={};for(var r in t[i]){var n=t[i][r];n instanceof o.Color||n instanceof o.Vector2||n instanceof o.Vector3||n instanceof o.Vector4||n instanceof o.Matrix3||n instanceof o.Matrix4||n instanceof o.Texture?e[i][r]=n.clone():Array.isArray(n)?e[i][r]=n.slice():e[i][r]=n}}return e}},o.UniformsLib={common:{diffuse:{type:"c",value:new o.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new o.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new o.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new o.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"f"},coneCos:{type:"f"},penumbraCos:{type:"f"},decay:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"f"},distance:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new o.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new o.Vector4(0,0,1,1)}}},o.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n	#include <logdepthbuf_fragment>\n}\n",o.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	vWorldPosition = transformDirection( position, modelMatrix );\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n	#include <logdepthbuf_vertex>\n}\n",o.ShaderChunk.depth_frag="uniform float mNear;\nuniform float mFar;\nuniform float opacity;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	#ifdef USE_LOGDEPTHBUF_EXT\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n	#else\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n	#endif\n	float color = 1.0 - smoothstep( mNear, mFar, depth );\n	gl_FragColor = vec4( vec3( color ), opacity );\n}\n",o.ShaderChunk.depth_vert="#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n}\n",o.ShaderChunk.depthRGBA_frag="#include <common>\n#include <logdepthbuf_pars_fragment>\nvec4 pack_depth( const in float depth ) {\n	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n	res -= res.xxyz * bit_mask;\n	return res;\n}\nvoid main() {\n	#include <logdepthbuf_fragment>\n	#ifdef USE_LOGDEPTHBUF_EXT\n		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n	#else\n		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n	#endif\n}\n",o.ShaderChunk.depthRGBA_vert="#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <skinbase_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n}\n",o.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\nvec4 pack1K ( float depth ) {\n	depth /= 1000.0;\n	const vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n	const vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n	vec4 res = mod( depth * bitSh * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n	res -= res.xxyz * bitMsk;\n	return res;\n}\nfloat unpack1K ( vec4 color ) {\n	const vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n	return dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n	gl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}\n",o.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\nvoid main() {\n	#include <skinbase_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	vWorldPosition = worldPosition;\n}\n",o.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	vec3 direction = normalize( vWorldPosition );\n	vec2 sampleUV;\n	sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <logdepthbuf_fragment>\n}\n",o.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	vWorldPosition = transformDirection( position, modelMatrix );\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n	#include <logdepthbuf_vertex>\n}\n",o.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",o.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	vLineDistance = scale * lineDistance;\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n}\n",o.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight;\n	reflectedLight.directDiffuse = vec3( 0.0 );\n	reflectedLight.directSpecular = vec3( 0.0 );\n	reflectedLight.indirectDiffuse = diffuseColor.rgb;\n	reflectedLight.indirectSpecular = vec3( 0.0 );\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",o.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_ENVMAP\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n}\n",o.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <emissivemap_fragment>\n	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n	#include <lightmap_fragment>\n	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n	#ifdef DOUBLE_SIDED\n		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n	#else\n		reflectedLight.directDiffuse = vLightFront;\n	#endif\n	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",o.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_lambert_vertex>\n	#include <shadowmap_vertex>\n}\n",o.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_template>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",o.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <lights_phong_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_phong_vertex>\n	#include <shadowmap_vertex>\n}\n",o.ShaderChunk.meshstandard_frag="#define STANDARD\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_standard_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment>\n	#include <emissivemap_fragment>\n	#include <lights_standard_fragment>\n	#include <lights_template>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",
o.ShaderChunk.meshstandard_vert="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n}\n",o.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n	#include <logdepthbuf_fragment>\n}\n",o.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	vNormal = normalize( normalMatrix * normal );\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n}\n",o.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",o.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <project_vertex>\n	#ifdef USE_SIZEATTENUATION\n		gl_PointSize = size * ( scale / - mvPosition.z );\n	#else\n		gl_PointSize = size;\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",o.ShaderLib={basic:{uniforms:o.UniformsUtils.merge([o.UniformsLib.common,o.UniformsLib.aomap,o.UniformsLib.fog]),vertexShader:o.ShaderChunk.meshbasic_vert,fragmentShader:o.ShaderChunk.meshbasic_frag},lambert:{uniforms:o.UniformsUtils.merge([o.UniformsLib.common,o.UniformsLib.aomap,o.UniformsLib.lightmap,o.UniformsLib.emissivemap,o.UniformsLib.fog,o.UniformsLib.lights,{emissive:{type:"c",value:new o.Color(0)}}]),vertexShader:o.ShaderChunk.meshlambert_vert,fragmentShader:o.ShaderChunk.meshlambert_frag},phong:{uniforms:o.UniformsUtils.merge([o.UniformsLib.common,o.UniformsLib.aomap,o.UniformsLib.lightmap,o.UniformsLib.emissivemap,o.UniformsLib.bumpmap,o.UniformsLib.normalmap,o.UniformsLib.displacementmap,o.UniformsLib.fog,o.UniformsLib.lights,{emissive:{type:"c",value:new o.Color(0)},specular:{type:"c",value:new o.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:o.ShaderChunk.meshphong_vert,fragmentShader:o.ShaderChunk.meshphong_frag},standard:{uniforms:o.UniformsUtils.merge([o.UniformsLib.common,o.UniformsLib.aomap,o.UniformsLib.lightmap,o.UniformsLib.emissivemap,o.UniformsLib.bumpmap,o.UniformsLib.normalmap,o.UniformsLib.displacementmap,o.UniformsLib.roughnessmap,o.UniformsLib.metalnessmap,o.UniformsLib.fog,o.UniformsLib.lights,{emissive:{type:"c",value:new o.Color(0)},roughness:{type:"f",value:.5},metalness:{type:"f",value:0},envMapIntensity:{type:"f",value:1}}]),vertexShader:o.ShaderChunk.meshstandard_vert,fragmentShader:o.ShaderChunk.meshstandard_frag},points:{uniforms:o.UniformsUtils.merge([o.UniformsLib.points,o.UniformsLib.fog]),vertexShader:o.ShaderChunk.points_vert,fragmentShader:o.ShaderChunk.points_frag},dashed:{uniforms:o.UniformsUtils.merge([o.UniformsLib.common,o.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:o.ShaderChunk.linedashed_vert,fragmentShader:o.ShaderChunk.linedashed_frag},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:o.ShaderChunk.depth_vert,fragmentShader:o.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:o.ShaderChunk.normal_vert,fragmentShader:o.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:o.ShaderChunk.cube_vert,fragmentShader:o.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:o.ShaderChunk.equirect_vert,fragmentShader:o.ShaderChunk.equirect_frag},depthRGBA:{uniforms:{},vertexShader:o.ShaderChunk.depthRGBA_vert,fragmentShader:o.ShaderChunk.depthRGBA_frag},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new o.Vector3(0,0,0)}},vertexShader:o.ShaderChunk.distanceRGBA_vert,fragmentShader:o.ShaderChunk.distanceRGBA_frag}},o.WebGLRenderer=function(t){function e(){return null===xt?Ot:1}function i(t,e,i,r){at===!0&&(t*=r,e*=r,i*=r),Yt.clearColor(t,e,i,r)}function r(){Yt.init(),Yt.scissor(Tt.copy(It).multiplyScalar(Ot)),Yt.viewport(Et.copy(Bt).multiplyScalar(Ot)),i(At.r,At.g,At.b,Lt)}function n(){yt=null,St=null,wt="",bt=-1,Yt.reset()}function s(t){t.preventDefault(),n(),r(),qt.clear()}function a(t){var e=t.target;e.removeEventListener("dispose",a),c(e),Gt.textures--}function h(t){var e=t.target;e.removeEventListener("dispose",h),u(e),Gt.textures--}function l(t){var e=t.target;e.removeEventListener("dispose",l),p(e)}function c(t){var e=qt.get(t);if(t.image&&e.__image__webglTextureCube)Vt.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)return;Vt.deleteTexture(e.__webglTexture)}qt["delete"](t)}function u(t){var e=qt.get(t),i=qt.get(t.texture);if(t&&void 0!==i.__webglTexture){if(Vt.deleteTexture(i.__webglTexture),t instanceof o.WebGLRenderTargetCube)for(var r=0;6>r;r++)Vt.deleteFramebuffer(e.__webglFramebuffer[r]),Vt.deleteRenderbuffer(e.__webglDepthbuffer[r]);else Vt.deleteFramebuffer(e.__webglFramebuffer),Vt.deleteRenderbuffer(e.__webglDepthbuffer);qt["delete"](t.texture),qt["delete"](t)}}function p(t){d(t),qt["delete"](t)}function d(t){var e=qt.get(t).program;t.program=void 0,void 0!==e&&Zt.releaseProgram(e)}function f(t,e,i,r){var n;if(!(i instanceof o.InstancedBufferGeometry&&(n=Wt.get("ANGLE_instanced_arrays"),null===n))){void 0===r&&(r=0),Yt.initAttributes();var s=i.attributes,a=e.getAttributes(),h=t.defaultAttributeValues;for(var l in a){var c=a[l];if(c>=0){var u=s[l];if(void 0!==u){var p=u.itemSize,d=Kt.getAttributeBuffer(u);if(u instanceof o.InterleavedBufferAttribute){var f=u.data,m=f.stride,g=u.offset;f instanceof o.InstancedInterleavedBuffer?(Yt.enableAttributeAndDivisor(c,f.meshPerAttribute,n),void 0===i.maxInstancedCount&&(i.maxInstancedCount=f.meshPerAttribute*f.count)):Yt.enableAttribute(c),Vt.bindBuffer(Vt.ARRAY_BUFFER,d),Vt.vertexAttribPointer(c,p,Vt.FLOAT,!1,m*f.array.BYTES_PER_ELEMENT,(r*m+g)*f.array.BYTES_PER_ELEMENT)}else u instanceof o.InstancedBufferAttribute?(Yt.enableAttributeAndDivisor(c,u.meshPerAttribute,n),void 0===i.maxInstancedCount&&(i.maxInstancedCount=u.meshPerAttribute*u.count)):Yt.enableAttribute(c),Vt.bindBuffer(Vt.ARRAY_BUFFER,d),Vt.vertexAttribPointer(c,p,Vt.FLOAT,!1,0,r*p*4)}else if(void 0!==h){var v=h[l];if(void 0!==v)switch(v.length){case 2:Vt.vertexAttrib2fv(c,v);break;case 3:Vt.vertexAttrib3fv(c,v);break;case 4:Vt.vertexAttrib4fv(c,v);break;default:Vt.vertexAttrib1fv(c,v)}}}}Yt.disableUnusedAttributes()}}function m(t,e){return Math.abs(e[0])-Math.abs(t[0])}function g(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function v(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function y(t,e,i,r,n){var o,s;i.transparent?(o=pt,s=++dt):(o=ct,s=++ut);var a=o[s];void 0!==a?(a.id=t.id,a.object=t,a.geometry=e,a.material=i,a.z=Nt.z,a.group=n):(a={id:t.id,object:t,geometry:e,material:i,z:Nt.z,group:n},o.push(a))}function x(t,e){if(t.visible!==!1){if(t.layers.test(e.layers))if(t instanceof o.Light)lt.push(t);else if(t instanceof o.Sprite)t.frustumCulled!==!1&&kt.intersectsObject(t)!==!0||mt.push(t);else if(t instanceof o.LensFlare)gt.push(t);else if(t instanceof o.ImmediateRenderObject)vt.sortObjects===!0&&(Nt.setFromMatrixPosition(t.matrixWorld),Nt.applyProjection(Ft)),y(t,null,t.material,Nt.z,null);else if((t instanceof o.Mesh||t instanceof o.Line||t instanceof o.Points)&&(t instanceof o.SkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||kt.intersectsObject(t)===!0)){var i=t.material;if(i.visible===!0){vt.sortObjects===!0&&(Nt.setFromMatrixPosition(t.matrixWorld),Nt.applyProjection(Ft));var r=Kt.update(t);if(i instanceof o.MultiMaterial)for(var n=r.groups,s=i.materials,a=0,h=n.length;h>a;a++){var l=n[a],c=s[l.materialIndex];c.visible===!0&&y(t,r,c,Nt.z,l)}else y(t,r,i,Nt.z,null)}}for(var u=t.children,a=0,h=u.length;h>a;a++)x(u[a],e)}}function _(t,e,i,r){for(var n=0,s=t.length;s>n;n++){var a=t[n],h=a.object,l=a.geometry,c=void 0===r?a.material:r,u=a.group;if(h.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),h instanceof o.ImmediateRenderObject){w(c);var p=T(e,i,c,h);wt="",h.render(function(t){vt.renderBufferImmediate(t,p,c)})}else vt.renderBufferDirect(e,i,l,c,h,u)}}function b(t,e,i){var r=qt.get(t),n=Zt.getParameters(t,Ut,e,i),s=Zt.getProgramCode(t,n),a=r.program,h=!0;if(void 0===a)t.addEventListener("dispose",l);else if(a.code!==s)d(t);else{if(void 0!==n.shaderID)return;h=!1}if(h){if(n.shaderID){var c=o.ShaderLib[n.shaderID];r.__webglShader={name:t.type,uniforms:o.UniformsUtils.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else r.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=r.__webglShader,a=Zt.acquireProgram(t,n,s),r.program=a,t.program=a}var u=a.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<vt.maxMorphTargets;p++)u["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var p=0;p<vt.maxMorphNormals;p++)u["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}r.uniformsList=[];var f=r.__webglShader.uniforms,m=r.program.getUniforms();for(var g in f){var v=m[g];v&&r.uniformsList.push([r.__webglShader.uniforms[g],v])}(t instanceof o.MeshPhongMaterial||t instanceof o.MeshLambertMaterial||t instanceof o.MeshStandardMaterial||t.lights)&&(r.lightsHash=Ut.hash,f.ambientLightColor.value=Ut.ambient,f.directionalLights.value=Ut.directional,f.spotLights.value=Ut.spot,f.pointLights.value=Ut.point,f.hemisphereLights.value=Ut.hemi,f.directionalShadowMap.value=Ut.directionalShadowMap,f.directionalShadowMatrix.value=Ut.directionalShadowMatrix,f.spotShadowMap.value=Ut.spotShadowMap,f.spotShadowMatrix.value=Ut.spotShadowMatrix,f.pointShadowMap.value=Ut.pointShadowMap,f.pointShadowMatrix.value=Ut.pointShadowMatrix),r.hasDynamicUniforms=!1;for(var y=0,x=r.uniformsList.length;x>y;y++){var _=r.uniformsList[y][0];if(_.dynamic===!0){r.hasDynamicUniforms=!0;break}}}function w(t){S(t),t.transparent===!0?Yt.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):Yt.setBlending(o.NoBlending),Yt.setDepthFunc(t.depthFunc),Yt.setDepthTest(t.depthTest),Yt.setDepthWrite(t.depthWrite),Yt.setColorWrite(t.colorWrite),Yt.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function S(t){t.side!==o.DoubleSide?Yt.enable(Vt.CULL_FACE):Yt.disable(Vt.CULL_FACE),Yt.setFlipSided(t.side===o.BackSide)}function T(t,e,i,r){Ct=0;var n=qt.get(i);void 0===n.program&&(i.needsUpdate=!0),void 0!==n.lightsHash&&n.lightsHash!==Ut.hash&&(i.needsUpdate=!0),i.needsUpdate&&(b(i,e,r),i.needsUpdate=!1);var s=!1,a=!1,h=!1,l=n.program,c=l.getUniforms(),u=n.__webglShader.uniforms;if(l.id!==yt&&(Vt.useProgram(l.program),yt=l.id,s=!0,a=!0,h=!0),i.id!==bt&&(bt=i.id,a=!0),(s||t!==St)&&(Vt.uniformMatrix4fv(c.projectionMatrix,!1,t.projectionMatrix.elements),Xt.logarithmicDepthBuffer&&Vt.uniform1f(c.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==St&&(St=t,a=!0,h=!0),(i instanceof o.ShaderMaterial||i instanceof o.MeshPhongMaterial||i instanceof o.MeshStandardMaterial||i.envMap)&&void 0!==c.cameraPosition&&(Nt.setFromMatrixPosition(t.matrixWorld),Vt.uniform3f(c.cameraPosition,Nt.x,Nt.y,Nt.z)),(i instanceof o.MeshPhongMaterial||i instanceof o.MeshLambertMaterial||i instanceof o.MeshBasicMaterial||i instanceof o.MeshStandardMaterial||i instanceof o.ShaderMaterial||i.skinning)&&void 0!==c.viewMatrix&&Vt.uniformMatrix4fv(c.viewMatrix,!1,t.matrixWorldInverse.elements),void 0!==c.toneMappingExposure&&Vt.uniform1f(c.toneMappingExposure,vt.toneMappingExposure),void 0!==c.toneMappingWhitePoint&&Vt.uniform1f(c.toneMappingWhitePoint,vt.toneMappingWhitePoint)),i.skinning)if(r.bindMatrix&&void 0!==c.bindMatrix&&Vt.uniformMatrix4fv(c.bindMatrix,!1,r.bindMatrix.elements),r.bindMatrixInverse&&void 0!==c.bindMatrixInverse&&Vt.uniformMatrix4fv(c.bindMatrixInverse,!1,r.bindMatrixInverse.elements),Xt.floatVertexTextures&&r.skeleton&&r.skeleton.useVertexTexture){if(void 0!==c.boneTexture){var p=k();Vt.uniform1i(c.boneTexture,p),vt.setTexture(r.skeleton.boneTexture,p)}void 0!==c.boneTextureWidth&&Vt.uniform1i(c.boneTextureWidth,r.skeleton.boneTextureWidth),void 0!==c.boneTextureHeight&&Vt.uniform1i(c.boneTextureHeight,r.skeleton.boneTextureHeight)}else r.skeleton&&r.skeleton.boneMatrices&&void 0!==c.boneGlobalMatrices&&Vt.uniformMatrix4fv(c.boneGlobalMatrices,!1,r.skeleton.boneMatrices);return a&&((i instanceof o.MeshPhongMaterial||i instanceof o.MeshLambertMaterial||i instanceof o.MeshStandardMaterial||i.lights)&&D(u,h),e&&i.fog&&P(u,e),(i instanceof o.MeshBasicMaterial||i instanceof o.MeshLambertMaterial||i instanceof o.MeshPhongMaterial||i instanceof o.MeshStandardMaterial)&&E(u,i),i instanceof o.LineBasicMaterial?C(u,i):i instanceof o.LineDashedMaterial?(C(u,i),A(u,i)):i instanceof o.PointsMaterial?L(u,i):i instanceof o.MeshLambertMaterial?R(u,i):i instanceof o.MeshPhongMaterial?O(u,i):i instanceof o.MeshStandardMaterial?I(u,i):i instanceof o.MeshDepthMaterial?(u.mNear.value=t.near,u.mFar.value=t.far,u.opacity.value=i.opacity):i instanceof o.MeshNormalMaterial&&(u.opacity.value=i.opacity),N(n.uniformsList)),B(c,r),void 0!==c.modelMatrix&&Vt.uniformMatrix4fv(c.modelMatrix,!1,r.matrixWorld.elements),n.hasDynamicUniforms===!0&&M(n.uniformsList,r,t),l}function M(t,e,i){for(var r=[],n=0,o=t.length;o>n;n++){var s=t[n][0],a=s.onUpdateCallback;void 0!==a&&(a.bind(s)(e,i),r.push(t[n]))}N(r)}function E(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var i;if(e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i){i instanceof o.WebGLRenderTarget&&(i=i.texture);var r=i.offset,n=i.repeat;t.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof o.WebGLRenderTargetCube?1:-1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function C(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function A(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function L(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Ot,t.scale.value=et.clientHeight/2,t.map.value=e.map,null!==e.map){var i=e.map.offset,r=e.map.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}}function P(t,e){t.fogColor.value=e.color,e instanceof o.Fog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e instanceof o.FogExp2&&(t.fogDensity.value=e.density)}function R(t,e){e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function O(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function I(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function D(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function B(t,e){Vt.uniformMatrix4fv(t.modelViewMatrix,!1,e.modelViewMatrix.elements),t.normalMatrix&&Vt.uniformMatrix3fv(t.normalMatrix,!1,e.normalMatrix.elements)}function k(){var t=Ct;return t>=Xt.maxTextures,Ct+=1,t}function F(t,e,i,r){var n,s;if("1i"===e)Vt.uniform1i(i,r);else if("1f"===e)Vt.uniform1f(i,r);else if("2f"===e)Vt.uniform2f(i,r[0],r[1]);else if("3f"===e)Vt.uniform3f(i,r[0],r[1],r[2]);else if("4f"===e)Vt.uniform4f(i,r[0],r[1],r[2],r[3]);else if("1iv"===e)Vt.uniform1iv(i,r);else if("3iv"===e)Vt.uniform3iv(i,r);else if("1fv"===e)Vt.uniform1fv(i,r);else if("2fv"===e)Vt.uniform2fv(i,r);else if("3fv"===e)Vt.uniform3fv(i,r);else if("4fv"===e)Vt.uniform4fv(i,r);else if("Matrix2fv"===e)Vt.uniformMatrix2fv(i,!1,r);else if("Matrix3fv"===e)Vt.uniformMatrix3fv(i,!1,r);else if("Matrix4fv"===e)Vt.uniformMatrix4fv(i,!1,r);else if("i"===e)Vt.uniform1i(i,r);else if("f"===e)Vt.uniform1f(i,r);else if("v2"===e)Vt.uniform2f(i,r.x,r.y);else if("v3"===e)Vt.uniform3f(i,r.x,r.y,r.z);else if("v4"===e)Vt.uniform4f(i,r.x,r.y,r.z,r.w);else if("c"===e)Vt.uniform3f(i,r.r,r.g,r.b);else if("s"===e){var a=t.properties;for(var h in a){var l=a[h],c=i[h],u=r[h];F(l,l.type,c,u)}}else if("sa"===e)for(var a=t.properties,p=0,d=r.length;d>p;p++)for(var h in a){var l=a[h],c=i[p][h],u=r[p][h];F(l,l.type,c,u)}else if("iv1"===e)Vt.uniform1iv(i,r);else if("iv"===e)Vt.uniform3iv(i,r);else if("fv1"===e)Vt.uniform1fv(i,r);else if("fv"===e)Vt.uniform3fv(i,r);else if("v2v"===e){void 0===t._array&&(t._array=new Float32Array(2*r.length));for(var p=0,f=0,m=r.length;m>p;p++,f+=2)t._array[f+0]=r[p].x,t._array[f+1]=r[p].y;Vt.uniform2fv(i,t._array)}else if("v3v"===e){void 0===t._array&&(t._array=new Float32Array(3*r.length));for(var p=0,g=0,m=r.length;m>p;p++,g+=3)t._array[g+0]=r[p].x,t._array[g+1]=r[p].y,t._array[g+2]=r[p].z;Vt.uniform3fv(i,t._array)}else if("v4v"===e){void 0===t._array&&(t._array=new Float32Array(4*r.length));for(var p=0,v=0,m=r.length;m>p;p++,v+=4)t._array[v+0]=r[p].x,t._array[v+1]=r[p].y,t._array[v+2]=r[p].z,t._array[v+3]=r[p].w;Vt.uniform4fv(i,t._array)}else if("m2"===e)Vt.uniformMatrix2fv(i,!1,r.elements);else if("m3"===e)Vt.uniformMatrix3fv(i,!1,r.elements);else if("m3v"===e){void 0===t._array&&(t._array=new Float32Array(9*r.length));for(var p=0,m=r.length;m>p;p++)r[p].flattenToArrayOffset(t._array,9*p);Vt.uniformMatrix3fv(i,!1,t._array)}else if("m4"===e)Vt.uniformMatrix4fv(i,!1,r.elements);else if("m4v"===e){void 0===t._array&&(t._array=new Float32Array(16*r.length));for(var p=0,m=r.length;m>p;p++)r[p].flattenToArrayOffset(t._array,16*p);Vt.uniformMatrix4fv(i,!1,t._array)}else if("t"===e){if(n=r,s=k(),Vt.uniform1i(i,s),!n)return;n instanceof o.CubeTexture||Array.isArray(n.image)&&6===n.image.length?X(n,s):n instanceof o.WebGLRenderTargetCube?Y(n.texture,s):n instanceof o.WebGLRenderTarget?vt.setTexture(n.texture,s):vt.setTexture(n,s)}else if("tv"===e){void 0===t._array&&(t._array=[]);for(var p=0,m=t.value.length;m>p;p++)t._array[p]=k();Vt.uniform1iv(i,t._array);for(var p=0,m=t.value.length;m>p;p++)n=t.value[p],s=t._array[p],n&&(n instanceof o.CubeTexture||n.image instanceof Array&&6===n.image.length?X(n,s):n instanceof o.WebGLRenderTarget?vt.setTexture(n.texture,s):n instanceof o.WebGLRenderTargetCube?Y(n.texture,s):vt.setTexture(n,s))}}function N(t){for(var e=0,i=t.length;i>e;e++){var r=t[e][0];if(r.needsUpdate!==!1){var n=r.type,o=t[e][1],s=r.value;F(r,n,o,s)}}}function U(t,e){var i,r,n,s,a,h,l=0,c=0,u=0,p=e.matrixWorldInverse,d=0,f=0,m=0,g=0,v=0;for(Ut.shadowsPointLight=0,i=0,r=t.length;r>i;i++)if(n=t[i],s=n.color,a=n.intensity,h=n.distance,n instanceof o.AmbientLight)l+=s.r*a,c+=s.g*a,u+=s.b*a;else if(n instanceof o.DirectionalLight){var y=Jt.get(n);y.color.copy(n.color).multiplyScalar(n.intensity),y.direction.setFromMatrixPosition(n.matrixWorld),Nt.setFromMatrixPosition(n.target.matrixWorld),y.direction.sub(Nt),y.direction.transformDirection(p),y.shadow=n.castShadow,n.castShadow&&(y.shadowBias=n.shadow.bias,y.shadowRadius=n.shadow.radius,y.shadowMapSize=n.shadow.mapSize,Ut.shadows[v++]=n),Ut.directionalShadowMap[d]=n.shadow.map,Ut.directionalShadowMatrix[d]=n.shadow.matrix,Ut.directional[d++]=y}else if(n instanceof o.SpotLight){var y=Jt.get(n);y.position.setFromMatrixPosition(n.matrixWorld),y.position.applyMatrix4(p),y.color.copy(s).multiplyScalar(a),y.distance=h,y.direction.setFromMatrixPosition(n.matrixWorld),Nt.setFromMatrixPosition(n.target.matrixWorld),y.direction.sub(Nt),y.direction.transformDirection(p),y.coneCos=Math.cos(n.angle),y.penumbraCos=Math.cos(n.angle*(1-n.penumbra)),y.decay=0===n.distance?0:n.decay,y.shadow=n.castShadow,n.castShadow&&(y.shadowBias=n.shadow.bias,y.shadowRadius=n.shadow.radius,y.shadowMapSize=n.shadow.mapSize,Ut.shadows[v++]=n),Ut.spotShadowMap[m]=n.shadow.map,Ut.spotShadowMatrix[m]=n.shadow.matrix,Ut.spot[m++]=y}else if(n instanceof o.PointLight){var y=Jt.get(n);y.position.setFromMatrixPosition(n.matrixWorld),y.position.applyMatrix4(p),y.color.copy(n.color).multiplyScalar(n.intensity),y.distance=n.distance,y.decay=0===n.distance?0:n.decay,y.shadow=n.castShadow,n.castShadow&&(y.shadowBias=n.shadow.bias,y.shadowRadius=n.shadow.radius,y.shadowMapSize=n.shadow.mapSize,Ut.shadows[v++]=n),Ut.pointShadowMap[f]=n.shadow.map,void 0===Ut.pointShadowMatrix[f]&&(Ut.pointShadowMatrix[f]=new o.Matrix4),Nt.setFromMatrixPosition(n.matrixWorld).negate(),Ut.pointShadowMatrix[f].identity().setPosition(Nt),Ut.point[f++]=y}else if(n instanceof o.HemisphereLight){var y=Jt.get(n);y.direction.setFromMatrixPosition(n.matrixWorld),y.direction.transformDirection(p),y.direction.normalize(),y.skyColor.copy(n.color).multiplyScalar(a),y.groundColor.copy(n.groundColor).multiplyScalar(a),Ut.hemi[g++]=y}Ut.ambient[0]=l,Ut.ambient[1]=c,Ut.ambient[2]=u,Ut.directional.length=d,Ut.spot.length=m,Ut.point.length=f,Ut.hemi.length=g,Ut.shadows.length=v,Ut.hash=d+","+f+","+m+","+g+","+v}function G(t,e,i){var r;if(i?(Vt.texParameteri(t,Vt.TEXTURE_WRAP_S,tt(e.wrapS)),Vt.texParameteri(t,Vt.TEXTURE_WRAP_T,tt(e.wrapT)),Vt.texParameteri(t,Vt.TEXTURE_MAG_FILTER,tt(e.magFilter)),Vt.texParameteri(t,Vt.TEXTURE_MIN_FILTER,tt(e.minFilter))):(Vt.texParameteri(t,Vt.TEXTURE_WRAP_S,Vt.CLAMP_TO_EDGE),Vt.texParameteri(t,Vt.TEXTURE_WRAP_T,Vt.CLAMP_TO_EDGE),e.wrapS!==o.ClampToEdgeWrapping||e.wrapT!==o.ClampToEdgeWrapping,Vt.texParameteri(t,Vt.TEXTURE_MAG_FILTER,$(e.magFilter)),Vt.texParameteri(t,Vt.TEXTURE_MIN_FILTER,$(e.minFilter)),e.minFilter!==o.NearestFilter&&e.minFilter!==o.LinearFilter),r=Wt.get("EXT_texture_filter_anisotropic")){if(e.type===o.FloatType&&null===Wt.get("OES_texture_float_linear"))return;if(e.type===o.HalfFloatType&&null===Wt.get("OES_texture_half_float_linear"))return;(e.anisotropy>1||qt.get(e).__currentAnisotropy)&&(Vt.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,vt.getMaxAnisotropy())),qt.get(e).__currentAnisotropy=e.anisotropy)}}function z(t,e,i){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",a),t.__webglTexture=Vt.createTexture(),Gt.textures++),Yt.activeTexture(Vt.TEXTURE0+i),Yt.bindTexture(Vt.TEXTURE_2D,t.__webglTexture),Vt.pixelStorei(Vt.UNPACK_FLIP_Y_WEBGL,e.flipY),Vt.pixelStorei(Vt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Vt.pixelStorei(Vt.UNPACK_ALIGNMENT,e.unpackAlignment);var r=V(e.image,Xt.maxTextureSize);H(e)&&j(r)===!1&&(r=W(r));var n=j(r),s=tt(e.format),h=tt(e.type);G(Vt.TEXTURE_2D,e,n);var l,c=e.mipmaps;if(e instanceof o.DataTexture)if(c.length>0&&n){for(var u=0,p=c.length;p>u;u++)l=c[u],Yt.texImage2D(Vt.TEXTURE_2D,u,s,l.width,l.height,0,s,h,l.data);e.generateMipmaps=!1}else Yt.texImage2D(Vt.TEXTURE_2D,0,s,r.width,r.height,0,s,h,r.data);else if(e instanceof o.CompressedTexture)for(var u=0,p=c.length;p>u;u++)l=c[u],e.format!==o.RGBAFormat&&e.format!==o.RGBFormat?Yt.getCompressedTextureFormats().indexOf(s)>-1&&Yt.compressedTexImage2D(Vt.TEXTURE_2D,u,s,l.width,l.height,0,l.data):Yt.texImage2D(Vt.TEXTURE_2D,u,s,l.width,l.height,0,s,h,l.data);else if(c.length>0&&n){for(var u=0,p=c.length;p>u;u++)l=c[u],Yt.texImage2D(Vt.TEXTURE_2D,u,s,s,h,l);e.generateMipmaps=!1}else Yt.texImage2D(Vt.TEXTURE_2D,0,s,s,h,r);e.generateMipmaps&&n&&Vt.generateMipmap(Vt.TEXTURE_2D),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function V(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),r=document.createElement("canvas");r.width=Math.floor(t.width*i),r.height=Math.floor(t.height*i);var n=r.getContext("2d");return n.drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),r}return t}function j(t){return o.Math.isPowerOfTwo(t.width)&&o.Math.isPowerOfTwo(t.height)}function H(t){return t.wrapS!==o.ClampToEdgeWrapping||t.wrapT!==o.ClampToEdgeWrapping?!0:t.minFilter!==o.NearestFilter&&t.minFilter!==o.LinearFilter}function W(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElement("canvas");e.width=o.Math.nearestPowerOfTwo(t.width),e.height=o.Math.nearestPowerOfTwo(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),e}return t}function X(t,e){var i=qt.get(t);if(6===t.image.length)if(t.version>0&&i.__version!==t.version){i.__image__webglTextureCube||(t.addEventListener("dispose",a),i.__image__webglTextureCube=Vt.createTexture(),Gt.textures++),Yt.activeTexture(Vt.TEXTURE0+e),Yt.bindTexture(Vt.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),Vt.pixelStorei(Vt.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var r=t instanceof o.CompressedTexture,n=t.image[0]instanceof o.DataTexture,s=[],h=0;6>h;h++)!vt.autoScaleCubemaps||r||n?s[h]=n?t.image[h].image:t.image[h]:s[h]=V(t.image[h],Xt.maxCubemapSize);var l=s[0],c=j(l),u=tt(t.format),p=tt(t.type);G(Vt.TEXTURE_CUBE_MAP,t,c);for(var h=0;6>h;h++)if(r)for(var d,f=s[h].mipmaps,m=0,g=f.length;g>m;m++)d=f[m],t.format!==o.RGBAFormat&&t.format!==o.RGBFormat?Yt.getCompressedTextureFormats().indexOf(u)>-1&&Yt.compressedTexImage2D(Vt.TEXTURE_CUBE_MAP_POSITIVE_X+h,m,u,d.width,d.height,0,d.data):Yt.texImage2D(Vt.TEXTURE_CUBE_MAP_POSITIVE_X+h,m,u,d.width,d.height,0,u,p,d.data);else n?Yt.texImage2D(Vt.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,u,s[h].width,s[h].height,0,u,p,s[h].data):Yt.texImage2D(Vt.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,u,u,p,s[h]);t.generateMipmaps&&c&&Vt.generateMipmap(Vt.TEXTURE_CUBE_MAP),i.__version=t.version,t.onUpdate&&t.onUpdate(t)}else Yt.activeTexture(Vt.TEXTURE0+e),Yt.bindTexture(Vt.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)}function Y(t,e){Yt.activeTexture(Vt.TEXTURE0+e),Yt.bindTexture(Vt.TEXTURE_CUBE_MAP,qt.get(t).__webglTexture)}function q(t,e,i,r){var n=tt(e.texture.format),o=tt(e.texture.type);Yt.texImage2D(r,0,n,e.width,e.height,0,n,o,null),Vt.bindFramebuffer(Vt.FRAMEBUFFER,t),Vt.framebufferTexture2D(Vt.FRAMEBUFFER,i,r,qt.get(e.texture).__webglTexture,0),Vt.bindFramebuffer(Vt.FRAMEBUFFER,null)}function K(t,e){Vt.bindRenderbuffer(Vt.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(Vt.renderbufferStorage(Vt.RENDERBUFFER,Vt.DEPTH_COMPONENT16,e.width,e.height),Vt.framebufferRenderbuffer(Vt.FRAMEBUFFER,Vt.DEPTH_ATTACHMENT,Vt.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(Vt.renderbufferStorage(Vt.RENDERBUFFER,Vt.DEPTH_STENCIL,e.width,e.height),Vt.framebufferRenderbuffer(Vt.FRAMEBUFFER,Vt.DEPTH_STENCIL_ATTACHMENT,Vt.RENDERBUFFER,t)):Vt.renderbufferStorage(Vt.RENDERBUFFER,Vt.RGBA4,e.width,e.height),Vt.bindRenderbuffer(Vt.RENDERBUFFER,null)}function Z(t){var e=qt.get(t),i=t instanceof o.WebGLRenderTargetCube;if(i){e.__webglDepthbuffer=[];for(var r=0;6>r;r++)Vt.bindFramebuffer(Vt.FRAMEBUFFER,e.__webglFramebuffer[r]),e.__webglDepthbuffer[r]=Vt.createRenderbuffer(),K(e.__webglDepthbuffer[r],t)}else Vt.bindFramebuffer(Vt.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=Vt.createRenderbuffer(),K(e.__webglDepthbuffer,t);Vt.bindFramebuffer(Vt.FRAMEBUFFER,null)}function J(t){var e=qt.get(t),i=qt.get(t.texture);t.addEventListener("dispose",h),i.__webglTexture=Vt.createTexture(),Gt.textures++;var r=t instanceof o.WebGLRenderTargetCube,n=o.Math.isPowerOfTwo(t.width)&&o.Math.isPowerOfTwo(t.height);if(r){e.__webglFramebuffer=[];for(var s=0;6>s;s++)e.__webglFramebuffer[s]=Vt.createFramebuffer()}else e.__webglFramebuffer=Vt.createFramebuffer();if(r){Yt.bindTexture(Vt.TEXTURE_CUBE_MAP,i.__webglTexture),G(Vt.TEXTURE_CUBE_MAP,t.texture,n);for(var s=0;6>s;s++)q(e.__webglFramebuffer[s],t,Vt.COLOR_ATTACHMENT0,Vt.TEXTURE_CUBE_MAP_POSITIVE_X+s);t.texture.generateMipmaps&&n&&Vt.generateMipmap(Vt.TEXTURE_CUBE_MAP),Yt.bindTexture(Vt.TEXTURE_CUBE_MAP,null)}else Yt.bindTexture(Vt.TEXTURE_2D,i.__webglTexture),G(Vt.TEXTURE_2D,t.texture,n),q(e.__webglFramebuffer,t,Vt.COLOR_ATTACHMENT0,Vt.TEXTURE_2D),t.texture.generateMipmaps&&n&&Vt.generateMipmap(Vt.TEXTURE_2D),Yt.bindTexture(Vt.TEXTURE_2D,null);t.depthBuffer&&Z(t)}function Q(t){var e=t instanceof o.WebGLRenderTargetCube?Vt.TEXTURE_CUBE_MAP:Vt.TEXTURE_2D,i=qt.get(t.texture).__webglTexture;Yt.bindTexture(e,i),Vt.generateMipmap(e),Yt.bindTexture(e,null)}function $(t){return t===o.NearestFilter||t===o.NearestMipMapNearestFilter||t===o.NearestMipMapLinearFilter?Vt.NEAREST:Vt.LINEAR}function tt(t){var e;if(t===o.RepeatWrapping)return Vt.REPEAT;if(t===o.ClampToEdgeWrapping)return Vt.CLAMP_TO_EDGE;if(t===o.MirroredRepeatWrapping)return Vt.MIRRORED_REPEAT;if(t===o.NearestFilter)return Vt.NEAREST;if(t===o.NearestMipMapNearestFilter)return Vt.NEAREST_MIPMAP_NEAREST;if(t===o.NearestMipMapLinearFilter)return Vt.NEAREST_MIPMAP_LINEAR;if(t===o.LinearFilter)return Vt.LINEAR;if(t===o.LinearMipMapNearestFilter)return Vt.LINEAR_MIPMAP_NEAREST;
if(t===o.LinearMipMapLinearFilter)return Vt.LINEAR_MIPMAP_LINEAR;if(t===o.UnsignedByteType)return Vt.UNSIGNED_BYTE;if(t===o.UnsignedShort4444Type)return Vt.UNSIGNED_SHORT_4_4_4_4;if(t===o.UnsignedShort5551Type)return Vt.UNSIGNED_SHORT_5_5_5_1;if(t===o.UnsignedShort565Type)return Vt.UNSIGNED_SHORT_5_6_5;if(t===o.ByteType)return Vt.BYTE;if(t===o.ShortType)return Vt.SHORT;if(t===o.UnsignedShortType)return Vt.UNSIGNED_SHORT;if(t===o.IntType)return Vt.INT;if(t===o.UnsignedIntType)return Vt.UNSIGNED_INT;if(t===o.FloatType)return Vt.FLOAT;if(e=Wt.get("OES_texture_half_float"),null!==e&&t===o.HalfFloatType)return e.HALF_FLOAT_OES;if(t===o.AlphaFormat)return Vt.ALPHA;if(t===o.RGBFormat)return Vt.RGB;if(t===o.RGBAFormat)return Vt.RGBA;if(t===o.LuminanceFormat)return Vt.LUMINANCE;if(t===o.LuminanceAlphaFormat)return Vt.LUMINANCE_ALPHA;if(t===o.AddEquation)return Vt.FUNC_ADD;if(t===o.SubtractEquation)return Vt.FUNC_SUBTRACT;if(t===o.ReverseSubtractEquation)return Vt.FUNC_REVERSE_SUBTRACT;if(t===o.ZeroFactor)return Vt.ZERO;if(t===o.OneFactor)return Vt.ONE;if(t===o.SrcColorFactor)return Vt.SRC_COLOR;if(t===o.OneMinusSrcColorFactor)return Vt.ONE_MINUS_SRC_COLOR;if(t===o.SrcAlphaFactor)return Vt.SRC_ALPHA;if(t===o.OneMinusSrcAlphaFactor)return Vt.ONE_MINUS_SRC_ALPHA;if(t===o.DstAlphaFactor)return Vt.DST_ALPHA;if(t===o.OneMinusDstAlphaFactor)return Vt.ONE_MINUS_DST_ALPHA;if(t===o.DstColorFactor)return Vt.DST_COLOR;if(t===o.OneMinusDstColorFactor)return Vt.ONE_MINUS_DST_COLOR;if(t===o.SrcAlphaSaturateFactor)return Vt.SRC_ALPHA_SATURATE;if(e=Wt.get("WEBGL_compressed_texture_s3tc"),null!==e){if(t===o.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===o.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===o.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===o.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e=Wt.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(t===o.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===o.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===o.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===o.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e=Wt.get("WEBGL_compressed_texture_etc1"),null!==e&&t===o.RGB_ETC1_Format)return e.COMPRESSED_RGB_ETC1_WEBGL;if(e=Wt.get("EXT_blend_minmax"),null!==e){if(t===o.MinEquation)return e.MIN_EXT;if(t===o.MaxEquation)return e.MAX_EXT}return 0}t=t||{};var et=void 0!==t.canvas?t.canvas:document.createElement("canvas"),it=void 0!==t.context?t.context:null,rt=void 0!==t.alpha?t.alpha:!1,nt=void 0!==t.depth?t.depth:!0,ot=void 0!==t.stencil?t.stencil:!0,st=void 0!==t.antialias?t.antialias:!1,at=void 0!==t.premultipliedAlpha?t.premultipliedAlpha:!0,ht=void 0!==t.preserveDrawingBuffer?t.preserveDrawingBuffer:!1,lt=[],ct=[],ut=-1,pt=[],dt=-1,ft=new Float32Array(8),mt=[],gt=[];this.domElement=et,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=o.LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var vt=this,yt=null,xt=null,_t=null,bt=-1,wt="",St=null,Tt=new o.Vector4,Mt=null,Et=new o.Vector4,Ct=0,At=new o.Color(0),Lt=0,Pt=et.width,Rt=et.height,Ot=1,It=new o.Vector4(0,0,Pt,Rt),Dt=!1,Bt=new o.Vector4(0,0,Pt,Rt),kt=new o.Frustum,Ft=new o.Matrix4,Nt=new o.Vector3,Ut={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[],shadowsPointLight:0},Gt={geometries:0,textures:0},zt={calls:0,vertices:0,faces:0,points:0};this.info={render:zt,memory:Gt,programs:null};var Vt;try{var jt={alpha:rt,depth:nt,stencil:ot,antialias:st,premultipliedAlpha:at,preserveDrawingBuffer:ht};if(Vt=it||et.getContext("webgl",jt)||et.getContext("experimental-webgl",jt),null===Vt)throw null!==et.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===Vt.getShaderPrecisionFormat&&(Vt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),et.addEventListener("webglcontextlost",s,!1)}catch(Ht){}var Wt=new o.WebGLExtensions(Vt);Wt.get("OES_texture_float"),Wt.get("OES_texture_float_linear"),Wt.get("OES_texture_half_float"),Wt.get("OES_texture_half_float_linear"),Wt.get("OES_standard_derivatives"),Wt.get("ANGLE_instanced_arrays"),Wt.get("OES_element_index_uint")&&(o.BufferGeometry.MaxIndex=4294967296);var Xt=new o.WebGLCapabilities(Vt,Wt,t),Yt=new o.WebGLState(Vt,Wt,tt),qt=new o.WebGLProperties,Kt=new o.WebGLObjects(Vt,qt,this.info),Zt=new o.WebGLPrograms(this,Xt),Jt=new o.WebGLLights;this.info.programs=Zt.programs;var Qt=new o.WebGLBufferRenderer(Vt,Wt,zt),$t=new o.WebGLIndexedBufferRenderer(Vt,Wt,zt);r(),this.context=Vt,this.capabilities=Xt,this.extensions=Wt,this.properties=qt,this.state=Yt;var te=new o.WebGLShadowMap(this,Ut,Kt);this.shadowMap=te;var ee=new o.SpritePlugin(this,mt),ie=new o.LensFlarePlugin(this,gt);this.getContext=function(){return Vt},this.getContextAttributes=function(){return Vt.getContextAttributes()},this.forceContextLoss=function(){Wt.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=Wt.get("EXT_texture_filter_anisotropic");return t=null!==e?Vt.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return Xt.precision},this.getPixelRatio=function(){return Ot},this.setPixelRatio=function(t){void 0!==t&&(Ot=t,this.setSize(Bt.z,Bt.w,!1))},this.getSize=function(){return{width:Pt,height:Rt}},this.setSize=function(t,e,i){Pt=t,Rt=e,et.width=t*Ot,et.height=e*Ot,i!==!1&&(et.style.width=t+"px",et.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,r){Yt.viewport(Bt.set(t,e,i,r))},this.setScissor=function(t,e,i,r){Yt.scissor(It.set(t,e,i,r))},this.setScissorTest=function(t){Yt.setScissorTest(Dt=t)},this.getClearColor=function(){return At},this.setClearColor=function(t,e){At.set(t),Lt=void 0!==e?e:1,i(At.r,At.g,At.b,Lt)},this.getClearAlpha=function(){return Lt},this.setClearAlpha=function(t){Lt=t,i(At.r,At.g,At.b,Lt)},this.clear=function(t,e,i){var r=0;(void 0===t||t)&&(r|=Vt.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=Vt.DEPTH_BUFFER_BIT),(void 0===i||i)&&(r|=Vt.STENCIL_BUFFER_BIT),Vt.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,r){this.setRenderTarget(t),this.clear(e,i,r)},this.resetGLState=n,this.dispose=function(){et.removeEventListener("webglcontextlost",s,!1)},this.renderBufferImmediate=function(t,e,i){Yt.initAttributes();var r=qt.get(t);t.hasPositions&&!r.position&&(r.position=Vt.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=Vt.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=Vt.createBuffer()),t.hasColors&&!r.color&&(r.color=Vt.createBuffer());var n=e.getAttributes();if(t.hasPositions&&(Vt.bindBuffer(Vt.ARRAY_BUFFER,r.position),Vt.bufferData(Vt.ARRAY_BUFFER,t.positionArray,Vt.DYNAMIC_DRAW),Yt.enableAttribute(n.position),Vt.vertexAttribPointer(n.position,3,Vt.FLOAT,!1,0,0)),t.hasNormals){if(Vt.bindBuffer(Vt.ARRAY_BUFFER,r.normal),"MeshPhongMaterial"!==i.type&&"MeshStandardMaterial"!==i.type&&i.shading===o.FlatShading)for(var s=0,a=3*t.count;a>s;s+=9){var h=t.normalArray,l=(h[s+0]+h[s+3]+h[s+6])/3,c=(h[s+1]+h[s+4]+h[s+7])/3,u=(h[s+2]+h[s+5]+h[s+8])/3;h[s+0]=l,h[s+1]=c,h[s+2]=u,h[s+3]=l,h[s+4]=c,h[s+5]=u,h[s+6]=l,h[s+7]=c,h[s+8]=u}Vt.bufferData(Vt.ARRAY_BUFFER,t.normalArray,Vt.DYNAMIC_DRAW),Yt.enableAttribute(n.normal),Vt.vertexAttribPointer(n.normal,3,Vt.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(Vt.bindBuffer(Vt.ARRAY_BUFFER,r.uv),Vt.bufferData(Vt.ARRAY_BUFFER,t.uvArray,Vt.DYNAMIC_DRAW),Yt.enableAttribute(n.uv),Vt.vertexAttribPointer(n.uv,2,Vt.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==o.NoColors&&(Vt.bindBuffer(Vt.ARRAY_BUFFER,r.color),Vt.bufferData(Vt.ARRAY_BUFFER,t.colorArray,Vt.DYNAMIC_DRAW),Yt.enableAttribute(n.color),Vt.vertexAttribPointer(n.color,3,Vt.FLOAT,!1,0,0)),Yt.disableUnusedAttributes(),Vt.drawArrays(Vt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,i,r,n,s,a){w(n);var h=T(t,i,n,s),l=!1,c=r.id+"_"+h.id+"_"+n.wireframe;c!==wt&&(wt=c,l=!0);var u=s.morphTargetInfluences;if(void 0!==u){for(var p=[],d=0,g=u.length;g>d;d++){var v=u[d];p.push([v,d])}p.sort(m),p.length>8&&(p.length=8);for(var y=r.morphAttributes,d=0,g=p.length;g>d;d++){var v=p[d];if(ft[d]=v[0],0!==v[0]){var x=v[1];n.morphTargets===!0&&y.position&&r.addAttribute("morphTarget"+d,y.position[x]),n.morphNormals===!0&&y.normal&&r.addAttribute("morphNormal"+d,y.normal[x])}else n.morphTargets===!0&&r.removeAttribute("morphTarget"+d),n.morphNormals===!0&&r.removeAttribute("morphNormal"+d)}var _=h.getUniforms();null!==_.morphTargetInfluences&&Vt.uniform1fv(_.morphTargetInfluences,ft),l=!0}var x=r.index,b=r.attributes.position;n.wireframe===!0&&(x=Kt.getWireframeAttribute(r));var S;null!==x?(S=$t,S.setIndex(x)):S=Qt,l&&(f(n,h,r),null!==x&&Vt.bindBuffer(Vt.ELEMENT_ARRAY_BUFFER,Kt.getAttributeBuffer(x)));var M=0,E=1/0;null!==x?E=x.count:void 0!==b&&(E=b.count);var C=r.drawRange.start,A=r.drawRange.count,L=null!==a?a.start:0,P=null!==a?a.count:1/0,R=Math.max(M,C,L),O=Math.min(M+E,C+A,L+P)-1,I=Math.max(0,O-R+1);if(s instanceof o.Mesh)if(n.wireframe===!0)Yt.setLineWidth(n.wireframeLinewidth*e()),S.setMode(Vt.LINES);else switch(s.drawMode){case o.TrianglesDrawMode:S.setMode(Vt.TRIANGLES);break;case o.TriangleStripDrawMode:S.setMode(Vt.TRIANGLE_STRIP);break;case o.TriangleFanDrawMode:S.setMode(Vt.TRIANGLE_FAN)}else if(s instanceof o.Line){var D=n.linewidth;void 0===D&&(D=1),Yt.setLineWidth(D*e()),s instanceof o.LineSegments?S.setMode(Vt.LINES):S.setMode(Vt.LINE_STRIP)}else s instanceof o.Points&&S.setMode(Vt.POINTS);r instanceof o.InstancedBufferGeometry?r.maxInstancedCount>0&&S.renderInstances(r,R,I):S.render(R,I)},this.render=function(t,e,i,r){if(e instanceof o.Camera!=!1){var n=t.fog;if(wt="",bt=-1,St=null,t.autoUpdate===!0&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),Ft.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),kt.setFromMatrix(Ft),lt.length=0,ut=-1,dt=-1,mt.length=0,gt.length=0,x(t,e),ct.length=ut+1,pt.length=dt+1,vt.sortObjects===!0&&(ct.sort(g),pt.sort(v)),U(lt,e),te.render(t,e),zt.calls=0,zt.vertices=0,zt.faces=0,zt.points=0,void 0===i&&(i=null),this.setRenderTarget(i),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial){var s=t.overrideMaterial;_(ct,e,n,s),_(pt,e,n,s)}else Yt.setBlending(o.NoBlending),_(ct,e,n),_(pt,e,n);if(ee.render(t,e),ie.render(t,e,Et),i){var a=i.texture;a.generateMipmaps&&j(i)&&a.minFilter!==o.NearestFilter&&a.minFilter!==o.LinearFilter&&Q(i)}Yt.setDepthTest(!0),Yt.setDepthWrite(!0),Yt.setColorWrite(!0)}},this.setFaceCulling=function(t,e){t===o.CullFaceNone?Yt.disable(Vt.CULL_FACE):(e===o.FrontFaceDirectionCW?Vt.frontFace(Vt.CW):Vt.frontFace(Vt.CCW),t===o.CullFaceBack?Vt.cullFace(Vt.BACK):t===o.CullFaceFront?Vt.cullFace(Vt.FRONT):Vt.cullFace(Vt.FRONT_AND_BACK),Yt.enable(Vt.CULL_FACE))},this.setTexture=function(t,e){var i=qt.get(t);if(t.version>0&&i.__version!==t.version){var r=t.image;if(void 0===r)return;if(r.complete===!1)return;return void z(i,t,e)}Yt.activeTexture(Vt.TEXTURE0+e),Yt.bindTexture(Vt.TEXTURE_2D,i.__webglTexture)},this.getCurrentRenderTarget=function(){return xt},this.setRenderTarget=function(t){xt=t,t&&void 0===qt.get(t).__webglFramebuffer&&J(t);var e,i=t instanceof o.WebGLRenderTargetCube;if(t){var r=qt.get(t);e=i?r.__webglFramebuffer[t.activeCubeFace]:r.__webglFramebuffer,Tt.copy(t.scissor),Mt=t.scissorTest,Et.copy(t.viewport)}else e=null,Tt.copy(It).multiplyScalar(Ot),Mt=Dt,Et.copy(Bt).multiplyScalar(Ot);if(_t!==e&&(Vt.bindFramebuffer(Vt.FRAMEBUFFER,e),_t=e),Yt.scissor(Tt),Yt.setScissorTest(Mt),Yt.viewport(Et),i){var n=qt.get(t.texture);Vt.framebufferTexture2D(Vt.FRAMEBUFFER,Vt.COLOR_ATTACHMENT0,Vt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,n.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,i,r,n,s){if(t instanceof o.WebGLRenderTarget!=!1){var a=qt.get(t).__webglFramebuffer;if(a){var h=!1;a!==_t&&(Vt.bindFramebuffer(Vt.FRAMEBUFFER,a),h=!0);try{var l=t.texture;if(l.format!==o.RGBAFormat&&tt(l.format)!==Vt.getParameter(Vt.IMPLEMENTATION_COLOR_READ_FORMAT))return;if(!(l.type===o.UnsignedByteType||tt(l.type)===Vt.getParameter(Vt.IMPLEMENTATION_COLOR_READ_TYPE)||l.type===o.FloatType&&Wt.get("WEBGL_color_buffer_float")||l.type===o.HalfFloatType&&Wt.get("EXT_color_buffer_half_float")))return;Vt.checkFramebufferStatus(Vt.FRAMEBUFFER)===Vt.FRAMEBUFFER_COMPLETE&&Vt.readPixels(e,i,r,n,tt(l.format),tt(l.type),s)}finally{h&&Vt.bindFramebuffer(Vt.FRAMEBUFFER,_t)}}}}},o.WebGLRenderTarget=function(t,e,i){this.uuid=o.Math.generateUUID(),this.width=t,this.height=e,this.scissor=new o.Vector4(0,0,t,e),this.scissorTest=!1,this.viewport=new o.Vector4(0,0,t,e),i=i||{},void 0===i.minFilter&&(i.minFilter=o.LinearFilter),this.texture=new o.Texture(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy),this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0},o.WebGLRenderTarget.prototype={constructor:o.WebGLRenderTarget,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},o.EventDispatcher.prototype.apply(o.WebGLRenderTarget.prototype),o.WebGLRenderTargetCube=function(t,e,i){o.WebGLRenderTarget.call(this,t,e,i),this.activeCubeFace=0,this.activeMipMapLevel=0},o.WebGLRenderTargetCube.prototype=Object.create(o.WebGLRenderTarget.prototype),o.WebGLRenderTargetCube.prototype.constructor=o.WebGLRenderTargetCube,o.WebGLBufferRenderer=function(t,e,i){function r(t){a=t}function n(e,r){t.drawArrays(a,e,r),i.calls++,i.vertices+=r,a===t.TRIANGLES&&(i.faces+=r/3)}function s(r){var n=e.get("ANGLE_instanced_arrays");if(null!==n){var s=r.attributes.position,h=0;s instanceof o.InterleavedBufferAttribute?(h=s.data.count,n.drawArraysInstancedANGLE(a,0,h,r.maxInstancedCount)):(h=s.count,n.drawArraysInstancedANGLE(a,0,h,r.maxInstancedCount)),i.calls++,i.vertices+=h*r.maxInstancedCount,a===t.TRIANGLES&&(i.faces+=r.maxInstancedCount*h/3)}}var a;this.setMode=r,this.render=n,this.renderInstances=s},o.WebGLIndexedBufferRenderer=function(t,e,i){function r(t){a=t}function n(i){i.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(h=t.UNSIGNED_INT,l=4):(h=t.UNSIGNED_SHORT,l=2)}function o(e,r){t.drawElements(a,r,h,e*l),i.calls++,i.vertices+=r,a===t.TRIANGLES&&(i.faces+=r/3)}function s(r,n,o){var s=e.get("ANGLE_instanced_arrays");null!==s&&(s.drawElementsInstancedANGLE(a,o,h,n*l,r.maxInstancedCount),i.calls++,i.vertices+=o*r.maxInstancedCount,a===t.TRIANGLES&&(i.faces+=r.maxInstancedCount*o/3))}var a,h,l;this.setMode=r,this.setIndex=n,this.render=o,this.renderInstances=s},o.WebGLExtensions=function(t){var e={};this.get=function(i){if(void 0!==e[i])return e[i];var r;switch(i){case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(i)}return e[i]=r,r}},o.WebGLCapabilities=function(t,e,i){function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}this.getMaxPrecision=r,this.precision=void 0!==i.precision?i.precision:"highp",this.logarithmicDepthBuffer=void 0!==i.logarithmicDepthBuffer?i.logarithmicDepthBuffer:!1,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=this.maxVertexTextures>0,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var n=r(this.precision);n!==this.precision&&(this.precision=n),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"))},o.WebGLGeometries=function(t,e,i){function r(t){var e=t.geometry;if(void 0!==c[e.id])return c[e.id];e.addEventListener("dispose",n);var r;return e instanceof o.BufferGeometry?r=e:e instanceof o.Geometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new o.BufferGeometry).setFromObject(t)),r=e._bufferGeometry),c[e.id]=r,i.memory.geometries++,r}function n(t){var r=t.target,o=c[r.id];null!==o.index&&a(o.index),h(o.attributes),r.removeEventListener("dispose",n),delete c[r.id];var s=e.get(r);s.wireframe&&a(s.wireframe),e["delete"](r);var l=e.get(o);l.wireframe&&a(l.wireframe),e["delete"](o),i.memory.geometries--}function s(t){return t instanceof o.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function a(e){var i=s(e);void 0!==i&&(t.deleteBuffer(i),l(e))}function h(t){for(var e in t)a(t[e])}function l(t){t instanceof o.InterleavedBufferAttribute?e["delete"](t.data):e["delete"](t)}var c={};this.get=r},o.WebGLLights=function(){var t={};this.get=function(e){if(void 0!==t[e.id])return t[e.id];var i;switch(e.type){case"DirectionalLight":i={direction:new o.Vector3,color:new o.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o.Vector2};break;case"SpotLight":i={position:new o.Vector3,direction:new o.Vector3,color:new o.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o.Vector2};break;case"PointLight":i={position:new o.Vector3,color:new o.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o.Vector2};break;case"HemisphereLight":i={direction:new o.Vector3,skyColor:new o.Color,groundColor:new o.Color}}return t[e.id]=i,i}},o.WebGLObjects=function(t,e,i){function r(e){var i=u.get(e);e.geometry instanceof o.Geometry&&i.updateFromObject(e);var r=i.index,s=i.attributes;null!==r&&n(r,t.ELEMENT_ARRAY_BUFFER);for(var a in s)n(s[a],t.ARRAY_BUFFER);var h=i.morphAttributes;for(var a in h)for(var l=h[a],c=0,p=l.length;p>c;c++)n(l[c],t.ARRAY_BUFFER);return i}function n(t,i){var r=t instanceof o.InterleavedBufferAttribute?t.data:t,n=e.get(r);void 0===n.__webglBuffer?s(n,r,i):n.version!==r.version&&a(n,r,i)}function s(e,i,r){e.__webglBuffer=t.createBuffer(),t.bindBuffer(r,e.__webglBuffer);var n=i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(r,i.array,n),e.version=i.version}function a(e,i,r){t.bindBuffer(r,e.__webglBuffer),i.dynamic===!1||-1===i.updateRange.count?t.bufferSubData(r,0,i.array):0===i.updateRange.count||(t.bufferSubData(r,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),e.version=i.version}function h(t){return t instanceof o.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function l(i){var r=e.get(i);if(void 0!==r.wireframe)return r.wireframe;var s=[],a=i.index,h=i.attributes,l=h.position;if(null!==a)for(var u={},p=a.array,d=0,f=p.length;f>d;d+=3){var m=p[d+0],g=p[d+1],v=p[d+2];c(u,m,g)&&s.push(m,g),c(u,g,v)&&s.push(g,v),c(u,v,m)&&s.push(v,m)}else for(var p=h.position.array,d=0,f=p.length/3-1;f>d;d+=3){var m=d+0,g=d+1,v=d+2;s.push(m,g,g,v,v,m)}var y=l.count>65535?Uint32Array:Uint16Array,x=new o.BufferAttribute(new y(s),1);return n(x,t.ELEMENT_ARRAY_BUFFER),r.wireframe=x,x}function c(t,e,i){if(e>i){var r=e;e=i,i=r}var n=t[e];return void 0===n?(t[e]=[i],!0):-1===n.indexOf(i)?(n.push(i),!0):!1}var u=new o.WebGLGeometries(t,e,i);this.getAttributeBuffer=h,this.getWireframeAttribute=l,this.update=r},o.WebGLProgram=function(){function t(t){switch(t){case o.LinearEncoding:return["Linear","( value )"];case o.sRGBEncoding:return["sRGB","( value )"];case o.RGBEEncoding:return["RGBE","( value )"];case o.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case o.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case o.RGBDEncoding:return["RGBD","( value, 256.0 )"];case o.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function e(e,i){var r=t(i);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function i(e,i){var r=t(i);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function r(t,e){var i;switch(e){case o.LinearToneMapping:i="Linear";break;case o.ReinhardToneMapping:i="Reinhard";break;case o.Uncharted2ToneMapping:i="Uncharted2";break;case o.CineonToneMapping:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function n(t,e,i){t=t||{};var r=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return r.filter(l).join("\n")}function s(t){var e=[];for(var i in t){var r=t[i];r!==!1&&e.push("#define "+i+" "+r)}return e.join("\n")}function a(t,e,i){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;n>o;o++){var s=t.getActiveUniform(e,o),a=s.name,h=t.getUniformLocation(e,a),l=f.exec(a);if(l){var c=l[1],u=l[2],p=r[c];p||(p=r[c]={}),p[u]=h}else if(l=m.exec(a)){var d=l[1],v=l[2],y=l[3],x=r[d];x||(x=r[d]=[]);var _=x[v];_||(_=x[v]={}),_[y]=h}else if(l=g.exec(a)){var d=l[1];r[d]=h}else r[a]=h}return r}function h(t,e,i){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;n>o;o++){var s=t.getActiveAttrib(e,o),a=s.name;r[a]=t.getAttribLocation(e,a)}return r}function l(t){return""!==t}function c(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function u(t){function e(t,e){var i=o.ShaderChunk[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return u(i)}var i=/#include +<([\w\d.]+)>/g;return t.replace(i,e)}function p(t){function e(t,e,i,r){for(var n="",o=parseInt(e);o<parseInt(i);o++)n+=r.replace(/\[ i \]/g,"[ "+o+" ]");return n}var i=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(i,e)}var d=0,f=/^([\w\d_]+)\.([\w\d_]+)$/,m=/^([\w\d_]+)\[(\d+)\]\.([\w\d_]+)$/,g=/^([\w\d_]+)\[0\]$/;return function(t,f,m,g){var v=t.context,y=m.extensions,x=m.defines,_=m.__webglShader.vertexShader,b=m.__webglShader.fragmentShader,w="SHADOWMAP_TYPE_BASIC";g.shadowMapType===o.PCFShadowMap?w="SHADOWMAP_TYPE_PCF":g.shadowMapType===o.PCFSoftShadowMap&&(w="SHADOWMAP_TYPE_PCF_SOFT");var S="ENVMAP_TYPE_CUBE",T="ENVMAP_MODE_REFLECTION",M="ENVMAP_BLENDING_MULTIPLY";if(g.envMap){switch(m.envMap.mapping){case o.CubeReflectionMapping:case o.CubeRefractionMapping:S="ENVMAP_TYPE_CUBE";break;case o.CubeUVReflectionMapping:case o.CubeUVRefractionMapping:S="ENVMAP_TYPE_CUBE_UV";break;case o.EquirectangularReflectionMapping:case o.EquirectangularRefractionMapping:S="ENVMAP_TYPE_EQUIREC";break;case o.SphericalReflectionMapping:S="ENVMAP_TYPE_SPHERE"}switch(m.envMap.mapping){case o.CubeRefractionMapping:case o.EquirectangularRefractionMapping:T="ENVMAP_MODE_REFRACTION"}switch(m.combine){case o.MultiplyOperation:M="ENVMAP_BLENDING_MULTIPLY";break;case o.MixOperation:M="ENVMAP_BLENDING_MIX";break;case o.AddOperation:M="ENVMAP_BLENDING_ADD"}}var E,C,A=t.gammaFactor>0?t.gammaFactor:1,L=n(y,g,t.extensions),P=s(x),R=v.createProgram();m instanceof o.RawShaderMaterial?(E="",C=""):(E=["precision "+g.precision+" float;","precision "+g.precision+" int;","#define SHADER_NAME "+m.__webglShader.name,P,g.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+g.maxBones,g.map?"#define USE_MAP":"",g.envMap?"#define USE_ENVMAP":"",g.envMap?"#define "+T:"",g.lightMap?"#define USE_LIGHTMAP":"",g.aoMap?"#define USE_AOMAP":"",g.emissiveMap?"#define USE_EMISSIVEMAP":"",g.bumpMap?"#define USE_BUMPMAP":"",g.normalMap?"#define USE_NORMALMAP":"",g.displacementMap&&g.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",g.specularMap?"#define USE_SPECULARMAP":"",g.roughnessMap?"#define USE_ROUGHNESSMAP":"",g.metalnessMap?"#define USE_METALNESSMAP":"",g.alphaMap?"#define USE_ALPHAMAP":"",g.vertexColors?"#define USE_COLOR":"",g.flatShading?"#define FLAT_SHADED":"",g.skinning?"#define USE_SKINNING":"",g.useVertexTexture?"#define BONE_TEXTURE":"",g.morphTargets?"#define USE_MORPHTARGETS":"",g.morphNormals&&g.flatShading===!1?"#define USE_MORPHNORMALS":"",g.doubleSided?"#define DOUBLE_SIDED":"",g.flipSided?"#define FLIP_SIDED":"",g.shadowMapEnabled?"#define USE_SHADOWMAP":"",g.shadowMapEnabled?"#define "+w:"",g.pointLightShadows>0?"#define POINT_LIGHT_SHADOWS":"",g.sizeAttenuation?"#define USE_SIZEATTENUATION":"",g.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",g.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(l).join("\n"),C=[L,"precision "+g.precision+" float;","precision "+g.precision+" int;","#define SHADER_NAME "+m.__webglShader.name,P,g.alphaTest?"#define ALPHATEST "+g.alphaTest:"","#define GAMMA_FACTOR "+A,g.useFog&&g.fog?"#define USE_FOG":"",g.useFog&&g.fogExp?"#define FOG_EXP2":"",g.map?"#define USE_MAP":"",g.envMap?"#define USE_ENVMAP":"",g.envMap?"#define "+S:"",g.envMap?"#define "+T:"",g.envMap?"#define "+M:"",g.lightMap?"#define USE_LIGHTMAP":"",g.aoMap?"#define USE_AOMAP":"",g.emissiveMap?"#define USE_EMISSIVEMAP":"",g.bumpMap?"#define USE_BUMPMAP":"",g.normalMap?"#define USE_NORMALMAP":"",g.specularMap?"#define USE_SPECULARMAP":"",g.roughnessMap?"#define USE_ROUGHNESSMAP":"",g.metalnessMap?"#define USE_METALNESSMAP":"",g.alphaMap?"#define USE_ALPHAMAP":"",g.vertexColors?"#define USE_COLOR":"",g.flatShading?"#define FLAT_SHADED":"",g.doubleSided?"#define DOUBLE_SIDED":"",g.flipSided?"#define FLIP_SIDED":"",g.shadowMapEnabled?"#define USE_SHADOWMAP":"",g.shadowMapEnabled?"#define "+w:"",g.pointLightShadows>0?"#define POINT_LIGHT_SHADOWS":"",g.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",g.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",g.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",g.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",g.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",g.toneMapping!==o.NoToneMapping?"#define TONE_MAPPING":"",g.toneMapping!==o.NoToneMapping?o.ShaderChunk.tonemapping_pars_fragment:"",g.toneMapping!==o.NoToneMapping?r("toneMapping",g.toneMapping):"",g.outputEncoding||g.mapEncoding||g.envMapEncoding||g.emissiveMapEncoding?o.ShaderChunk.encodings_pars_fragment:"",g.mapEncoding?e("mapTexelToLinear",g.mapEncoding):"",g.envMapEncoding?e("envMapTexelToLinear",g.envMapEncoding):"",g.emissiveMapEncoding?e("emissiveMapTexelToLinear",g.emissiveMapEncoding):"",g.outputEncoding?i("linearToOutputTexel",g.outputEncoding):"","\n"].filter(l).join("\n")),_=u(_,g),_=c(_,g),b=u(b,g),b=c(b,g),m instanceof o.ShaderMaterial==!1&&(_=p(_),b=p(b));var O=E+_,I=C+b,D=o.WebGLShader(v,v.VERTEX_SHADER,O),B=o.WebGLShader(v,v.FRAGMENT_SHADER,I);v.attachShader(R,D),v.attachShader(R,B),void 0!==m.index0AttributeName?v.bindAttribLocation(R,0,m.index0AttributeName):g.morphTargets===!0&&v.bindAttribLocation(R,0,"position"),v.linkProgram(R);var k=v.getProgramInfoLog(R),F=v.getShaderInfoLog(D),N=v.getShaderInfoLog(B),U=!0,G=!0;v.getProgramParameter(R,v.LINK_STATUS)===!1?U=!1:""!==k||""!==F&&""!==N||(G=!1),G&&(this.diagnostics={runnable:U,material:m,programLog:k,vertexShader:{log:F,prefix:E},fragmentShader:{log:N,prefix:C}}),v.deleteShader(D),v.deleteShader(B);var z;this.getUniforms=function(){return void 0===z&&(z=a(v,R)),z};var V;return this.getAttributes=function(){return void 0===V&&(V=h(v,R)),V},this.destroy=function(){v.deleteProgram(R),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return this.getUniforms()}},attributes:{get:function(){return this.getAttributes()}}}),this.id=d++,this.code=f,this.usedTimes=1,this.program=R,this.vertexShader=D,this.fragmentShader=B,this}}(),o.WebGLPrograms=function(t,e){function i(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var i=e.maxVertexUniforms,r=Math.floor((i-20)/4),n=r;return void 0!==t&&t instanceof o.SkinnedMesh&&(n=Math.min(t.skeleton.bones.length,n),n<t.skeleton.bones.length),n}function r(t,e){var i;return t?t instanceof o.Texture?i=t.encoding:t instanceof o.WebGLRenderTarget&&(i=t.texture.encoding):i=o.LinearEncoding,i===o.LinearEncoding&&e&&(i=o.GammaEncoding),i}var n=[],s={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"standard",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","pointLightShadows","toneMapping","physicallyCorrectLights","shadowMapType","alphaTest","doubleSided","flipSided"];
this.getParameters=function(n,a,h,l){var c=s[n.type],u=i(l),p=t.getPrecision();null!==n.precision&&(p=e.getMaxPrecision(n.precision),p!==n.precision);var d={shaderID:c,precision:p,supportsVertexTextures:e.vertexTextures,outputEncoding:r(t.getCurrentRenderTarget(),t.gammaOutput),map:!!n.map,mapEncoding:r(n.map,t.gammaInput),envMap:!!n.envMap,envMapMode:n.envMap&&n.envMap.mapping,envMapEncoding:r(n.envMap,t.gammaInput),envMapCubeUV:!!n.envMap&&(n.envMap.mapping===o.CubeUVReflectionMapping||n.envMap.mapping===o.CubeUVRefractionMapping),lightMap:!!n.lightMap,aoMap:!!n.aoMap,emissiveMap:!!n.emissiveMap,emissiveMapEncoding:r(n.emissiveMap,t.gammaInput),bumpMap:!!n.bumpMap,normalMap:!!n.normalMap,displacementMap:!!n.displacementMap,roughnessMap:!!n.roughnessMap,metalnessMap:!!n.metalnessMap,specularMap:!!n.specularMap,alphaMap:!!n.alphaMap,combine:n.combine,vertexColors:n.vertexColors,fog:h,useFog:n.fog,fogExp:h instanceof o.FogExp2,flatShading:n.shading===o.FlatShading,sizeAttenuation:n.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:n.skinning,maxBones:u,useVertexTexture:e.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:n.morphTargets,morphNormals:n.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numHemiLights:a.hemi.length,pointLightShadows:a.shadowsPointLight,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&a.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:n.premultipliedAlpha,alphaTest:n.alphaTest,doubleSided:n.side===o.DoubleSide,flipSided:n.side===o.BackSide};return d},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)i.push(r),i.push(t.defines[r]);for(var n=0;n<a.length;n++){var o=a[n];i.push(o),i.push(e[o])}return i.join()},this.acquireProgram=function(e,i,r){for(var s,a=0,h=n.length;h>a;a++){var l=n[a];if(l.code===r){s=l,++s.usedTimes;break}}return void 0===s&&(s=new o.WebGLProgram(t,r,e,i),n.push(s)),s},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=n.indexOf(t);n[e]=n[n.length-1],n.pop(),t.destroy()}},this.programs=n},o.WebGLProperties=function(){var t={};this.get=function(e){var i=e.uuid,r=t[i];return void 0===r&&(r={},t[i]=r),r},this["delete"]=function(e){delete t[e.uuid]},this.clear=function(){t={}}},o.WebGLShader=function(){return function(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)===!1,""!==t.getShaderInfoLog(r),r}}(),o.WebGLShadowMap=function(t,e,i){function r(t,e,i,r){var n=t.geometry,s=null,a=v,h=t.customDepthMaterial;if(i&&(a=y,h=t.customDistanceMaterial),h)s=h;else{var l=void 0!==n.morphTargets&&n.morphTargets.length>0&&e.morphTargets,c=t instanceof o.SkinnedMesh&&e.skinning,u=0;l&&(u|=f),c&&(u|=m),s=a[u]}return s.visible=e.visible,s.wireframe=e.wireframe,s.wireframeLinewidth=e.wireframeLinewidth,i&&void 0!==s.uniforms.lightPos&&s.uniforms.lightPos.value.copy(r),s}function n(t,e,i){if(t.visible!==!1){if(t.layers.test(e.layers)&&(t instanceof o.Mesh||t instanceof o.Line||t instanceof o.Points)&&t.castShadow&&(t.frustumCulled===!1||h.intersectsObject(t)===!0)){var r=t.material;r.visible===!0&&(t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),d.push(t))}for(var s=t.children,a=0,l=s.length;l>a;a++)n(s[a],e,i)}}for(var s=t.context,a=t.state,h=new o.Frustum,l=new o.Matrix4,c=new o.Vector2,u=new o.Vector3,p=new o.Vector3,d=[],f=1,m=2,g=(f|m)+1,v=new Array(g),y=new Array(g),x=[new o.Vector3(1,0,0),new o.Vector3(-1,0,0),new o.Vector3(0,0,1),new o.Vector3(0,0,-1),new o.Vector3(0,1,0),new o.Vector3(0,-1,0)],_=[new o.Vector3(0,1,0),new o.Vector3(0,1,0),new o.Vector3(0,1,0),new o.Vector3(0,1,0),new o.Vector3(0,0,1),new o.Vector3(0,0,-1)],b=[new o.Vector4,new o.Vector4,new o.Vector4,new o.Vector4,new o.Vector4,new o.Vector4],w=o.ShaderLib.depthRGBA,S=o.UniformsUtils.clone(w.uniforms),T=o.ShaderLib.distanceRGBA,M=o.UniformsUtils.clone(T.uniforms),E=0;E!==g;++E){var C=0!==(E&f),A=0!==(E&m),L=new o.ShaderMaterial({uniforms:S,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:C,skinning:A});v[E]=L;var P=new o.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:M,vertexShader:T.vertexShader,fragmentShader:T.fragmentShader,morphTargets:C,skinning:A});y[E]=P}var R=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=o.PCFShadowMap,this.cullFace=o.CullFaceFront,this.render=function(f,m){var g,v,y=e.shadows;if(0!==y.length&&R.enabled!==!1&&(R.autoUpdate!==!1||R.needsUpdate!==!1)){a.clearColor(1,1,1,1),a.disable(s.BLEND),a.enable(s.CULL_FACE),s.frontFace(s.CCW),s.cullFace(R.cullFace===o.CullFaceFront?s.FRONT:s.BACK),a.setDepthTest(!0),a.setScissorTest(!1);for(var w=0,S=y.length;S>w;w++){var T=y[w],M=T.shadow,E=M.camera;if(c.copy(M.mapSize),T instanceof o.PointLight){g=6,v=!0;var C=c.x,A=c.y;b[0].set(2*C,A,C,A),b[1].set(0,A,C,A),b[2].set(3*C,A,C,A),b[3].set(C,A,C,A),b[4].set(3*C,0,C,A),b[5].set(C,0,C,A),c.x*=4,c.y*=2}else g=1,v=!1;if(null===M.map){var L={minFilter:o.NearestFilter,magFilter:o.NearestFilter,format:o.RGBAFormat};M.map=new o.WebGLRenderTarget(c.x,c.y,L),T instanceof o.SpotLight&&(E.aspect=c.x/c.y),E.updateProjectionMatrix()}var P=M.map,O=M.matrix;p.setFromMatrixPosition(T.matrixWorld),E.position.copy(p),t.setRenderTarget(P),t.clear();for(var I=0;g>I;I++){if(v){u.copy(E.position),u.add(x[I]),E.up.copy(_[I]),E.lookAt(u);var D=b[I];a.viewport(D)}else u.setFromMatrixPosition(T.target.matrixWorld),E.lookAt(u);E.updateMatrixWorld(),E.matrixWorldInverse.getInverse(E.matrixWorld),O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(E.projectionMatrix),O.multiply(E.matrixWorldInverse),l.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),h.setFromMatrix(l),d.length=0,n(f,m,E);for(var B=0,k=d.length;k>B;B++){var F=d[B],N=i.update(F),U=F.material;if(U instanceof o.MultiMaterial)for(var G=N.groups,z=U.materials,V=0,j=G.length;j>V;V++){var H=G[V],W=z[H.materialIndex];if(W.visible===!0){var X=r(F,W,v,p);t.renderBufferDirect(E,null,N,X,F,H)}}else{var X=r(F,U,v,p);t.renderBufferDirect(E,null,N,X,F,null)}}}}var Y=t.getClearColor(),q=t.getClearAlpha();t.setClearColor(Y,q),a.enable(s.BLEND),R.cullFace===o.CullFaceFront&&s.cullFace(s.BACK),R.needsUpdate=!1}}},o.WebGLState=function(t,e,i){var r=this,n=new o.Vector4,s=new Uint8Array(16),a=new Uint8Array(16),h=new Uint8Array(16),l={},c=null,u=null,p=null,d=null,f=null,m=null,g=null,v=null,y=!1,x=null,_=null,b=null,w=null,S=null,T=null,M=null,E=null,C=null,A=null,L=null,P=null,R=null,O=null,I=null,D=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),B=void 0,k={},F=new o.Vector4,N=null,U=null,G=new o.Vector4,z=new o.Vector4,V=t.createTexture();t.bindTexture(t.TEXTURE_2D,V),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,1,1,0,t.RGB,t.UNSIGNED_BYTE,new Uint8Array(3)),this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=s.length;e>t;t++)s[t]=0},this.enableAttribute=function(i){if(s[i]=1,0===a[i]&&(t.enableVertexAttribArray(i),a[i]=1),0!==h[i]){var r=e.get("ANGLE_instanced_arrays");r.vertexAttribDivisorANGLE(i,0),h[i]=0}},this.enableAttributeAndDivisor=function(e,i,r){s[e]=1,0===a[e]&&(t.enableVertexAttribArray(e),a[e]=1),h[e]!==i&&(r.vertexAttribDivisorANGLE(e,i),h[e]=i)},this.disableUnusedAttributes=function(){for(var e=0,i=a.length;i>e;e++)a[e]!==s[e]&&(t.disableVertexAttribArray(e),a[e]=0)},this.enable=function(e){l[e]!==!0&&(t.enable(e),l[e]=!0)},this.disable=function(e){l[e]!==!1&&(t.disable(e),l[e]=!1)},this.getCompressedTextureFormats=function(){if(null===c&&(c=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<i.length;r++)c.push(i[r]);return c},this.setBlending=function(e,r,n,s,a,h,l,c){e===o.NoBlending?this.disable(t.BLEND):this.enable(t.BLEND),e===u&&c===y||(e===o.AdditiveBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===o.SubtractiveBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===o.MultiplyBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.SRC_COLOR,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),u=e,y=c),e===o.CustomBlending?(a=a||r,h=h||n,l=l||s,r===p&&a===m||(t.blendEquationSeparate(i(r),i(a)),p=r,m=a),n===d&&s===f&&h===g&&l===v||(t.blendFuncSeparate(i(n),i(s),i(h),i(l)),d=n,f=s,g=h,v=l)):(p=null,d=null,f=null,m=null,g=null,v=null)},this.setDepthFunc=function(e){if(x!==e){if(e)switch(e){case o.NeverDepth:t.depthFunc(t.NEVER);break;case o.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case o.LessDepth:t.depthFunc(t.LESS);break;case o.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case o.EqualDepth:t.depthFunc(t.EQUAL);break;case o.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case o.GreaterDepth:t.depthFunc(t.GREATER);break;case o.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);x=e}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)},this.setDepthWrite=function(e){_!==e&&(t.depthMask(e),_=e)},this.setColorWrite=function(e){b!==e&&(t.colorMask(e,e,e,e),b=e)},this.setStencilFunc=function(e,i,r){S===e&&T===i&&M===r||(t.stencilFunc(e,i,r),S=e,T=i,M=r)},this.setStencilOp=function(e,i,r){E===e&&C===i&&A===r||(t.stencilOp(e,i,r),E=e,C=i,A=r)},this.setStencilTest=function(e){e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)},this.setStencilWrite=function(e){w!==e&&(t.stencilMask(e),w=e)},this.setFlipSided=function(e){L!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),L=e)},this.setLineWidth=function(e){e!==P&&(t.lineWidth(e),P=e)},this.setPolygonOffset=function(e,i,r){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||R===i&&O===r||(t.polygonOffset(i,r),R=i,O=r)},this.getScissorTest=function(){return I},this.setScissorTest=function(e){I=e,e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+D-1),B!==e&&(t.activeTexture(e),B=e)},this.bindTexture=function(e,i){void 0===B&&r.activeTexture();var n=k[B];void 0===n&&(n={type:void 0,texture:void 0},k[B]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||V),n.type=e,n.texture=i)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(e){}},this.clearColor=function(e,i,r,o){n.set(e,i,r,o),F.equals(n)===!1&&(t.clearColor(e,i,r,o),F.copy(n))},this.clearDepth=function(e){N!==e&&(t.clearDepth(e),N=e)},this.clearStencil=function(e){U!==e&&(t.clearStencil(e),U=e)},this.scissor=function(e){G.equals(e)===!1&&(t.scissor(e.x,e.y,e.z,e.w),G.copy(e))},this.viewport=function(e){z.equals(e)===!1&&(t.viewport(e.x,e.y,e.z,e.w),z.copy(e))},this.reset=function(){for(var e=0;e<a.length;e++)1===a[e]&&(t.disableVertexAttribArray(e),a[e]=0);l={},c=null,B=void 0,k={},u=null,b=null,_=null,w=null,L=null}},o.LensFlarePlugin=function(t,e){function i(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);n=d.createBuffer(),s=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,n),d.bufferData(d.ARRAY_BUFFER,t,d.STATIC_DRAW),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),d.bufferData(d.ELEMENT_ARRAY_BUFFER,e,d.STATIC_DRAW),u=d.createTexture(),p=d.createTexture(),f.bindTexture(d.TEXTURE_2D,u),d.texImage2D(d.TEXTURE_2D,0,d.RGB,16,16,0,d.RGB,d.UNSIGNED_BYTE,null),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),f.bindTexture(d.TEXTURE_2D,p),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,16,16,0,d.RGBA,d.UNSIGNED_BYTE,null),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),c=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var i;i=c?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},a=r(i),h={vertex:d.getAttribLocation(a,"position"),uv:d.getAttribLocation(a,"uv")},l={renderType:d.getUniformLocation(a,"renderType"),map:d.getUniformLocation(a,"map"),occlusionMap:d.getUniformLocation(a,"occlusionMap"),opacity:d.getUniformLocation(a,"opacity"),color:d.getUniformLocation(a,"color"),scale:d.getUniformLocation(a,"scale"),rotation:d.getUniformLocation(a,"rotation"),screenPosition:d.getUniformLocation(a,"screenPosition")}}function r(e){var i=d.createProgram(),r=d.createShader(d.FRAGMENT_SHADER),n=d.createShader(d.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return d.shaderSource(r,o+e.fragmentShader),d.shaderSource(n,o+e.vertexShader),d.compileShader(r),d.compileShader(n),d.attachShader(i,r),d.attachShader(i,n),d.linkProgram(i),i}var n,s,a,h,l,c,u,p,d=t.context,f=t.state;this.render=function(r,m,g){if(0!==e.length){var v=new o.Vector3,y=g.w/g.z,x=.5*g.z,_=.5*g.w,b=16/g.w,w=new o.Vector2(b*y,b),S=new o.Vector3(1,1,0),T=new o.Vector2(1,1);void 0===a&&i(),d.useProgram(a),f.initAttributes(),f.enableAttribute(h.vertex),f.enableAttribute(h.uv),f.disableUnusedAttributes(),d.uniform1i(l.occlusionMap,0),d.uniform1i(l.map,1),d.bindBuffer(d.ARRAY_BUFFER,n),d.vertexAttribPointer(h.vertex,2,d.FLOAT,!1,16,0),d.vertexAttribPointer(h.uv,2,d.FLOAT,!1,16,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),f.disable(d.CULL_FACE),f.setDepthWrite(!1);for(var M=0,E=e.length;E>M;M++){b=16/g.w,w.set(b*y,b);var C=e[M];if(v.set(C.matrixWorld.elements[12],C.matrixWorld.elements[13],C.matrixWorld.elements[14]),v.applyMatrix4(m.matrixWorldInverse),v.applyProjection(m.projectionMatrix),S.copy(v),T.x=S.x*x+x,T.y=S.y*_+_,c||T.x>0&&T.x<g.z&&T.y>0&&T.y<g.w){f.activeTexture(d.TEXTURE0),f.bindTexture(d.TEXTURE_2D,null),f.activeTexture(d.TEXTURE1),f.bindTexture(d.TEXTURE_2D,u),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGB,g.x+T.x-8,g.y+T.y-8,16,16,0),d.uniform1i(l.renderType,0),d.uniform2f(l.scale,w.x,w.y),d.uniform3f(l.screenPosition,S.x,S.y,S.z),f.disable(d.BLEND),f.enable(d.DEPTH_TEST),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),f.activeTexture(d.TEXTURE0),f.bindTexture(d.TEXTURE_2D,p),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,g.x+T.x-8,g.y+T.y-8,16,16,0),d.uniform1i(l.renderType,1),f.disable(d.DEPTH_TEST),f.activeTexture(d.TEXTURE1),f.bindTexture(d.TEXTURE_2D,u),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),C.positionScreen.copy(S),C.customUpdateCallback?C.customUpdateCallback(C):C.updateLensFlares(),d.uniform1i(l.renderType,2),f.enable(d.BLEND);for(var A=0,L=C.lensFlares.length;L>A;A++){var P=C.lensFlares[A];P.opacity>.001&&P.scale>.001&&(S.x=P.x,S.y=P.y,S.z=P.z,b=P.size*P.scale/g.w,w.x=b*y,w.y=b,d.uniform3f(l.screenPosition,S.x,S.y,S.z),d.uniform2f(l.scale,w.x,w.y),d.uniform1f(l.rotation,P.rotation),d.uniform1f(l.opacity,P.opacity),d.uniform3f(l.color,P.color.r,P.color.g,P.color.b),f.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),t.setTexture(P.texture,1),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0))}}}f.enable(d.CULL_FACE),f.enable(d.DEPTH_TEST),f.setDepthWrite(!0),t.resetGLState()}}},o.SpritePlugin=function(t,e){function i(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);s=p.createBuffer(),a=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,s),p.bufferData(p.ARRAY_BUFFER,t,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,a),p.bufferData(p.ELEMENT_ARRAY_BUFFER,e,p.STATIC_DRAW),h=r(),l={position:p.getAttribLocation(h,"position"),uv:p.getAttribLocation(h,"uv")},c={uvOffset:p.getUniformLocation(h,"uvOffset"),uvScale:p.getUniformLocation(h,"uvScale"),rotation:p.getUniformLocation(h,"rotation"),scale:p.getUniformLocation(h,"scale"),color:p.getUniformLocation(h,"color"),map:p.getUniformLocation(h,"map"),opacity:p.getUniformLocation(h,"opacity"),modelViewMatrix:p.getUniformLocation(h,"modelViewMatrix"),projectionMatrix:p.getUniformLocation(h,"projectionMatrix"),fogType:p.getUniformLocation(h,"fogType"),fogDensity:p.getUniformLocation(h,"fogDensity"),fogNear:p.getUniformLocation(h,"fogNear"),fogFar:p.getUniformLocation(h,"fogFar"),fogColor:p.getUniformLocation(h,"fogColor"),alphaTest:p.getUniformLocation(h,"alphaTest")};var i=document.createElement("canvas");i.width=8,i.height=8;var n=i.getContext("2d");n.fillStyle="white",n.fillRect(0,0,8,8),u=new o.Texture(i),u.needsUpdate=!0}function r(){var e=p.createProgram(),i=p.createShader(p.VERTEX_SHADER),r=p.createShader(p.FRAGMENT_SHADER);return p.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),p.shaderSource(r,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),p.compileShader(i),p.compileShader(r),p.attachShader(e,i),p.attachShader(e,r),p.linkProgram(e),e}function n(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var s,a,h,l,c,u,p=t.context,d=t.state,f=new o.Vector3,m=new o.Quaternion,g=new o.Vector3;this.render=function(r,v){if(0!==e.length){void 0===h&&i(),p.useProgram(h),d.initAttributes(),d.enableAttribute(l.position),d.enableAttribute(l.uv),d.disableUnusedAttributes(),d.disable(p.CULL_FACE),d.enable(p.BLEND),p.bindBuffer(p.ARRAY_BUFFER,s),p.vertexAttribPointer(l.position,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(l.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,a),p.uniformMatrix4fv(c.projectionMatrix,!1,v.projectionMatrix.elements),d.activeTexture(p.TEXTURE0),p.uniform1i(c.map,0);var y=0,x=0,_=r.fog;_?(p.uniform3f(c.fogColor,_.color.r,_.color.g,_.color.b),_ instanceof o.Fog?(p.uniform1f(c.fogNear,_.near),p.uniform1f(c.fogFar,_.far),p.uniform1i(c.fogType,1),y=1,x=1):_ instanceof o.FogExp2&&(p.uniform1f(c.fogDensity,_.density),p.uniform1i(c.fogType,2),y=2,x=2)):(p.uniform1i(c.fogType,0),y=0,x=0);for(var b=0,w=e.length;w>b;b++){var S=e[b];S.modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14]}e.sort(n);for(var T=[],b=0,w=e.length;w>b;b++){var S=e[b],M=S.material;p.uniform1f(c.alphaTest,M.alphaTest),p.uniformMatrix4fv(c.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(f,m,g),T[0]=g.x,T[1]=g.y;var E=0;r.fog&&M.fog&&(E=x),y!==E&&(p.uniform1i(c.fogType,E),y=E),null!==M.map?(p.uniform2f(c.uvOffset,M.map.offset.x,M.map.offset.y),p.uniform2f(c.uvScale,M.map.repeat.x,M.map.repeat.y)):(p.uniform2f(c.uvOffset,0,0),p.uniform2f(c.uvScale,1,1)),p.uniform1f(c.opacity,M.opacity),p.uniform3f(c.color,M.color.r,M.color.g,M.color.b),p.uniform1f(c.rotation,M.rotation),p.uniform2fv(c.scale,T),d.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),d.setDepthTest(M.depthTest),d.setDepthWrite(M.depthWrite),M.map&&M.map.image&&M.map.image.width?t.setTexture(M.map,0):t.setTexture(u,0),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0)}d.enable(p.CULL_FACE),t.resetGLState()}}},Object.defineProperties(o.Box2.prototype,{empty:{value:function(){return this.isEmpty()}},isIntersectionBox:{value:function(t){return this.intersectsBox(t)}}}),Object.defineProperties(o.Box3.prototype,{empty:{value:function(){return this.isEmpty()}},isIntersectionBox:{value:function(t){return this.intersectsBox(t)}},isIntersectionSphere:{value:function(t){return this.intersectsSphere(t)}}}),Object.defineProperties(o.Matrix3.prototype,{multiplyVector3:{value:function(t){return t.applyMatrix3(this)}},multiplyVector3Array:{value:function(t){return this.applyToVector3Array(t)}}}),Object.defineProperties(o.Matrix4.prototype,{extractPosition:{value:function(t){return this.copyPosition(t)}},setRotationFromQuaternion:{value:function(t){return this.makeRotationFromQuaternion(t)}},multiplyVector3:{value:function(t){return t.applyProjection(this)}},multiplyVector4:{value:function(t){return t.applyMatrix4(this)}},multiplyVector3Array:{value:function(t){return this.applyToVector3Array(t)}},rotateAxis:{value:function(t){t.transformDirection(this)}},crossVector:{value:function(t){return t.applyMatrix4(this)}},translate:{value:function(t){}},rotateX:{value:function(t){}},rotateY:{value:function(t){}},rotateZ:{value:function(t){}},rotateByAxis:{value:function(t,e){}}}),Object.defineProperties(o.Plane.prototype,{isIntersectionLine:{value:function(t){return this.intersectsLine(t)}}}),Object.defineProperties(o.Quaternion.prototype,{multiplyVector3:{value:function(t){return t.applyQuaternion(this)}}}),Object.defineProperties(o.Ray.prototype,{isIntersectionBox:{value:function(t){return this.intersectsBox(t)}},isIntersectionPlane:{value:function(t){return this.intersectsPlane(t)}},isIntersectionSphere:{value:function(t){return this.intersectsSphere(t)}}}),Object.defineProperties(o.Vector3.prototype,{setEulerFromRotationMatrix:{value:function(){}},setEulerFromQuaternion:{value:function(){}},getPositionFromMatrix:{value:function(t){return this.setFromMatrixPosition(t)}},getScaleFromMatrix:{value:function(t){return this.setFromMatrixScale(t)}},getColumnFromMatrix:{value:function(t,e){return this.setFromMatrixColumn(t,e)}}}),o.Face4=function(t,e,i,r,n,s,a){return new o.Face3(t,e,i,n,s,a)},o.Vertex=function(t,e,i){return new o.Vector3(t,e,i)},Object.defineProperties(o.Object3D.prototype,{eulerOrder:{get:function(){return this.rotation.order},set:function(t){this.rotation.order=t}},getChildByName:{value:function(t){return this.getObjectByName(t)}},renderDepth:{set:function(t){}},translate:{value:function(t,e){return this.translateOnAxis(e,t)}},useQuaternion:{get:function(){},set:function(t){}}}),Object.defineProperties(o,{PointCloud:{value:function(t,e){return new o.Points(t,e)}},ParticleSystem:{value:function(t,e){return new o.Points(t,e)}}}),Object.defineProperties(o.Light.prototype,{onlyShadow:{set:function(t){}},shadowCameraFov:{set:function(t){this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){}},shadowBias:{set:function(t){this.shadow.bias=t}},shadowDarkness:{set:function(t){}},shadowMapWidth:{set:function(t){this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){this.shadow.mapSize.height=t}}}),Object.defineProperties(o.BufferAttribute.prototype,{length:{get:function(){return this.array.length}}}),Object.defineProperties(o.BufferGeometry.prototype,{drawcalls:{get:function(){return this.groups}},offsets:{get:function(){return this.groups}},addIndex:{value:function(t){this.setIndex(t)}},addDrawCall:{value:function(t,e,i){this.addGroup(t,e)}},clearDrawCalls:{value:function(){this.clearGroups()}},computeTangents:{value:function(){}},computeOffsets:{value:function(){}}}),Object.defineProperties(o.Material.prototype,{wrapAround:{get:function(){},set:function(t){}},wrapRGB:{get:function(){return new o.Color}}}),Object.defineProperties(o,{PointCloudMaterial:{value:function(t){return new o.PointsMaterial(t)}},ParticleBasicMaterial:{value:function(t){return new o.PointsMaterial(t)}},ParticleSystemMaterial:{value:function(t){return new o.PointsMaterial(t)}}}),Object.defineProperties(o.MeshPhongMaterial.prototype,{metal:{get:function(){return!1},set:function(t){}}}),Object.defineProperties(o.ShaderMaterial.prototype,{derivatives:{get:function(){return this.extensions.derivatives},set:function(t){this.extensions.derivatives=t}}}),Object.defineProperties(o.WebGLRenderer.prototype,{supportsFloatTextures:{value:function(){return this.extensions.get("OES_texture_float")}},supportsHalfFloatTextures:{value:function(){return this.extensions.get("OES_texture_half_float")}},supportsStandardDerivatives:{value:function(){return this.extensions.get("OES_standard_derivatives")}},supportsCompressedTextureS3TC:{value:function(){return this.extensions.get("WEBGL_compressed_texture_s3tc")}},supportsCompressedTexturePVRTC:{value:function(){return this.extensions.get("WEBGL_compressed_texture_pvrtc")}},supportsBlendMinMax:{value:function(){return this.extensions.get("EXT_blend_minmax")}},supportsVertexTextures:{value:function(){return this.capabilities.vertexTextures}},supportsInstancedArrays:{value:function(){return this.extensions.get("ANGLE_instanced_arrays")}},enableScissorTest:{value:function(t){this.setScissorTest(t)}},initMaterial:{value:function(){}},addPrePlugin:{value:function(){}},addPostPlugin:{value:function(){}},updateShadowMap:{value:function(){}},shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){this.shadowMap.cullFace=t}}}),Object.defineProperties(o.WebGLRenderTarget.prototype,{wrapS:{get:function(){return this.texture.wrapS},set:function(t){this.texture.wrapS=t}},wrapT:{get:function(){return this.texture.wrapT},set:function(t){this.texture.wrapT=t}},magFilter:{get:function(){return this.texture.magFilter},set:function(t){this.texture.magFilter=t}},minFilter:{get:function(){return this.texture.minFilter},set:function(t){this.texture.minFilter=t}},anisotropy:{get:function(){return this.texture.anisotropy},set:function(t){this.texture.anisotropy=t}},offset:{get:function(){return this.texture.offset},set:function(t){this.texture.offset=t}},repeat:{get:function(){return this.texture.repeat},set:function(t){this.texture.repeat=t}},format:{get:function(){return this.texture.format},set:function(t){this.texture.format=t}},type:{get:function(){return this.texture.type},set:function(t){this.texture.type=t}},generateMipmaps:{get:function(){return this.texture.generateMipmaps},set:function(t){this.texture.generateMipmaps=t}}}),o.GeometryUtils={merge:function(t,e,i){var r;e instanceof o.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,i)},center:function(t){return t.center()}},o.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,i,r){var n=new o.TextureLoader;n.setCrossOrigin(this.crossOrigin);
var s=n.load(t,i,void 0,r);return e&&(s.mapping=e),s},loadTextureCube:function(t,e,i,r){var n=new o.CubeTextureLoader;n.setCrossOrigin(this.crossOrigin);var s=n.load(t,i,void 0,r);return e&&(s.mapping=e),s},loadCompressedTexture:function(){},loadCompressedTextureCube:function(){}},o.Projector=function(){this.projectVector=function(t,e){t.project(e)},this.unprojectVector=function(t,e){t.unproject(e)},this.pickingRay=function(t,e){}},o.CanvasRenderer=function(){this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},o.MeshFaceMaterial=o.MultiMaterial,o.CurveUtils={tangentQuadraticBezier:function(t,e,i,r){return 2*(1-t)*(i-e)+2*t*(r-i)},tangentCubicBezier:function(t,e,i,r,n){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*r*(1-t)-3*t*t*r+3*t*t*n},tangentSpline:function(t,e,i,r,n){var o=6*t*t-6*t,s=3*t*t-4*t+1,a=-6*t*t+6*t,h=3*t*t-2*t;return o+s+a+h},interpolate:function(t,e,i,r,n){var o=.5*(i-t),s=.5*(r-e),a=n*n,h=n*a;return(2*e-2*i+o+s)*h+(-3*e+3*i-2*o-s)*a+o*n+e}},o.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new o.Group,r=0,n=e.length;n>r;r++)i.add(new o.Mesh(t,e[r]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var r=new o.Matrix4;r.getInverse(i.matrixWorld),t.applyMatrix(r),e.remove(t),i.add(t)}},o.ShapeUtils={area:function(t){for(var e=t.length,i=0,r=e-1,n=0;e>n;r=n++)i+=t[r].x*t[n].y-t[n].x*t[r].y;return.5*i},triangulate:function(){function t(t,e,i,r,n,o){var s,a,h,l,c,u,p,d,f;if(a=t[o[e]].x,h=t[o[e]].y,l=t[o[i]].x,c=t[o[i]].y,u=t[o[r]].x,p=t[o[r]].y,Number.EPSILON>(l-a)*(p-h)-(c-h)*(u-a))return!1;var m,g,v,y,x,_,b,w,S,T,M,E,C,A,L;for(m=u-l,g=p-c,v=a-u,y=h-p,x=l-a,_=c-h,s=0;n>s;s++)if(d=t[o[s]].x,f=t[o[s]].y,!(d===a&&f===h||d===l&&f===c||d===u&&f===p)&&(b=d-a,w=f-h,S=d-l,T=f-c,M=d-u,E=f-p,L=m*T-g*S,C=x*w-_*b,A=v*E-y*M,L>=-Number.EPSILON&&A>=-Number.EPSILON&&C>=-Number.EPSILON))return!1;return!0}return function(e,i){var r=e.length;if(3>r)return null;var n,s,a,h=[],l=[],c=[];if(o.ShapeUtils.area(e)>0)for(s=0;r>s;s++)l[s]=s;else for(s=0;r>s;s++)l[s]=r-1-s;var u=r,p=2*u;for(s=u-1;u>2;){if(p--<=0)return i?c:h;if(n=s,n>=u&&(n=0),s=n+1,s>=u&&(s=0),a=s+1,a>=u&&(a=0),t(e,n,s,a,u,l)){var d,f,m,g,v;for(d=l[n],f=l[s],m=l[a],h.push([e[d],e[f],e[m]]),c.push([l[n],l[s],l[a]]),g=s,v=s+1;u>v;g++,v++)l[g]=l[v];u--,p=2*u}}return i?c:h}}(),triangulateShape:function(t,e){function i(t,e,i){return t.x!==e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function r(t,e,r,n,o){var s=e.x-t.x,a=e.y-t.y,h=n.x-r.x,l=n.y-r.y,c=t.x-r.x,u=t.y-r.y,p=a*h-s*l,d=a*c-s*u;if(Math.abs(p)>Number.EPSILON){var f;if(p>0){if(0>d||d>p)return[];if(f=l*c-h*u,0>f||f>p)return[]}else{if(d>0||p>d)return[];if(f=l*c-h*u,f>0||p>f)return[]}if(0===f)return!o||0!==d&&d!==p?[t]:[];if(f===p)return!o||0!==d&&d!==p?[e]:[];if(0===d)return[r];if(d===p)return[n];var m=f/p;return[{x:t.x+m*s,y:t.y+m*a}]}if(0!==d||l*c!==h*u)return[];var g=0===s&&0===a,v=0===h&&0===l;if(g&&v)return t.x!==r.x||t.y!==r.y?[]:[t];if(g)return i(r,n,t)?[t]:[];if(v)return i(t,e,r)?[r]:[];var y,x,_,b,w,S,T,M;return 0!==s?(t.x<e.x?(y=t,_=t.x,x=e,b=e.x):(y=e,_=e.x,x=t,b=t.x),r.x<n.x?(w=r,T=r.x,S=n,M=n.x):(w=n,T=n.x,S=r,M=r.x)):(t.y<e.y?(y=t,_=t.y,x=e,b=e.y):(y=e,_=e.y,x=t,b=t.y),r.y<n.y?(w=r,T=r.y,S=n,M=n.y):(w=n,T=n.y,S=r,M=r.y)),T>=_?T>b?[]:b===T?o?[]:[w]:M>=b?[w,x]:[w,S]:_>M?[]:_===M?o?[]:[y]:M>=b?[y,x]:[y,S]}function n(t,e,i,r){var n=e.x-t.x,o=e.y-t.y,s=i.x-t.x,a=i.y-t.y,h=r.x-t.x,l=r.y-t.y,c=n*a-o*s,u=n*l-o*h;if(Math.abs(c)>Number.EPSILON){var p=h*a-l*s;return c>0?u>=0&&p>=0:u>=0||p>=0}return u>0}function s(t,e){function i(t,e){var i=y.length-1,r=t-1;0>r&&(r=i);var o=t+1;o>i&&(o=0);var s=n(y[t],y[r],y[o],a[e]);if(!s)return!1;var h=a.length-1,l=e-1;0>l&&(l=h);var c=e+1;return c>h&&(c=0),s=n(a[e],a[l],a[c],y[t]),!!s}function o(t,e){var i,n,o;for(i=0;i<y.length;i++)if(n=i+1,n%=y.length,o=r(t,e,y[i],y[n],!0),o.length>0)return!0;return!1}function s(t,i){var n,o,s,a,h;for(n=0;n<x.length;n++)for(o=e[x[n]],s=0;s<o.length;s++)if(a=s+1,a%=o.length,h=r(t,i,o[s],o[a],!0),h.length>0)return!0;return!1}for(var a,h,l,c,u,p,d,f,m,g,v,y=t.concat(),x=[],_=[],b=0,w=e.length;w>b;b++)x.push(b);for(var S=0,T=2*x.length;x.length>0&&(T--,!(0>T));)for(l=S;l<y.length;l++){c=y[l],h=-1;for(var b=0;b<x.length;b++)if(p=x[b],d=c.x+":"+c.y+":"+p,void 0===_[d]){a=e[p];for(var M=0;M<a.length;M++)if(u=a[M],i(l,M)&&!o(c,u)&&!s(c,u)){h=M,x.splice(b,1),f=y.slice(0,l+1),m=y.slice(l),g=a.slice(h),v=a.slice(0,h+1),y=f.concat(g).concat(v).concat(m),S=l;break}if(h>=0)break;_[d]=!0}if(h>=0)break}return y}for(var a,h,l,c,u,p,d={},f=t.concat(),m=0,g=e.length;g>m;m++)Array.prototype.push.apply(f,e[m]);for(a=0,h=f.length;h>a;a++)u=f[a].x+":"+f[a].y,void 0!==d[u],d[u]=a;var v=s(t,e),y=o.ShapeUtils.triangulate(v,!1);for(a=0,h=y.length;h>a;a++)for(c=y[a],l=0;3>l;l++)u=c[l].x+":"+c[l].y,p=d[u],void 0!==p&&(c[l]=p);return y.concat()},isClockWise:function(t){return o.ShapeUtils.area(t)<0},b2:function(){function t(t,e){var i=1-t;return i*i*e}function e(t,e){return 2*(1-t)*t*e}function i(t,e){return t*t*e}return function(r,n,o,s){return t(r,n)+e(r,o)+i(r,s)}}(),b3:function(){function t(t,e){var i=1-t;return i*i*i*e}function e(t,e){var i=1-t;return 3*i*i*t*e}function i(t,e){var i=1-t;return 3*i*t*t*e}function r(t,e){return t*t*t*e}return function(n,o,s,a,h){return t(n,o)+e(n,s)+i(n,a)+r(n,h)}}()},o.Curve=function(){},o.Curve.prototype={constructor:o.Curve,getPoint:function(t){return null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPoint(e/t));return i},getSpacedPoints:function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPointAt(e/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,r=[],n=this.getPoint(0),o=0;for(r.push(0),i=1;t>=i;i++)e=this.getPoint(i/t),o+=e.distanceTo(n),r.push(o),n=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,r=this.getLengths(),n=0,o=r.length;i=e?e:t*r[o-1];for(var s,a=0,h=o-1;h>=a;)if(n=Math.floor(a+(h-a)/2),s=r[n]-i,0>s)a=n+1;else{if(!(s>0)){h=n;break}h=n-1}if(n=h,r[n]===i){var l=n/(o-1);return l}var c=r[n],u=r[n+1],p=u-c,d=(i-c)/p,l=(n+d)/(o-1);return l},getTangent:function(t){var e=1e-4,i=t-e,r=t+e;0>i&&(i=0),r>1&&(r=1);var n=this.getPoint(i),o=this.getPoint(r),s=o.clone().sub(n);return s.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)}},o.Curve.create=function(t,e){return t.prototype=Object.create(o.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},o.CurvePath=function(){this.curves=[],this.autoClose=!1},o.CurvePath.prototype=Object.create(o.Curve.prototype),o.CurvePath.prototype.constructor=o.CurvePath,o.CurvePath.prototype.add=function(t){this.curves.push(t)},o.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new o.LineCurve(e,t))},o.CurvePath.prototype.getPoint=function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=e){var n=i[r]-e,o=this.curves[r],s=1-n/o.getLength();return o.getPointAt(s)}r++}return null},o.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},o.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,r=this.curves.length;r>i;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},o.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t);return this.createGeometry(e)},o.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},o.CurvePath.prototype.createGeometry=function(t){for(var e=new o.Geometry,i=0,r=t.length;r>i;i++){var n=t[i];e.vertices.push(new o.Vector3(n.x,n.y,n.z||0))}return e},o.Font=function(t){this.data=t},o.Font.prototype={constructor:o.Font,generateShapes:function(t,e,i){function r(t){for(var i=String(t).split(""),r=e/s.resolution,o=0,a=[],h=0;h<i.length;h++){var l=n(i[h],r,o);o+=l.offset,a.push(l.path)}return a}function n(t,e,r){var n=s.glyphs[t]||s.glyphs["?"];if(n){var a,h,l,c,u,p,d,f,m,g,v,y=new o.Path,x=[],_=o.ShapeUtils.b2,b=o.ShapeUtils.b3;if(n.o)for(var w=n._cachedOutline||(n._cachedOutline=n.o.split(" ")),S=0,T=w.length;T>S;){var M=w[S++];switch(M){case"m":a=w[S++]*e+r,h=w[S++]*e,y.moveTo(a,h);break;case"l":a=w[S++]*e+r,h=w[S++]*e,y.lineTo(a,h);break;case"q":if(l=w[S++]*e+r,c=w[S++]*e,d=w[S++]*e+r,f=w[S++]*e,y.quadraticCurveTo(d,f,l,c),v=x[x.length-1]){u=v.x,p=v.y;for(var E=1;i>=E;E++){var C=E/i;_(C,u,d,l),_(C,p,f,c)}}break;case"b":if(l=w[S++]*e+r,c=w[S++]*e,d=w[S++]*e+r,f=w[S++]*e,m=w[S++]*e+r,g=w[S++]*e,y.bezierCurveTo(d,f,m,g,l,c),v=x[x.length-1]){u=v.x,p=v.y;for(var E=1;i>=E;E++){var C=E/i;b(C,u,d,m,l),b(C,p,f,g,c)}}}}return{offset:n.ha*e,path:y}}}void 0===e&&(e=100),void 0===i&&(i=4);for(var s=this.data,a=r(t),h=[],l=0,c=a.length;c>l;l++)Array.prototype.push.apply(h,a[l].toShapes());return h}},o.Path=function(t){o.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},o.Path.prototype=Object.create(o.CurvePath.prototype),o.Path.prototype.constructor=o.Path,o.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;i>e;e++)this.lineTo(t[e].x,t[e].y)},o.Path.prototype.moveTo=function(t,e){this.actions.push({action:"moveTo",args:[t,e]})},o.Path.prototype.lineTo=function(t,e){var i=this.actions[this.actions.length-1].args,r=i[i.length-2],n=i[i.length-1],s=new o.LineCurve(new o.Vector2(r,n),new o.Vector2(t,e));this.curves.push(s),this.actions.push({action:"lineTo",args:[t,e]})},o.Path.prototype.quadraticCurveTo=function(t,e,i,r){var n=this.actions[this.actions.length-1].args,s=n[n.length-2],a=n[n.length-1],h=new o.QuadraticBezierCurve(new o.Vector2(s,a),new o.Vector2(t,e),new o.Vector2(i,r));this.curves.push(h),this.actions.push({action:"quadraticCurveTo",args:[t,e,i,r]})},o.Path.prototype.bezierCurveTo=function(t,e,i,r,n,s){var a=this.actions[this.actions.length-1].args,h=a[a.length-2],l=a[a.length-1],c=new o.CubicBezierCurve(new o.Vector2(h,l),new o.Vector2(t,e),new o.Vector2(i,r),new o.Vector2(n,s));this.curves.push(c),this.actions.push({action:"bezierCurveTo",args:[t,e,i,r,n,s]})},o.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,r=i[i.length-2],n=i[i.length-1],s=[new o.Vector2(r,n)];Array.prototype.push.apply(s,t);var a=new o.SplineCurve(s);this.curves.push(a),this.actions.push({action:"splineThru",args:e})},o.Path.prototype.arc=function(t,e,i,r,n,o){var s=this.actions[this.actions.length-1].args,a=s[s.length-2],h=s[s.length-1];this.absarc(t+a,e+h,i,r,n,o)},o.Path.prototype.absarc=function(t,e,i,r,n,o){this.absellipse(t,e,i,i,r,n,o)},o.Path.prototype.ellipse=function(t,e,i,r,n,o,s,a){var h=this.actions[this.actions.length-1].args,l=h[h.length-2],c=h[h.length-1];this.absellipse(t+l,e+c,i,r,n,o,s,a)},o.Path.prototype.absellipse=function(t,e,i,r,n,s,a,h){var l=[t,e,i,r,n,s,a,h||0],c=new o.EllipseCurve(t,e,i,r,n,s,a,h);this.curves.push(c);var u=c.getPoint(1);l.push(u.x),l.push(u.y),this.actions.push({action:"ellipse",args:l})},o.Path.prototype.getSpacedPoints=function(t){t||(t=40);for(var e=[],i=0;t>i;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},o.Path.prototype.getPoints=function(t){t=t||12;for(var e,i,r,n,s,a,h,l,c,u,p,d=o.ShapeUtils.b2,f=o.ShapeUtils.b3,m=[],g=0,v=this.actions.length;v>g;g++){var y=this.actions[g],x=y.action,_=y.args;switch(x){case"moveTo":m.push(new o.Vector2(_[0],_[1]));break;case"lineTo":m.push(new o.Vector2(_[0],_[1]));break;case"quadraticCurveTo":e=_[2],i=_[3],s=_[0],a=_[1],m.length>0?(c=m[m.length-1],h=c.x,l=c.y):(c=this.actions[g-1].args,h=c[c.length-2],l=c[c.length-1]);for(var b=1;t>=b;b++){var w=b/t;u=d(w,h,s,e),p=d(w,l,a,i),m.push(new o.Vector2(u,p))}break;case"bezierCurveTo":e=_[4],i=_[5],s=_[0],a=_[1],r=_[2],n=_[3],m.length>0?(c=m[m.length-1],h=c.x,l=c.y):(c=this.actions[g-1].args,h=c[c.length-2],l=c[c.length-1]);for(var b=1;t>=b;b++){var w=b/t;u=f(w,h,s,r,e),p=f(w,l,a,n,i),m.push(new o.Vector2(u,p))}break;case"splineThru":c=this.actions[g-1].args;var S=new o.Vector2(c[c.length-2],c[c.length-1]),T=[S],M=t*_[0].length;T=T.concat(_[0]);for(var E=new o.SplineCurve(T),b=1;M>=b;b++)m.push(E.getPointAt(b/M));break;case"arc":for(var C,A=_[0],L=_[1],P=_[2],R=_[3],O=_[4],I=!!_[5],D=O-R,B=2*t,b=1;B>=b;b++){var w=b/B;I||(w=1-w),C=R+w*D,u=A+P*Math.cos(C),p=L+P*Math.sin(C),m.push(new o.Vector2(u,p))}break;case"ellipse":var C,k,F,A=_[0],L=_[1],N=_[2],U=_[3],R=_[4],O=_[5],I=!!_[6],G=_[7],D=O-R,B=2*t;0!==G&&(k=Math.cos(G),F=Math.sin(G));for(var b=1;B>=b;b++){var w=b/B;if(I||(w=1-w),C=R+w*D,u=A+N*Math.cos(C),p=L+U*Math.sin(C),0!==G){var z=u,V=p;u=(z-A)*k-(V-L)*F+A,p=(z-A)*F+(V-L)*k+L}m.push(new o.Vector2(u,p))}}}var j=m[m.length-1];return Math.abs(j.x-m[0].x)<Number.EPSILON&&Math.abs(j.y-m[0].y)<Number.EPSILON&&m.splice(m.length-1,1),this.autoClose&&m.push(m[0]),m},o.Path.prototype.toShapes=function(t,e){function i(t){for(var e=[],i=new o.Path,r=0,n=t.length;n>r;r++){var s=t[r],a=s.args,h=s.action;"moveTo"===h&&0!==i.actions.length&&(e.push(i),i=new o.Path),i[h].apply(i,a)}return 0!==i.actions.length&&e.push(i),e}function r(t){for(var e=[],i=0,r=t.length;r>i;i++){var n=t[i],s=new o.Shape;s.actions=n.actions,s.curves=n.curves,e.push(s)}return e}function n(t,e){for(var i=e.length,r=!1,n=i-1,o=0;i>o;n=o++){var s=e[n],a=e[o],h=a.x-s.x,l=a.y-s.y;if(Math.abs(l)>Number.EPSILON){if(0>l&&(s=e[o],h=-h,a=e[n],l=-l),t.y<s.y||t.y>a.y)continue;if(t.y===s.y){if(t.x===s.x)return!0}else{var c=l*(t.x-s.x)-h*(t.y-s.y);if(0===c)return!0;if(0>c)continue;r=!r}}else{if(t.y!==s.y)continue;if(a.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=a.x)return!0}}return r}var s=o.ShapeUtils.isClockWise,a=i(this.actions);if(0===a.length)return[];if(e===!0)return r(a);var h,l,c,u=[];if(1===a.length)return l=a[0],c=new o.Shape,c.actions=l.actions,c.curves=l.curves,u.push(c),u;var p=!s(a[0].getPoints());p=t?!p:p;var d,f=[],m=[],g=[],v=0;m[v]=void 0,g[v]=[];for(var y=0,x=a.length;x>y;y++)l=a[y],d=l.getPoints(),h=s(d),h=t?!h:h,h?(!p&&m[v]&&v++,m[v]={s:new o.Shape,p:d},m[v].s.actions=l.actions,m[v].s.curves=l.curves,p&&v++,g[v]=[]):g[v].push({h:l,p:d[0]});if(!m[0])return r(a);if(m.length>1){for(var _=!1,b=[],w=0,S=m.length;S>w;w++)f[w]=[];for(var w=0,S=m.length;S>w;w++)for(var T=g[w],M=0;M<T.length;M++){for(var E=T[M],C=!0,A=0;A<m.length;A++)n(E.p,m[A].p)&&(w!==A&&b.push({froms:w,tos:A,hole:M}),C?(C=!1,f[A].push(E)):_=!0);C&&f[w].push(E)}b.length>0&&(_||(g=f))}for(var L,y=0,P=m.length;P>y;y++){c=m[y].s,u.push(c),L=g[y];for(var R=0,O=L.length;O>R;R++)c.holes.push(L[R].h)}return u},o.Shape=function(){o.Path.apply(this,arguments),this.holes=[]},o.Shape.prototype=Object.create(o.Path.prototype),o.Shape.prototype.constructor=o.Shape,o.Shape.prototype.extrude=function(t){return new o.ExtrudeGeometry(this,t)},o.Shape.prototype.makeGeometry=function(t){return new o.ShapeGeometry(this,t)},o.Shape.prototype.getPointsHoles=function(t){for(var e=[],i=0,r=this.holes.length;r>i;i++)e[i]=this.holes[i].getPoints(t);return e},o.Shape.prototype.extractAllPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},o.Shape.prototype.extractPoints=function(t){return this.extractAllPoints(t)},o.LineCurve=function(t,e){this.v1=t,this.v2=e},o.LineCurve.prototype=Object.create(o.Curve.prototype),o.LineCurve.prototype.constructor=o.LineCurve,o.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},o.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},o.LineCurve.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},o.QuadraticBezierCurve=function(t,e,i){this.v0=t,this.v1=e,this.v2=i},o.QuadraticBezierCurve.prototype=Object.create(o.Curve.prototype),o.QuadraticBezierCurve.prototype.constructor=o.QuadraticBezierCurve,o.QuadraticBezierCurve.prototype.getPoint=function(t){var e=o.ShapeUtils.b2;return new o.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},o.QuadraticBezierCurve.prototype.getTangent=function(t){var e=o.CurveUtils.tangentQuadraticBezier;return new o.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()},o.CubicBezierCurve=function(t,e,i,r){this.v0=t,this.v1=e,this.v2=i,this.v3=r},o.CubicBezierCurve.prototype=Object.create(o.Curve.prototype),o.CubicBezierCurve.prototype.constructor=o.CubicBezierCurve,o.CubicBezierCurve.prototype.getPoint=function(t){var e=o.ShapeUtils.b3;return new o.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},o.CubicBezierCurve.prototype.getTangent=function(t){var e=o.CurveUtils.tangentCubicBezier;return new o.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},o.SplineCurve=function(t){this.points=void 0==t?[]:t},o.SplineCurve.prototype=Object.create(o.Curve.prototype),o.SplineCurve.prototype.constructor=o.SplineCurve,o.SplineCurve.prototype.getPoint=function(t){var e=this.points,i=(e.length-1)*t,r=Math.floor(i),n=i-r,s=e[0===r?r:r-1],a=e[r],h=e[r>e.length-2?e.length-1:r+1],l=e[r>e.length-3?e.length-1:r+2],c=o.CurveUtils.interpolate;return new o.Vector2(c(s.x,a.x,h.x,l.x,n),c(s.y,a.y,h.y,l.y,n))},o.EllipseCurve=function(t,e,i,r,n,o,s,a){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a||0},o.EllipseCurve.prototype=Object.create(o.Curve.prototype),o.EllipseCurve.prototype.constructor=o.EllipseCurve,o.EllipseCurve.prototype.getPoint=function(t){var e=this.aEndAngle-this.aStartAngle;0>e&&(e+=2*Math.PI),e>2*Math.PI&&(e-=2*Math.PI);var i;i=this.aClockwise===!0?this.aEndAngle+(1-t)*(2*Math.PI-e):this.aStartAngle+t*e;var r=this.aX+this.xRadius*Math.cos(i),n=this.aY+this.yRadius*Math.sin(i);if(0!==this.aRotation){var s=Math.cos(this.aRotation),a=Math.sin(this.aRotation),h=r,l=n;r=(h-this.aX)*s-(l-this.aY)*a+this.aX,n=(h-this.aX)*a+(l-this.aY)*s+this.aY}return new o.Vector2(r,n)},o.ArcCurve=function(t,e,i,r,n,s){o.EllipseCurve.call(this,t,e,i,i,r,n,s)},o.ArcCurve.prototype=Object.create(o.EllipseCurve.prototype),o.ArcCurve.prototype.constructor=o.ArcCurve,o.LineCurve3=o.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new o.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),o.QuadraticBezierCurve3=o.Curve.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e=o.ShapeUtils.b2;return new o.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))}),o.CubicBezierCurve3=o.Curve.create(function(t,e,i,r){this.v0=t,this.v1=e,this.v2=i,this.v3=r},function(t){var e=o.ShapeUtils.b3;return new o.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),o.SplineCurve3=o.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e=this.points,i=(e.length-1)*t,r=Math.floor(i),n=i-r,s=e[0==r?r:r-1],a=e[r],h=e[r>e.length-2?e.length-1:r+1],l=e[r>e.length-3?e.length-1:r+2],c=o.CurveUtils.interpolate;return new o.Vector3(c(s.x,a.x,h.x,l.x,n),c(s.y,a.y,h.y,l.y,n),c(s.z,a.z,h.z,l.z,n))}),o.CatmullRomCurve3=function(){function t(){}var e=new o.Vector3,i=new t,r=new t,n=new t;return t.prototype.init=function(t,e,i,r){this.c0=t,this.c1=i,this.c2=-3*t+3*e-2*i-r,this.c3=2*t-2*e+i+r},t.prototype.initNonuniformCatmullRom=function(t,e,i,r,n,o,s){var a=(e-t)/n-(i-t)/(n+o)+(i-e)/o,h=(i-e)/o-(r-e)/(o+s)+(r-i)/s;a*=o,h*=o,this.init(e,i,a,h)},t.prototype.initCatmullRom=function(t,e,i,r,n){this.init(e,i,n*(i-t),n*(r-e))},t.prototype.calc=function(t){var e=t*t,i=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*i},o.Curve.create(function(t){this.points=t||[],this.closed=!1},function(t){var s,a,h,l,c=this.points;l=c.length,s=(l-(this.closed?0:1))*t,a=Math.floor(s),h=s-a,this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/c.length)+1)*c.length:0===h&&a===l-1&&(a=l-2,h=1);var u,p,d,f;if(this.closed||a>0?u=c[(a-1)%l]:(e.subVectors(c[0],c[1]).add(c[0]),u=e),p=c[a%l],d=c[(a+1)%l],this.closed||l>a+2?f=c[(a+2)%l]:(e.subVectors(c[l-1],c[l-2]).add(c[l-1]),f=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var m="chordal"===this.type?.5:.25,g=Math.pow(u.distanceToSquared(p),m),v=Math.pow(p.distanceToSquared(d),m),y=Math.pow(d.distanceToSquared(f),m);1e-4>v&&(v=1),1e-4>g&&(g=v),1e-4>y&&(y=v),i.initNonuniformCatmullRom(u.x,p.x,d.x,f.x,g,v,y),r.initNonuniformCatmullRom(u.y,p.y,d.y,f.y,g,v,y),n.initNonuniformCatmullRom(u.z,p.z,d.z,f.z,g,v,y)}else if("catmullrom"===this.type){var x=void 0!==this.tension?this.tension:.5;i.initCatmullRom(u.x,p.x,d.x,f.x,x),r.initCatmullRom(u.y,p.y,d.y,f.y,x),n.initCatmullRom(u.z,p.z,d.z,f.z,x)}var _=new o.Vector3(i.calc(h),r.calc(h),n.calc(h));return _})}(),o.ClosedSplineCurve3=function(t){o.CatmullRomCurve3.call(this,t),this.type="catmullrom",this.closed=!0},o.ClosedSplineCurve3.prototype=Object.create(o.CatmullRomCurve3.prototype),o.BoxGeometry=function(t,e,i,r,n,s){o.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:n,depthSegments:s},this.fromBufferGeometry(new o.BoxBufferGeometry(t,e,i,r,n,s)),this.mergeVertices()},o.BoxGeometry.prototype=Object.create(o.Geometry.prototype),o.BoxGeometry.prototype.constructor=o.BoxGeometry,o.CubeGeometry=o.BoxGeometry,o.BoxBufferGeometry=function(t,e,i,r,n,s){function a(t,e,i){var r=0;return r+=t*e*2,r+=t*i*2,r+=i*e*2,4*r}function h(t,e,i,r,n,s,a,h,c,u,b){for(var w=s/c,S=a/u,T=s/2,M=a/2,E=h/2,C=c+1,A=u+1,L=0,P=0,R=new o.Vector3,O=0;A>O;O++)for(var I=O*S-M,D=0;C>D;D++){var B=D*w-T;R[t]=B*r,R[e]=I*n,R[i]=E,d[g]=R.x,d[g+1]=R.y,d[g+2]=R.z,R[t]=0,R[e]=0,R[i]=h>0?1:-1,f[g]=R.x,f[g+1]=R.y,f[g+2]=R.z,m[v]=D/c,m[v+1]=1-O/u,g+=3,v+=2,L+=1}for(O=0;u>O;O++)for(D=0;c>D;D++){var k=x+D+C*O,F=x+D+C*(O+1),N=x+(D+1)+C*(O+1),U=x+(D+1)+C*O;p[y]=k,p[y+1]=F,p[y+2]=U,p[y+3]=F,p[y+4]=N,p[y+5]=U,y+=6,P+=6}l.addGroup(_,P,b),_+=P,x+=L}o.BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:n,depthSegments:s};var l=this;r=Math.floor(r)||1,n=Math.floor(n)||1,s=Math.floor(s)||1;var c=a(r,n,s),u=c/4*6,p=new(u>65535?Uint32Array:Uint16Array)(u),d=new Float32Array(3*c),f=new Float32Array(3*c),m=new Float32Array(2*c),g=0,v=0,y=0,x=0,_=0;h("z","y","x",-1,-1,i,e,t,s,n,0),h("z","y","x",1,-1,i,e,-t,s,n,1),h("x","z","y",1,1,t,i,e,r,s,2),h("x","z","y",1,-1,t,i,-e,r,s,3),h("x","y","z",1,-1,t,e,i,r,n,4),h("x","y","z",-1,-1,t,e,-i,r,n,5),this.setIndex(new o.BufferAttribute(p,1)),this.addAttribute("position",new o.BufferAttribute(d,3)),this.addAttribute("normal",new o.BufferAttribute(f,3)),this.addAttribute("uv",new o.BufferAttribute(m,2))},o.BoxBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.BoxBufferGeometry.prototype.constructor=o.BoxBufferGeometry,o.CircleGeometry=function(t,e,i,r){o.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},this.fromBufferGeometry(new o.CircleBufferGeometry(t,e,i,r))},o.CircleGeometry.prototype=Object.create(o.Geometry.prototype),o.CircleGeometry.prototype.constructor=o.CircleGeometry,o.CircleBufferGeometry=function(t,e,i,r){o.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var n=e+2,s=new Float32Array(3*n),a=new Float32Array(3*n),h=new Float32Array(2*n);a[2]=1,h[0]=.5,h[1]=.5;for(var l=0,c=3,u=2;e>=l;l++,c+=3,u+=2){var p=i+l/e*r;s[c]=t*Math.cos(p),s[c+1]=t*Math.sin(p),a[c+2]=1,h[u]=(s[c]/t+1)/2,h[u+1]=(s[c+1]/t+1)/2}for(var d=[],c=1;e>=c;c++)d.push(c,c+1,0);this.setIndex(new o.BufferAttribute(new Uint16Array(d),1)),this.addAttribute("position",new o.BufferAttribute(s,3)),this.addAttribute("normal",new o.BufferAttribute(a,3)),this.addAttribute("uv",new o.BufferAttribute(h,2)),this.boundingSphere=new o.Sphere(new o.Vector3,t)},o.CircleBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.CircleBufferGeometry.prototype.constructor=o.CircleBufferGeometry,o.CylinderBufferGeometry=function(t,e,i,r,n,s,a,h){function l(){var t=(r+1)*(n+1);return s===!1&&(t+=2*(r+1)+2*r),t}function c(){var t=r*n*2*3;return s===!1&&(t+=2*r*3),t}function u(){var s,l,c=new o.Vector3,u=new o.Vector3,p=(e-t)/i;for(l=0;n>=l;l++){var d=[],f=l/n,S=f*(e-t)+t;for(s=0;r>=s;s++){var T=s/r;u.x=S*Math.sin(T*h+a),u.y=-f*i+w,u.z=S*Math.cos(T*h+a),g.setXYZ(x,u.x,u.y,u.z),c.copy(u),(0===t&&0===l||0===e&&l===n)&&(c.x=Math.sin(T*h+a),c.z=Math.cos(T*h+a)),c.setY(Math.sqrt(c.x*c.x+c.z*c.z)*p).normalize(),v.setXYZ(x,c.x,c.y,c.z),y.setXY(x,T,1-f),d.push(x),x++}b.push(d)}for(s=0;r>s;s++)for(l=0;n>l;l++){var M=b[l][s],E=b[l+1][s],C=b[l+1][s+1],A=b[l][s+1];m.setX(_,M),_++,m.setX(_,E),_++,m.setX(_,A),_++,m.setX(_,E),_++,m.setX(_,C),_++,m.setX(_,A),_++}}function p(i){var n,s,l,c=new o.Vector2,u=new o.Vector3,p=i===!0?t:e,d=i===!0?1:-1;for(s=x,n=1;r>=n;n++)g.setXYZ(x,0,w*d,0),v.setXYZ(x,0,d,0),i===!0?(c.x=n/r,c.y=0):(c.x=(n-1)/r,c.y=1),y.setXY(x,c.x,c.y),x++;for(l=x,n=0;r>=n;n++){var f=n/r;u.x=p*Math.sin(f*h+a),u.y=w*d,u.z=p*Math.cos(f*h+a),g.setXYZ(x,u.x,u.y,u.z),v.setXYZ(x,0,d,0),y.setXY(x,f,i===!0?1:0),x++}for(n=0;r>n;n++){var b=s+n,S=l+n;i===!0?(m.setX(_,S),_++,m.setX(_,S+1),_++,m.setX(_,b),_++):(m.setX(_,S+1),_++,m.setX(_,S),_++,m.setX(_,b),_++)}}o.BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:h},t=void 0!==t?t:20,e=void 0!==e?e:20,i=void 0!==i?i:100,r=Math.floor(r)||8,n=Math.floor(n)||1,s=void 0!==s?s:!1,a=void 0!==a?a:0,h=void 0!==h?h:2*Math.PI;var d=l(),f=c(),m=new o.BufferAttribute(new(f>65535?Uint32Array:Uint16Array)(f),1),g=new o.BufferAttribute(new Float32Array(3*d),3),v=new o.BufferAttribute(new Float32Array(3*d),3),y=new o.BufferAttribute(new Float32Array(2*d),2),x=0,_=0,b=[],w=i/2;u(),s===!1&&(t>0&&p(!0),e>0&&p(!1)),this.setIndex(m),this.addAttribute("position",g),this.addAttribute("normal",v),this.addAttribute("uv",y)},o.CylinderBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.CylinderBufferGeometry.prototype.constructor=o.CylinderBufferGeometry,o.CylinderGeometry=function(t,e,i,r,n,s,a,h){o.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:h},this.fromBufferGeometry(new o.CylinderBufferGeometry(t,e,i,r,n,s,a,h)),this.mergeVertices()},o.CylinderGeometry.prototype=Object.create(o.Geometry.prototype),o.CylinderGeometry.prototype.constructor=o.CylinderGeometry,o.EdgesGeometry=function(t,e){function i(t,e){return t-e}o.BufferGeometry.call(this),e=void 0!==e?e:1;var r,n=Math.cos(o.Math.degToRad(e)),s=[0,0],a={},h=["a","b","c"];t instanceof o.BufferGeometry?(r=new o.Geometry,r.fromBufferGeometry(t)):r=t.clone(),r.mergeVertices(),r.computeFaceNormals();for(var l=r.vertices,c=r.faces,u=0,p=c.length;p>u;u++)for(var d=c[u],f=0;3>f;f++){s[0]=d[h[f]],s[1]=d[h[(f+1)%3]],s.sort(i);var m=s.toString();void 0===a[m]?a[m]={vert1:s[0],vert2:s[1],face1:u,face2:void 0}:a[m].face2=u}var g=[];for(var m in a){var v=a[m];if(void 0===v.face2||c[v.face1].normal.dot(c[v.face2].normal)<=n){var y=l[v.vert1];g.push(y.x),g.push(y.y),g.push(y.z),y=l[v.vert2],g.push(y.x),g.push(y.y),g.push(y.z)}}this.addAttribute("position",new o.BufferAttribute(new Float32Array(g),3))},o.EdgesGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.EdgesGeometry.prototype.constructor=o.EdgesGeometry,o.ExtrudeGeometry=function(t,e){return"undefined"==typeof t?void(t=[]):(o.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),void this.computeFaceNormals())},o.ExtrudeGeometry.prototype=Object.create(o.Geometry.prototype),o.ExtrudeGeometry.prototype.constructor=o.ExtrudeGeometry,o.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var i=t.length,r=0;i>r;r++){var n=t[r];this.addShape(n,e)}},o.ExtrudeGeometry.prototype.addShape=function(t,e){function i(t,e,i){return e.clone().multiplyScalar(i).add(t)}function r(t,e,i){var r,n,s=1,a=t.x-e.x,h=t.y-e.y,l=i.x-t.x,c=i.y-t.y,u=a*a+h*h,p=a*c-h*l;if(Math.abs(p)>Number.EPSILON){var d=Math.sqrt(u),f=Math.sqrt(l*l+c*c),m=e.x-h/d,g=e.y+a/d,v=i.x-c/f,y=i.y+l/f,x=((v-m)*c-(y-g)*l)/(a*c-h*l);r=m+a*x-t.x,n=g+h*x-t.y;var _=r*r+n*n;if(2>=_)return new o.Vector2(r,n);s=Math.sqrt(_/2)}else{var b=!1;a>Number.EPSILON?l>Number.EPSILON&&(b=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(b=!0):Math.sign(h)===Math.sign(c)&&(b=!0),b?(r=-h,n=a,s=Math.sqrt(u)):(r=a,n=h,s=Math.sqrt(u/2))}return new o.Vector2(r/s,n/s)}function n(){if(_){var t=0,e=j*t;for(X=0;H>X;X++)V=B[X],l(V[2]+e,V[1]+e,V[0]+e);for(t=w+2*x,e=j*t,X=0;H>X;X++)V=B[X],l(V[0]+e,V[1]+e,V[2]+e)}else{for(X=0;H>X;X++)V=B[X],l(V[2],V[1],V[0]);for(X=0;H>X;X++)V=B[X],l(V[0]+j*w,V[1]+j*w,V[2]+j*w)}}function s(){var t=0;for(a(k,t),t+=k.length,C=0,A=I.length;A>C;C++)E=I[C],a(E,t),t+=E.length}function a(t,e){var i,r;for(X=t.length;--X>=0;){i=X,r=X-1,0>r&&(r=t.length-1);var n=0,o=w+2*x;for(n=0;o>n;n++){var s=j*n,a=j*(n+1),h=e+i+s,l=e+r+s,u=e+r+a,p=e+i+a;c(h,l,u,p,t,n,o,i,r)}}}function h(t,e,i){L.vertices.push(new o.Vector3(t,e,i))}function l(t,e,i){t+=P,e+=P,i+=P,L.faces.push(new o.Face3(t,e,i,null,null,0));var r=M.generateTopUV(L,t,e,i);L.faceVertexUvs[0].push(r)}function c(t,e,i,r,n,s,a,h,l){t+=P,e+=P,i+=P,r+=P,L.faces.push(new o.Face3(t,e,r,null,null,1)),L.faces.push(new o.Face3(e,i,r,null,null,1));var c=M.generateSideWallUV(L,t,e,i,r);L.faceVertexUvs[0].push([c[0],c[1],c[3]]),L.faceVertexUvs[0].push([c[1],c[2],c[3]])}var u,p,d,f,m,g=void 0!==e.amount?e.amount:100,v=void 0!==e.bevelThickness?e.bevelThickness:6,y=void 0!==e.bevelSize?e.bevelSize:v-2,x=void 0!==e.bevelSegments?e.bevelSegments:3,_=void 0!==e.bevelEnabled?e.bevelEnabled:!0,b=void 0!==e.curveSegments?e.curveSegments:12,w=void 0!==e.steps?e.steps:1,S=e.extrudePath,T=!1,M=void 0!==e.UVGenerator?e.UVGenerator:o.ExtrudeGeometry.WorldUVGenerator;S&&(u=S.getSpacedPoints(w),T=!0,_=!1,p=void 0!==e.frames?e.frames:new o.TubeGeometry.FrenetFrames(S,w,!1),d=new o.Vector3,f=new o.Vector3,m=new o.Vector3),_||(x=0,v=0,y=0);var E,C,A,L=this,P=this.vertices.length,R=t.extractPoints(b),O=R.shape,I=R.holes,D=!o.ShapeUtils.isClockWise(O);if(D){for(O=O.reverse(),C=0,A=I.length;A>C;C++)E=I[C],o.ShapeUtils.isClockWise(E)&&(I[C]=E.reverse());D=!1}var B=o.ShapeUtils.triangulateShape(O,I),k=O;for(C=0,A=I.length;A>C;C++)E=I[C],O=O.concat(E);for(var F,N,U,G,z,V,j=O.length,H=B.length,W=[],X=0,Y=k.length,q=Y-1,K=X+1;Y>X;X++,q++,K++)q===Y&&(q=0),K===Y&&(K=0),W[X]=r(k[X],k[q],k[K]);var Z,J=[],Q=W.concat();for(C=0,A=I.length;A>C;C++){for(E=I[C],Z=[],X=0,Y=E.length,q=Y-1,K=X+1;Y>X;X++,q++,K++)q===Y&&(q=0),K===Y&&(K=0),Z[X]=r(E[X],E[q],E[K]);J.push(Z),Q=Q.concat(Z)}for(F=0;x>F;F++){for(U=F/x,G=v*(1-U),N=y*Math.sin(U*Math.PI/2),X=0,Y=k.length;Y>X;X++)z=i(k[X],W[X],N),h(z.x,z.y,-G);for(C=0,A=I.length;A>C;C++)for(E=I[C],Z=J[C],X=0,Y=E.length;Y>X;X++)z=i(E[X],Z[X],N),h(z.x,z.y,-G)}for(N=y,X=0;j>X;X++)z=_?i(O[X],Q[X],N):O[X],T?(f.copy(p.normals[0]).multiplyScalar(z.x),d.copy(p.binormals[0]).multiplyScalar(z.y),
m.copy(u[0]).add(f).add(d),h(m.x,m.y,m.z)):h(z.x,z.y,0);var $;for($=1;w>=$;$++)for(X=0;j>X;X++)z=_?i(O[X],Q[X],N):O[X],T?(f.copy(p.normals[$]).multiplyScalar(z.x),d.copy(p.binormals[$]).multiplyScalar(z.y),m.copy(u[$]).add(f).add(d),h(m.x,m.y,m.z)):h(z.x,z.y,g/w*$);for(F=x-1;F>=0;F--){for(U=F/x,G=v*(1-U),N=y*Math.sin(U*Math.PI/2),X=0,Y=k.length;Y>X;X++)z=i(k[X],W[X],N),h(z.x,z.y,g+G);for(C=0,A=I.length;A>C;C++)for(E=I[C],Z=J[C],X=0,Y=E.length;Y>X;X++)z=i(E[X],Z[X],N),T?h(z.x,z.y+u[w-1].y,u[w-1].x+G):h(z.x,z.y,g+G)}n(),s()},o.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,i,r){var n=t.vertices,s=n[e],a=n[i],h=n[r];return[new o.Vector2(s.x,s.y),new o.Vector2(a.x,a.y),new o.Vector2(h.x,h.y)]},generateSideWallUV:function(t,e,i,r,n){var s=t.vertices,a=s[e],h=s[i],l=s[r],c=s[n];return Math.abs(a.y-h.y)<.01?[new o.Vector2(a.x,1-a.z),new o.Vector2(h.x,1-h.z),new o.Vector2(l.x,1-l.z),new o.Vector2(c.x,1-c.z)]:[new o.Vector2(a.y,1-a.z),new o.Vector2(h.y,1-h.z),new o.Vector2(l.y,1-l.z),new o.Vector2(c.y,1-c.z)]}},o.ShapeGeometry=function(t,e){o.Geometry.call(this),this.type="ShapeGeometry",Array.isArray(t)===!1&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},o.ShapeGeometry.prototype=Object.create(o.Geometry.prototype),o.ShapeGeometry.prototype.constructor=o.ShapeGeometry,o.ShapeGeometry.prototype.addShapeList=function(t,e){for(var i=0,r=t.length;r>i;i++)this.addShape(t[i],e);return this},o.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var i,r,n,s=void 0!==e.curveSegments?e.curveSegments:12,a=e.material,h=void 0===e.UVGenerator?o.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,l=this.vertices.length,c=t.extractPoints(s),u=c.shape,p=c.holes,d=!o.ShapeUtils.isClockWise(u);if(d){for(u=u.reverse(),i=0,r=p.length;r>i;i++)n=p[i],o.ShapeUtils.isClockWise(n)&&(p[i]=n.reverse());d=!1}var f=o.ShapeUtils.triangulateShape(u,p);for(i=0,r=p.length;r>i;i++)n=p[i],u=u.concat(n);var m,g,v=u.length,y=f.length;for(i=0;v>i;i++)m=u[i],this.vertices.push(new o.Vector3(m.x,m.y,0));for(i=0;y>i;i++){g=f[i];var x=g[0]+l,_=g[1]+l,b=g[2]+l;this.faces.push(new o.Face3(x,_,b,null,null,a)),this.faceVertexUvs[0].push(h.generateTopUV(this,x,_,b))}},o.LatheBufferGeometry=function(t,e,i,r){o.BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},e=Math.floor(e)||12,i=i||0,r=r||2*Math.PI,r=o.Math.clamp(r,0,2*Math.PI);var n,s,a,h=(e+1)*t.length,l=e*t.length*2*3,c=new o.BufferAttribute(new(l>65535?Uint32Array:Uint16Array)(l),1),u=new o.BufferAttribute(new Float32Array(3*h),3),p=new o.BufferAttribute(new Float32Array(2*h),2),d=0,f=0,m=(1/(t.length-1),1/e),g=new o.Vector3,v=new o.Vector2;for(s=0;e>=s;s++){var y=i+s*m*r,x=Math.sin(y),_=Math.cos(y);for(a=0;a<=t.length-1;a++)g.x=t[a].x*x,g.y=t[a].y,g.z=t[a].x*_,u.setXYZ(d,g.x,g.y,g.z),v.x=s/e,v.y=a/(t.length-1),p.setXY(d,v.x,v.y),d++}for(s=0;e>s;s++)for(a=0;a<t.length-1;a++){n=a+s*t.length;var b=n,w=n+t.length,S=n+t.length+1,T=n+1;c.setX(f,b),f++,c.setX(f,w),f++,c.setX(f,T),f++,c.setX(f,w),f++,c.setX(f,S),f++,c.setX(f,T),f++}if(this.setIndex(c),this.addAttribute("position",u),this.addAttribute("uv",p),this.computeVertexNormals(),r===2*Math.PI){var M=this.attributes.normal.array,E=new o.Vector3,C=new o.Vector3,A=new o.Vector3;for(n=e*t.length*3,s=0,a=0;s<t.length;s++,a+=3)E.x=M[a+0],E.y=M[a+1],E.z=M[a+2],C.x=M[n+a+0],C.y=M[n+a+1],C.z=M[n+a+2],A.addVectors(E,C).normalize(),M[a+0]=M[n+a+0]=A.x,M[a+1]=M[n+a+1]=A.y,M[a+2]=M[n+a+2]=A.z}},o.LatheBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.LatheBufferGeometry.prototype.constructor=o.LatheBufferGeometry,o.LatheGeometry=function(t,e,i,r){o.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},this.fromBufferGeometry(new o.LatheBufferGeometry(t,e,i,r)),this.mergeVertices()},o.LatheGeometry.prototype=Object.create(o.Geometry.prototype),o.LatheGeometry.prototype.constructor=o.LatheGeometry,o.PlaneGeometry=function(t,e,i,r){o.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r},this.fromBufferGeometry(new o.PlaneBufferGeometry(t,e,i,r))},o.PlaneGeometry.prototype=Object.create(o.Geometry.prototype),o.PlaneGeometry.prototype.constructor=o.PlaneGeometry,o.PlaneBufferGeometry=function(t,e,i,r){o.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r};for(var n=t/2,s=e/2,a=Math.floor(i)||1,h=Math.floor(r)||1,l=a+1,c=h+1,u=t/a,p=e/h,d=new Float32Array(l*c*3),f=new Float32Array(l*c*3),m=new Float32Array(l*c*2),g=0,v=0,y=0;c>y;y++)for(var x=y*p-s,_=0;l>_;_++){var b=_*u-n;d[g]=b,d[g+1]=-x,f[g+2]=1,m[v]=_/a,m[v+1]=1-y/h,g+=3,v+=2}g=0;for(var w=new(d.length/3>65535?Uint32Array:Uint16Array)(a*h*6),y=0;h>y;y++)for(var _=0;a>_;_++){var S=_+l*y,T=_+l*(y+1),M=_+1+l*(y+1),E=_+1+l*y;w[g]=S,w[g+1]=T,w[g+2]=E,w[g+3]=T,w[g+4]=M,w[g+5]=E,g+=6}this.setIndex(new o.BufferAttribute(w,1)),this.addAttribute("position",new o.BufferAttribute(d,3)),this.addAttribute("normal",new o.BufferAttribute(f,3)),this.addAttribute("uv",new o.BufferAttribute(m,2))},o.PlaneBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.PlaneBufferGeometry.prototype.constructor=o.PlaneBufferGeometry,o.RingBufferGeometry=function(t,e,i,r,n,s){o.BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:s},t=t||20,e=e||50,n=void 0!==n?n:0,s=void 0!==s?s:2*Math.PI,i=void 0!==i?Math.max(3,i):8,r=void 0!==r?Math.max(1,r):1;var a,h,l,c=(i+1)*(r+1),u=i*r*2*3,p=new o.BufferAttribute(new(u>65535?Uint32Array:Uint16Array)(u),1),d=new o.BufferAttribute(new Float32Array(3*c),3),f=new o.BufferAttribute(new Float32Array(3*c),3),m=new o.BufferAttribute(new Float32Array(2*c),2),g=0,v=0,y=t,x=(e-t)/r,_=new o.Vector3,b=new o.Vector2;for(h=0;r>=h;h++){for(l=0;i>=l;l++)a=n+l/i*s,_.x=y*Math.cos(a),_.y=y*Math.sin(a),d.setXYZ(g,_.x,_.y,_.z),f.setXYZ(g,0,0,1),b.x=(_.x/e+1)/2,b.y=(_.y/e+1)/2,m.setXY(g,b.x,b.y),g++;y+=x}for(h=0;r>h;h++){var w=h*(i+1);for(l=0;i>l;l++){a=l+w;var S=a,T=a+i+1,M=a+i+2,E=a+1;p.setX(v,S),v++,p.setX(v,T),v++,p.setX(v,M),v++,p.setX(v,S),v++,p.setX(v,M),v++,p.setX(v,E),v++}}this.setIndex(p),this.addAttribute("position",d),this.addAttribute("normal",f),this.addAttribute("uv",m)},o.RingBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.RingBufferGeometry.prototype.constructor=o.RingBufferGeometry,o.RingGeometry=function(t,e,i,r,n,s){o.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:s},this.fromBufferGeometry(new o.RingBufferGeometry(t,e,i,r,n,s))},o.RingGeometry.prototype=Object.create(o.Geometry.prototype),o.RingGeometry.prototype.constructor=o.RingGeometry,o.SphereGeometry=function(t,e,i,r,n,s,a){o.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new o.SphereBufferGeometry(t,e,i,r,n,s,a))},o.SphereGeometry.prototype=Object.create(o.Geometry.prototype),o.SphereGeometry.prototype.constructor=o.SphereGeometry,o.SphereBufferGeometry=function(t,e,i,r,n,s,a){o.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:s,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI,s=void 0!==s?s:0,a=void 0!==a?a:Math.PI;for(var h=s+a,l=(e+1)*(i+1),c=new o.BufferAttribute(new Float32Array(3*l),3),u=new o.BufferAttribute(new Float32Array(3*l),3),p=new o.BufferAttribute(new Float32Array(2*l),2),d=0,f=[],m=new o.Vector3,g=0;i>=g;g++){for(var v=[],y=g/i,x=0;e>=x;x++){var _=x/e,b=-t*Math.cos(r+_*n)*Math.sin(s+y*a),w=t*Math.cos(s+y*a),S=t*Math.sin(r+_*n)*Math.sin(s+y*a);m.set(b,w,S).normalize(),c.setXYZ(d,b,w,S),u.setXYZ(d,m.x,m.y,m.z),p.setXY(d,_,1-y),v.push(d),d++}f.push(v)}for(var T=[],g=0;i>g;g++)for(var x=0;e>x;x++){var M=f[g][x+1],E=f[g][x],C=f[g+1][x],A=f[g+1][x+1];(0!==g||s>0)&&T.push(M,E,A),(g!==i-1||h<Math.PI)&&T.push(E,C,A)}this.setIndex(new(c.count>65535?o.Uint32Attribute:o.Uint16Attribute)(T,1)),this.addAttribute("position",c),this.addAttribute("normal",u),this.addAttribute("uv",p),this.boundingSphere=new o.Sphere(new o.Vector3,t)},o.SphereBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.SphereBufferGeometry.prototype.constructor=o.SphereBufferGeometry,o.TextGeometry=function(t,e){e=e||{};var i=e.font;if(i instanceof o.Font==!1)return new o.Geometry;var r=i.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),o.ExtrudeGeometry.call(this,r,e),this.type="TextGeometry"},o.TextGeometry.prototype=Object.create(o.ExtrudeGeometry.prototype),o.TextGeometry.prototype.constructor=o.TextGeometry,o.TorusBufferGeometry=function(t,e,i,r,n){o.BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,arc:n},t=t||100,e=e||40,i=Math.floor(i)||8,r=Math.floor(r)||6,n=n||2*Math.PI;var s,a,h=(i+1)*(r+1),l=i*r*2*3,c=new(l>65535?Uint32Array:Uint16Array)(l),u=new Float32Array(3*h),p=new Float32Array(3*h),d=new Float32Array(2*h),f=0,m=0,g=0,v=new o.Vector3,y=new o.Vector3,x=new o.Vector3;for(s=0;i>=s;s++)for(a=0;r>=a;a++){var _=a/r*n,b=s/i*Math.PI*2;y.x=(t+e*Math.cos(b))*Math.cos(_),y.y=(t+e*Math.cos(b))*Math.sin(_),y.z=e*Math.sin(b),u[f]=y.x,u[f+1]=y.y,u[f+2]=y.z,v.x=t*Math.cos(_),v.y=t*Math.sin(_),x.subVectors(y,v).normalize(),p[f]=x.x,p[f+1]=x.y,p[f+2]=x.z,d[m]=a/r,d[m+1]=s/i,f+=3,m+=2}for(s=1;i>=s;s++)for(a=1;r>=a;a++){var w=(r+1)*s+a-1,S=(r+1)*(s-1)+a-1,T=(r+1)*(s-1)+a,M=(r+1)*s+a;c[g]=w,c[g+1]=S,c[g+2]=M,c[g+3]=S,c[g+4]=T,c[g+5]=M,g+=6}this.setIndex(new o.BufferAttribute(c,1)),this.addAttribute("position",new o.BufferAttribute(u,3)),this.addAttribute("normal",new o.BufferAttribute(p,3)),this.addAttribute("uv",new o.BufferAttribute(d,2))},o.TorusBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.TorusBufferGeometry.prototype.constructor=o.TorusBufferGeometry,o.TorusGeometry=function(t,e,i,r,n){o.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,arc:n},this.fromBufferGeometry(new o.TorusBufferGeometry(t,e,i,r,n))},o.TorusGeometry.prototype=Object.create(o.Geometry.prototype),o.TorusGeometry.prototype.constructor=o.TorusGeometry,o.TorusKnotBufferGeometry=function(t,e,i,r,n,s){function a(t,e,i,r,n){var o=Math.cos(t),s=Math.sin(t),a=i/e*t,h=Math.cos(a);n.x=r*(2+h)*.5*o,n.y=r*(2+h)*s*.5,n.z=r*Math.sin(a)*.5}o.BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:n,q:s},t=t||100,e=e||40,i=Math.floor(i)||64,r=Math.floor(r)||8,n=n||2,s=s||3;var h,l,c=(r+1)*(i+1),u=r*i*2*3,p=new o.BufferAttribute(new(u>65535?Uint32Array:Uint16Array)(u),1),d=new o.BufferAttribute(new Float32Array(3*c),3),f=new o.BufferAttribute(new Float32Array(3*c),3),m=new o.BufferAttribute(new Float32Array(2*c),2),g=0,v=0,y=new o.Vector3,x=new o.Vector3,_=new o.Vector2,b=new o.Vector3,w=new o.Vector3,S=new o.Vector3,T=new o.Vector3,M=new o.Vector3;for(h=0;i>=h;++h){var E=h/i*n*Math.PI*2;for(a(E,n,s,t,b),a(E+.01,n,s,t,w),T.subVectors(w,b),M.addVectors(w,b),S.crossVectors(T,M),M.crossVectors(S,T),S.normalize(),M.normalize(),l=0;r>=l;++l){var C=l/r*Math.PI*2,A=-e*Math.cos(C),L=e*Math.sin(C);y.x=b.x+(A*M.x+L*S.x),y.y=b.y+(A*M.y+L*S.y),y.z=b.z+(A*M.z+L*S.z),d.setXYZ(g,y.x,y.y,y.z),x.subVectors(y,b).normalize(),f.setXYZ(g,x.x,x.y,x.z),_.x=h/i,_.y=l/r,m.setXY(g,_.x,_.y),g++}}for(l=1;i>=l;l++)for(h=1;r>=h;h++){var P=(r+1)*(l-1)+(h-1),R=(r+1)*l+(h-1),O=(r+1)*l+h,I=(r+1)*(l-1)+h;p.setX(v,P),v++,p.setX(v,R),v++,p.setX(v,I),v++,p.setX(v,R),v++,p.setX(v,O),v++,p.setX(v,I),v++}this.setIndex(p),this.addAttribute("position",d),this.addAttribute("normal",f),this.addAttribute("uv",m)},o.TorusKnotBufferGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.TorusKnotBufferGeometry.prototype.constructor=o.TorusKnotBufferGeometry,o.TorusKnotGeometry=function(t,e,i,r,n,s,a){o.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:n,q:s},this.fromBufferGeometry(new o.TorusKnotBufferGeometry(t,e,i,r,n,s)),this.mergeVertices()},o.TorusKnotGeometry.prototype=Object.create(o.Geometry.prototype),o.TorusKnotGeometry.prototype.constructor=o.TorusKnotGeometry,o.TubeGeometry=function(t,e,i,r,n,s){function a(t,e,i){return P.vertices.push(new o.Vector3(t,e,i))-1}o.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:i,radialSegments:r,closed:n,taper:s},e=e||64,i=i||1,r=r||8,n=n||!1,s=s||o.TubeGeometry.NoTaper;var h,l,c,u,p,d,f,m,g,v,y,x,_,b,w,S,T,M,E,C,A,L=[],P=this,R=e+1,O=new o.Vector3,I=new o.TubeGeometry.FrenetFrames(t,e,n),D=I.tangents,B=I.normals,k=I.binormals;for(this.tangents=D,this.normals=B,this.binormals=k,v=0;R>v;v++)for(L[v]=[],u=v/(R-1),g=t.getPointAt(u),h=D[v],l=B[v],c=k[v],d=i*s(u),y=0;r>y;y++)p=y/r*2*Math.PI,f=-d*Math.cos(p),m=d*Math.sin(p),O.copy(g),O.x+=f*l.x+m*c.x,O.y+=f*l.y+m*c.y,O.z+=f*l.z+m*c.z,L[v][y]=a(O.x,O.y,O.z);for(v=0;e>v;v++)for(y=0;r>y;y++)x=n?(v+1)%e:v+1,_=(y+1)%r,b=L[v][y],w=L[x][y],S=L[x][_],T=L[v][_],M=new o.Vector2(v/e,y/r),E=new o.Vector2((v+1)/e,y/r),C=new o.Vector2((v+1)/e,(y+1)/r),A=new o.Vector2(v/e,(y+1)/r),this.faces.push(new o.Face3(b,w,T)),this.faceVertexUvs[0].push([M,E,A]),this.faces.push(new o.Face3(w,S,T)),this.faceVertexUvs[0].push([E.clone(),C,A.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},o.TubeGeometry.prototype=Object.create(o.Geometry.prototype),o.TubeGeometry.prototype.constructor=o.TubeGeometry,o.TubeGeometry.NoTaper=function(t){return 1},o.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},o.TubeGeometry.FrenetFrames=function(t,e,i){function r(){f[0]=new o.Vector3,m[0]=new o.Vector3,s=Number.MAX_VALUE,a=Math.abs(d[0].x),h=Math.abs(d[0].y),l=Math.abs(d[0].z),s>=a&&(s=a,p.set(1,0,0)),s>=h&&(s=h,p.set(0,1,0)),s>=l&&p.set(0,0,1),g.crossVectors(d[0],p).normalize(),f[0].crossVectors(d[0],g),m[0].crossVectors(d[0],f[0])}var n,s,a,h,l,c,u,p=new o.Vector3,d=[],f=[],m=[],g=new o.Vector3,v=new o.Matrix4,y=e+1;for(this.tangents=d,this.normals=f,this.binormals=m,c=0;y>c;c++)u=c/(y-1),d[c]=t.getTangentAt(u),d[c].normalize();for(r(),c=1;y>c;c++)f[c]=f[c-1].clone(),m[c]=m[c-1].clone(),g.crossVectors(d[c-1],d[c]),g.length()>Number.EPSILON&&(g.normalize(),n=Math.acos(o.Math.clamp(d[c-1].dot(d[c]),-1,1)),f[c].applyMatrix4(v.makeRotationAxis(g,n))),m[c].crossVectors(d[c],f[c]);if(i)for(n=Math.acos(o.Math.clamp(f[0].dot(f[y-1]),-1,1)),n/=y-1,d[0].dot(g.crossVectors(f[0],f[y-1]))>0&&(n=-n),c=1;y>c;c++)f[c].applyMatrix4(v.makeRotationAxis(d[c],n*c)),m[c].crossVectors(d[c],f[c])},o.PolyhedronGeometry=function(t,e,i,r){function n(t){var e=t.normalize().clone();e.index=u.vertices.push(e)-1;var i=h(t)/2/Math.PI+.5,r=l(t)/Math.PI+.5;return e.uv=new o.Vector2(i,1-r),e}function s(t,e,i,r){var n=new o.Face3(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()],void 0,r);u.faces.push(n),_.copy(t).add(e).add(i).divideScalar(3);var s=h(_);u.faceVertexUvs[0].push([c(t.uv,t,s),c(e.uv,e,s),c(i.uv,i,s)])}function a(t,e){for(var i=Math.pow(2,e),r=n(u.vertices[t.a]),o=n(u.vertices[t.b]),a=n(u.vertices[t.c]),h=[],l=t.materialIndex,c=0;i>=c;c++){h[c]=[];for(var p=n(r.clone().lerp(a,c/i)),d=n(o.clone().lerp(a,c/i)),f=i-c,m=0;f>=m;m++)0===m&&c===i?h[c][m]=p:h[c][m]=n(p.clone().lerp(d,m/f))}for(var c=0;i>c;c++)for(var m=0;2*(i-c)-1>m;m++){var g=Math.floor(m/2);m%2===0?s(h[c][g+1],h[c+1][g],h[c][g],l):s(h[c][g+1],h[c+1][g+1],h[c+1][g],l)}}function h(t){return Math.atan2(t.z,-t.x)}function l(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}function c(t,e,i){return 0>i&&1===t.x&&(t=new o.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new o.Vector2(i/2/Math.PI+.5,t.y)),t.clone()}o.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r},i=i||1,r=r||0;for(var u=this,p=0,d=t.length;d>p;p+=3)n(new o.Vector3(t[p],t[p+1],t[p+2]));for(var f=this.vertices,m=[],p=0,g=0,d=e.length;d>p;p+=3,g++){var v=f[e[p]],y=f[e[p+1]],x=f[e[p+2]];m[g]=new o.Face3(v.index,y.index,x.index,[v.clone(),y.clone(),x.clone()],void 0,g)}for(var _=new o.Vector3,p=0,d=m.length;d>p;p++)a(m[p],r);for(var p=0,d=this.faceVertexUvs[0].length;d>p;p++){var b=this.faceVertexUvs[0][p],w=b[0].x,S=b[1].x,T=b[2].x,M=Math.max(w,S,T),E=Math.min(w,S,T);M>.9&&.1>E&&(.2>w&&(b[0].x+=1),.2>S&&(b[1].x+=1),.2>T&&(b[2].x+=1))}for(var p=0,d=this.vertices.length;d>p;p++)this.vertices[p].multiplyScalar(i);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new o.Sphere(new o.Vector3,i)},o.PolyhedronGeometry.prototype=Object.create(o.Geometry.prototype),o.PolyhedronGeometry.prototype.constructor=o.PolyhedronGeometry,o.DodecahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2,r=1/i,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];o.PolyhedronGeometry.call(this,n,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}},o.DodecahedronGeometry.prototype=Object.create(o.PolyhedronGeometry.prototype),o.DodecahedronGeometry.prototype.constructor=o.DodecahedronGeometry,o.IcosahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];o.PolyhedronGeometry.call(this,r,n,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},o.IcosahedronGeometry.prototype=Object.create(o.PolyhedronGeometry.prototype),o.IcosahedronGeometry.prototype.constructor=o.IcosahedronGeometry,o.OctahedronGeometry=function(t,e){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];o.PolyhedronGeometry.call(this,i,r,t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},o.OctahedronGeometry.prototype=Object.create(o.PolyhedronGeometry.prototype),o.OctahedronGeometry.prototype.constructor=o.OctahedronGeometry,o.TetrahedronGeometry=function(t,e){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];o.PolyhedronGeometry.call(this,i,r,t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},o.TetrahedronGeometry.prototype=Object.create(o.PolyhedronGeometry.prototype),o.TetrahedronGeometry.prototype.constructor=o.TetrahedronGeometry,o.ParametricGeometry=function(t,e,i){o.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i};var r,n,s,a,h,l=this.vertices,c=this.faces,u=this.faceVertexUvs[0],p=e+1;for(r=0;i>=r;r++)for(h=r/i,n=0;e>=n;n++)a=n/e,s=t(a,h),l.push(s);var d,f,m,g,v,y,x,_;for(r=0;i>r;r++)for(n=0;e>n;n++)d=r*p+n,f=r*p+n+1,m=(r+1)*p+n+1,g=(r+1)*p+n,v=new o.Vector2(n/e,r/i),y=new o.Vector2((n+1)/e,r/i),x=new o.Vector2((n+1)/e,(r+1)/i),_=new o.Vector2(n/e,(r+1)/i),c.push(new o.Face3(d,f,g)),u.push([v,y,_]),c.push(new o.Face3(f,m,g)),u.push([y.clone(),x,_.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},o.ParametricGeometry.prototype=Object.create(o.Geometry.prototype),o.ParametricGeometry.prototype.constructor=o.ParametricGeometry,o.WireframeGeometry=function(t){function e(t,e){return t-e}o.BufferGeometry.call(this);var i=[0,0],r={},n=["a","b","c"];if(t instanceof o.Geometry){for(var s=t.vertices,a=t.faces,h=0,l=new Uint32Array(6*a.length),c=0,u=a.length;u>c;c++)for(var p=a[c],d=0;3>d;d++){i[0]=p[n[d]],i[1]=p[n[(d+1)%3]],i.sort(e);var f=i.toString();void 0===r[f]&&(l[2*h]=i[0],l[2*h+1]=i[1],r[f]=!0,h++)}for(var m=new Float32Array(2*h*3),c=0,u=h;u>c;c++)for(var d=0;2>d;d++){var g=s[l[2*c+d]],v=6*c+3*d;m[v+0]=g.x,m[v+1]=g.y,m[v+2]=g.z}this.addAttribute("position",new o.BufferAttribute(m,3))}else if(t instanceof o.BufferGeometry)if(null!==t.index){var y=t.index.array,s=t.attributes.position,x=t.groups,h=0;0===x.length&&t.addGroup(0,y.length);for(var l=new Uint32Array(2*y.length),_=0,b=x.length;b>_;++_)for(var w=x[_],S=w.start,T=w.count,c=S,M=S+T;M>c;c+=3)for(var d=0;3>d;d++){i[0]=y[c+d],i[1]=y[c+(d+1)%3],i.sort(e);var f=i.toString();void 0===r[f]&&(l[2*h]=i[0],l[2*h+1]=i[1],r[f]=!0,h++)}for(var m=new Float32Array(2*h*3),c=0,u=h;u>c;c++)for(var d=0;2>d;d++){var v=6*c+3*d,E=l[2*c+d];m[v+0]=s.getX(E),m[v+1]=s.getY(E),m[v+2]=s.getZ(E)}this.addAttribute("position",new o.BufferAttribute(m,3))}else{for(var s=t.attributes.position.array,h=s.length/3,C=h/3,m=new Float32Array(2*h*3),c=0,u=C;u>c;c++)for(var d=0;3>d;d++){var v=18*c+6*d,A=9*c+3*d;m[v+0]=s[A],m[v+1]=s[A+1],m[v+2]=s[A+2];var E=9*c+3*((d+1)%3);m[v+3]=s[E],m[v+4]=s[E+1],m[v+5]=s[E+2]}this.addAttribute("position",new o.BufferAttribute(m,3))}},o.WireframeGeometry.prototype=Object.create(o.BufferGeometry.prototype),o.WireframeGeometry.prototype.constructor=o.WireframeGeometry,o.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),r=new o.BufferGeometry;r.addAttribute("position",new o.BufferAttribute(e,3)),r.addAttribute("color",new o.BufferAttribute(i,3));var n=new o.LineBasicMaterial({vertexColors:o.VertexColors});o.LineSegments.call(this,r,n)},o.AxisHelper.prototype=Object.create(o.LineSegments.prototype),o.AxisHelper.prototype.constructor=o.AxisHelper,o.ArrowHelper=function(){var t=new o.Geometry;t.vertices.push(new o.Vector3(0,0,0),new o.Vector3(0,1,0));var e=new o.CylinderGeometry(0,.5,1,5,1);return e.translate(0,-.5,0),function(i,r,n,s,a,h){o.Object3D.call(this),void 0===s&&(s=16776960),void 0===n&&(n=1),void 0===a&&(a=.2*n),void 0===h&&(h=.2*a),this.position.copy(r),this.line=new o.Line(t,new o.LineBasicMaterial({color:s})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new o.Mesh(e,new o.MeshBasicMaterial({color:s})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(i),this.setLength(n,a,h)}}(),o.ArrowHelper.prototype=Object.create(o.Object3D.prototype),o.ArrowHelper.prototype.constructor=o.ArrowHelper,o.ArrowHelper.prototype.setDirection=function(){var t,e=new o.Vector3;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),o.ArrowHelper.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},o.ArrowHelper.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},o.BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new o.BufferGeometry;r.setIndex(new o.BufferAttribute(e,1)),r.addAttribute("position",new o.BufferAttribute(i,3)),o.LineSegments.call(this,r,new o.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t)},o.BoxHelper.prototype=Object.create(o.LineSegments.prototype),o.BoxHelper.prototype.constructor=o.BoxHelper,o.BoxHelper.prototype.update=function(){var t=new o.Box3;return function(e){if(t.setFromObject(e),!t.isEmpty()){var i=t.min,r=t.max,n=this.geometry.attributes.position,o=n.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=i.x,o[4]=r.y,o[5]=r.z,o[6]=i.x,o[7]=i.y,o[8]=r.z,o[9]=r.x,o[10]=i.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=i.z,o[15]=i.x,o[16]=r.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=r.x,o[22]=i.y,o[23]=i.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),o.BoundingBoxHelper=function(t,e){var i=void 0!==e?e:8947848;this.object=t,this.box=new o.Box3,o.Mesh.call(this,new o.BoxGeometry(1,1,1),new o.MeshBasicMaterial({color:i,wireframe:!0}))},o.BoundingBoxHelper.prototype=Object.create(o.Mesh.prototype),o.BoundingBoxHelper.prototype.constructor=o.BoundingBoxHelper,o.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},o.CameraHelper=function(t){function e(t,e,r){i(t,r),i(e,r)}function i(t,e){r.vertices.push(new o.Vector3),r.colors.push(new o.Color(e)),void 0===s[t]&&(s[t]=[]),s[t].push(r.vertices.length-1)}var r=new o.Geometry,n=new o.LineBasicMaterial({color:16777215,vertexColors:o.FaceColors}),s={},a=16755200,h=16711680,l=43775,c=16777215,u=3355443;e("n1","n2",a),e("n2","n4",a),e("n4","n3",a),e("n3","n1",a),e("f1","f2",a),e("f2","f4",a),e("f4","f3",a),e("f3","f1",a),e("n1","f1",a),e("n2","f2",a),e("n3","f3",a),e("n4","f4",a),e("p","n1",h),e("p","n2",h),e("p","n3",h),e("p","n4",h),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",c),e("p","c",u),e("cn1","cn2",u),e("cn3","cn4",u),e("cf1","cf2",u),e("cf3","cf4",u),o.LineSegments.call(this,r,n),this.camera=t,this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()},o.CameraHelper.prototype=Object.create(o.LineSegments.prototype),o.CameraHelper.prototype.constructor=o.CameraHelper,o.CameraHelper.prototype.update=function(){function t(t,o,s,a){r.set(o,s,a).unproject(n);var h=i[t];if(void 0!==h)for(var l=0,c=h.length;c>l;l++)e.vertices[h[l]].copy(r)}var e,i,r=new o.Vector3,n=new o.Camera;return function(){e=this.geometry,i=this.pointMap;var r=1,o=1;n.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-r,-o,-1),t("n2",r,-o,-1),t("n3",-r,o,-1),t("n4",r,o,-1),t("f1",-r,-o,1),t("f2",r,-o,1),t("f3",-r,o,1),t("f4",r,o,1),t("u1",.7*r,1.1*o,-1),t("u2",.7*-r,1.1*o,-1),t("u3",0,2*o,-1),t("cf1",-r,0,1),t("cf2",r,0,1),t("cf3",0,-o,1),t("cf4",0,o,1),t("cn1",-r,0,-1),t("cn2",r,0,-1),t("cn3",0,-o,-1),t("cn4",0,o,-1),e.verticesNeedUpdate=!0}}(),o.DirectionalLightHelper=function(t,e){o.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var i=new o.Geometry;i.vertices.push(new o.Vector3(-e,e,0),new o.Vector3(e,e,0),new o.Vector3(e,-e,0),new o.Vector3(-e,-e,0),new o.Vector3(-e,e,0));var r=new o.LineBasicMaterial({fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new o.Line(i,r),this.add(this.lightPlane),i=new o.Geometry,i.vertices.push(new o.Vector3,new o.Vector3),r=new o.LineBasicMaterial({fog:!1}),r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new o.Line(i,r),this.add(this.targetLine),this.update()},o.DirectionalLightHelper.prototype=Object.create(o.Object3D.prototype),o.DirectionalLightHelper.prototype.constructor=o.DirectionalLightHelper,o.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},o.DirectionalLightHelper.prototype.update=function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t),this.lightPlane.lookAt(i),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(i),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),o.EdgesHelper=function(t,e,i){var r=void 0!==e?e:16777215;o.LineSegments.call(this,new o.EdgesGeometry(t.geometry,i),new o.LineBasicMaterial({color:r})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},o.EdgesHelper.prototype=Object.create(o.LineSegments.prototype),o.EdgesHelper.prototype.constructor=o.EdgesHelper,o.FaceNormalsHelper=function(t,e,i,r){this.object=t,this.size=void 0!==e?e:1;var n=void 0!==i?i:16776960,s=void 0!==r?r:1,a=0,h=this.object.geometry;h instanceof o.Geometry&&(a=h.faces.length);var l=new o.BufferGeometry,c=new o.Float32Attribute(2*a*3,3);l.addAttribute("position",c),o.LineSegments.call(this,l,new o.LineBasicMaterial({color:n,linewidth:s})),this.matrixAutoUpdate=!1,this.update()},o.FaceNormalsHelper.prototype=Object.create(o.LineSegments.prototype),o.FaceNormalsHelper.prototype.constructor=o.FaceNormalsHelper,o.FaceNormalsHelper.prototype.update=function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Matrix3;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,n=this.geometry.attributes.position,o=this.object.geometry,s=o.vertices,a=o.faces,h=0,l=0,c=a.length;c>l;l++){var u=a[l],p=u.normal;t.copy(s[u.a]).add(s[u.b]).add(s[u.c]).divideScalar(3).applyMatrix4(r),e.copy(p).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),n.setXYZ(h,t.x,t.y,t.z),h+=1,n.setXYZ(h,e.x,e.y,e.z),h+=1}return n.needsUpdate=!0,this}}(),o.GridHelper=function(t,e){var i=new o.Geometry,r=new o.LineBasicMaterial({vertexColors:o.VertexColors});this.color1=new o.Color(4473924),this.color2=new o.Color(8947848);for(var n=-t;t>=n;n+=e){i.vertices.push(new o.Vector3(-t,0,n),new o.Vector3(t,0,n),new o.Vector3(n,0,-t),new o.Vector3(n,0,t));var s=0===n?this.color1:this.color2;i.colors.push(s,s,s,s)}o.LineSegments.call(this,i,r)},o.GridHelper.prototype=Object.create(o.LineSegments.prototype),o.GridHelper.prototype.constructor=o.GridHelper,o.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},o.HemisphereLightHelper=function(t,e){o.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new o.Color,new o.Color];var i=new o.SphereGeometry(e,4,2);i.rotateX(-Math.PI/2);for(var r=0,n=8;n>r;r++)i.faces[r].color=this.colors[4>r?0:1];var s=new o.MeshBasicMaterial({vertexColors:o.FaceColors,wireframe:!0});this.lightSphere=new o.Mesh(i,s),this.add(this.lightSphere),this.update()},o.HemisphereLightHelper.prototype=Object.create(o.Object3D.prototype),o.HemisphereLightHelper.prototype.constructor=o.HemisphereLightHelper,o.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},o.HemisphereLightHelper.prototype.update=function(){var t=new o.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),o.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var i=new o.SphereGeometry(e,4,2),r=new o.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),o.Mesh.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},o.PointLightHelper.prototype=Object.create(o.Mesh.prototype),o.PointLightHelper.prototype.constructor=o.PointLightHelper,o.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},o.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},o.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new o.Geometry,i=0;i<this.bones.length;i++){var r=this.bones[i];r.parent instanceof o.Bone&&(e.vertices.push(new o.Vector3),
e.vertices.push(new o.Vector3),e.colors.push(new o.Color(0,0,1)),e.colors.push(new o.Color(0,1,0)))}e.dynamic=!0;var n=new o.LineBasicMaterial({vertexColors:o.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});o.LineSegments.call(this,e,n),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},o.SkeletonHelper.prototype=Object.create(o.LineSegments.prototype),o.SkeletonHelper.prototype.constructor=o.SkeletonHelper,o.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof o.Bone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},o.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new o.Matrix4).getInverse(this.root.matrixWorld),i=new o.Matrix4,r=0,n=0;n<this.bones.length;n++){var s=this.bones[n];s.parent instanceof o.Bone&&(i.multiplyMatrices(e,s.matrixWorld),t.vertices[r].setFromMatrixPosition(i),i.multiplyMatrices(e,s.parent.matrixWorld),t.vertices[r+1].setFromMatrixPosition(i),r+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},o.SpotLightHelper=function(t){o.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var e=new o.CylinderGeometry(0,1,1,8,1,!0);e.translate(0,-.5,0),e.rotateX(-Math.PI/2);var i=new o.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new o.Mesh(e,i),this.add(this.cone),this.update()},o.SpotLightHelper.prototype=Object.create(o.Object3D.prototype),o.SpotLightHelper.prototype.constructor=o.SpotLightHelper,o.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},o.SpotLightHelper.prototype.update=function(){var t=new o.Vector3,e=new o.Vector3;return function(){var i=this.light.distance?this.light.distance:1e4,r=i*Math.tan(this.light.angle);this.cone.scale.set(r,r,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),o.VertexNormalsHelper=function(t,e,i,r){this.object=t,this.size=void 0!==e?e:1;var n=void 0!==i?i:16711680,s=void 0!==r?r:1,a=0,h=this.object.geometry;h instanceof o.Geometry?a=3*h.faces.length:h instanceof o.BufferGeometry&&(a=h.attributes.normal.count);var l=new o.BufferGeometry,c=new o.Float32Attribute(2*a*3,3);l.addAttribute("position",c),o.LineSegments.call(this,l,new o.LineBasicMaterial({color:n,linewidth:s})),this.matrixAutoUpdate=!1,this.update()},o.VertexNormalsHelper.prototype=Object.create(o.LineSegments.prototype),o.VertexNormalsHelper.prototype.constructor=o.VertexNormalsHelper,o.VertexNormalsHelper.prototype.update=function(){var t=new o.Vector3,e=new o.Vector3,i=new o.Matrix3;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var n=this.object.matrixWorld,s=this.geometry.attributes.position,a=this.object.geometry;if(a instanceof o.Geometry)for(var h=a.vertices,l=a.faces,c=0,u=0,p=l.length;p>u;u++)for(var d=l[u],f=0,m=d.vertexNormals.length;m>f;f++){var g=h[d[r[f]]],v=d.vertexNormals[f];t.copy(g).applyMatrix4(n),e.copy(v).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),s.setXYZ(c,t.x,t.y,t.z),c+=1,s.setXYZ(c,e.x,e.y,e.z),c+=1}else if(a instanceof o.BufferGeometry)for(var y=a.attributes.position,x=a.attributes.normal,c=0,f=0,m=y.count;m>f;f++)t.set(y.getX(f),y.getY(f),y.getZ(f)).applyMatrix4(n),e.set(x.getX(f),x.getY(f),x.getZ(f)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),s.setXYZ(c,t.x,t.y,t.z),c+=1,s.setXYZ(c,e.x,e.y,e.z),c+=1;return s.needsUpdate=!0,this}}(),o.WireframeHelper=function(t,e){var i=void 0!==e?e:16777215;o.LineSegments.call(this,new o.WireframeGeometry(t.geometry),new o.LineBasicMaterial({color:i})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},o.WireframeHelper.prototype=Object.create(o.LineSegments.prototype),o.WireframeHelper.prototype.constructor=o.WireframeHelper,o.ImmediateRenderObject=function(t){o.Object3D.call(this),this.material=t,this.render=function(t){}},o.ImmediateRenderObject.prototype=Object.create(o.Object3D.prototype),o.ImmediateRenderObject.prototype.constructor=o.ImmediateRenderObject,o.MorphBlendMesh=function(t,e){o.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,r="__default",n=0,s=i-1,a=i/1;this.createAnimation(r,n,s,a),this.setAnimationWeight(r,1)},o.MorphBlendMesh.prototype=Object.create(o.Mesh.prototype),o.MorphBlendMesh.prototype.constructor=o.MorphBlendMesh,o.MorphBlendMesh.prototype.createAnimation=function(t,e,i,r){var n={start:e,end:i,length:i-e+1,fps:r,duration:(i-e)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=n,this.animationsList.push(n)},o.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\d+)/i,r={},n=this.geometry,o=0,s=n.morphTargets.length;s>o;o++){var a=n.morphTargets[o],h=a.name.match(i);if(h&&h.length>1){var l=h[1];r[l]||(r[l]={start:1/0,end:-(1/0)});var c=r[l];o<c.start&&(c.start=o),o>c.end&&(c.end=o),e||(e=l)}}for(var l in r){var c=r[l];this.createAnimation(l,c.start,c.end,t)}this.firstAnimation=e},o.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},o.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},o.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},o.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},o.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},o.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},o.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},o.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},o.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e&&(e.time=0,e.active=!0)},o.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},o.MorphBlendMesh.prototype.update=function(t){for(var e=0,i=this.animationsList.length;i>e;e++){var r=this.animationsList[e];if(r.active){var n=r.duration/r.length;r.time+=r.direction*t,r.mirroredLoop?(r.time>r.duration||r.time<0)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),r.time<0&&(r.time=0,r.directionBackwards=!1)):(r.time=r.time%r.duration,r.time<0&&(r.time+=r.duration));var s=r.start+o.Math.clamp(Math.floor(r.time/n),0,r.length-1),a=r.weight;s!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*a,this.morphTargetInfluences[s]=0,r.lastFrame=r.currentFrame,r.currentFrame=s);var h=r.time%n/n;r.directionBackwards&&(h=1-h),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=h*a,this.morphTargetInfluences[r.lastFrame]=(1-h)*a):this.morphTargetInfluences[r.currentFrame]=a}}}},function(t,e,i){var r;r=function(t,e,r){var n=i(7);window.PIXI=n;var o=i(12),s=(i(20),i(21)),a=i(29),h=i(31),l=i(32),c=i(33),u=i(36),p=i(51),d=i(66),f=i(69),m=i(73),g=i(74),v=i(83),y=i(84),x=i(167),_=i(168),b=(i(46),i(169)),w=i(15),S=i(170),T=i(171),M=i(47),E=(i(63),i(34));n.glCore.VertexArrayObject.FORCE_NATIVE=!0;var C=function(){var t={config:ASSET_URL+"json/config.json",loaderScreen:l,backgroundColor:0};o.call(this,t),this.screenManager.defaultTransition=new b,this.safeSize={width:1136,height:640},this.maxSize={width:1136,height:745},this.preloader.addPixiAssets([ASSET_URL+"img/ui/menu-background.jpg",ASSET_URL+"img/loader/loader-bar.png",ASSET_URL+"img/loader/loader-fill.png"]),this.loader.addPixiAssets([ASSET_URL+"img/ring.png",ASSET_URL+"img/game/main_info_panel.png",ASSET_URL+"img/game/panelDivider.png",ASSET_URL+"img/game/toon_pitch_full.jpg",ASSET_URL+"img/game/leaderboard.json",ASSET_URL+"img/ui/title.json",ASSET_URL+"img/game/game.json",ASSET_URL+"img/game/referee.json",ASSET_URL+"img/game/shoot_arrow.png",ASSET_URL+"img/game/runnoff.png",ASSET_URL+"img/sponsor/board1.png",ASSET_URL+"img/sponsor/board2.png",ASSET_URL+"img/sponsor/pitch-logo.png",ASSET_URL+"img/game/front_crowd.png",ASSET_URL+"img/game/shield_bubble.png",ASSET_URL+"img/game/overlays.json",ASSET_URL+"img/game/shop.json",ASSET_URL+"img/game/game_objects/ball-shadow.png",ASSET_URL+"img/ui/buttons.json",ASSET_URL+"img/ui/panels.json",ASSET_URL+"img/ui/menu-background.jpg",ASSET_URL+"img/ui/country-select-panel.png",ASSET_URL+"img/ui/panel-player-select-and-tournament.png",ASSET_URL+"img/ui/diagram.png",ASSET_URL+"img/ui/vs-panel.png",ASSET_URL+"img/ui/panel-various-paused-bg.png",ASSET_URL+"img/ui/overlay-background.png",ASSET_URL+"img/ui/instructions-panel.png",ASSET_URL+"img/ui/panel-final-score-background.png"]),this.loader.addCSS(ASSET_URL+"css/fonts.css"),this.loader.addJson(ASSET_URL+"json/shopData.json","shopData"),this.loader.addJson(ASSET_URL+"json/character-animation.json","character-animation"),this.loader.addCSS(ASSET_URL+"css/fonts.css"),this.loader.addFonts(["lubalin","fredburger"]);for(var e=[],i=0;40>i;i++){var r=i;10>r&&(r="0"+r),e[i]=ASSET_URL+"img/game/shield/shield_"+r+".png"}this.loader.addPixiAssets(e),this.loadSounds();var n={};for(var i in M){var s=M[i].spriteSheet;spriteSheetBlue=s.replace("%COLOR%","blue"),spriteSheetRed=s.replace("%COLOR%","red"),n[spriteSheetBlue]||(n[spriteSheetBlue]=!0,this.loader.addPixiAssets([ASSET_URL+"img/game/characters/"+spriteSheetRed,ASSET_URL+"img/game/characters/"+spriteSheetBlue]))}this.onReady.add(this.onAppReady,this),this.startup()};C.prototype=Object.create(o.prototype),C.prototype.onPreload=function(){var t=w.getJson("config").config.LOCALE,e=-1!==["_ru"].indexOf(t);window.MAIN_FONT=e?"fredburger":"lubalin",this.background=n.Sprite.from(ASSET_URL+"img/ui/menu-background.jpg"),this.stage.addChildAt(this.background,0),this.background.alpha=0},C.prototype.loadSounds=function(){a.sfx.addSound(ASSET_URL+"snd/applause_extra","applause_extra"),a.sfx.addSound(ASSET_URL+"snd/ballkick_billboards","ballkick_billboards"),a.sfx.addSound(ASSET_URL+"snd/ballkick_pass","ballkick_pass"),a.sfx.addSound(ASSET_URL+"snd/ball_pickup","ball_pickup"),a.sfx.addSound(ASSET_URL+"snd/ballkick_post","ballkick_post"),a.sfx.addSound(ASSET_URL+"snd/ballkick_shoot","ballkick_shoot"),a.sfx.addSound(ASSET_URL+"snd/ballkick_shoot_hard","ballkick_shoot_hard"),a.sfx.addSound(ASSET_URL+"snd/bonus_box_pickup","bonus_box_pickup"),a.sfx.addSound(ASSET_URL+"snd/buttercup","buttercup"),a.sfx.addSound(ASSET_URL+"snd/button_press","button_press"),a.sfx.addSound(ASSET_URL+"snd/button_press2","button_press2"),a.sfx.addSound(ASSET_URL+"snd/button_roll","button_roll"),a.sfx.addSound(ASSET_URL+"snd/captain_shot_charged","captain_shot_charged"),a.sfx.addSound(ASSET_URL+"snd/crowd_goal_1","crowd_goal_1"),a.sfx.addSound(ASSET_URL+"snd/crowd_goal_2","crowd_goal_2"),a.sfx.addSound(ASSET_URL+"snd/crowd_tackle","crowd_tackle"),a.sfx.addSound(ASSET_URL+"snd/electro_cute","electro_cute"),a.sfx.addSound(ASSET_URL+"snd/finn","finn"),a.sfx.addSound(ASSET_URL+"snd/gumball","gumball"),a.sfx.addSound(ASSET_URL+"snd/mojo","mojo"),a.sfx.addSound(ASSET_URL+"snd/panda_bear","panda_bear"),a.sfx.addSound(ASSET_URL+"snd/princess_bubblegum","princess_bubblegum"),a.sfx.addSound(ASSET_URL+"snd/shot_charged","shot_charged"),a.sfx.addSound(ASSET_URL+"snd/charge_up","charge_up"),a.sfx.addSound(ASSET_URL+"snd/tackle_hit_deck","tackle_hit_deck"),a.sfx.addSound(ASSET_URL+"snd/whistle_full_time","whistle_full_time"),a.sfx.addSound(ASSET_URL+"snd/whistle_long","whistle_long"),a.sfx.addSound(ASSET_URL+"snd/whistle_short","whistle_short"),a.sfx.addSound(ASSET_URL+"snd/whistle_tripple","whistle_tripple"),a.sfx.addSound(ASSET_URL+"snd/crowd_tackle_2","crowd_tackle_2"),a.sfx.addSound(ASSET_URL+"snd/big_kick","big_kick"),a.sfx.addSound(ASSET_URL+"snd/slide_1","slide_1"),a.sfx.addSound(ASSET_URL+"snd/slide_2","slide_2"),a.sfx.addSound(ASSET_URL+"snd/slide_3","slide_3"),a.sfx.addSound(ASSET_URL+"snd/crowd_normal_1","crowd_normal_1"),a.sfx.addSound(ASSET_URL+"snd/crowd_normal_2","crowd_normal_2"),a.sfx.addSound(ASSET_URL+"snd/crowd_normal_3","crowd_normal_3"),a.sfx.addGroup(["crowd_tackle_2","crowd_tackle","crowd_normal_1","crowd_normal_2","crowd_normal_3"],"croudAngry"),a.sfx.addGroup(["crowd_normal_1","crowd_normal_2","crowd_normal_3"],"croudHappy"),a.sfx.addGroup(["slide_1","slide_2","slide_3"],"slide"),a.music.addSound(ASSET_URL+"snd/menumusic2","menumusic2",{loop:!0}),a.music.addSound(ASSET_URL+"snd/applause_loop","applause_loop",{loop:!0,volume:.1})},C.prototype.onAppReady=function(){for(var t in E){var e=E[t];for(var i in e){var r=e[i];if(window.translations[r])e[i]=window.translations[r];else for(var n in r){var o=r[n];window.translations[o]&&(r[n]=window.translations[o])}}}this.titleScreen=new u(this),this.instructionsScreen=new p(this),this.countrySelectScreen=new d(this),this.teamSelectScreen=new f(this),this.tournamentScreen=new m(this),this.leaderboardScreen=new g(this),this.gameoverScreen=new v(this),this.gameScreen=new y(this),this.succeedScreen=new x(this),this.failScreen=new _(this),this.screenManager.addScreen(this.titleScreen,h.SCREEN_ID.TITLE),this.screenManager.addScreen(this.instructionsScreen,h.SCREEN_ID.INSTRUCTIONS),this.screenManager.addScreen(this.countrySelectScreen,h.SCREEN_ID.COUNTRY_SELECT),this.screenManager.addScreen(this.teamSelectScreen,h.SCREEN_ID.TEAM_SELECT),this.screenManager.addScreen(this.tournamentScreen,h.SCREEN_ID.TOURNAMENT),this.screenManager.addScreen(this.leaderboardScreen,h.SCREEN_ID.LEADERBOARD),this.screenManager.addScreen(this.gameoverScreen,h.SCREEN_ID.GAMEOVER),this.screenManager.addScreen(this.gameScreen,h.SCREEN_ID.GAME),this.screenManager.addScreen(this.succeedScreen,h.SCREEN_ID.SUCCEED),this.screenManager.addScreen(this.failScreen,h.SCREEN_ID.FAIL),this.topMenu=new S(this),this.stage.addChild(this.topMenu),this.overlayManager=new T(this),this.stage.addChild(this.overlayManager.view),"true"===c.get_query("fastplay")?this.screenManager.gotoScreenByID(h.SCREEN_ID.GAME):this.screenManager.gotoScreenByID(h.SCREEN_ID.TITLE),this.resize(this.w,this.h)},C.prototype.resize=function(t,e){this.w=t||this.w,this.h=e||this.h;var i=1;s.instance.isMobile&&(i=window.devicePixelRatio?window.devicePixelRatio:window.screen.deviceXDPI/window.screen.logicalXDPI),i>2&&(i=2);var r=t/this.safeSize.width<e/this.safeSize.height?t/this.safeSize.width:e/this.safeSize.height,n=Math.min(this.maxSize.width*r,t),o=Math.min(this.maxSize.height*r,e);this.renderer.resize(n*i|0,o*i|0),this.view.style.width=n+"px",this.view.style.height=o+"px",this.view.style.left=t/2-n/2+"px",this.view.style.top=e/2-o/2+"px",this.screenManager.resize(n/r,o/r),this.overlayManager&&(this.overlayManager.resize(n/r,o/r),this.overlayManager.view.scale.set(r*i)),this.background&&this.background.scale.set(r*i),this.topMenu&&(this.topMenu.scale.set(r*i),this.topMenu.resize(n/r,o/r)),this.screenManager.container.scale.set(r*i)},r.exports=C}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(13),s=i(17),a=i(20),h=i(21),l=i(22),c=i(24),u=i(25),p=i(14),d=(i(26),function(t){t=t||d.defaultOptions,this.options={};for(var e in d.defaultOptions)this.options[e]=t[e]||d.defaultOptions[e];this.setupPixi(),a.instance.start(),a.instance.add(this.update,this),this.screenManager=new s(null,300,300),this.preloader=new o,this.loader=new o,this.translation=new u(this,t),this.onReady=new p,this.options.orientationMode!==d.orientationModes.BOTH&&(this.orientationManager=new c(this.options.orientationMode)),this.stage.addChild(this.screenManager.container)});d.prototype.setupPixi=function(){var t=this.options;if(t.forceCanvas||h.instance.android&&!h.instance.chrome)this.renderer=new n.CanvasRenderer(t.width,t.height),this.renderer.clearBeforeRender=!0;else{var e={resolution:1,backgroundColor:t.backgroundColor};this.renderer=n.autoDetectRenderer(t.width,t.height,e)}window.WEBGL=n.isWebGL=this.renderer instanceof n.WebGLRenderer,window.renderer=this.renderer,this.view=this.renderer.view,this.stage=new n.Container,this.view.style.position="absolute",this.view.addEventListener("mousedown",function(){window.focus()},!0),n.stage=this.stage},d.prototype.update=function(){this.renderer.render(this.stage)},d.prototype.startup=function(){this.options.config&&this.preloader.addJson(this.options.config,"config"),this.preloader.onComplete.addOnce(this.onPreloadComplete,this),this.preloader.load()},d.prototype.onPreloadComplete=function(){this.loaderScreen=new this.options.loaderScreen(this),this.loaderScreen.onReady.addOnce(this.onLoaderScreenReady,this),this.loaderScreen.onComplete.addOnce(this.onLoaderScreenComplete,this),this.onPreload&&this.onPreload(),this.screenManager.addScreen(this.loaderScreen,"loader"),this.screenManager.gotoScreenByID("loader")},d.prototype.onLoaderScreenReady=function(){this.loader.onComplete.addOnce(this.onAssetsLoaded,this),this.loader.onProgress.add(this.onProgresss,this),this.loader.load()},d.prototype.onAssetsLoaded=function(){},d.prototype.onProgresss=function(t){this.loaderScreen.updateProgress(t)},d.prototype.onLoaderScreenComplete=function(){this.onReady.dispatch()},d.prototype.resize=function(t,e){this.orientationManager&&this.orientationManager.check(t,e),this.options.resizeMode===d.resizeModes.DEFUALT?(this.renderer.resize(t,e),this.view.style.width="auto",this.view.style.height="auto"):this["this"].options.resizeMode===d.resizeModes.CSS_RESIZE_PRESERVE_RATIO||this.options.resizeMode===d.resizeModes.CSS_RESIZE&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},d.resizeModes={DEFUALT:0,CSS_RESIZE_PRESERVE_RATIO:1,CSS_RESIZE:2},d.orientationModes={LANDSCAPE:0,PORTRAIT:1,BOTH:2},d.defaultOptions={width:800,height:600,forceCanvas:!1,backgroundColor:0,resizeMode:d.resizeModes.DEFUALT,orientationMode:d.orientationModes.LANDSCAPE,loaderScreen:l,config:null},r.exports=d}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=i(15),a=(i(16),function(){this.crossdomain=!1,window.XDomainRequest&&this.crossdomain?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=function(){},this.ajaxRequest.ontimeout=function(){},this.ajaxRequest.onprogress=function(){}):window.XMLHttpRequest&&(this.ajaxRequest=new window.XMLHttpRequest),this.ajaxRequest.onload=this._onFileLoaded.bind(this),this.ajaxRequest.onreadystatechange=function(t){},this.fileCount=0,this.filesToLoad=[],this.fontsToLoad=[],this.pixiAssetsToLoad=[],this.soundsToLoad=[],this.customToLoad=[],this.onComplete=new o,this.onProgress=new o});a.prototype.addFonts=function(t){this.fontsToLoad=this.fontsToLoad.concat(t)},a.prototype.addText=function(t,e){var i={url:t,id:e,type:a.TEXT};this.filesToLoad.push(i)},a.prototype.addJson=function(t,e){var i={url:t,id:e,type:a.JSON};this.filesToLoad.push(i)},a.prototype.addPixiAssets=function(t){this.pixiAssetsToLoad=this.pixiAssetsToLoad.concat(t)},a.prototype.addCSS=function(t){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)},a.prototype.addCustom=function(t){var e={object:t,type:a.CUSTOM};this.filesToLoad.push(e)},a.prototype.load=function(){this._loadFonts()},a.prototype._loadFiles=function(){this.fileCount=0,this.filesToLoad.length?this._loadNextFile():this._loadPixiAssets()},a.prototype._loadNextFile=function(){var t=this.filesToLoad[this.fileCount];t.type===a.CUSTOM?(t.object.onLoaded.addOnce(this._onFileLoaded,this),t.object.load()):(this.ajaxRequest.open("GET",t.url,!0),this.ajaxRequest.send())},a.prototype._onFileLoaded=function(){var t=this.filesToLoad[this.fileCount];if(t.type===a.CUSTOM);else if(200!==this.ajaxRequest.status);else switch(t.type){case a.TEXT:var e=this.ajaxRequest.responseText;s.addText(e,t.id);break;case a.JSON:var i=JSON.parse(this.ajaxRequest.responseText);s.addJson(i,t.id)}this.fileCount++,this._onProgress(),this.fileCount===this.filesToLoad.length?this._loadPixiAssets():this._loadNextFile()},a.prototype._loadPixiAssets=function(){return 0===this.pixiAssetsToLoad.length?void this._onComplete():(this.pixiAssetLoader=new n.loaders.Loader,this.pixiAssetLoader.add(this.pixiAssetsToLoad),this.pixiAssetLoader.on("progress",this._onProgress,this),void this.pixiAssetLoader.load(this._onComplete.bind(this)))},a.prototype._loadFonts=function(){return 0===this.fontsToLoad.length?void this._loadFiles():(WebFont.load({custom:{families:this.fontsToLoad,urls:[ASSET_URL+"./css/fonts.css"]},active:function(){for(var t=0;t<this.fontsToLoad.length;t++){var e=new n.Text("cheeky",{font:"32px "+this.fontsToLoad[t]});e.updateText()}}.bind(this)}),void this._loadFiles())},a.prototype._onComplete=function(t,e){n.loadedResources=e,this.onProgress.dispatch(1),this.onComplete.dispatch()},a.prototype._onProgress=function(){var t=(this.filesToLoad.length+this.pixiAssetsToLoad.length,this.fileCount);this.pixiAssetLoader&&(t=this.pixiAssetLoader.progress),this.onProgress.dispatch(.01*t)},a.TEXT=0,a.JSON=1,a.CUSTOM=2,r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;!function(n){function o(t,e,i,r,n){this._listener=e,this._isOnce=i,this.context=r,this._signal=t,this._priority=n||0}function s(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function a(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){a.prototype.dispatch.apply(t,arguments)}}o.prototype={active:!0,params:null,execute:function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},a.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,i,r){var n,s=this._indexOfListener(t,i);if(-1!==s){if(n=this._bindings[s],n.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else n=new o(this,t,e,i,r),this._addBinding(n);return this.memorize&&this._prevParams&&n.execute(this._prevParams),n},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,r=this._bindings.length;r--;)if(i=this._bindings[r],i._listener===t&&i.context===e)return r;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){return s(t,"add"),this._registerListener(t,!1,e,i)},addOnce:function(t,e,i){return s(t,"addOnce"),this._registerListener(t,!0,e,i)},remove:function(t,e){s(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(t){if(this.active){var e,i=Array.prototype.slice.call(arguments),r=this._bindings.length;if(this.memorize&&(this._prevParams=i),r){e=this._bindings.slice(),this._shouldPropagate=!0;do r--;while(e[r]&&this._shouldPropagate&&e[r].execute(i)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var h=a;h.Signal=a,r=function(){return h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))}(this)},function(t,e,i){var r;r=function(t,e,i){var r=function(){this._json={},this._text={}};r.prototype.addJson=function(t,e){this._json[e]=t},r.prototype.addText=function(t,e){this._text[e]=t},r.prototype.getJson=function(t){return this._json[t]?this._json[t]:null},r.prototype.getText=function(t){return this._text[t]?this._text[t]:void 0},i.exports=new r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e){!function(t,e,i){function r(t,e,i){return t.call.apply(t.bind,arguments)}function n(t,e,i){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function o(t,e,i){return o=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?r:n,o.apply(null,arguments)}function s(t,e){this.J=t,this.t=e||t,this.C=this.t.document}function a(t,i,r){t=t.C.getElementsByTagName(i)[0],t||(t=e.documentElement),t&&t.lastChild&&t.insertBefore(r,t.lastChild)}function h(t,e){function i(){t.C.body?e():setTimeout(i,0)}i()}function l(t,e,i){e=e||[],i=i||[];for(var r=t.className.split(/\s+/),n=0;n<e.length;n+=1){for(var o=!1,s=0;s<r.length;s+=1)if(e[n]===r[s]){o=!0;break}o||r.push(e[n])}for(e=[],n=0;n<r.length;n+=1){for(o=!1,s=0;s<i.length;s+=1)if(r[n]===i[s]){o=!0;break}o||e.push(r[n])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function c(t,e){for(var i=t.className.split(/\s+/),r=0,n=i.length;n>r;r++)if(i[r]==e)return!0;return!1}function u(t){if("string"==typeof t.ma)return t.ma;var e=t.t.location.protocol;return"about:"==e&&(e=t.J.location.protocol),"https:"==e?"https:":"http:"}function p(t,e){var i=t.createElement("link",{rel:"stylesheet",href:e}),r=!1;i.onload=function(){r||(r=!0)},i.onerror=function(){r||(r=!0)},a(t,"head",i)}function d(e,i,r,n){var o=e.C.getElementsByTagName("head")[0];if(o){var s=e.createElement("script",{src:i}),a=!1;return s.onload=s.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,r&&r(null),s.onload=s.onreadystatechange=null,"HEAD"==s.parentNode.tagName&&o.removeChild(s))},o.appendChild(s),t.setTimeout(function(){a||(a=!0,r&&r(Error("Script load timeout")))},n||5e3),s}return null}function f(t,e){this.X=t,this.fa=e}function m(t,e,i,r){this.c=null!=t?t:null,this.g=null!=e?e:null,this.A=null!=i?i:null,this.e=null!=r?r:null}function g(t){t=Q.exec(t);var e=null,i=null,r=null,n=null;return t&&(null!==t[1]&&t[1]&&(e=parseInt(t[1],10)),null!==t[2]&&t[2]&&(i=parseInt(t[2],10)),null!==t[3]&&t[3]&&(r=parseInt(t[3],10)),null!==t[4]&&t[4]&&(n=/^[0-9]+$/.test(t[4])?parseInt(t[4],10):t[4])),new m(e,i,r,n)}function v(t,e,i,r,n,o,s,a){this.M=t,this.k=a}function y(t){this.a=t}function x(t){var e=w(t.a,/(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/,1);return""!=e?(/BB\d{2}/.test(e)&&(e="BlackBerry"),e):(t=w(t.a,/(Linux|Mac_PowerPC|Macintosh|Windows|CrOS|PlayStation|CrKey)/,1),""!=t?("Mac_PowerPC"==t?t="Macintosh":"PlayStation"==t&&(t="Linux"),t):"Unknown")}function _(t){var e=w(t.a,/(OS X|Windows NT|Android) ([^;)]+)/,2);if(e||(e=w(t.a,/Windows Phone( OS)? ([^;)]+)/,2))||(e=w(t.a,/(iPhone )?OS ([\d_]+)/,2)))return e;if(e=w(t.a,/(?:Linux|CrOS|CrKey) ([^;)]+)/,1))for(var e=e.split(/\s/),i=0;i<e.length;i+=1)if(/^[\d\._]+$/.test(e[i]))return e[i];return(t=w(t.a,/(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/,2))?t:"Unknown"}function b(t){var e=x(t),i=g(_(t)),r=g(w(t.a,/AppleWeb(?:K|k)it\/([\d\.\+]+)/,1)),n="Unknown",o=new m,o="Unknown",s=!1;return/OPR\/[\d.]+/.test(t.a)?n="Opera":-1!=t.a.indexOf("Chrome")||-1!=t.a.indexOf("CrMo")||-1!=t.a.indexOf("CriOS")?n="Chrome":/Silk\/\d/.test(t.a)?n="Silk":"BlackBerry"==e||"Android"==e?n="BuiltinBrowser":-1!=t.a.indexOf("PhantomJS")?n="PhantomJS":-1!=t.a.indexOf("Safari")?n="Safari":-1!=t.a.indexOf("AdobeAIR")?n="AdobeAIR":-1!=t.a.indexOf("PlayStation")&&(n="BuiltinBrowser"),"BuiltinBrowser"==n?o="Unknown":"Silk"==n?o=w(t.a,/Silk\/([\d\._]+)/,1):"Chrome"==n?o=w(t.a,/(Chrome|CrMo|CriOS)\/([\d\.]+)/,2):-1!=t.a.indexOf("Version/")?o=w(t.a,/Version\/([\d\.\w]+)/,1):"AdobeAIR"==n?o=w(t.a,/AdobeAIR\/([\d\.]+)/,1):"Opera"==n?o=w(t.a,/OPR\/([\d.]+)/,1):"PhantomJS"==n&&(o=w(t.a,/PhantomJS\/([\d.]+)/,1)),o=g(o),s="AdobeAIR"==n?2<o.c||2==o.c&&5<=o.g:"BlackBerry"==e?10<=i.c:"Android"==e?2<i.c||2==i.c&&1<i.g:526<=r.c||525<=r.c&&13<=r.g,new v(n,0,0,0,0,0,0,new f(s,536>r.c||536==r.c&&11>r.g))}function w(t,e,i){return(t=t.match(e))&&t[i]?t[i]:""}function S(t){this.la=t||"-"}function T(t,e){this.M=t,this.Y=4,this.N="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.N=i[1],this.Y=parseInt(i[2],10))}function M(t){return t.N+t.Y}function E(t){var e=4,i="n",r=null;return t&&((r=t.match(/(normal|oblique|italic)/i))&&r[1]&&(i=r[1].substr(0,1).toLowerCase()),(r=t.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?e=7:/[1-9]00/.test(r[1])&&(e=parseInt(r[1].substr(0,1),10)))),i+e}function C(t,e){this.d=t,this.p=t.t.document.documentElement,this.P=e,this.j="wf",this.h=new S("-"),this.ga=!1!==e.events,this.B=!1!==e.classes}function A(t){if(t.B){var e=c(t.p,t.h.e(t.j,"active")),i=[],r=[t.h.e(t.j,"loading")];e||i.push(t.h.e(t.j,"inactive")),l(t.p,i,r)}L(t,"inactive")}function L(t,e,i){t.ga&&t.P[e]&&(i?t.P[e](i.getName(),M(i)):t.P[e]())}function P(){this.w={}}function R(t,e){this.d=t,this.G=e,this.m=this.d.createElement("span",{"aria-hidden":"true"},this.G)}function O(t){a(t.d,"body",t.m)}function I(t){var e;e=[];for(var i=t.M.split(/,\s*/),r=0;r<i.length;r++){var n=i[r].replace(/['"]/g,"");-1==n.indexOf(" ")?e.push(n):e.push("'"+n+"'")}return e=e.join(","),i="normal","o"===t.N?i="oblique":"i"===t.N&&(i="italic"),"display:block;position:absolute;top:-999px;left:-999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+e+";"+("font-style:"+i+";font-weight:"+(t.Y+"00")+";")}function D(t,e,i,r,n,o,s,a){this.Z=t,this.ja=e,this.d=i,this.s=r,this.G=a||"BESbswy",this.k=n,this.I={},this.W=o||3e3,this.ba=s||null,this.F=this.D=null,t=new R(this.d,this.G),O(t);for(var h in tt)tt.hasOwnProperty(h)&&(e=new T(tt[h],M(this.s)),e=I(e),t.m.style.cssText=e,this.I[tt[h]]=t.m.offsetWidth);t.remove()}function B(t,e,i){for(var r in tt)if(tt.hasOwnProperty(r)&&e===t.I[tt[r]]&&i===t.I[tt[r]])return!0;return!1}function k(t){var e=t.D.m.offsetWidth,i=t.F.m.offsetWidth;e===t.I.serif&&i===t.I["sans-serif"]||t.k.fa&&B(t,e,i)?J()-t.na>=t.W?t.k.fa&&B(t,e,i)&&(null===t.ba||t.ba.hasOwnProperty(t.s.getName()))?N(t,t.Z):N(t,t.ja):F(t):N(t,t.Z)}function F(t){setTimeout(o(function(){k(this)},t),25)}function N(t,e){t.D.remove(),t.F.remove(),e(t.s)}function U(t,e,i,r){this.d=e,this.u=i,this.R=0,this.da=this.aa=!1,this.W=r,this.k=t.k}function G(t,e,i,r,n){if(i=i||{},0===e.length&&n)A(t.u);else for(t.R+=e.length,n&&(t.aa=n),n=0;n<e.length;n++){var s=e[n],a=i[s.getName()],h=t.u,c=s;h.B&&l(h.p,[h.h.e(h.j,c.getName(),M(c).toString(),"loading")]),L(h,"fontloading",c),h=null,h=new D(o(t.ha,t),o(t.ia,t),t.d,s,t.k,t.W,r,a),h.start()}}function z(t){0==--t.R&&t.aa&&(t.da?(t=t.u,t.B&&l(t.p,[t.h.e(t.j,"active")],[t.h.e(t.j,"loading"),t.h.e(t.j,"inactive")]),L(t,"active")):A(t.u))}function V(t){this.J=t,this.v=new P,this.oa=new y(t.navigator.userAgent),this.a=this.oa.parse(),this.T=this.U=0,this.Q=this.S=!0}function j(t,e,i,r,n){
var o=0==--t.U;(t.Q||t.S)&&setTimeout(function(){G(e,i,r||null,n||null,o)},0)}function H(t,e,i){this.O=t?t:e+et,this.q=[],this.V=[],this.ea=i||""}function W(t){this.q=t,this.ca=[],this.L={}}function X(t,e){this.a=new y(navigator.userAgent).parse(),this.d=t,this.f=e}function Y(t,e){this.d=t,this.f=e,this.o=[]}function q(t,e){this.d=t,this.f=e,this.o=[]}function K(t,e){this.d=t,this.f=e,this.o=[]}function Z(t,e){this.d=t,this.f=e}var J=Date.now||function(){return+new Date};s.prototype.createElement=function(t,e,i){if(t=this.C.createElement(t),e)for(var r in e)e.hasOwnProperty(r)&&("style"==r?t.style.cssText=e[r]:t.setAttribute(r,e[r]));return i&&t.appendChild(this.C.createTextNode(i)),t};var Q=/^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;m.prototype.compare=function(t){return this.c>t.c||this.c===t.c&&this.g>t.g||this.c===t.c&&this.g===t.g&&this.A>t.A?1:this.c<t.c||this.c===t.c&&this.g<t.g||this.c===t.c&&this.g===t.g&&this.A<t.A?-1:0},m.prototype.toString=function(){return[this.c,this.g||"",this.A||"",this.e||""].join("")},v.prototype.getName=function(){return this.M};var $=new v("Unknown",0,0,0,0,0,0,new f(!1,!1));y.prototype.parse=function(){var t;if(-1!=this.a.indexOf("MSIE")||-1!=this.a.indexOf("Trident/")){t=x(this);var e=g(_(this)),i=null,r=w(this.a,/Trident\/([\d\w\.]+)/,1),i=g(-1!=this.a.indexOf("MSIE")?w(this.a,/MSIE ([\d\w\.]+)/,1):w(this.a,/rv:([\d\w\.]+)/,1));""!=r&&g(r),t=new v("MSIE",0,0,0,0,0,0,new f("Windows"==t&&6<=i.c||"Windows Phone"==t&&8<=e.c,!1))}else if(-1!=this.a.indexOf("Opera"))t:if(t=g(w(this.a,/Presto\/([\d\w\.]+)/,1)),g(_(this)),null!==t.c||g(w(this.a,/rv:([^\)]+)/,1)),-1!=this.a.indexOf("Opera Mini/"))t=g(w(this.a,/Opera Mini\/([\d\.]+)/,1)),t=new v("OperaMini",0,0,0,x(this),0,0,new f(!1,!1));else{if(-1!=this.a.indexOf("Version/")&&(t=g(w(this.a,/Version\/([\d\.]+)/,1)),null!==t.c)){t=new v("Opera",0,0,0,x(this),0,0,new f(10<=t.c,!1));break t}t=g(w(this.a,/Opera[\/ ]([\d\.]+)/,1)),t=null!==t.c?new v("Opera",0,0,0,x(this),0,0,new f(10<=t.c,!1)):new v("Opera",0,0,0,x(this),0,0,new f(!1,!1))}else/OPR\/[\d.]+/.test(this.a)?t=b(this):/AppleWeb(K|k)it/.test(this.a)?t=b(this):-1!=this.a.indexOf("Gecko")?(t="Unknown",e=new m,g(_(this)),e=!1,-1!=this.a.indexOf("Firefox")?(t="Firefox",e=g(w(this.a,/Firefox\/([\d\w\.]+)/,1)),e=3<=e.c&&5<=e.g):-1!=this.a.indexOf("Mozilla")&&(t="Mozilla"),i=g(w(this.a,/rv:([^\)]+)/,1)),e||(e=1<i.c||1==i.c&&9<i.g||1==i.c&&9==i.g&&2<=i.A),t=new v(t,0,0,0,x(this),0,0,new f(e,!1))):t=$;return t},S.prototype.e=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.la)},T.prototype.getName=function(){return this.M},R.prototype.remove=function(){var t=this.m;t.parentNode&&t.parentNode.removeChild(t)};var tt={ra:"serif",qa:"sans-serif",pa:"monospace"};D.prototype.start=function(){this.D=new R(this.d,this.G),O(this.D),this.F=new R(this.d,this.G),O(this.F),this.na=J();var t=new T(this.s.getName()+",serif",M(this.s)),t=I(t);this.D.m.style.cssText=t,t=new T(this.s.getName()+",sans-serif",M(this.s)),t=I(t),this.F.m.style.cssText=t,k(this)},U.prototype.ha=function(t){var e=this.u;e.B&&l(e.p,[e.h.e(e.j,t.getName(),M(t).toString(),"active")],[e.h.e(e.j,t.getName(),M(t).toString(),"loading"),e.h.e(e.j,t.getName(),M(t).toString(),"inactive")]),L(e,"fontactive",t),this.da=!0,z(this)},U.prototype.ia=function(t){var e=this.u;if(e.B){var i=c(e.p,e.h.e(e.j,t.getName(),M(t).toString(),"active")),r=[],n=[e.h.e(e.j,t.getName(),M(t).toString(),"loading")];i||r.push(e.h.e(e.j,t.getName(),M(t).toString(),"inactive")),l(e.p,r,n)}L(e,"fontinactive",t),z(this)},V.prototype.load=function(t){this.d=new s(this.J,t.context||this.J),this.S=!1!==t.events,this.Q=!1!==t.classes;var e=new C(this.d,t),i=[],r=t.timeout;e.B&&l(e.p,[e.h.e(e.j,"loading")]),L(e,"loading");var n,i=this.v,a=this.d,h=[];for(n in t)if(t.hasOwnProperty(n)){var c=i.w[n];c&&h.push(c(t[n],a))}for(i=h,this.T=this.U=i.length,t=new U(this.a,this.d,e,r),r=0,n=i.length;n>r;r++)a=i[r],a.K(this.a,o(this.ka,this,a,e,t))},V.prototype.ka=function(t,e,i,r){var n=this;r?t.load(function(t,e,r){j(n,i,t,e,r)}):(t=0==--this.U,this.T--,t&&0==this.T?A(e):(this.Q||this.S)&&G(i,[],{},null,t))};var et="//fonts.googleapis.com/css";H.prototype.e=function(){if(0==this.q.length)throw Error("No fonts to load!");if(-1!=this.O.indexOf("kit="))return this.O;for(var t=this.q.length,e=[],i=0;t>i;i++)e.push(this.q[i].replace(/ /g,"+"));return t=this.O+"?family="+e.join("%7C"),0<this.V.length&&(t+="&subset="+this.V.join(",")),0<this.ea.length&&(t+="&text="+encodeURIComponent(this.ea)),t};var it={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},rt={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},nt={i:"i",italic:"i",n:"n",normal:"n"},ot=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;W.prototype.parse=function(){for(var t=this.q.length,e=0;t>e;e++){var i=this.q[e].split(":"),r=i[0].replace(/\+/g," "),n=["n4"];if(2<=i.length){var o,s=i[1];if(o=[],s)for(var s=s.split(","),a=s.length,h=0;a>h;h++){var l;if(l=s[h],l.match(/^[\w-]+$/)){l=ot.exec(l.toLowerCase());var c=void 0;if(null==l)c="";else{if(c=void 0,c=l[1],null==c||""==c)c="4";else var u=rt[c],c=u?u:isNaN(c)?"4":c.substr(0,1);l=l[2],c=[null==l||""==l?"n":nt[l],c].join("")}l=c}else l="";l&&o.push(l)}0<o.length&&(n=o),3==i.length&&(i=i[2],o=[],i=i?i.split(","):o,0<i.length&&(i=it[i[0]])&&(this.L[r]=i))}for(this.L[r]||(i=it[r])&&(this.L[r]=i),i=0;i<n.length;i+=1)this.ca.push(new T(r,n[i]))}};var st={Arimo:!0,Cousine:!0,Tinos:!0};X.prototype.K=function(t,e){e(t.k.X)},X.prototype.load=function(t){var e=this.d;"MSIE"==this.a.getName()&&1!=this.f.blocking?h(e,o(this.$,this,t)):this.$(t)},X.prototype.$=function(t){for(var e=this.d,i=new H(this.f.api,u(e),this.f.text),r=this.f.families,n=r.length,o=0;n>o;o++){var s=r[o].split(":");3==s.length&&i.V.push(s.pop());var a="";2==s.length&&""!=s[1]&&(a=":"),i.q.push(s.join(a))}r=new W(r),r.parse(),p(e,i.e()),t(r.ca,r.L,st)},Y.prototype.H=function(t){var e=this.d;return u(this.d)+(this.f.api||"//f.fontdeck.com/s/css/js/")+(e.t.location.hostname||e.J.location.hostname)+"/"+t+".js"},Y.prototype.K=function(t,e){var i=this.f.id,r=this.d.t,n=this;i?(r.__webfontfontdeckmodule__||(r.__webfontfontdeckmodule__={}),r.__webfontfontdeckmodule__[i]=function(t,i){for(var r=0,o=i.fonts.length;o>r;++r){var s=i.fonts[r];n.o.push(new T(s.name,E("font-weight:"+s.weight+";font-style:"+s.style)))}e(t)},d(this.d,this.H(i),function(t){t&&e(!1)})):e(!1)},Y.prototype.load=function(t){t(this.o)},q.prototype.H=function(t){var e=u(this.d);return(this.f.api||e+"//use.typekit.net")+"/"+t+".js"},q.prototype.K=function(t,e){var i=this.f.id,r=this.d.t,n=this;i?d(this.d,this.H(i),function(t){if(t)e(!1);else{if(r.Typekit&&r.Typekit.config&&r.Typekit.config.fn){t=r.Typekit.config.fn;for(var i=0;i<t.length;i+=2)for(var o=t[i],s=t[i+1],a=0;a<s.length;a++)n.o.push(new T(o,s[a]));try{r.Typekit.load({events:!1,classes:!1})}catch(h){}}e(!0)}},2e3):e(!1)},q.prototype.load=function(t){t(this.o)},K.prototype.K=function(t,e){var i=this,r=i.f.projectId,n=i.f.version;if(r){var o=i.d.t;d(this.d,i.H(r,n),function(n){if(n)e(!1);else{if(o["__mti_fntLst"+r]&&(n=o["__mti_fntLst"+r]()))for(var s=0;s<n.length;s++)i.o.push(new T(n[s].fontfamily));e(t.k.X)}}).id="__MonotypeAPIScript__"+r}else e(!1)},K.prototype.H=function(t,e){var i=u(this.d),r=(this.f.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return i+"//"+r+"/"+t+".js"+(e?"?v="+e:"")},K.prototype.load=function(t){t(this.o)},Z.prototype.load=function(t){var e,i,r=this.f.urls||[],n=this.f.families||[],o=this.f.testStrings||{};for(e=0,i=r.length;i>e;e++)p(this.d,r[e]);for(r=[],e=0,i=n.length;i>e;e++){var s=n[e].split(":");if(s[1])for(var a=s[1].split(","),h=0;h<a.length;h+=1)r.push(new T(s[0],a[h]));else r.push(new T(s[0]))}t(r,o)},Z.prototype.K=function(t,e){return e(t.k.X)};var at=new V(this);at.v.w.custom=function(t,e){return new Z(e,t)},at.v.w.fontdeck=function(t,e){return new Y(e,t)},at.v.w.monotype=function(t,e){return new K(e,t)},at.v.w.typekit=function(t,e){return new q(e,t)},at.v.w.google=function(t,e){return new X(e,t)},this.WebFont||(this.WebFont={},this.WebFont.load=o(at.load,at),this.WebFontConfig&&at.load(this.WebFontConfig))}(this,document)},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(18),i(19)),s=function(t,e,i,r){this.container=t||new n.Container,this.screens={},this.currentScreen,this.fading=!1,this.w=e||400,this.h=i||400,this.history=[],this.defaultTransition=r||new o,this.transition=this.defaultTransition,this.active=!1};s.constructor=s,s.prototype.gotoScreenByID=function(t,e){var i=this.screens[t];if(!i)throw new Error("screen not found with id : "+t);this.gotoScreen(i,e)},s.prototype.addScreen=function(t,e){this.screens[e]=t,t.id=e,t.screenManager=this},s.prototype.goBack=function(){this.history.pop();var t=this.history.pop();t&&this.gotoScreen(t)},s.prototype.getScreenId=function(t){for(var e in this.screens)if(this.screens[e]===t)return e;return null},s.prototype.gotoScreen=function(t,e){if(this.currentScreen!==t&&(this.history.push(t),this.nextScreen=t,!this.active)){this.active=!0,this.transition=t.transition||this.defaultTransition,this.transition.onResize&&this.transition.onResize(this.w,this.h);var i=this.currentScreen;this.nextScreen&&this.nextScreen.resize&&this.nextScreen.resize(this.w,this.h),this.currentScreen=t,this.transition.begin(this,i,this.nextScreen)}},s.prototype.onTransitionComplete=function(){this.active=!1,this.currentScreen!=this.nextScreen&&this.gotoScreen(this.nextScreen)},s.prototype.resize=function(t,e){this.w=t,this.h=e,this.transition.onResize&&this.transition.onResize(t,e),this.currentScreen&&this.currentScreen.resize&&this.currentScreen.resize(t,e)},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){AlphaTransition=function(){},AlphaTransition.constructor=AlphaTransition,AlphaTransition.prototype.begin=function(t,e,i){this.screenManager=t,this.currentScreen=e,this.nextScreen=i,this.currentScreen?(this.currentScreen.onHide&&this.currentScreen.onHide(),TweenLite.to(this.currentScreen,.4,{alpha:0,onComplete:this.onFadeout.bind(this)})):this.onFadeout()},AlphaTransition.prototype.onFadeout=function(){this.currentScreen&&(this.currentScreen.onHidden&&this.currentScreen.onHidden(),this.screenManager.container.removeChild(this.currentScreen),this.currentScreen.alpha=1),this.nextScreen.alpha=0,this.nextScreen.onShow&&this.nextScreen.onShow(),this.nextScreen.resize&&this.nextScreen.resize(this.screenManager.w,this.screenManager.h),TweenLite.to(this.nextScreen,.4,{alpha:1,onComplete:this.onFadein.bind(this)}),this.screenManager.container.addChild(this.nextScreen)},AlphaTransition.prototype.onFadein=function(){this.nextScreen.onShown&&this.nextScreen.onShown(),this.screenManager.onTransitionComplete()},AlphaTransition.prototype.resize=function(t,e){this.w=t,this.h=e},i.exports=AlphaTransition}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){ColorTransition=function(){this.colorRect=(new PIXI.Graphics).beginFill(0).drawRect(0,0,2e3,1e3),this.colorRect.alpha=0},ColorTransition.constructor=ColorTransition,ColorTransition.prototype.begin=function(t,e,i){this.screenManager=t,this.currentScreen=e,this.nextScreen=i,this.screenManager.container.addChild(this.colorRect),this.currentScreen?(this.currentScreen.onHide&&this.currentScreen.onHide(),TweenLite.to(this.colorRect,.4,{alpha:1,onComplete:this.onFadeout.bind(this)})):this.onFadeout()},ColorTransition.prototype.onFadeout=function(){this.currentScreen&&(this.currentScreen.onHidden&&this.currentScreen.onHidden(),this.screenManager.container.removeChild(this.currentScreen),this.currentScreen.alpha=1),this.nextScreen.onShow&&this.nextScreen.onShow(),this.nextScreen.resize&&this.nextScreen.resize(this.screenManager.w,this.screenManager.h),this.screenManager.container.addChild(this.nextScreen),this.screenManager.container.addChild(this.colorRect),TweenLite.to(this.colorRect,.4,{alpha:0,onComplete:this.onFadein.bind(this)})},ColorTransition.prototype.onFadein=function(){this.screenManager.container.removeChild(this.colorRect),this.nextScreen.onShown&&this.nextScreen.onShown(),this.screenManager.onTransitionComplete()},ColorTransition.prototype.resize=function(t,e){this.w===t&&this.h===e||(this.w=t,this.h=e,this.colorRect.scale.x=t/100,this.colorRect.scale.y=e/100)},i.exports=ColorTransition}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(14),o=function(){this.onUpdate=new n,this.updateBind=this.update.bind(this),this.active=!1,this.deltaTime=1,this.timeElapsed=0,this.lastTime=0,this.speed=1};o.prototype.start=function(){this.active||(this.active=!0,requestAnimationFrame(this.updateBind))},o.prototype.stop=function(){this.active&&(this.active=!1)},o.prototype.update=function(){if(this.active){requestAnimationFrame(this.updateBind);var t=(new Date).getTime(),e=t-this.lastTime;e>100&&(e=100),this.deltaTime=.06*e,this.deltaTime*=this.speed,this.onUpdate.dispatch(this.deltaTime),this.lastTime=t}},o.prototype.add=function(t,e){this.onUpdate.add(t,e)},o.prototype.remove=function(t,e){this.onUpdate.remove(t,e)},o.instance=new o,o.game=new o,r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){Device=function(){this.arora=!1,this.chrome=!1,this.epiphany=!1,this.firefox=!1,this.mobileSafari=!1,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.midori=!1,this.opera=!1,this.safari=!1,this.silk=!1,this.webApp=!1,this.cocoonJS=!1,this.android=!1,this.chromeOS=!1,this.iOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.desktop=!1,this.pixelRatio=0,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.blob=!1,this.canvas=!1,this.localStorage=!1,this.file=!1,this.fileSystem=!1,this.webGL=!1,this.worker=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1;var t=navigator.userAgent;this._checkBrowser(t),this._checkOS(t),this._checkDevice(t),this._checkAudio(),this._checkFeatures(),this._checkIsMobile(),this._checkIsTouch()},Device.prototype._checkBrowser=function(t){/Arora/.test(t)?this.arora=!0:/Opera|OPR|op/.test(t)?(this.opera=!0,this.chrome=!1):/Chrome/.test(t)?this.chrome=!0:/Epiphany/.test(t)?this.epiphany=!0:/Firefox/.test(t)?this.firefox=!0:/Mobile Safari/.test(t)?this.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(t)||navigator.userAgent.match(/Trident.*rv[ :]*11\./)?(this.ie=!0,this.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(t)?this.midori=!0:/Safari/.test(t)?this.safari=!0:/\bSilk\b/.test(t)?this.silk=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(this.ie=!0,this.trident=!0,this.tridentVersion=parseInt(RegExp.$1,10),this.ieVersion=parseInt(RegExp.$3,10)),navigator.standalone&&(this.webApp=!0),navigator.isCocoonJS&&(this.cocoonJS=!0)},Device.prototype._checkOS=function(t){/Android/.test(t)?this.android=!0:/CrOS/.test(t)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(t)?(this.iOS=!0,this.iOS_version=parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||!1):/Linux/.test(t)?this.linux=!0:/Mac OS/.test(t)?this.macOS=!0:/Windows/.test(t)&&(this.windows=!0),(this.windows||this.macOS||this.linux||this.chromeOS)&&(this.desktop=!0)},Device.prototype._checkDevice=function(){this.pixelRatio=window.devicePixelRatio||1,this.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone"),this.iPhone4=2===this.pixelRatio&&this.iPhone,this.iPhone4&&(this.iPhone4=480==window.screen.height&&320==window.screen.width||480==window.screen.width&&320==window.screen.height),this.iPad=-1!==navigator.userAgent.toLowerCase().indexOf("ipad")},Device.prototype._checkFeatures=function(){"undefined"!=typeof window.Blob&&(this.blob=!0),this.canvas=!!window.CanvasRenderingContext2D;try{this.localStorage=!!localStorage.getItem}catch(t){this.localStorage=!1}this.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),this.fileSystem=!!window.requestFileSystem,this.webGL=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),(this.android||this.ie)&&(this.webGL=!1),this.worker=!!window.Worker,("ontouchstart"in document.documentElement||window.navigator.msPointerEnabled)&&(this.touch=!0)},Device.prototype._checkAudio=function(){this.audioData=!!window.Audio,this.webaudio=!(!window.AudioContext&&!window.webkitAudioContext);var t=document.createElement("audio"),e=!1;try{(e=!!t.canPlayType)&&(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.ogg=!0),t.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.mp3=!0),t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.wav=!0),(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;").replace(/^no$/,""))&&(this.m4a=!0))}catch(i){}},Device.prototype._checkIsMobile=function(){var t=!1;!function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),this.isMobile=t,this.mobile=t},Device.prototype._checkIsTouch=function(){this.isTouch="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},Device.prototype.getInfo=function(){var t="DEVICE OUTPUT\n\n";return t+="---\n",t+="Browser Info :: \n",t+="Arora : "+this.arora+"\n",t+="Chrome : "+this.chrome+"\n",t+="Epiphany : "+this.epiphany+"\n",t+="Firefox : "+this.firefox+"\n",t+="Mobile Safari : "+this.mobileSafari+"\n",t+="IE : "+this.ie,t+=this.ie?" (Version "+this.ieVersion+")\n":"\n",t+="Midori : "+this.midori+"\n",t+="Opera : "+this.opera+"\n",t+="Safari : "+this.safari+"\n",t+="Web App : "+this.webApp+"\n",t+="CocoonJS : "+this.cocoonJS+"\n",t+="Android : "+this.android+"\n",t+="---\n",t+="Operating System :: \n",t+="Chrome OS : "+this.chromeOS+"\n",t+="iOS : "+this.iOS+"\n",t+="Linux : "+this.linux+"\n",t+="Mac OS : "+this.macOS+"\n",t+="Windows : "+this.windows+"\n",t+="Desktop : "+this.desktop+"\n",t+="---\n",t+="Device Type : \n",t+="Pixel Ratio : "+this.pixelRatio+"\n",t+="iPhone : "+this.iPhone+"\n",t+="iPhone 4 : "+this.iPhone4+"\n",t+="iPad : "+this.iPad+"\n",t+="---\n",t+="Features :: \n",t+="Blob : "+this.blob+"\n",t+="Canvas : "+this.canvas+"\n",t+="LocalStorage : "+this.localStorage+"\n",t+="File : "+this.file+"\n",t+="File System : "+this.fileSystem+"\n",t+="WebGL : "+this.webGL+"\n",t+="Workers : "+this.worker+"\n",t+="---\n",t+="Audio :: \n",t+="AudioData : "+this.audioData+"\n",t+="WebAudio : "+this.webAudio+"\n",t+="Supports .ogg : "+this.ogg+"\n",t+="Supports Opus : "+this.opus+"\n",t+="Supports .mp3 : "+this.mp3+"\n",t+="Supports .wav : "+this.wav+"\n",t+="Supports .m4a : "+this.m4a+"\n",t+="Supports .webm : "+this.webm},Object.defineProperty(Device.prototype,"ie9",{get:function(){return this.ie&&9===this.ieVersion}}),Object.defineProperty(Device.prototype,"useSM2",{get:function(){return this.ie||this.opera}}),Device.instance=new Device,i.exports=Device}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(20),s=i(23),a=i(14),h=function(t){n.Container.call(this),this.app=t,this.easeLoad=0,this.targetLoad=0,this.onReady=new a,this.onComplete=new a,this.initLoader()};h.prototype=Object.create(n.Container.prototype),h.prototype.initLoader=function(){o.instance.add(this.update,this),this.resize(this.w,this.h),s.wait(this.showLoader.bind(this))},h.prototype.showLoader=function(){this.onReady.dispatch()},h.prototype.update=function(){this.easeLoad+=.3*(this.targetLoad-this.easeLoad),this.easeLoad>.99&&(this.easeLoad=1,o.instance.remove(this.update,this),this.onComplete.dispatch())},h.prototype.updateProgress=function(t){this.targetLoad=t},h.prototype.onHide=function(){o.instance.remove(this.update,this)},h.prototype.resize=function(t,e){this.w=t,this.h=e,this.barBg},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(){this.updateBind=this.update.bind(this),this.waits=[]};r.prototype.wait=function(t,e){var i={callback:t,count:e||2};this.waits.push(i),requestAnimationFrame(this.updateBind)},r.prototype.update=function(){for(var t=this.waits.length-1;t>=0;t--){var e=this.waits[t];e.count--,e.count<=0&&(e.callback(),this.waits.splice(t,1))}this.waits.length>0&&requestAnimationFrame(this.updateBind)},i.exports=new r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(20),o=i(21),s=i(14),a=(i(12),function(t){if(this.mode=t,this.onRotationChanged=new s,this.rotationWarning=!0,this.orientation,this.rotateScreen=document.createElement("div"),this.rotateScreen.style.backgroundPosition="50% 50%",this.rotateScreen.style.backgroundColor="#3b3b3b",this.rotateScreen.style.backgroundRepeat="no-repeat",this.rotateScreen.style.position="absolute",this.rotateScreen.style.backgroundSize="cover",this.rotateScreen.style.top="0",this.rotateScreen.style.left="0",this.rotateScreen.style.bottom="0",this.rotateScreen.style.right="0",this.rotateScreen.style.zIndex=1e7,this.rotateScreen.style.display="none",this.rotateScreen.height="100%",this.rotateScreen.width="100%",this.changeRotationImage(ASSET_URL+"img/orientation_iphone.jpg"),o.instance.iPad&&this.changeRotationImage(ASSET_URL+"img/orientation_ipad.jpg"),document.body.appendChild(this.rotateScreen),o.instance.firefox){var e=window.matchMedia("(orientation: portrait)");e.addListener(this.checkOrientationChangesFirefox.bind(this))}this.supportsOrientationChange="onorientationchange"in window,this.supportsOrientationChange&&(this.orientation=window.orientation,window.addEventListener("orientationchange",this.checkOrientationChanges.bind(this),!1),this.checkOrientationChanges()),this.supportsOrientationEvent="DeviceOrientationEvent"in window});a.prototype.constructor=a,a.prototype.checkOrientationResize=function(t){},a.prototype.changeRotationImage=function(t){this.rotateScreen.style.backgroundImage="url("+t+")"},a.prototype.checkOrientationChangesFirefox=function(){var t=screen.orientation||screen.mozOrientation||screen.msOrientation;"landscape-primary"===t?this.orientation=90:"landscape-secondary"===t&&(this.orientation=-90),this.onRotationChanged.dispatch(this.orientation)},a.prototype.checkOrientationChanges=function(){this.orientation=window.orientation,this.onRotationChanged.dispatch(window.orientation),0===this.orientation?(n.instance.stop(),this.rotateScreen.style.display="block"):(n.instance.start(),this.rotateScreen.style.display="none")},a.prototype.check=function(t,e){if(!o.instance.desktop){var i=0===this.mode?e>t:t>e;i?(n.instance.stop(),this.rotateScreen.style.display="block"):(n.instance.start(),this.rotateScreen.style.display="none")}},a.prototype.updateDeviceOrientation=function(t){this.alpha=t.alpha,this.beta=t.beta,this.gamma=t.gamma},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(15),o=function(t,e){this.debug=e.debug||!1,this.app=t,this.app.preloader.addJson(e.stringsUrl||ASSET_URL+"json/strings.json","strings"),this.app.preloader.onComplete.addOnce(this.onPreloaderComplete,this)};o.prototype.constructor=o,o.prototype.onPreloaderComplete=function(){if(window.translations=n.getJson("strings").strings,this.debug)for(var t in window.translations)window.translations[t]+=window.translations[t]},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;!function(n){var o=function(t){return this instanceof o?o.methods.initialize(t):new o(t)},s=window.devicePixelRatio||1,a={WIDTH:80*s,HEIGHT:50*s,FRAMES:{WIDTH:74*s,HEIGHT:32*s,X:3*s,Y:15*s},TEXT:{HEIGHT:8*s,X:75*s,Y:10*s}},h={FPS:{DATAS:"#1AFFFF",FRAMES:"#1B314C",BACKGROUND:"#1A1A38"},MS:{DATAS:"#1AFF1A",FRAMES:"#1B4C1B",BACKGROUND:"#1A381A"},MB:{DATAS:"#FF1A94",FRAMES:"#4C1B34",BACKGROUND:"#381A29"},PING:{DATAS:"#FFFFFF",FRAMES:"#555555",BACKGROUND:"#222222"}},l={FPS:0,MS:1,MB:2,PING:3},c=void 0!=window.performance&&void 0!=window.performance.memory&&void 0!=window.performance.memory.usedJSHeapSize;o.methods={initialize:function(t){return this.mode=l.FPS,this.realTime=t||!1,this.frameTime=0,this.beginTime=0,this.endTime=0,this.isPinging=!1,this.beginPinging=0,this.endPinging=0,this.fps={value:0,current:0,min:1/0,max:-(1/0),array:new Array(a.FRAMES.WIDTH)},this.ms={value:0,current:0,min:1/0,max:-(1/0),array:new Array(a.FRAMES.WIDTH)},this.mb={value:0,current:0,min:1/0,max:-(1/0),array:new Array(a.FRAMES.WIDTH)},this.ping={value:0,current:0,min:1/0,max:-(1/0),array:new Array(a.FRAMES.WIDTH)},this.domElement=document.createElement("canvas"),this.domElement.className="statsjs",this.domElement.width=a.WIDTH,this.domElement.height=a.HEIGHT,this.domElement.style.width=a.WIDTH/s+"px",this.domElement.style.height=a.HEIGHT/s+"px",this.domElement.addEventListener("click",function(t){this.switchMode()}.bind(this),!1),this.context=this.domElement.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.context.font="bold "+a.TEXT.HEIGHT+"px sans-serif",this.context.textAlign="right",this},switchMode:function(){this.mode==l.FPS?this.mode=l.MS:this.mode==l.MS?1==c?this.mode=l.MB:this.mode=l.PING:this.mode==l.MB?this.mode=l.PING:this.mode==l.PING&&(this.mode=l.FPS),this.draw()},begin:function(){this.beginTime=window.performance.now()},end:function(){var t=window.performance.now(),e=t-this.frameTime;if(this.endTime=t,this.fps.current++,this.fps.max=Math.max(this.fps.current,this.fps.max),this.ms.current=(this.endTime-this.beginTime).toFixed(0),this.ms.min=Math.min(this.ms.current,this.ms.min),this.ms.max=Math.max(this.ms.current,this.ms.max),1==c&&(this.mb.current=Math.round(9.54e-7*window.performance.memory.usedJSHeapSize),this.mb.min=Math.min(this.mb.current,this.mb.min),this.mb.max=Math.max(this.mb.current,this.mb.max)),1==this.realTime&&(this.fps.value=this.fps.current,this.fps.array[this.fps.array.length-1]=this.fps.value),1e3>e&&1==this.realTime)this.draw();else if(e>=1e3){this.fps.min=Math.min(this.fps.current,this.fps.min),this.frameTime=t,this.fps.value=this.fps.current,this.ms.value=this.ms.current,this.mb.value=this.mb.current,this.ping.value=this.ping.current;for(var i=0,r=a.FRAMES.WIDTH;r>i;i++)this.fps.array[i]=this.fps.array[i+1],this.ms.array[i]=this.ms.array[i+1],this.mb.array[i]=this.mb.array[i+1],this.ping.array[i]=this.ping.array[i+1];this.fps.array[this.fps.array.length-1]=this.fps.value,this.ms.array[this.ms.array.length-1]=this.ms.value,this.mb.array[this.mb.array.length-1]=this.mb.value,this.ping.array[this.ping.array.length-1]=this.ping.value,this.draw(),this.fps.current=0}},beginPing:function(){this.beginPinging=window.performance.now()},endPing:function(){this.endPinging=window.performance.now(),this.ping.current=parseInt(this.endPinging-this.beginPinging),this.ping.min=Math.min(this.ping.current,this.ping.min),this.ping.max=Math.max(this.ping.current,this.ping.max)},draw:function(){if(this.context.clearRect(0,0,a.WIDTH,a.HEIGHT),this.mode==l.FPS){this.context.fillStyle=h.FPS.BACKGROUND,this.context.fillRect(0,0,a.WIDTH,a.HEIGHT),this.context.fillStyle=h.FPS.FRAMES,this.context.fillRect(a.FRAMES.X,a.FRAMES.Y,a.FRAMES.WIDTH,a.FRAMES.HEIGHT),this.context.fillStyle=h.FPS.DATAS;var t=this.fps.min==1/0?"":this.fps.min,e=this.fps.max==-(1/0)?"":this.fps.max;1==this.realTime?this.context.fillText(this.fps.current+" FPS ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y):this.context.fillText(this.fps.value+" FPS ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y);for(var i=0,r=this.fps.array.length;r>i;i++){var n=this.fps.array[i]/this.fps.max*a.FRAMES.HEIGHT||0,o=a.FRAMES.X+i,s=a.FRAMES.Y+a.FRAMES.HEIGHT-n;this.context.fillRect(o,s,1,n)}}else if(this.mode==l.MS){this.context.fillStyle=h.MS.BACKGROUND,this.context.fillRect(0,0,a.WIDTH,a.HEIGHT),this.context.fillStyle=h.MS.FRAMES,this.context.fillRect(a.FRAMES.X,a.FRAMES.Y,a.FRAMES.WIDTH,a.FRAMES.HEIGHT),this.context.fillStyle=h.MS.DATAS;var t=this.ms.min==1/0?"":this.ms.min,e=this.ms.max==-(1/0)?"":this.ms.max;1==this.realTime?this.context.fillText(this.ms.current+" MS ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y):this.context.fillText(this.ms.value+" MS ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y);for(var i=0,r=this.ms.array.length;r>i;i++){var n=this.ms.array[i]/this.ms.max*a.FRAMES.HEIGHT||0,o=a.FRAMES.X+i,s=a.FRAMES.Y+a.FRAMES.HEIGHT-n;this.context.fillRect(o,s,1,n)}}else if(this.mode==l.MB){this.context.fillStyle=h.MB.BACKGROUND,this.context.fillRect(0,0,a.WIDTH,a.HEIGHT),this.context.fillStyle=h.MB.FRAMES,this.context.fillRect(a.FRAMES.X,a.FRAMES.Y,a.FRAMES.WIDTH,a.FRAMES.HEIGHT),this.context.fillStyle=h.MB.DATAS;var t=this.mb.min==1/0?"":this.mb.min,e=this.mb.max==-(1/0)?"":this.mb.max;1==this.realTime?this.context.fillText(this.mb.current+" MB ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y):this.context.fillText(this.mb.value+" MB ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y);for(var i=0,r=this.mb.array.length;r>i;i++){var n=this.mb.array[i]/this.mb.max*a.FRAMES.HEIGHT||0,o=a.FRAMES.X+i,s=a.FRAMES.Y+a.FRAMES.HEIGHT-n;this.context.fillRect(o,s,1,n)}}else if(this.mode==l.PING){this.context.fillStyle=h.PING.BACKGROUND,this.context.fillRect(0,0,a.WIDTH,a.HEIGHT),this.context.fillStyle=h.PING.FRAMES,this.context.fillRect(a.FRAMES.X,a.FRAMES.Y,a.FRAMES.WIDTH,a.FRAMES.HEIGHT),this.context.fillStyle=h.PING.DATAS;var t=this.ping.min==1/0?"":this.ping.min,e=this.ping.max==-(1/0)?"":this.ping.max;1==this.realTime?this.context.fillText(this.ping.current+" PING ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y):this.context.fillText(this.ping.value+" PING ("+t+"-"+e+")",a.TEXT.X,a.TEXT.Y);for(var i=0,r=this.ping.array.length;r>i;i++){var n=this.ping.array[i]/this.ping.max*a.FRAMES.HEIGHT||0,o=a.FRAMES.X+i,s=a.FRAMES.Y+a.FRAMES.HEIGHT-n;
this.context.fillRect(o,s,1,n)}}}},o.methods.initialize.prototype=o.methods,i(27)instanceof Function&&void 0!=i(28)?(r=function(){return o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))):"undefined"!=typeof t&&t.exports?t.exports=o:void 0!=n&&(n.Stats=o)}(this||{})},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,i){var r;r=function(t,e,r){var n=i(14),o=i(30),s=function(){this.disabled=!1,this.preload=!0,this.currentSound=null,this.sounds={},this.groups={},this.globalVolume=1,this.isMuted=!1,window.onfocus=this._onFocus.bind(this),this.onMuteToggle=new n};s.prototype._onFocus=function(){this.isMuted?this.mute():this.unmute()},s.prototype.addSound=function(t,e,i){if(!this.disabled&&!this.sounds[e]){i=i||{};var r=new Howl({urls:[t+".mp3",t+".ogg"],autoplay:i.autoplay||!1,loop:i.loop||!1,volume:i.volume||1});r.realVolume=i.volume||1,this.sounds[e]=r}},s.prototype.addSounds=function(t,e){for(var i=0;i<t.length;i++){var r=t[i];this.addSound(e+r,r)}},s.prototype.addGroup=function(t,e){if(!this.disabled&&!this.groups[e]){var i={index:0,type:0,sounds:t};this.groups[e]=i}},s.prototype.getSoundAtId=function(t){return this.sounds[t]},s.prototype.getSound=function(t){return this.currentSound},s.prototype.play=function(t,e){return this.disabled||!this.sounds[t]?void!this.sounds[t]:(e&&this.sounds[t].volume(e),this.sounds[t].play(),this.currentSound=this.sounds[t],this.currentSound)},s.prototype.fadeTo=function(t,e,i){if("undefined"==typeof i&&(i=2.5),"undefined"==typeof callback&&(callback=null),"undefined"!=typeof e){var r=this.sounds[t];r&&TweenLite.to(r,i,{_volume:e,onUpdate:this.actuallyChangeVolume.bind(this),onComplete:this.stopAndReset.bind(this),onCompleteParams:[t],onUpdateParams:["{self}",t]})}},s.prototype.actuallyChangeVolume=function(t,e){this.setVolume(e,t.target._volume)},s.prototype.stopAndReset=function(t){this.stop(t),this.setVolume(t,1),this.stop(t)},s.prototype.isPlaying=function(t){return this.disabled?void 0:!this.sounds[t]._audioNode[0].paused},s.prototype.playGroup=function(t){if(!this.disabled&&this.groups[t]){var e=this.groups[t],i=Math.random()*e.sounds.length|0;this.sounds[e.sounds[i]].play(),this.currentSound=this.sounds[e.sounds[i]]}},s.prototype.setVolume=function(t,e){if(!this.disabled){var i=this.sounds[t];i.realVolume=e,i.volume(e*this.globalVolume)}},s.prototype.stop=function(t){!this.disabled&&this.sounds[t]&&this.sounds[t].stop()},s.prototype.stopAll=function(){if(!this.disabled)for(var t in this.sounds)this.sounds[t].stop()},s.prototype.setPlaybackSpeed=function(t,e){if(!this.disabled){var i=this.sounds[t];i._playbackSpeed=e;var r="music"==t?0:1;i._webAudio&&Howler._howls[r]._audioNode[0]&&(Howler._howls[r]._audioNode[0].bufferSource.playbackRate.value=e)}},s.prototype.getPlaybackSpeed=function(t){if(!this.disabled){var e=this.sounds[t];return e._playbackSpeed||1}},s.prototype.setGlobalVolume=function(t){this.globalVolume=t;for(var e in this.sounds){var i=this.sounds[e];i.volume(i.realVolume*t)}},s.prototype.mute=function(){this.isMuted=!0,Howler.mute(),this.onMuteToggle.dispatch(!0)},s.prototype.unmute=function(){this.isMuted=!1,Howler.unmute(),this.onMuteToggle.dispatch(!1)},s.prototype.check=function(){this.lastSeen=Date.now();var t=function(){lastSeen=Date.now(),setTimeout(t,50)};t();var i=document.getElementById("music");i.addEventListener("timeupdate",function(){Date.now()-e.lastSeen>100&&this.pause()},!1)},s.sfx=new s,s.music=new s,s.sfx.disabled=!Howler.usingWebAudio,o.onHide.add(Howler.mute,Howler),o.onShow.add(function(){s.sfx.isMuted||Howler.unmute()}),r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(14),o=function(){"undefined"!=typeof document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.onHide=new n,this.onShow=new n,this.init()};o.prototype.handleVisibilityChange=function(){document[this.hidden]?this.onHide.dispatch():this.onShow.dispatch()},o.prototype.init=function(){document.addEventListener(this.visibilityChange,this.handleVisibilityChange.bind(this),!1)},r.exports=new o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e){t.exports={SCREEN_ID:{TITLE:"TITLE",INSTRUCTIONS:"INSTRUCTIONS",COUNTRY_SELECT:"COUNTRY_SELECT",TEAM_SELECT:"TEAM_SELECT",TOURNAMENT:"TOURNAMENT",GAME:"GAME",GAMEOVER:"GAMEOVER",SUCCEED:"SUCCEED",FAIL:"FAIL",LEADERBOARD:"LEADERBOARD"},OVERLAY_ID:{INSTRUCTIONS:"INSTRUCTIONS",PAUSE:"PAUSE",QUIT:"QUIT",EMPTY:"EMPTY"},MESSAGE_ID:{VS:"VS",WHISTLE:"WHISTLE",GOAL:"GOAL",SCORE:"SCORE"}}},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(20),s=(i(21),i(23)),a=(i(33),i(14)),h=i(34),l=i(35),c=i(18),u=function(t){n.Container.call(this),this.app=t,this.count=0,t.loader.onProgress.add(this.onProgress,this),this.easeLoad=0,this.targetLoad=0,this.onReady=new a,this.onComplete=new a,this.transition=new c,this.onAssetsLoaded()};u.prototype=Object.create(n.Container.prototype),u.prototype.constructor=u,u.prototype.onShown=function(){},u.prototype.onAssetsLoaded=function(){this.container=new n.Container,this.barBg=new n.Sprite.fromImage(ASSET_URL+"img/loader/loader-bar.png"),this.barBg.anchor.set(.5,.5),this.barFill=new n.Sprite.fromImage(ASSET_URL+"img/loader/loader-fill.png"),this.barFill.anchor.set(.5,.5),this.barW=494,this.barH=70,this.barMask=new n.Graphics,this.barMask.lineStyle(0),this.barMask.beginFill(16711680,1),this.barMask.moveTo(0,0),this.barMask.lineTo(this.barW,0),this.barMask.lineTo(this.barW,this.barH),this.barMask.lineTo(0,this.barH),this.barMask.scale.x=0,this.barFill.mask=this.barMask,this.barFrame=new n.Sprite.fromImage(ASSET_URL+"img/loader/loader-frame.png"),this.barFrame.anchor.set(.5,.5),this.label=new l,this.container.addChild(this.barBg),this.container.addChild(this.barFill),this.container.addChild(this.barMask),this.container.addChild(this.barFrame),this.container.addChild(this.label),o.instance.add(this.update,this),this.addChild(this.container),this.resize(this.w,this.h),s.wait(this.showLoader.bind(this))},u.prototype.showLoader=function(){TweenLite.to(this.app.background,.6,{alpha:1,ease:Sine.easeOut}),this.app.resize(this.app.w,this.app.h),this.app.loader.load()},u.prototype.update=function(){this.count+=.02,this.easeLoad+=.3*(this.targetLoad-this.easeLoad),this.barMask.scale.x=this.easeLoad,this.label.setText(h.loader.loading.replace("##",Math.ceil(100*this.easeLoad))),this.easeLoad>.99&&(o.instance.remove(this.update,this),this.onComplete.dispatch())},u.prototype.onProgress=function(t){this.targetLoad=t},u.prototype.onShow=function(){},u.prototype.onHide=function(){o.instance.remove(this.update,this)},u.prototype.resize=function(t,e){this.w=t,this.h=e,this.barBg.position.set(this.app.safeSize.width/2,this.app.safeSize.height/2),this.barFill.position.set(this.app.safeSize.width/2,this.app.safeSize.height/2),this.barMask.position.set((this.app.safeSize.width-this.barW)/2,(this.app.safeSize.height-this.barH)/2),this.barFrame.position.set(this.app.safeSize.width/2,this.app.safeSize.height/2),this.label.position.set(this.app.safeSize.width/2,this.app.safeSize.height/2)},r.exports=u}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o={};o.trimTexture=function(t,e,i,r,n){e=e||0,i=i||0,r=r||0,n=n||0;var o=t._frame;o.x+=e,o.y+=r,o.width-=e+i,o.height-=r+n,t.frame=o,t._updateUvs()},o.getTexturesFromFrames=function(t){for(var e=[],i=0;i<t.length;i++)e.push(new n.Texture.fromFrame(t[i]));return e},o.getTexturesFromImages=function(t){for(var e=[],i=0;i<t.length;i++)e.push(new n.Texture.fromImage(t[i]));return e},o.getTexturesFromFramesWithPrefix=function(t,e,i,r){var o=[];void 0==i&&(i=0);for(var s=0;e>s;s++){var a=s+i,h=t.replace("%%",10>a?"0"+a:a);if(r)var h=t.replace("%%",a);o.push(new n.Texture.fromFrame(h))}return o},o.formatTime=function(t){if(999999===t)return"00:00:00";var t=t/.06,e=t/60/1e3|0;t-=60*e*1e3;var i=t/1e3|0;t-=1e3*i;var r=t/10|0;return t-=10*r,(10>e?"0":"")+e+":"+(10>i?"0":"")+i+":"+(10>r?"0":"")+r},o.formatTimeSeconds=function(t){if(999999===t)return"00:00";var t=t/.06,e=t/60/1e3|0;t-=60*e*1e3;var i=t/1e3|0;return t-=1e3*i,(10>e?"0":"")+e+":"+(10>i?"0":"")+i},o.pad=function(t,e){var i="0000"+t;return i.substr(i.length-e)},o.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[i],t[i]=r}return t},o.formatScore=function(t){for(var e=t.toString().split(""),i="",r=e.length,n=r%3-1,o=0;r>o;o++)i+=e[o],(o-n)%3==0&&o!=r-1&&(i+=",");return i},o.formatNumber=function(t){if(ones=t%10,tens=Math.floor(t/10)%10,1==tens)return t+"th";switch(ones){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd";default:return t+"th"}},o.formatName=function(t){for(var e=t.split(" "),i=e.length-1;i>=0;i--)0!==e[i].length&&(wordArray=e[i].split(""),wordArray[0]=wordArray[0].toUpperCase(),e[i]=wordArray.join(""));return word=e.join(" "),word},window.console||(window.console={log:function(t){}}),o.get_query=function(t){for(var e=location.href,i=e.substring(e.indexOf("?")+1).split("&"),r=0,n={};r<i.length;r++)i[r]=i[r].split("="),n[i[r][0]]=decodeURIComponent(i[r][1]);return n.hasOwnProperty(t)?n[t]:!1},o.toCamelCase=function(t){var e=/\s([a-z]|[A-Z])/,i=t.trim();return i=i.toLowerCase(),i=i.replace(e,function(t,e){return e.toUpperCase()})},o.defaults=function(t,e){t=t||{};for(var i in e)i in t||(t[i]=e[i]);return t},o.fitText=o.resizeText=function(t,e,i,r){r=r||"w",t.scale.set(1),i&&(t.text=i);var n=0;n="w"===r?e/t.width:e/t.height,n>1&&(n=1),t.scale.set(n)},o.resizeMultipleTexts=function(t,e,i){for(var r=0;r<t.length;r++){var n=t[r];n.scale.set(1)}var o=0;if(i)for(var r=0;r<t.length;r++){var n=t[r];n.text=i[r]}for(var r=0;r<t.length;r++){var n=t[r];n.width>o&&(o=n.width)}var s=e/o;s>1&&(s=1);for(var r=0;r<t.length;r++)t[r].scale.set(s)},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e){var i={loader:{loading:"STR_LOADER_LOADING"},sponsor:{path:"img/sponsor/main-menu-sponsor.jpg",url:"www.google.co.uk"},title_screen:{logo:"img/localisation/logo.png",quick_play:"STR_TITLE_QUICKPLAY",tournament:"STR_TITLE_TOURNAMENT",leaderboard:"STR_TITLE_LEADERBOARD",updateBrowser:"STR_BROWSER_SUPPORT"},country_select_screen:{title:"STR_COUNTRY_SELECT_TITLE",toolTip:"STR_COUNTRY_RANKING"},instructions_screen:{title:"STR_INSTRUCTIONS_TITLE",movement:"STR_INSTRUCTIONS_MOVEMENT",tackle:"STR_INSTRUCTIONS_TACKLE",shortPass:"STR_INSTRUCTIONS_PASS",specialShot:"STR_INSTRUCTIONS_SHOT",tackleKey:"Z",specialShotKey:"X"},team_select_screen:{title:"STR_TEAM_SELECT_TITLE",captain:"STR_TEAM_SELECT_CAPTAIN",players:"STR_TEAM_SELECT_PLAYERS"},tournament_screen:{title:"STR_TOURNAMENT_TITLE",stages:{quarter:"STR_TOURNAMENT_QUARTERS",semi:"STR_TOURNAMENT_SEMI","final":"STR_TOURNAMENT_FINALS",winner:"STR_TOURNAMENT_WINNER"}},gameover_screen:{title:"STR_GAMEOVER_TITLE"},leaderboard_screen:{title:"STR_LEADERBOARD_TITLE"},game_screen:{goal:"STR_GAME_GOAL",goldenGoal:"STR_GAME_GOLDEN_GOAL"},succeed_screen:{title:"STR_GAME_WIN"},fail_screen:{title:"STR_GAME_FAIL"},pause_overlay:{title:"STR_PAUSED"},quit_overlay:{title:"STR_QUIT"},countries:{AFR:{ID:"AFR",SCORE_ID:25,NAME:"STR_COUNTRY_AFRICA",FLAG:"all-stars-africa-flag.png"},EUR:{ID:"EUR",SCORE_ID:24,NAME:"STR_COUNTRY_EUR",FLAG:"all-stars-euro-flags.png"},MEA:{ID:"MEA",SCORE_ID:22,NAME:"STR_COUNTRY_MEA",FLAG:"all-stars-middle-east-flag.png"},WRD:{ID:"WRD",SCORE_ID:23,NAME:"STR_COUNTRY_WRD",FLAG:"all-stars-world-flag.png"},BG:{ID:"BG",SCORE_ID:1,NAME:"STR_COUNTRY_BULGARIA",FLAG:"bulgaria-flag.png"},DK:{ID:"DK",SCORE_ID:3,NAME:"STR_COUNTRY_DENMARK",FLAG:"denmark-flag.png"},EG:{ID:"EG",SCORE_ID:20,NAME:"STR_COUNTRY_EGYPT",FLAG:"egypt-flag.png"},FR:{ID:"FR",SCORE_ID:6,NAME:"STR_COUNTRY_FRANCE",FLAG:"france-flag.png"},DE:{ID:"DE",SCORE_ID:2,NAME:"STR_COUNTRY_GERMANY",FLAG:"germany-flag.png"},DZ:{ID:"DZ",SCORE_ID:18,NAME:"STR_COUNTRY_ALGERIA",FLAG:"algeria-flag.png"},HU:{ID:"HU",SCORE_ID:7,NAME:"STR_COUNTRY_HUNGARY",FLAG:"hungary-flag.png"},IT:{ID:"IT",SCORE_ID:8,NAME:"STR_COUNTRY_ITALY",FLAG:"italy-flag.png"},NL:{ID:"NL",SCORE_ID:9,NAME:"STR_COUNTRY_NETHERLANDS",FLAG:"netherlands-flag.png"},NO:{ID:"NO",SCORE_ID:10,NAME:"STR_COUNTRY_NORWAY",FLAG:"norway-flag.png"},PL:{ID:"PL",SCORE_ID:11,NAME:"STR_COUNTRY_POLAND",FLAG:"poland-flag.png"},PT:{ID:"PT",SCORE_ID:12,NAME:"STR_COUNTRY_PORTUGAL",FLAG:"portugal-flag.png"},RO:{ID:"RO",SCORE_ID:13,NAME:"STR_COUNTRY_ROMANIA",FLAG:"romania-flag.png"},RU:{ID:"RU",SCORE_ID:14,NAME:"STR_COUNTRY_RUSSIA",FLAG:"russia-flag.png"},SA:{ID:"SA",SCORE_ID:21,NAME:"STR_COUNTRY_SAUDI_ARABIA",FLAG:"saudi-arabia-flag.png"},ZA:{ID:"ZA",SCORE_ID:16,NAME:"STR_COUNTRY_SOUTH_AFRICA",FLAG:"south-africa-flag.png"},ES:{ID:"ES",SCORE_ID:5,NAME:"STR_COUNTRY_SPAIN",FLAG:"spain-flag.png"},SE:{ID:"SE",SCORE_ID:15,NAME:"STR_COUNTRY_SWEDEN",FLAG:"sweden-flag.png"},TR:{ID:"TR",SCORE_ID:17,NAME:"STR_COUNTRY_TURKEY",FLAG:"turkey-flag.png"},AE:{ID:"AE",SCORE_ID:26,NAME:"STR_COUNTRY_EMIRATES",FLAG:"uae-flag.png"},GB:{ID:"GB",SCORE_ID:4,NAME:"STR_COUNTRY_UNITED_KINGDOM",FLAG:"uk-flag.png"}}};t.exports=i},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=function(t,e){n.Container.call(this),this.bg=n.Sprite.from(e),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.label=new n.Text("",{fill:"white",font:"28px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"}),this.label.anchor.set(.5,.5),this.addChild(this.label),this.setText(t)};o.prototype=Object.create(n.Container.prototype),o.prototype.setText=function(t){this.label.scale.set(1),this.label.text="undefined"!=typeof t?t:"",this.label.updateText();var e=.9*this.bg.width/this.label.width;e=Math.min(e,1),this.label.scale.set(e)},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(37)),s=(i(38),i(41)),a=i(45),h=i(21),l=i(46),c=i(31),u=i(34),p=i(48),d=i(49),f=i(47),m=i(15),g=function(t){n.Container.call(this),this.app=t,this.party=new d(1136,800,1),this.addChild(this.party),this.bg=new n.Container,this.addChild(this.bg);var e=m.getJson("config").config.LOCALE;this.local=e,this.logo=n.Sprite.from(ASSET_URL+u.title_screen.logo),this.logo.anchor.set(.5,.5),this.playButton=new s("quickplay-normal.png","quickplay-hover.png","quickplay-hover.png",u.title_screen.quick_play,1.1),this.playButton.defaultScale=1,this.playButton.onPress.add(this.onPlayButtonPressed,this),this.addChild(this.playButton),this.tournamentButton=new s("tournament-normal.png","tournament-hover.png","tournament-hover.png",u.title_screen.tournament,1.1),this.tournamentButton.defaultScale=1,this.tournamentButton.onPress.add(this.onTournamentButtonPressed,this),this.addChild(this.tournamentButton),this.leaderboardButton=new s("leaderboard-normal.png","leaderboard-hover.png","leaderboard-hover.png",u.title_screen.leaderboard,1.1),this.leaderboardButton.defaultScale=1,this.leaderboardButton.onPress.add(this.onLeaderboardButtonPressed,this),this.addChild(this.leaderboardButton),this.flash=new p,this.characters=[];for(var i=-1!==["_it","_uk","_bg","_da","_de","_fr","_nl","_no","_sv"].indexOf(e),r=layouts[e]||layouts.defualt,o=0;o<r.length;o++){4==o&&this.bg.addChild(this.logo);var h=r[o],l=n.Sprite.from(h.id);l.anchor.set(.5),l.scale.set(0),l.home=h.pos,l.count=a.random(-30,30),l.wobbleSpeed=a.random(.05,.1),l.scaleWobble=h.scaleWobble,l.moveSpeed=a.random(.05,.2),l.yRange=h.yRange,l.moveCount=a.random(-30,30),this.characters.push(l),this.bg.addChild(l)}this.ball=n.Sprite.fromFrame("logo_ball.png"),this.ball.anchor.set(.5,.5),this.ball.position.set(-86,-23),this.ballShadow=n.Sprite.fromFrame("logo_ball_shadow.png"),this.ballShadow.anchor.set(.5,.5),this.ballShadow.position.set(-86,-23),i&&(this.logo.addChild(this.ball),this.logo.addChild(this.ballShadow)),this.ballAnim(),this.pos=new n.Point,this.chars=new n.Container,this.chars.addChild((new n.Graphics).beginFill(16777215).drawRect(-1e3,-1e3,2e3,2e3));var c=0;for(var o in f){var g=f[o],v="blue",y=g.spriteSheet.replace("%COLOR%",v),x=m.getJson("character-animation")[y],_=new n.Sprite.from(x.stand[0]);this.chars.addChild(_),_.anchor.x=0,_.anchor.y=.87;_.texture;c++,_.x=50*c,_.y=300}if(!window.WEBGL){this.removeChild(this.playButton),this.removeChild(this.tournamentButton),this.removeChild(this.leaderboardButton);var b=new n.Text(u.title_screen.updateBrowser,{fill:"white",font:"28px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"});b.anchor.set(.5,.5),this.label=b,this.addChild(b)}};g.prototype=Object.create(n.Container.prototype),g.prototype.ballAnim=function(){this.ball.rotation=Math.PI/180,TweenLite.to(this.ball,2,{rotation:360*Math.PI/180,ease:Linear.easeNone,onComplete:this.ballAnim,onCompleteScope:this})},g.prototype.goBackToMainSite=function(){window.location.href="http://www.disney.co.uk"},g.prototype.onPlayButtonPressed=function(){this.startGame(!1)},g.prototype.onTournamentButtonPressed=function(){this.startGame(!0)},g.prototype.onLeaderboardButtonPressed=function(){this.screenManager.gotoScreenByID(c.SCREEN_ID.LEADERBOARD)},g.prototype.startGame=function(t){h.instance.android&&(document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.webkitRequestFullScreen&&document.body.webkitRequestFullScreen()),l.difficulty=0,l.isTournament=t===!0,this.screenManager.gotoScreenByID(c.SCREEN_ID.COUNTRY_SELECT)},g.prototype.onShow=function(){TweenLite.to(this.app.background,.4,{alpha:1}),o.play("menumusic2"),this.party.visible=!1,this.logo.scale.set(0),this.playButton.scale.set(0),this.tournamentButton.scale.set(0),this.leaderboardButton.scale.set(0),this.app.topMenu.normalMode();for(var t=0;t<this.bg.children.length;t++)if(4!=t){var e=this.bg.children[t];TweenLite.to(e.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.4+.01*t}),TweenLite.to(e.position,1,{x:e.home.x,y:e.home.y,ease:Elastic.easeOut,delay:.4+.01*t})}TweenLite.delayedCall(.4,function(){this.flash.flash(.2,1),this.playButton.scale.set(.5),this.tournamentButton.scale.set(.5),this.leaderboardButton.scale.set(.5),this.party.visible=!0}.bind(this));var i="_ru"===this.local?1.5:1;TweenLite.to(this.logo.scale,1,{x:i,y:i,ease:Elastic.easeOut,delay:.2}),TweenLite.to(this.playButton.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.4}),TweenLite.to(this.tournamentButton.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.4}),TweenLite.to(this.leaderboardButton.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.4})},g.prototype.onShown=function(){},g.prototype.updateTransform=function(){this.party.update(this.pos),this.containerUpdateTransform();for(var t=0;t<this.characters.length;t++){var e=this.characters[t];e.count+=e.wobbleSpeed,e.moveCount+=e.moveSpeed,e.y=e.home.y+Math.sin(e.moveCount)*e.yRange}},g.prototype.resize=function(t,e){h.instance.isMobile?(this.position.y=e/2-372.5-40,this.bg.position.set(t/2,360),this.playButton.position.set(250,575),this.tournamentButton.position.set(t/2,575),this.leaderboardButton.position.set(t-250,575),this.label&&this.label.position.set(t/2,625)):(this.position.y=e/2-372.5-40,this.bg.position.set(t/2,400),this.playButton.position.set(250,675),this.tournamentButton.position.set(t/2,675),this.leaderboardButton.position.set(t-250,675),this.label&&this.label.position.set(t/2,675)),this.flash.resize(t,e)};var v=[{id:"title_bears.png",pos:{x:-58.5,y:-63},scaleWobble:.05,yRange:10},{id:"title_blossom.png",pos:{x:198,y:-108},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-337.25,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:247.5,y:27},scaleWobble:.01,yRange:5}],y=[{id:"title_bears.png",pos:{x:-58.5,y:-63},scaleWobble:.05,yRange:10},{id:"title_blossom.png",pos:{x:270,y:-108},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-337.25,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:310.5,y:27},scaleWobble:.01,yRange:5}],x=[{id:"title_bears.png",pos:{x:-58.5,y:-81},scaleWobble:.05,yRange:4},{id:"title_blossom.png",pos:{x:207,y:-108},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-337.25,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:301.5,y:27},scaleWobble:.01,yRange:5}],_=[{id:"title_bears.png",pos:{x:22.5,y:-81},scaleWobble:.05,yRange:4},{id:"title_blossom.png",pos:{x:202.5,y:-63},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-289.75,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:315,y:27},scaleWobble:.01,yRange:5}],b=[{id:"title_bears.png",pos:{x:-76.5,y:-99},scaleWobble:.05,yRange:4},{id:"title_blossom.png",pos:{x:216,y:-63},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-337.25,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:297,y:63},scaleWobble:.01,yRange:5}],w=[{id:"title_bears.png",pos:{x:58.5,y:-63},scaleWobble:.05,yRange:10},{id:"title_blossom.png",pos:{x:234,y:-72},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-232.75,y:-112.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:337.5,y:27},scaleWobble:.01,yRange:5}],S=[{id:"title_bears.png",pos:{x:-58.5,y:-72},scaleWobble:.05,yRange:4},{id:"title_blossom.png",pos:{x:207,y:-135},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-337.25,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:310.5,y:27},scaleWobble:.01,yRange:5}],T=[{id:"title_bears.png",pos:{x:-58.5,y:-108},scaleWobble:.05,yRange:10},{id:"title_blossom.png",pos:{x:234,y:-108},scaleWobble:.025,yRange:5},{id:"title_buttercup.png",pos:{x:-337.25,y:-85.5},scaleWobble:.025,yRange:5},{id:"title_finn.png",pos:{x:-283.5,y:90},scaleWobble:.015,yRange:5},{id:"title_gumball.png",pos:{x:301.5,y:27},scaleWobble:.01,yRange:5}];layouts={defualt:v,_tr:y,_ru:x,_ro:_,_pt:b,_pl:w,_es:T,_hu:S},r.exports=g}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(14),o=i(29),s=function(t){this.disabled=o.music.disabled,this.music=o.music,this.currentSound=null,this.newSound=null,this.onFade=new n,this.globalVolume=1,this.volume=1,this.fadeInDuration=1,this.fadeOutDuration=1,this.music.onMuteToggle.add(this.onMusicToggle,this)};s.prototype.init=function(t){this.volume=t.volume||1,this.fadeInDuration=t.fadeInDuration||3.2,this.fadeOutDuration=t.fadeOutDuration||3.5},s.prototype.add=function(t,e){o.music.addSound(t,e,{loop:!0})},s.prototype.play=function(t){var e=this.music.sounds[t];!this.disabled&&e&&this.currentSound!==e&&(this.currentSound&&this.currentSound.fadeOut(0,this.fadeOutDuration),this.currentSound=e,this.currentSound.fadeIn(this.volume,this.fadeInDuration))},s.prototype.onMusicToggle=function(t){},s.prototype.setVolume=function(t,e){this.disabled||(t.realVolume=e,t.volume(e*this.globalVolume))},s.prototype.isPlaying=function(t){return this.disabled?void 0:!this.sounds[t]._audioNode[0].paused},r.exports=new s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(39)),o=i(41),s=i(42),a=i(44),h={small:function(t){var e=new n("big-button-up.png","big-button-over.png","big-button-over.png",t?t:null,.85);return e.defaultScale=.75,e.scale.set(.75),e},big:function(t){var e=new n("big-button-up.png","big-button-over.png","big-button-over.png",t?t:null,1.1);return e.defaultScale=1,e},label:function(t){var e=new o("big-button-up.png","big-button-over.png","big-button-over.png",t);return e.defaultScale=1,e.pressSound="button_press2",e},country:function(t){var e=new s(null,null,null,t,null,"transparent-pixel.png","flag-white-border.png");return e},character:function(t){var e=new a(null,null,null,t.profile,null,t.isCaptain?"blue-pixel.png":"orange-pixel.png",null,null,t.available);return e},sponsor:function(t,e){var i=new n("sponsor-background.png",null,null,null);return i.defaultScale=1,i.interactive=!1,i},close:function(t){var e=new n("big-button-up.png","big-button-over.png","big-button-over.png",t?t:null);return e.defaultScale=1,e}};r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(40),s=i(29),a=function(t,e,i,r,s){o.call(this),this.isOnlyIcon=!0,this.scaleVal="undefined"!=typeof s?s:null,this.pressSound="button_press",this.rollSound="button_roll",t&&(this.background=new n.Sprite.fromFrame(t),this.background.anchor.set(.5),this.addChild(this.background),this.isOnlyIcon=!1),this.normalTexture=t,this.downTexture=e||this.normalTexture,this.hoverTexture=i||this.normalTexture,r&&(this.icon=new n.Sprite.fromFrame(r),this.icon.anchor.set(.5),this.addChild(this.icon)),this.onDown.add(this._onDown,this),this.onUp.add(this._onUp,this),this.onHover.add(this._onHover,this),this.onOut.add(this._onMouseOut,this),this.onEnabled.add(this._onEnabled,this),this.onDisabled.add(this._onDisabled,this),this._soundDirty=!0};a.prototype=Object.create(o.prototype),a.prototype._onDown=function(){this.isOnlyIcon||(this.background.texture=n.Texture.fromFrame(this.downTexture))},a.prototype._onHover=function(){this.isOnlyIcon||(this._soundDirty&&(this._soundDirty=!1,s.sfx.play(this.rollSound)),this.background.texture=n.Texture.fromFrame(this.hoverTexture),null!==this.scaleVal&&(TweenLite.to(this.scale,.3,{x:this.scaleVal,y:this.scaleVal,ease:Linear.None}),TweenLite.to(this,.2,{rotation:-5*Math.PI/180,ease:Linear.None})))},a.prototype._onMouseOut=function(){this.isOnlyIcon||(this._soundDirty||TweenLite.delayedCall(.4,function(){this._soundDirty=!0}.bind(this)),this.background.texture=n.Texture.fromFrame(this.normalTexture),null!==this.scaleVal&&(TweenLite.to(this.scale,.3,{x:this.defaultScale,y:this.defaultScale,ease:Linear.None}),TweenLite.to(this,.3,{rotation:0,ease:Linear.None})))},a.prototype._onUp=function(){this.isOnlyIcon||(s.sfx.play(this.pressSound),this.background.texture=n.Texture.fromFrame(this.hoverTexture))},a.prototype._onEnabled=function(){o.prototype.enable.call(this)},a.prototype._onDisabled=function(){o.prototype.disable.call(this)},a.prototype.setIcon=function(t){this.icon.texture=n.Texture.fromFrame(t)},a.prototype.setSize=function(t){this.defaultScale=t,this.overScale=1.1*t},a.prototype.fromFrames=function(t,e,i,r){return new a(n.Texture.fromFrame(t),n.Texture.fromFrame(e),n.Texture.fromFrame(i),r?n.Texture.fromFrame(r):null)},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=function(){n.Container.call(this),this.onPress=new o,this.onDown=new o,this.onUp=new o,this.onHover=new o,this.onOut=new o,this.onEnabled=new o,this.onDisabled=new o,this.mousedown=this.touchstart=this.onDown.dispatch.bind(this,this),this.mouseup=this.touchend=this.onUp.dispatch.bind(this,this),this.click=this.tap=this.onPress.dispatch.bind(this,this),this.mouseover=this.onHover.dispatch.bind(this,this),this.touchendoutside=this.mouseupoutside=this.mouseout=this.onOut.dispatch.bind(this,this),this.onDown.add(this.down,this),this.onUp.add(this.up,this),this.onHover.add(this.hover,this),this.onOut.add(this.out,this),this.onEnabled.add(this.enable,this),this.onDisabled.add(this.disable,this),this._scale=new n.Point,this.enable(),this.setSize()};s.prototype=Object.create(n.Container.prototype),s.prototype.constructor=s,s.prototype.setSize=function(t){switch(t){case"small":this.scale.set(.5);break;case"big":this.scale.set(2);break;default:this.scale.set(1)}},s.prototype.enable=function(){this.interactive=!0,this.buttonMode=!0,TweenLite.to(this,.3,{alpha:1,ease:Linear.None})},s.prototype.disable=function(){this.interactive=!1,this.buttonMode=!1,TweenLite.to(this,.3,{alpha:.5,ease:Linear.None})},s.prototype.down=function(t,e){},s.prototype.up=function(t,e){},s.prototype.hover=function(t,e){},s.prototype.out=function(t,e){},s.prototype.show=function(){this.visible=!0,this.enable()},s.prototype.hide=function(){this.disable(),this.visible=!1},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(39),o=function(t,e,i,r,o){n.call(this,t,e,i,null,o);var s={fill:"white",font:"38px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"};this.label=new PIXI.Text(r,s),this.label.anchor.set(.5),this.addChild(this.label);var a=.9*this.background.width/this.label.width;a=Math.min(1,a),this.label.scale.set(a)};o.prototype=Object.create(n.prototype),r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(43),s=(i(14),function(t,e,i,r,s,a,h,l,c){o.call(this,t,e,i,r,s,l,c),this.borderTexture=a,this.borderTextureSelected=h||this.borderTexture,this.borderSprite=new n.Sprite.fromFrame(a),this.borderSprite.anchor.set(.5),this.addChild(this.borderSprite)});s.prototype=Object.create(o.prototype),s.prototype.toggleIcon=function(t){o.prototype.toggleIcon.call(this);var e=t===!0;e?TweenLite.to(this.scale,.3,{x:1.3,y:1.3,ease:Linear.None}):TweenLite.to(this.scale,.3,{x:1,y:1,ease:Linear.None}),this.borderTextureSelected&&(this.borderSprite.texture=n.Texture.fromFrame(e?this.borderTextureSelected:this.borderTexture))},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(39),s=i(14),a=i(29),h=function(t,e,i,r,n,a,h){o.call(this,t,e,i,r),this.iconTexture=r,this.iconTextureSelected,"undefined"!=typeof n&&(this.iconTextureSelected=n),this.selected=a===!0,this.enabled=this.enabledInit=h!==!1,this.onSelected=new s,this.onHover2=new s,this.onMouseOut=new s,this.toggleIcon(this.selected),this.setEnabled(this.enabled)};h.prototype=Object.create(o.prototype),h.prototype.setEnabled=function(t){this.enabled=t!==!1,this.enabled?o.prototype._onEnabled.call(this):o.prototype._onDisabled.call(this)},h.prototype.toggleIcon=function(t){var e=t===!0;this.iconTextureSelected&&(this.icon.texture=n.Texture.fromFrame(e?this.iconTextureSelected:this.iconTexture))},h.prototype._onDown=function(){this.selected=!this.selected,this.onSelected.dispatch(this),this.toggleIcon(this.selected),a.sfx.play("button_press"),o.prototype._onDown.call(this)},h.prototype._onHover=function(){this.toggleIcon(!0),this._soundDirty=!0,a.sfx.play("button_roll"),this.onHover2.dispatch(this)},h.prototype._onMouseOut=function(){this.onMouseOut.dispatch(this),this.toggleIcon(this.selected),o.prototype._onMouseOut.call(this)},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(43),s=(i(14),function(t,e,i,r,s,a,h,l,c){this.borderTexture=a,this.borderTextureSelected=h,this.multiplier=Math.pow(-1,Math.floor(2*Math.random())),this.borderSprite=new n.Sprite.fromFrame(a),this.borderSprite.anchor.set(.5),o.call(this,t,e,i,r,s,l,c),this.addChildAt(this.borderSprite,0)});s.prototype=Object.create(o.prototype),s.prototype.toggleIcon=function(t){o.prototype.toggleIcon.call(this);var e=t===!0;e?(TweenLite.to(this.scale,.3,{x:1.1,y:1.1,ease:Back.easeOut}),TweenLite.to(this,.2,{rotation:5*this.multiplier*Math.PI/180,ease:Back.easeOut})):(TweenLite.to(this.scale,.3,{x:1,y:1,ease:Linear.None}),TweenLite.to(this,.2,{rotation:0,ease:Linear.None})),this.borderTextureSelected?this.borderSprite.texture=n.Texture.fromFrame(e?this.borderTextureSelected:this.borderTexture):e?TweenLite.to(this.borderSprite.scale,.3,{x:1.1,y:1.1,ease:Back.easeOut}):TweenLite.to(this.borderSprite.scale,.3,{
x:1,y:1,ease:Back.easeOut})},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r={};r.TWO_PI=2*Math.PI,r.random=function(t,e){return t=t||0,e=void 0===e?1:e,t+Math.random()*(e-t)},r.randomInt=function(t,e){return t+Math.random()*(e-t)|0},r.randomSeed=function(t,e,i){min=t,max=e,i=i||1,i=(9301*i+49297)%233280;var r=i/233280;return min+r*(max-min)},r.randomChance=function(t,e){return r.randomSeed(0,1,e)>t},r.cap=function(t,e,i){return e>t?e:t>i?i:t},r.sign=function(t){return 0>t?-1:t>0?1:0},r.randomSign=function(t){return Math.random()<(t||.5)?-1:1},r.randomChoice=function(t,e){return Math.random()<.5?t:e},r.map=function(t,e,i,r,n){return(n-r)*((t-e)/(i-e))+r},r.smallestAngle=function(t,e){t%=2*Math.PI,0>t&&(t+=2*Math.PI);var i=e-t,r=e+2*Math.PI-t,n=e-2*Math.PI-t,o=Math.abs(i),s=Math.abs(r),a=Math.abs(n),h=i;return o>s&&a>s?h=r:o>a&&s>a&&(h=n),h},r.wrap=function(t,e,i){var r=i-e;return t-=e,t%=r,0>t&&(t+=r),t+=e},r.floor=function(t,e){return(t/e|0)*e},r.round=function(t,e){return Math.round(t/e)*e},r.ceil=function(t,e){return Math.ceil(t/e)*e},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r=i(47),n=(i(31),function(){var t=r;this.teamA=[t.jake,t.gumball,t.finn],this.teamB=[t.darwin,t.anais,t.princess_bubblegum],this.leftOverPlayers=[],this.autoSwitch=!0,this.isMuted=!1,this.isTournament=!1,this.countryID={ID:"MEA",NAME:"MIDDLE EAST\nALL STARS",FLAG:"all-stars-middle-east-flag.png"},this.opponentID={ID:"WRD",NAME:"WORLD\nALL STARS",FLAG:"all-stars-world-flag.png"},this.tournamentData={quarter:[],semi:[],"final":[],winner:[]},this.difficulty=0,this.matchResult={goalsA:-1,goalsB:-1}});t.exports=new n},function(t,e){var i={anais:{id:"anais",available:!0,isCaptain:!1,scale:1,skill:.3,power:.2,speed:.3,profile:"anais-78x78.jpg",sad:"img/game/characters/characters-win-lose/anais-lose.png",happy:"img/game/characters/characters-win-lose/anais-win.png",spriteSheet:"anais_%COLOR%.json"},blossom:{id:"blossom",available:!0,isCaptain:!1,scale:1,skill:.3,power:.3,speed:.3,profile:"blossom-78x78.jpg",sad:"img/game/characters/characters-win-lose/blossom-lose.png",happy:"img/game/characters/characters-win-lose/blossom-win.png",spriteSheet:"blossom_%COLOR%.json"},bmo:{id:"bmo",available:!0,isCaptain:!1,scale:.9,skill:.3,power:.2,speed:.4,profile:"bmo-78x78.jpg",sad:"img/game/characters/characters-win-lose/bmo-lose.png",happy:"img/game/characters/characters-win-lose/bmo-win.png",spriteSheet:"bmo_%COLOR%.json"},bubbles:{id:"bubbles",available:!0,isCaptain:!1,scale:1,skill:.2,power:.3,speed:.3,profile:"bubbles-78x78.jpg",sad:"img/game/characters/characters-win-lose/bubbles-lose.png",happy:"img/game/characters/characters-win-lose/bubbles-win.png",spriteSheet:"bubbles_%COLOR%.json"},buttercup:{id:"buttercup",available:!0,isCaptain:!0,scale:1,skill:.3,power:.5,speed:.4,profile:"buttercup-78x78.jpg",sad:"img/game/characters/characters-win-lose/buttercup-lose.png",happy:"img/game/characters/characters-win-lose/buttercup-win.png","super":"super_shot_buttercup_red.png",spriteSheet:"buttercup_%COLOR%.json"},darwin:{id:"darwin",available:!0,isCaptain:!1,scale:.9,skill:.3,power:.2,speed:.4,profile:"darwin-78x78.jpg",sad:"img/game/characters/characters-win-lose/darwin-lose.png",happy:"img/game/characters/characters-win-lose/darwin-win.png",spriteSheet:"darwin_%COLOR%.json"},finn:{id:"finn",available:!0,isCaptain:!0,scale:.8,skill:.3,power:.4,speed:.4,profile:"finn-78x78.jpg",sad:"img/game/characters/characters-win-lose/finn-lose.png",happy:"img/game/characters/characters-win-lose/finn-win.png","super":"super_shot_finn_red.png",spriteSheet:"finn_%COLOR%.json"},grizz_bear:{id:"grizz_bear",available:!0,isCaptain:!1,scale:1.1,skill:.4,power:.2,speed:.2,profile:"grizz-bear.jpg",sad:"img/game/characters/characters-win-lose/grizz_bear-lose.png",happy:"img/game/characters/characters-win-lose/grizz_bear-win.png",spriteSheet:"grizz_%COLOR%.json"},gumball:{id:"gumball",available:!0,isCaptain:!0,scale:1,skill:.3,power:.3,speed:.5,profile:"gumball-78x78.jpg",sad:"img/game/characters/characters-win-lose/gumball-lose.png",happy:"img/game/characters/characters-win-lose/gumball-win.png","super":"super_shot_gumball_red.png",spriteSheet:"gumball_%COLOR%.json"},ice_bear:{id:"ice_bear",available:!0,isCaptain:!1,scale:1.1,skill:.5,power:.3,speed:.2,profile:"ice-bear-78x78.jpg",sad:"img/game/characters/characters-win-lose/ice_bear-lose.png",happy:"img/game/characters/characters-win-lose/ice_bear-win.png",spriteSheet:"ice-bear_%COLOR%.json"},jake:{id:"jake",available:!0,isCaptain:!1,scale:1,skill:.3,power:.3,speed:.2,profile:"jake-78x78.jpg",sad:"img/game/characters/characters-win-lose/jake-lose.png",happy:"img/game/characters/characters-win-lose/jake-win.png",spriteSheet:"jake_%COLOR%.json"},marceline:{id:"marceline",available:!0,isCaptain:!1,scale:1,skill:.3,power:.4,speed:.2,profile:"marceline-78x78.jpg",sad:"img/game/characters/characters-win-lose/marceline-lose.png",happy:"img/game/characters/characters-win-lose/marceline-win.png",spriteSheet:"marceline_%COLOR%.json"},mojo:{id:"mojo",available:!0,isCaptain:!0,scale:.8,skill:.5,power:.4,speed:.3,profile:"mojo-78x78.jpg",sad:"img/game/characters/characters-win-lose/mojo-lose.png",happy:"img/game/characters/characters-win-lose/mojo-win.png","super":"super_shot_mojo_red.png",spriteSheet:"mojo_%COLOR%.json"},moredecai:{id:"moredecai",available:!0,isCaptain:!1,scale:.9,skill:.3,power:.2,speed:.4,profile:"moredecai-78x78.jpg",sad:"img/game/characters/characters-win-lose/moredecai-lose.png",happy:"img/game/characters/characters-win-lose/moredecai-win.png",spriteSheet:"moredecai_%COLOR%.json"},panda_bear:{id:"panda_bear",available:!0,isCaptain:!0,scale:1.1,skill:.4,power:.4,speed:.2,profile:"panda-bear-78x78.jpg",sad:"img/game/characters/characters-win-lose/panda_bear-lose.png",happy:"img/game/characters/characters-win-lose/panda_bear-win.png","super":"super_shot_panda_red.png",spriteSheet:"panda_%COLOR%.json"},princess_bubblegum:{id:"princess_bubblegum",available:!0,isCaptain:!0,scale:1,skill:.5,power:.2,speed:.4,profile:"princess-bubblegum-78x78.jpg",sad:"img/game/characters/characters-win-lose/princess_bubblegum-lose.png",happy:"img/game/characters/characters-win-lose/princess_bubblegum-win.png","super":"super_shot_princess_red.png",spriteSheet:"princess_%COLOR%.json"},richard:{id:"richard",available:!0,isCaptain:!1,scale:1.3,skill:.2,power:.5,speed:.1,profile:"richard-78x78.jpg",sad:"img/game/characters/characters-win-lose/richard-lose.png",happy:"img/game/characters/characters-win-lose/richard-win.png",spriteSheet:"richard_%COLOR%.json"},rigby:{id:"rigby",available:!0,isCaptain:!1,scale:1,skill:.2,power:.2,speed:.4,profile:"rigby-78x78.jpg",sad:"img/game/characters/characters-win-lose/rigby-lose.png",happy:"img/game/characters/characters-win-lose/rigby-win.png",spriteSheet:"rigby_%COLOR%.json"}};t.exports=i},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=function(t,e){n.Graphics.call(this),this.beginFill(16777215).drawRect(0,0,100,100),this.resize(t,e),this.alpha=0};o.prototype=Object.create(n.Graphics.prototype),o.prototype.flash=function(t,e){this.alpha=1,TweenLite.to(this,e||.5,{alpha:0,delay:t||0,ease:Expo.easeOut})},o.prototype.resize=function(t,e){this.scale.x=t/100,this.scale.y=t/100},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(50),s=i(21);PixiParty=function(t,e,i){n.Container.call(this),this.particals=[],this.particalPool=new o(ParticalTickerTape),this.max=n.isWebGL?150:5,this.overallScale=i||1,s.instance.isMobile&&(this.max=n.isWebGL?60:10),this.count=0,this.pos=0;for(var r=0;r<this.max;r++){var a=this.particalPool.getObject();a.home.x=-1136*Math.random(),a.position.y=a.home.y=110640*Math.random(),a.speed=new n.Point(Math.random()-.5,Math.random()+2),this.particals.push(a),this.addChild(a)}this.w=t||1136,this.h=e||740,this.focalLength=150},PixiParty.prototype=Object.create(n.Container.prototype),PixiParty.prototype.update=function(t){if(this.visible)for(var e=0;e<this.particals.length;e++){var i=this.particals[e],r=this.focalLength/(this.focalLength+i.z),r=this.focalLength/(this.focalLength+i.z);i.scale.x=i.scale.y=.2*r*i.scaleOffset*this.overallScale,i.home.x+=i.speed.x,i.home.y+=i.speed.y,i.position.y=(i.home.y-t.y)*r*.5,i.position.x=(i.home.x-t.x)*r*.5,i.scale.y*=Math.sin(2*i.rotation),i.position.x%=this.w,i.position.x<0&&(i.position.x+=this.w),i.position.y%=this.h,i.position.y<0&&(i.position.y+=this.h),i.rotation+=i.rotationSpeed}},PixiParty.prototype.resize=function(t){},ParticalTickerTape=function(){ParticalTicker.globalCount++,n.Sprite.call(this,n.Texture.fromFrame(ParticalTickerTape.frames[ParticalTicker.globalCount%6])),this.anchor.x=.5,this.anchor.y=.5,this.scaleOffset=1+Math.random(),this.z=-50+-50*Math.random(),this.rotation=Math.random()*Math.PI*2,this.rotationSpeed=.3*(Math.random()-.5),this.home=new n.Point},ParticalTickerTape.globalCount=0,ParticalTickerTape.frames=["confetti_yellow.png","confetti-blue.png","confetti-red.png","streamer-blue.png","streamer-red.png","streamer-yellow.png"],ParticalTickerTape.prototype=Object.create(n.Sprite.prototype),r.exports=PixiParty}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(t){this.classType=t,this.pool=[]};r.constructor=r,r.prototype.prepopulate=function(t){for(var e=0;t>e;e++)this.pool.push(new this.classType)},r.prototype.get=r.prototype.getObject=function(){var t=this.pool.pop();return t||(t=new this.classType),t},r.prototype["return"]=r.prototype.returnObject=function(t){this.pool.push(t)},Object.defineProperties(r.prototype,{total:{get:function(){return this.pool.length}},length:{get:function(){return this.pool.length}}}),r.pools=[],r.idGenerator=1,r.getPool=function(t){return t._CLASS_ID||(t._CLASS_ID=r.idGenerator++,r.pools[t._CLASS_ID]=new r(t)),r.pools[t._CLASS_ID]},r.get=r.getObject=function(t){t._CLASS_ID||(t._CLASS_ID=r.idGenerator++,r.pools[t._CLASS_ID]=new r(t));var e=r.pools[t._CLASS_ID].getObject();return e._CLASS_ID=t._CLASS_ID,e},r["return"]=r.returnObject=function(t){r.pools[t._CLASS_ID].returnObject(t)},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=(i(35),i(52)),a=(i(61),i(46)),h=(i(47),i(21),i(31)),l=i(34),c=(i(62),i(63),function(t){n.Container.call(this),this.app=t,this.bg=new s,this.bg.onNextButton.add(this.onNextButtonPressed,this),this.bg.onPreviousButton.add(this.onPreviousButtonPressed,this),this.addChild(this.bg),this.sponsorButton=o.sponsor("sponsor-background.png",l.sponsor.url),this.sponsorButton.position.set(0,200),this.bg.addChild(this.sponsorButton);var e=n.Sprite.from(ASSET_URL+l.sponsor.path);e.anchor.set(.5,.5),this.sponsorButton.addChild(e)});c.prototype=Object.create(n.Container.prototype),c.prototype.onPreviousButtonPressed=function(){a.isTournament?this.screenManager.gotoScreenByID(h.SCREEN_ID.TOURNAMENT):this.screenManager.gotoScreenByID(h.SCREEN_ID.TEAM_SELECT)},c.prototype.onNextButtonPressed=function(){this.screenManager.gotoScreenByID(h.SCREEN_ID.GAME)},c.prototype.onShow=function(){this.bg.scale.set(0),this.app.topMenu.normalMode(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},c.prototype.onShown=function(){},c.prototype.resize=function(t,e){this.position.y=e/2-372.5-40,this.bg.position.set(t/2,440)},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(53)),s=i(15),a=i(35),h=(i(31),i(34)),l=(i(46),i(14)),c=i(33),u=i(60),p=i(21);InstructionsBaseScreen=function(t){n.Container.call(this),this.hasNextButton=t!==!1,this.mobile=!p.instance.desktop,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-player-select-and-tournament.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.panelBg=n.Sprite.from(ASSET_URL+"img/ui/instructions-panel.png"),this.panelBg.anchor.set(.5,.5),this.panelBg.position.set(0,-40),this.bg.addChild(this.panelBg),this.title=new a(h.instructions_screen.title,"title-bar-long.png"),this.title.position.set(0,-275),this.bg.addChild(this.title),this.onNextButton=new l,this.onPreviousButton=new l;var e={fill:"white",font:"16px "+window.MAIN_FONT};if(this.movementLabel=new n.Text(h.instructions_screen.movement,e),this.movementLabel.anchor.set(.5),this.movementLabel.position.set(-275,-195),this.bg.addChild(this.movementLabel),this.tackleLabel=new n.Text(h.instructions_screen.tackle,e),this.tackleLabel.anchor.set(.5),this.tackleLabel.position.set(0,-195),this.tackleLabel.alpha=0,this.bg.addChild(this.tackleLabel),TweenLite.to(this.tackleLabel,.5,{alpha:1,ease:Linear.None,delay:2,onCompleteScope:this,onComplete:this.tackleAnimCompleted}),this.shortPassLabel=new n.Text(h.instructions_screen.shortPass,e),this.shortPassLabel.anchor.set(.5),this.shortPassLabel.position.set(0,-195),this.bg.addChild(this.shortPassLabel),TweenLite.to(this.shortPassLabel,.5,{alpha:0,ease:Linear.None,delay:2}),this.specialShotLabel=new n.Text(h.instructions_screen.specialShot,e),this.specialShotLabel.anchor.set(.5),this.specialShotLabel.position.set(275,-195),this.bg.addChild(this.specialShotLabel),this.line=new n.Graphics,this.line.lineStyle(4,16777215).moveTo(0,0).lineTo(40,-140),this.line.x=-15,this.line.y=-10,this.addChild(this.line),this.movementKey=n.Sprite.fromFrame(this.mobile?"touch-button-background.png":"instructions-arrowkeys.png"),this.movementKey.anchor.set(.5,.5),this.movementKey.position.set(-285,50),this.bg.addChild(this.movementKey),this.mobile){var i=n.Sprite.fromFrame("touch-button-movement.png");i.anchor.set(.5),this.movementKey.icon=i,this.movementKey.addChild(i)}if(this.tackleKey=n.Sprite.fromFrame(this.mobile?"touch-button-blue.png":"instructions-button-off.png"),this.tackleKey.anchor.set(.5,.5),this.tackleKey.position.set(0,50),this.mobile){this.tackleKey.scale.set(.75);var i=n.Sprite.fromFrame("touch-icon-pass.png");i.anchor.set(.5),this.tackleKey.addChild(i),this.tackleKey.y+=15}this.bg.addChild(this.tackleKey);var e={fill:"black",font:"20px lubalin",align:"center"},r=s.getJson("config").config.LOCALE,d="z";"_fr"===r?d="w":"_de"===r&&(d="y");var f=new n.Text(d,e);if(f.anchor.set(.5,.5),f.position.set(2,-2),this.mobile||this.tackleKey.addChild(f),this.specialShotKey=n.Sprite.fromFrame(this.mobile?"touch-button-yellow.png":"instructions-button-off.png"),this.specialShotKey.anchor.set(.5,.5),this.specialShotKey.position.set(285,50),this.bg.addChild(this.specialShotKey),this.mobile){this.specialShotKey.scale.set(.75);var i=n.Sprite.fromFrame("touch-icon-shoot.png");i.anchor.set(.5),this.specialShotKey.addChild(i),this.specialShotKey.y+=15}f=new n.Text(h.instructions_screen.specialShotKey,e),f.anchor.set(.5,.5),f.position.set(2,-2),this.specialShotKey.addChild(f),this.specialShotKey.text=f;var m=s.getJson("character-animation")["finn_blue.json"];this.movementAnim=new n.MovieClip(c.getTexturesFromFrames(m.run)),this.movementAnim.anchor.set(.5,.5),this.movementAnim.scale.set(.6),this.movementAnim.position.set(-275,-100),this.movementAnim.animationSpeed=.3,this.movementAnim.play(),this.bg.addChild(this.movementAnim),this.tackleAnim=new n.MovieClip(c.getTexturesFromFrames(m.tackle)),this.tackleAnim.anchor.set(.5,.5),this.tackleAnim.scale.set(.6),this.tackleAnim.position.set(-55,-100),this.tackleAnim.animationSpeed=.3,this.tackleAnim.play(),this.tackleAnim.alpha=0,this.bg.addChild(this.tackleAnim),TweenLite.to(this.tackleAnim,.5,{alpha:1,ease:Linear.None,delay:2}),this.shortPassAnim=new n.MovieClip(c.getTexturesFromFrames(m.kickCharge)),this.shortPassAnim.anchor.set(.5,.5),this.shortPassAnim.scale.set(.6),this.shortPassAnim.position.set(55,-100),this.shortPassAnim.animationSpeed=.3,this.shortPassAnim.alpha=0,this.shortPassAnim.play(),this.bg.addChild(this.shortPassAnim),TweenLite.to(this.shortPassAnim,.5,{alpha:1,ease:Linear.None,delay:2}),this.specialShotAnim=new n.MovieClip(c.getTexturesFromFrames(m.kickCharge)),this.specialShotAnim.anchor.set(.5,.5),this.specialShotAnim.scale.set(.6),this.specialShotAnim.position.set(275,-100),this.specialShotAnim.animationSpeed=.3,this.specialShotAnim.loop=!1,this.specialShotAnim.play(),this.bg.addChild(this.specialShotAnim),this.previousButton=o.big("icon-back.png"),this.previousButton.position.set(-370,200),this.previousButton.onPress.add(this.onPreviousButtonPressed,this),this.bg.addChild(this.previousButton),this.nextButton=o.big("icon-back.png"),this.nextButton.position.set(380,200),this.nextButton.icon.rotation=Math.PI,this.nextButton.onPress.add(this.onNextButtonPressed,this),this.hasNextButton&&this.bg.addChild(this.nextButton),this.chargeBar=new u,this.ratio=0,this.chargeBar.setSize(1),this.bg.addChild(this.chargeBar),this.chargeBar.show(),this.chargeBar.position.set(280,-10),this.count=0,this.step=0,this.tick=0,this.specialShotAnim.gotoAndStop(1)},InstructionsBaseScreen.prototype=Object.create(n.Container.prototype),InstructionsBaseScreen.prototype.updateTransform=function(){this.containerUpdateTransform(),this.mobile&&(this.tick+=.1,this.movementKey.icon.position.x=20*Math.sin(this.tick)),0===this.step?(this.ratio+=.01,this.chargeBar.setRatio(this.ratio),this.specialShotKey.texture=n.Texture.fromFrame(this.mobile?"touch-button-yellow-on.png":"instructions-button-on.png"),this.mobile&&this.specialShotKey.scale.set(.75*.95),this.specialShotKey.text.position.set(0,0),this.ratio>.75&&(this.step=1,this.count=0,this.specialShotAnim.play(),this.specialShotKey.texture=n.Texture.fromFrame(this.mobile?"touch-button-yellow.png":"instructions-button-off.png"),this.mobile&&this.specialShotKey.scale.set(.75),this.specialShotKey.text.position.set(2,-2))):1===this.step&&(this.count++,this.count>30&&(this.step=0,this.ratio=0,this.specialShotAnim.gotoAndStop(1)))},InstructionsBaseScreen.prototype.tackleAnimCompleted=function(){return},InstructionsBaseScreen.prototype.onPreviousButtonPressed=function(){this.onPreviousButton.dispatch()},InstructionsBaseScreen.prototype.onNextButtonPressed=function(){this.onNextButton.dispatch()},r.exports=InstructionsBaseScreen}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(54)),o=i(56),s=i(57),a=i(59),h={small:function(t){var e=new n("big-button-up.png","big-button-over.png","big-button-over.png",t?t:null,.85);return e.defaultScale=.75,e.scale.set(.75),e},big:function(t){var e=new n("big-button-up.png","big-button-over.png","big-button-over.png",t?t:null,1.1);return e.defaultScale=1,e},label:function(t){var e=new o("big-button-up.png","big-button-over.png","big-button-over.png",t);return e.defaultScale=1,e.pressSound="button_press2",e},country:function(t){var e=new s(null,null,null,t,null,"transparent-pixel.png","flag-white-border.png");return e},character:function(t){var e=new a(null,null,null,t.profile,null,t.isCaptain?"blue-pixel.png":"orange-pixel.png",null,null,t.available);return e},sponsor:function(t,e){var i=new n("sponsor-background.png",null,null,null);return i.defaultScale=1,i.interactive=!1,i},close:function(t){var e=new n("big-button-up.png","big-button-over.png","big-button-over.png",t?t:null);return e.defaultScale=1,e}};r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(55),s=i(29),a=function(t,e,i,r,s){o.call(this),this.isOnlyIcon=!0,this.scaleVal="undefined"!=typeof s?s:null,this.pressSound="button_press",this.rollSound="button_roll",t&&(this.background=new n.Sprite.fromFrame(t),this.background.anchor.set(.5),this.addChild(this.background),this.isOnlyIcon=!1),this.normalTexture=t,this.downTexture=e||this.normalTexture,this.hoverTexture=i||this.normalTexture,r&&(this.icon=new n.Sprite.fromFrame(r),this.icon.anchor.set(.5),this.addChild(this.icon)),this.onDown.add(this._onDown,this),this.onUp.add(this._onUp,this),this.onHover.add(this._onHover,this),this.onOut.add(this._onMouseOut,this),this.onEnabled.add(this._onEnabled,this),this.onDisabled.add(this._onDisabled,this),this._soundDirty=!0};a.prototype=Object.create(o.prototype),a.prototype._onDown=function(){this.isOnlyIcon||(this.background.texture=n.Texture.fromFrame(this.downTexture))},a.prototype._onHover=function(){this.isOnlyIcon||(this._soundDirty&&(this._soundDirty=!1,s.sfx.play(this.rollSound)),this.background.texture=n.Texture.fromFrame(this.hoverTexture),null!==this.scaleVal&&(TweenLite.to(this.scale,.3,{x:this.scaleVal,y:this.scaleVal,ease:Linear.None}),TweenLite.to(this,.2,{rotation:-5*Math.PI/180,ease:Linear.None})))},a.prototype._onMouseOut=function(){this.isOnlyIcon||(this._soundDirty||TweenLite.delayedCall(.4,function(){this._soundDirty=!0}.bind(this)),this.background.texture=n.Texture.fromFrame(this.normalTexture),null!==this.scaleVal&&(TweenLite.to(this.scale,.3,{x:this.defaultScale,y:this.defaultScale,ease:Linear.None}),TweenLite.to(this,.3,{rotation:0,ease:Linear.None})))},a.prototype._onUp=function(){this.isOnlyIcon||(s.sfx.play(this.pressSound),this.background.texture=n.Texture.fromFrame(this.hoverTexture))},a.prototype._onEnabled=function(){o.prototype.enable.call(this)},a.prototype._onDisabled=function(){o.prototype.disable.call(this)},a.prototype.setIcon=function(t){this.icon.texture=n.Texture.fromFrame(t)},a.prototype.setSize=function(t){this.defaultScale=t,this.overScale=1.1*t},a.prototype.fromFrames=function(t,e,i,r){return new a(n.Texture.fromFrame(t),n.Texture.fromFrame(e),n.Texture.fromFrame(i),r?n.Texture.fromFrame(r):null)},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=function(){n.Container.call(this),this.onPress=new o,this.onDown=new o,this.onUp=new o,this.onHover=new o,this.onOut=new o,this.onEnabled=new o,this.onDisabled=new o,this.mousedown=this.touchstart=this.onDown.dispatch.bind(this,this),this.mouseup=this.touchend=this.onUp.dispatch.bind(this,this),this.click=this.tap=this.onPress.dispatch.bind(this,this),this.mouseover=this.onHover.dispatch.bind(this,this),this.touchendoutside=this.mouseupoutside=this.mouseout=this.onOut.dispatch.bind(this,this),this.onDown.add(this.down,this),this.onUp.add(this.up,this),this.onHover.add(this.hover,this),this.onOut.add(this.out,this),this.onEnabled.add(this.enable,this),this.onDisabled.add(this.disable,this),this._scale=new n.Point,this.enable(),this.setSize()};s.prototype=Object.create(n.Container.prototype),s.prototype.constructor=s,s.prototype.setSize=function(t){switch(t){case"small":this.scale.set(.5);break;case"big":this.scale.set(2);break;default:this.scale.set(1)}},s.prototype.enable=function(){this.interactive=!0,this.buttonMode=!0,TweenLite.to(this,.3,{alpha:1,ease:Linear.None})},s.prototype.disable=function(){this.interactive=!1,this.buttonMode=!1,TweenLite.to(this,.3,{alpha:.5,ease:Linear.None})},s.prototype.down=function(t,e){},s.prototype.up=function(t,e){},s.prototype.hover=function(t,e){},s.prototype.out=function(t,e){},s.prototype.show=function(){this.visible=!0,this.enable()},s.prototype.hide=function(){this.disable(),this.visible=!1},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(54),o=function(t,e,i,r,o){n.call(this,t,e,i,null,o);var s={fill:"white",font:"38px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"};this.label=new PIXI.Text(r,s),this.label.anchor.set(.5),this.addChild(this.label);var a=.9*this.background.width/this.label.width;a=Math.min(1,a),this.label.scale.set(a)};o.prototype=Object.create(n.prototype),r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(58),s=(i(14),function(t,e,i,r,s,a,h,l,c){o.call(this,t,e,i,r,s,l,c),this.borderTexture=a,this.borderTextureSelected=h||this.borderTexture,this.borderSprite=new n.Sprite.fromFrame(a),this.borderSprite.anchor.set(.5),this.addChild(this.borderSprite)});s.prototype=Object.create(o.prototype),s.prototype.toggleIcon=function(t){o.prototype.toggleIcon.call(this);var e=t===!0;e?TweenLite.to(this.scale,.3,{x:1.3,y:1.3,ease:Linear.None}):TweenLite.to(this.scale,.3,{x:1,y:1,ease:Linear.None}),this.borderTextureSelected&&(this.borderSprite.texture=n.Texture.fromFrame(e?this.borderTextureSelected:this.borderTexture))},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(54),s=i(14),a=i(29),h=function(t,e,i,r,n,a,h){o.call(this,t,e,i,r),this.iconTexture=r,this.iconTextureSelected,"undefined"!=typeof n&&(this.iconTextureSelected=n),this.selected=a===!0,this.enabled=this.enabledInit=h!==!1,this.onSelected=new s,this.onHover2=new s,this.onMouseOut=new s,this.toggleIcon(this.selected),this.setEnabled(this.enabled)};h.prototype=Object.create(o.prototype),h.prototype.setEnabled=function(t){this.enabled=t!==!1,this.enabled?o.prototype._onEnabled.call(this):o.prototype._onDisabled.call(this)},h.prototype.toggleIcon=function(t){var e=t===!0;this.iconTextureSelected&&(this.icon.texture=n.Texture.fromFrame(e?this.iconTextureSelected:this.iconTexture))},h.prototype._onDown=function(){this.selected=!this.selected,this.onSelected.dispatch(this),this.toggleIcon(this.selected),a.sfx.play("button_press"),o.prototype._onDown.call(this)},h.prototype._onHover=function(){this.toggleIcon(!0),this._soundDirty=!0,a.sfx.play("button_roll"),this.onHover2.dispatch(this)},h.prototype._onMouseOut=function(){this.onMouseOut.dispatch(this),this.toggleIcon(this.selected),o.prototype._onMouseOut.call(this)},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(58),s=(i(14),function(t,e,i,r,s,a,h,l,c){this.borderTexture=a,this.borderTextureSelected=h,this.multiplier=Math.pow(-1,Math.floor(2*Math.random())),this.borderSprite=new n.Sprite.fromFrame(a),this.borderSprite.anchor.set(.5),o.call(this,t,e,i,r,s,l,c),this.addChildAt(this.borderSprite,0)});s.prototype=Object.create(o.prototype),s.prototype.toggleIcon=function(t){o.prototype.toggleIcon.call(this);var e=t===!0;e?(TweenLite.to(this.scale,.3,{x:1.1,y:1.1,ease:Back.easeOut}),TweenLite.to(this,.2,{rotation:5*this.multiplier*Math.PI/180,ease:Back.easeOut})):(TweenLite.to(this.scale,.3,{x:1,y:1,ease:Linear.None}),TweenLite.to(this,.2,{rotation:0,ease:Linear.None})),this.borderTextureSelected?this.borderSprite.texture=n.Texture.fromFrame(e?this.borderTextureSelected:this.borderTexture):e?TweenLite.to(this.borderSprite.scale,.3,{x:1.1,y:1.1,ease:Back.easeOut}):TweenLite.to(this.borderSprite.scale,.3,{x:1,y:1,ease:Back.easeOut})},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=function(){n.Container.call(this),this.bg=(new n.Graphics).beginFill(16777215).drawRect(0,-10,100,20),this.bar=(new n.Graphics).beginFill(16711680).drawRect(0,-10,100,20),this.sweetSpot=(new n.Graphics).beginFill(255).drawRect(0,-10,15,20),this.bg2=new n.Sprite.from("shoot_charge_bg.png"),this.bar2=new n.Sprite.from("shoot_charge_fill.png"),this.frame=new n.Sprite.from("shoot_charge_frame.png"),this.bar2.alpha=.5,this.addChild(this.bg2),this.addChild(this.bar2),this.addChild(this.frame),this.sweetSpot.position.x=75,this.min=0,this.max=0,this.hidden=!0,this.scale.y=0,this.visible=!1;var t=(new n.Graphics).beginFill(16711680).moveTo(5,7).lineTo(146,3).lineTo(141,38).lineTo(3,33);this.addChild(t),this.bar2.mask=t,this.setRatio(0),this.pivot.y=21,this.pivot.x=75,this.setSize(2)};o.prototype=Object.create(n.Container.prototype),o.prototype.setRatio=function(t){this.bar.scale.x=t,this.bar2.anchor.x=1-t},o.prototype.setSize=function(t){0===t?(this.bg2.texture=n.Texture.from("shoot_charge_bg_small.png"),this.min=91/143,this.max=107/143):1===t?(this.bg2.texture=n.Texture.from("shoot_charge_bg.png"),this.min=96/143,this.max=118/143):2===t&&(this.bg2.texture=n.Texture.from("shoot_charge_bg_large.png"),this.min=77/143,this.max=118/143)},o.prototype.show=function(){this.hidden&&(this.hidden=!1,this.visible=!0,this.rotation=Math.random(),TweenLite.to(this.scale,.3,{y:1,ease:Back.easeOut}),TweenLite.to(this,.5,{rotation:0,ease:Elastic.easeOut}))},o.prototype.hide=function(){this.hidden||(this.hidden=!0,TweenLite.to(this.scale,.3,{y:0,ease:Back.easeIn,onComplete:this.onHidden,onCompleteScope:this}))},o.prototype.onHidden=function(){this.visible=!1},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=function(t){n.Container.call(this),this.id=t,ie={id:4,name:"United Kingdom",total_wins:"5",total_loses:"0",total_points:"16",goal_difference:"15"};var e={fill:"white",font:"20px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round",dropShadow:!1},i=25,r=110;this.labelRank=new n.Text("",e),this.labelRank.anchor.set(0,0),this.addChild(this.labelRank),this.labelName=new n.Text("",e),this.labelName.position.set(i,0),this.addChild(this.labelName),i+=315,this.labelPoints=new n.Text("",e),this.labelPoints.anchor.set(0,0),this.labelPoints.position.set(i,0),this.addChild(this.labelPoints),i+=r,this.labelWins=new n.Text("",e),this.labelWins.anchor.set(0,0),this.labelWins.position.set(i,0),this.addChild(this.labelWins),i+=r,this.labelLoses=new n.Text("",e),this.labelLoses.anchor.set(0,0),this.labelLoses.position.set(i,0),this.addChild(this.labelLoses),i+=r,this.labelGoalDiff=new n.Text("",e),this.labelGoalDiff.anchor.set(0,0),this.labelGoalDiff.position.set(i,0),this.addChild(this.labelGoalDiff)};o.prototype=Object.create(n.Container.prototype),o.prototype.setData=function(t){this.data=t,this.labelRank.text=this.data.rank,this.labelName.text=this.data.name,this.labelPoints.text=this.data.total_points,this.labelWins.text=this.data.total_wins,this.labelLoses.text=this.data.total_loses,this.labelGoalDiff.text=this.data.goal_difference},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r={};r.shuffle=function(t){for(var e,i,r=t.length;0!==r;)i=Math.floor(Math.random()*r),r-=1,e=t[r],t[r]=t[i],t[i]=e;return t},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r=(i(64),i(65)),n=function(){this.targetFile="http://tooncup.teamgbaws.net/",this.sharedKey=null,this.lastEncryption=!1,this.defaultPerPage=20,this.defaultPageNumber=1,this.cachedResult=null};n.prototype.setSharedKey=function(t){this.sharedKey=t},n.prototype.getScores=function(t,e){var i=this.getRequest();this.cachedResult&&e?t&&t(this.cachedResult):(i.onload=function(e){this.cachedResult=JSON.parse(i.response),t&&t(this.cachedResult)}.bind(this),i.onreadystatechange=function(t){},i.open("GET",this.targetFile+"getScores",!0),i.send())},n.prototype.sendScore=function(t,e,i){var n=this.getRequest();n.onload=function(t){i&&i(JSON.parse(n.response))}.bind(this),n.onreadystatechange=function(t){};var o={id:t,gd:e},s=r.Ctr.encrypt(JSON.stringify(o),"S0Bwt275r192B1rPOokA8hu3EWoUHzNsFaYypUyU0BE",256);n.open("POST",this.targetFile+"scrsvc",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send("val="+s)},n.prototype.getRequest=function(){var t;return window.XDomainRequest&&this.crossdomain?(t=new window.XDomainRequest,t.timeout=3e3,t.onerror=function(){},t.ontimeout=function(){},t.onprogress=function(){}):window.XMLHttpRequest&&(t=new window.XMLHttpRequest),t},t.exports=new n},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(t){__WEBPACK_AMD_DEFINE_FACTORY__=t,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(function(){var win=window,limit=null,requests=0,request_stack=[],getXHR=function(){return win.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},version2=""===getXHR().responseType,qwest=function(method,url,data,options,before){data=data||null,options=options||{};
var typeSupported=!1,xhr=getXHR(),async=void 0===options.async?!0:!!options.async,cache=options.cache,type=options.type?options.type.toLowerCase():"json",user=options.user||"",password=options.password||"",headers={"X-Requested-With":"XMLHttpRequest"},accepts={xml:"application/xml, text/xml",html:"text/html",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},toUpper=function(t,e,i){return e+i.toUpperCase()},vars="",i,j,parseError="parseError",serialized,success_stack=[],error_stack=[],complete_stack=[],response,success,error,func,promises={success:function(t){return async?success_stack.push(t):success&&t.apply(xhr,[response]),promises},error:function(t){return async?error_stack.push(t):error&&t.apply(xhr,[response]),promises},complete:function(t){return async?complete_stack.push(t):t.apply(xhr),promises}},promises_limit={success:function(t){return request_stack[request_stack.length-1].success.push(t),promises_limit},error:function(t){return request_stack[request_stack.length-1].error.push(t),promises_limit},complete:function(t){return request_stack[request_stack.length-1].complete.push(t),promises_limit}},handleResponse=function(){var i,req,p;if(--requests,request_stack.length){for(req=request_stack.shift(),p=qwest(req.method,req.url,req.data,req.options,req.before),i=0;func=req.success[i];++i)p.success(func);for(i=0;func=req.error[i];++i)p.error(func);for(i=0;func=req.complete[i];++i)p.complete(func)}try{if(!/^2/.test(xhr.status))throw xhr.status+" ("+xhr.statusText+")";var responseText="responseText",responseXML="responseXML";if(typeSupported&&void 0!==xhr.response)response=xhr.response;else switch(type){case"json":try{response=win.JSON?win.JSON.parse(xhr[responseText]):eval("("+xhr[responseText]+")")}catch(e){throw"Error while parsing JSON body"}break;case"js":response=eval(xhr[responseText]);break;case"xml":if(!xhr[responseXML]||xhr[responseXML][parseError]&&xhr[responseXML][parseError].errorCode&&xhr[responseXML][parseError].reason)throw"Error while parsing XML body";response=xhr[responseXML];break;default:response=xhr[responseText]}if(success=!0,async)for(i=0;func=success_stack[i];++i)func.apply(xhr,[response])}catch(e){if(error=!0,response="Request to '"+url+"' aborted: "+e,async)for(i=0;func=error_stack[i];++i)func.apply(xhr,[response])}if(async)for(i=0;func=complete_stack[i];++i)func.apply(xhr)};if(limit&&requests==limit)return request_stack.push({method:method,url:url,data:data,options:options,before:before,success:[],error:[],complete:[]}),promises_limit;if(++requests,win.ArrayBuffer&&(data instanceof ArrayBuffer||data instanceof Blob||data instanceof Document||data instanceof FormData))"GET"==method&&(data=null);else{var values=[],enc=encodeURIComponent;for(i in data)void 0!==data[i]&&values.push(enc(i)+(data[i].pop?"[]":"")+"="+enc(data[i]));data=values.join("&"),serialized=!0}if("GET"==method&&(vars+=data),null==cache&&(cache="POST"==method),cache||(vars&&(vars+="&"),vars+="__t="+Date.now()),vars&&(url+=(/\?/.test(url)?"&":"?")+vars),xhr.open(method,url,async,user,password),type&&version2)try{xhr.responseType=type,typeSupported=xhr.responseType==type}catch(e){}version2?xhr.onload=handleResponse:xhr.onreadystatechange=function(){4==xhr.readyState&&handleResponse()};for(i in headers)j=i.replace(/(^|-)([^-])/g,toUpper),headers[j]=headers[i],delete headers[i],xhr.setRequestHeader(j,headers[j]);return!headers["Content-Type"]&&serialized&&"POST"==method&&xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),headers.Accept||xhr.setRequestHeader("Accept",accepts[type]),before&&before.apply(xhr),xhr.send("POST"==method?data:null),promises};return{get:function(t,e,i,r){return qwest("GET",t,e,i,r)},post:function(t,e,i,r){return qwest("POST",t,e,i,r)},xhr2:version2,limit:function(t){limit=t}}}())},function(t,e){var i={};i.cipher=function(t,e){for(var r=4,n=e.length/r-1,o=[[],[],[],[]],s=0;4*r>s;s++)o[s%4][Math.floor(s/4)]=t[s];o=i.addRoundKey(o,e,0,r);for(var a=1;n>a;a++)o=i.subBytes(o,r),o=i.shiftRows(o,r),o=i.mixColumns(o,r),o=i.addRoundKey(o,e,a,r);o=i.subBytes(o,r),o=i.shiftRows(o,r),o=i.addRoundKey(o,e,n,r);for(var h=new Array(4*r),s=0;4*r>s;s++)h[s]=o[s%4][Math.floor(s/4)];return h},i.keyExpansion=function(t){for(var e=4,r=t.length/4,n=r+6,o=new Array(e*(n+1)),s=new Array(4),a=0;r>a;a++){var h=[t[4*a],t[4*a+1],t[4*a+2],t[4*a+3]];o[a]=h}for(var a=r;e*(n+1)>a;a++){o[a]=new Array(4);for(var l=0;4>l;l++)s[l]=o[a-1][l];if(a%r==0){s=i.subWord(i.rotWord(s));for(var l=0;4>l;l++)s[l]^=i.rCon[a/r][l]}else r>6&&a%r==4&&(s=i.subWord(s));for(var l=0;4>l;l++)o[a][l]=o[a-r][l]^s[l]}return o},i.subBytes=function(t,e){for(var r=0;4>r;r++)for(var n=0;e>n;n++)t[r][n]=i.sBox[t[r][n]];return t},i.shiftRows=function(t,e){for(var i=new Array(4),r=1;4>r;r++){for(var n=0;4>n;n++)i[n]=t[r][(n+r)%e];for(var n=0;4>n;n++)t[r][n]=i[n]}return t},i.mixColumns=function(t,e){for(var i=0;4>i;i++){for(var r=new Array(4),n=new Array(4),o=0;4>o;o++)r[o]=t[o][i],n[o]=128&t[o][i]?t[o][i]<<1^283:t[o][i]<<1;t[0][i]=n[0]^r[1]^n[1]^r[2]^r[3],t[1][i]=r[0]^n[1]^r[2]^n[2]^r[3],t[2][i]=r[0]^r[1]^n[2]^r[3]^n[3],t[3][i]=r[0]^n[0]^r[1]^r[2]^n[3]}return t},i.addRoundKey=function(t,e,i,r){for(var n=0;4>n;n++)for(var o=0;r>o;o++)t[n][o]^=e[4*i+o][n];return t},i.subWord=function(t){for(var e=0;4>e;e++)t[e]=i.sBox[t[e]];return t},i.rotWord=function(t){for(var e=t[0],i=0;3>i;i++)t[i]=t[i+1];return t[3]=e,t},i.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],i.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],i.Ctr={},i.Ctr.encrypt=function(t,e,o){var s=16;if(128!=o&&192!=o&&256!=o)return"";t=n.encode(t),e=n.encode(e);for(var a=o/8,h=new Array(a),l=0;a>l;l++)h[l]=isNaN(e.charCodeAt(l))?0:e.charCodeAt(l);var c=i.cipher(h,i.keyExpansion(h));c=c.concat(c.slice(0,a-16));for(var u=new Array(s),p=(new Date).getTime(),d=p%1e3,f=Math.floor(p/1e3),m=Math.floor(65535*Math.random()),l=0;2>l;l++)u[l]=d>>>8*l&255;for(var l=0;2>l;l++)u[l+2]=m>>>8*l&255;for(var l=0;4>l;l++)u[l+4]=f>>>8*l&255;for(var g="",l=0;8>l;l++)g+=String.fromCharCode(u[l]);for(var v=i.keyExpansion(c),y=Math.ceil(t.length/s),x=new Array(y),_=0;y>_;_++){for(var b=0;4>b;b++)u[15-b]=_>>>8*b&255;for(var b=0;4>b;b++)u[15-b-4]=_/4294967296>>>8*b;for(var w=i.cipher(u,v),S=y-1>_?s:(t.length-1)%s+1,T=new Array(S),l=0;S>l;l++)T[l]=w[l]^t.charCodeAt(_*s+l),T[l]=String.fromCharCode(T[l]);x[_]=T.join("")}var M=g+x.join("");return M=r.encode(M)},i.Ctr.decrypt=function(t,e,o){var s=16;if(128!=o&&192!=o&&256!=o)return"";t=r.decode(t),e=n.encode(e);for(var a=o/8,h=new Array(a),l=0;a>l;l++)h[l]=isNaN(e.charCodeAt(l))?0:e.charCodeAt(l);var c=i.cipher(h,i.keyExpansion(h));c=c.concat(c.slice(0,a-16));var u=new Array(8);ctrTxt=t.slice(0,8);for(var l=0;8>l;l++)u[l]=ctrTxt.charCodeAt(l);for(var p=i.keyExpansion(c),d=Math.ceil((t.length-8)/s),f=new Array(d),m=0;d>m;m++)f[m]=t.slice(8+m*s,8+m*s+s);t=f;for(var g=new Array(t.length),m=0;d>m;m++){for(var v=0;4>v;v++)u[15-v]=m>>>8*v&255;for(var v=0;4>v;v++)u[15-v-4]=(m+1)/4294967296-1>>>8*v&255;for(var y=i.cipher(u,p),x=new Array(t[m].length),l=0;l<t[m].length;l++)x[l]=y[l]^t[m].charCodeAt(l),x[l]=String.fromCharCode(x[l]);g[m]=x.join("")}var _=g.join("");return _=n.decode(_)};var r={};r.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r.encode=function(t,e){e="undefined"==typeof e?!1:e;var i,n,o,s,a,h,l,c,u,p,d,f=[],m="",g=r.code;if(p=e?t.encodeUTF8():t,u=p.length%3,u>0)for(;u++<3;)m+="=",p+="\x00";for(u=0;u<p.length;u+=3)i=p.charCodeAt(u),n=p.charCodeAt(u+1),o=p.charCodeAt(u+2),s=i<<16|n<<8|o,a=s>>18&63,h=s>>12&63,l=s>>6&63,c=63&s,f[u/3]=g.charAt(a)+g.charAt(h)+g.charAt(l)+g.charAt(c);return d=f.join(""),d=d.slice(0,d.length-m.length)+m},r.decode=function(t,e){e="undefined"==typeof e?!1:e;var i,n,o,s,a,h,l,c,u,p,d=[],f=r.code;p=e?t.decodeUTF8():t;for(var m=0;m<p.length;m+=4)s=f.indexOf(p.charAt(m)),a=f.indexOf(p.charAt(m+1)),h=f.indexOf(p.charAt(m+2)),l=f.indexOf(p.charAt(m+3)),c=s<<18|a<<12|h<<6|l,i=c>>>16&255,n=c>>>8&255,o=255&c,d[m/4]=String.fromCharCode(i,n,o),64==l&&(d[m/4]=String.fromCharCode(i,n)),64==h&&(d[m/4]=String.fromCharCode(i));return u=d.join(""),e?u.decodeUTF8():u};var n={};n.encode=function(t){var e=t.replace(/[\u0080-\u07ff]/g,function(t){var e=t.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)});return e=e.replace(/[\u0800-\uffff]/g,function(t){var e=t.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},n.decode=function(t){var e=t.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(t){var e=(15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2);return String.fromCharCode(e)});return e=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(t){var e=(31&t.charCodeAt(0))<<6|63&t.charCodeAt(1);return String.fromCharCode(e)})},t.exports=i},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=i(67),a=i(68),h=i(35),l=i(46),c=(i(21),i(31)),u=i(34),p=i(63),d=function(t){n.Container.call(this),this.app=t,this.ranking=[],this.scaleRatio=.75,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-player-select-and-tournament.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new h(u.country_select_screen.title,"title-bar-long.png"),this.title.position.set(0,-275),this.bg.addChild(this.title),this.flagsContainer=new n.Container,this.flagsContainer.scale.set(this.scaleRatio),this.bg.addChild(this.flagsContainer),this.countryList=[[u.countries.BG,u.countries.FR,u.countries.NO,u.countries.SE,u.countries.SA],[u.countries.DE,u.countries.DZ,u.countries.PL,u.countries.ZA,u.countries.MEA],[u.countries.DK,u.countries.HU,u.countries.PT,u.countries.AE,u.countries.WRD],[u.countries.GB,u.countries.IT,u.countries.RO,u.countries.EG,u.countries.EUR],[u.countries.ES,u.countries.NL,u.countries.RU,u.countries.TR,u.countries.AFR]],this.buttonList=[];var e,i,r=new n.Point(36/this.scaleRatio,17/this.scaleRatio);for(var l in this.countryList)for(var c in this.countryList[l])e=this.countryList[l][c],i=o.country(e.FLAG),i.id=e.ID,i.position.x=i.width/2+(i.width+r.x)*c,i.position.y=i.height/2+(i.height+r.y)*l,i.onPress.add(this.onCountryButtonPressed,this),i.onHover2.add(this.onCountryButtonHover,this),i.onMouseOut.add(this.onCountryButtonMouseOut,this),this.flagsContainer.addChild(i),this.buttonList.push(i);var p={w:(this.countryList[0].length*(i.width+r.x)-r.x)*this.scaleRatio,h:(this.countryList.length*(i.height+r.y)-r.y)*this.scaleRatio};this.flagsContainer.position.set(p.w/-2,p.h/-2-35),this.countryGroup=new s(this.buttonList,1),this.sponsorButton=o.sponsor("sponsor-background.png",u.sponsor.url),this.sponsorButton.position.set(0,200),this.bg.addChild(this.sponsorButton);var d=n.Sprite.from(ASSET_URL+u.sponsor.path);d.anchor.set(.5,.5),this.sponsorButton.addChild(d),this.previousButton=o.big("icon-back.png"),this.previousButton.position.set(-370,200),this.previousButton.onPress.add(this.onPreviousButtonPressed,this),this.bg.addChild(this.previousButton),this.nextButton=o.big("icon-back.png"),this.nextButton.position.set(380,200),this.nextButton.icon.rotation=Math.PI,this.nextButton.disable(),this.nextButton.onPress.add(this.onNextButtonPressed,this),this.toolTip=new a,this.bg.addChild(this.toolTip)};d.prototype=Object.create(n.Container.prototype),d.prototype.onPreviousButtonPressed=function(t){this.screenManager.gotoScreenByID(c.SCREEN_ID.TITLE)},d.prototype.onNextButtonPressed=function(t){this.screenManager.gotoScreenByID(c.SCREEN_ID.TEAM_SELECT)},d.prototype.onCountryButtonPressed=function(t){t.selected?(l.countryID=u.countries[t.id],this.onNextButtonPressed()):l.countryID=null},d.prototype.onCountryButtonHover=function(t){var e={name:u.countries[t.id].NAME,label:u.country_select_screen.toolTip,ranking:this.getRank(u.countries[t.id].SCORE_ID)},i={x:t.position.x*this.scaleRatio+this.flagsContainer.position.x,y:(t.position.y+t.height/2)*this.scaleRatio+this.flagsContainer.position.y};TweenLite.to(this.toolTip.position,.25,{x:i.x,y:i.y,ease:Linear.None}),this.toolTip.show(e)},d.prototype.onCountryButtonMouseOut=function(t){this.toolTip.hide()},d.prototype.getRank=function(t){var e=0;for(var i in this.ranking)if(Number(this.ranking[i].id)==t)return e=this.ranking[i].rank;return e},d.prototype.onShow=function(){p.getScores(function(t){this.ranking=t}.bind(this),!0),this.bg.scale.set(0),this.app.topMenu.normalMode(),this.countryGroup.reset(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},d.prototype.onShown=function(){},d.prototype.resize=function(t,e){this.position.y=e/2-372.5-40,this.bg.position.set(t/2,440)},r.exports=d}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=function(t,e,i){n.Container.call(this),this.buttonList=t,this.maxSelected=e,this.autoLock=i===!0,this.onUpdate=new o,this.selectedList=[];for(var r in this.buttonList){var s=this.buttonList[r];s.selected&&this.selectedList.length<e&&this.selectedList.push(s),s.onSelected.add(this.updateButtons,this)}};s.prototype=Object.create(n.Container.prototype),s.prototype.setLock=function(t){for(var e in this.buttonList){var i=this.buttonList[e];t===!1&&i.enabledInit===!0?i.enable():i.selected===!1&&i.disable()}},s.prototype.reset=function(){for(var t in this.buttonList){var e=this.buttonList[t];e.selected===!0&&e._onDown()}},s.prototype.updateButtons=function(t){if(t.selected){if(this.selectedList.length>=this.maxSelected){var e=this.selectedList.shift();e._onDown()}this.selectedList.push(t)}else{var i=this.selectedList.indexOf(t);i>-1&&this.selectedList.splice(i,1)}this.autoLock&&this.setLock(this.selectedList.length>=this.maxSelected),this.onUpdate.dispatch(this.selectedList.length>=this.maxSelected,t)},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(34),function(t,e){n.Container.call(this),this.data="undefined"!=typeof t?t:{name:"",label:"",ranking:""},this.alpha=0,this.bg=n.Sprite.fromFrame("country-select-popup.png"),this.bg.anchor.set(.5,0),this.addChild(this.bg),this.name=new n.Text(this.data.name.replace("\n"," "),{fill:"black",font:"20px "+window.MAIN_FONT,align:"center"}),this.name.anchor.set(.5,0),this.name.position.y=30,this.addChild(this.name),this.label=new n.Text(this.data.label,{fill:"white",font:"20px "+window.MAIN_FONT,align:"left"}),this.label.position.set(this.bg.width/-2+15,75),this.addChild(this.label),this.ranking=new n.Text(this.data.ranking,{fill:"white",font:"20px "+window.MAIN_FONT,align:"right"}),this.ranking.anchor.set(1,0),this.ranking.position.set(this.bg.width/2-15,75),this.addChild(this.ranking),e===!0&&this.show(this.data)});o.prototype=Object.create(n.Container.prototype),o.prototype.show=function(t){this.data=t,this.name.scale.set(1),this.name.text=this.data.name.replace("\n"," ").replace("\n"," ");var e=.9*this.bg.width/this.name.width;e=Math.min(1,e),this.name.scale.set(e),this.label.text=t.label,this.ranking.text=""+t.ranking,TweenLite.to(this,.1,{alpha:1,ease:Linear.None})},o.prototype.hide=function(){TweenLite.to(this,.1,{alpha:0,ease:Linear.None})},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=i(67),a=i(35),h=i(70),l=i(46),c=i(47),u=(i(21),i(31)),p=i(34),d=i(62),f=function(t){n.Container.call(this),this.app=t,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-player-select-and-tournament.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new a(p.team_select_screen.title,"title-bar-long.png"),this.title.position.set(0,-275),this.bg.addChild(this.title),this.itemContainer=new n.Container,this.bg.addChild(this.itemContainer);var e,i,r,l,u=new n.Point(0,15),d=new n.Point(10,15),f={width:78,height:78};this.teamContainer=new n.Container,this.itemContainer.addChild(this.teamContainer);var m=new n.Sprite.fromFrame("stats-panel-pitch.jpg");this.teamContainer.addChild(m),this.teamList=[];var g;for(r=0;3>r;r++)g=new h,g.position.set(d.x+u.x,d.y+(g.height+u.y)*r),g.onRemoved.add(this.onCharacterRemoved,this),this.teamContainer.addChild(g),this.teamList.push(g);u=new n.Point(15,15),d=new n.Point(15,65),this.captainsContainer=new n.Container,this.itemContainer.addChild(this.captainsContainer),m=new n.Sprite.fromFrame("captains-panel.png"),m.position.y=-10,this.captainsContainer.addChild(m);var v={fill:"white",font:"20px "+window.MAIN_FONT,lineJoin:"round",align:"center"},y=new n.Text(p.team_select_screen.captain,v);y.anchor.set(.5,0),y.position.set(m.width/2,20),this.captainsContainer.addChild(y),this.captains=[[c.buttercup,c.finn],[c.gumball,c.mojo],[c.panda_bear,c.princess_bubblegum]],this.captainList=[];for(r in this.captains)for(l in this.captains[r])e=this.captains[r][l],i=o.character(e),i.id=e.id,i.position.x=f.width/2+d.x+(f.width+u.x)*l,i.position.y=f.height/2+d.y+(f.height+u.y)*r,i.onPress.add(this.onCharacterButtonPressed,this),i.onHover.add(this.onCharacterButtonHover,this),i.onMouseOut.add(this.onCharacterButtonMouseOut,this),this.captainsContainer.addChild(i),this.captainList.push(i);this.captainGroup=new s(this.captainList,1,!0),this.captainGroup.onUpdate.add(this.captainGroupUpdated,this),this.playersContainer=new n.Container,this.itemContainer.addChild(this.playersContainer),m=new n.Sprite.fromFrame("players-panel.png"),m.position.y=-10,this.playersContainer.addChild(m),y=new n.Text(p.team_select_screen.players,v),y.anchor.set(.5,0),y.position.set(m.width/2,20),this.playersContainer.addChild(y),this.players=[[c.anais,c.bmo,c.blossom,c.bubbles],[c.darwin,c.grizz_bear,c.ice_bear,c.jake],[c.marceline,c.moredecai,c.richard,c.rigby]],this.playerList=[];for(r in this.players)for(l in this.players[r])e=this.players[r][l],i=o.character(e),i.id=e.id,i.position.x=f.width/2+d.x+(f.width+u.x)*l,i.position.y=f.height/2+d.y+(f.height+u.y)*r,i.onPress.add(this.onCharacterButtonPressed,this),i.onHover.add(this.onCharacterButtonHover,this),i.onMouseOut.add(this.onCharacterButtonMouseOut,this),this.playersContainer.addChild(i),this.playerList.push(i);this.playerGroup=new s(this.playerList,2,!0),this.playerGroup.onUpdate.add(this.playerGroupUpdated,this),this.playerGroup.setLock(!0),this.captainsContainer.position.x=this.teamContainer.x+this.teamContainer.width+6,this.playersContainer.position.x=this.captainsContainer.x+this.captainsContainer.width+6,this.itemContainer.position.set(this.itemContainer.width/-2-10,this.itemContainer.height/-2-30),this.sponsorButton=o.sponsor("sponsor-background.png",p.sponsor.url),this.sponsorButton.position.set(0,200),this.bg.addChild(this.sponsorButton);var x=n.Sprite.from(ASSET_URL+p.sponsor.path);x.anchor.set(.5,.5),this.sponsorButton.addChild(x),this.previousButton=o.big("icon-back.png"),this.previousButton.position.set(-370,200),this.previousButton.onPress.add(this.onPreviousButtonPressed,this),this.bg.addChild(this.previousButton),this.nextButton=o.big("icon-back.png"),this.nextButton.position.set(380,200),this.nextButton.icon.rotation=Math.PI,this.nextButton.disable(),this.nextButton.onPress.add(this.onNextButtonPressed,this),this.bg.addChild(this.nextButton)};f.prototype=Object.create(n.Container.prototype),f.prototype.goBackToMainSite=function(){window.location.href="http://www.disney.co.uk"},f.prototype.onPreviousButtonPressed=function(){this.screenManager.gotoScreenByID(u.SCREEN_ID.COUNTRY_SELECT)},f.prototype.captainGroupUpdated=function(t,e){this.playerGroup.setLock(!t||this.playerGroup.selectedList.length>=this.playerGroup.maxSelected)},f.prototype.playerGroupUpdated=function(t,e){var i=this.captainGroup.selectedList.length>=this.captainGroup.maxSelected;i||this.onCharacterButtonPressed(e),this.captainGroupUpdated(i),i&&this.playerGroup.setLock(t)},f.prototype.onCharacterRemoved=function(t){for(var e=t.isCaptain?this.captainList:this.playerList,i=0;i<e.length;i++)if(e[i].id===t.id){e[i]._onDown();break}var r=c[t.id];r.isCaptain?this.teamList[0].setData():(this.teamList[1].data===r&&this.teamList[1].setData(this.teamList[2].data),this.teamList[2].setData()),this.checkForm()},f.prototype.onCharacterButtonPressed=function(t){var e=c[t.id];t.selected?e.isCaptain?this.teamList[0].setData(e):null===this.teamList[1].data?this.teamList[1].setData(e):(null!==this.teamList[2].data&&this.teamList[1].setData(this.teamList[2].data),this.teamList[2].setData(e)):e.isCaptain?this.teamList[0].setData():(this.teamList[1].data===e&&this.teamList[1].setData(this.teamList[2].data),this.teamList[2].setData()),this.checkForm()},f.prototype.onCharacterButtonHover=function(t){var e=c[t.id];e.isCaptain&&this.teamList[0].data!==e?this.teamList[0].showData(e):e.isCaptain||this.teamList[1].data===e||this.teamList[2].data===e||(null!==this.teamList[1].data?this.teamList[2].showData(e):this.teamList[1].showData(e))},f.prototype.onCharacterButtonMouseOut=function(t){var e=c[t.id];e.isCaptain?this.teamList[0].showData(this.teamList[0].data):(this.teamList[1].showData(this.teamList[1].data),this.teamList[2].showData(this.teamList[2].data))},f.prototype.checkForm=function(){for(var t=!0,e=0;e<this.teamList.length;e++)if(null===this.teamList[e].data){t=!1;break}t?this.nextButton.enable():this.nextButton.disable()},f.prototype.onNextButtonPressed=function(t){l.teamA=[],l.tournamentData.quarter=[],l.tournamentData.semi=[],l.tournamentData["final"]=[],l.tournamentData.winner=[],l.matchResult.goalsA=l.matchResult.goalsB=-1;for(var e=0;e<this.teamList.length;e++)l.teamA.push(this.teamList[e].data);var i=[];for(var e in c)i.push(c[e]);for(var e=0;e<l.teamA.length;e++){var r=i.indexOf(l.teamA[e]);-1!==r&&i.splice(r,1)}d.shuffle(i),l.teamB=i.slice(0,3);var n=[];for(e in p.countries)data=p.countries[e],l.countryID!==data&&n.push(data);if(d.shuffle(n),n=n.slice(0,7),l.isTournament){n.push(l.countryID),d.shuffle(n);var o=[],s=2;for(e=0;e<n.length;e+=s)o.push(n.slice(e,e+s));l.tournamentData.quarter=o.slice(),this.screenManager.gotoScreenByID(u.SCREEN_ID.TOURNAMENT)}else l.opponentID=n[0],this.screenManager.gotoScreenByID(u.SCREEN_ID.INSTRUCTIONS)},f.prototype.onShow=function(){this.bg.scale.set(0),this.app.topMenu.normalMode(),this.captainGroup.reset(),this.playerGroup.reset();for(var t in this.teamList)this.teamList[t].showData();TweenLite.to(this.bg.scale,.3,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},f.prototype.onShown=function(){},f.prototype.resize=function(t,e){this.position.y=e/2-372.5-40,this.bg.position.set(t/2,440)},r.exports=f}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(39),s=i(71),a=i(14),h=function(){n.Container.call(this),this.data=null,this.onRemoved=new a,this.bg=n.Sprite.fromFrame("placeholder-player-circle.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.profile=new n.Container,this.profile.item=null,this.addChild(this.profile);var t=(new n.Graphics).beginFill(16711680).drawCircle(0,0,32).endFill();this.addChild(t),this.profile.mask=t,this.removeButton=new o("close-player-selected.png"),this.removeButton.alpha=0,this.removeButton.onPress.add(this.onRemoveButtonPressed,this),this.addChild(this.removeButton);var e=new n.Point(10,3),i=new n.Point(74,0);this.skillBar=new s.skill,this.skillBar.position.set(i.x+e.x,i.y),this.addChild(this.skillBar),this.powerBar=new s.power,this.powerBar.position.set(i.x+e.x,i.y+e.y+this.skillBar.height+this.skillBar.y),this.addChild(this.powerBar),this.speedBar=new s.speed,this.speedBar.position.set(i.x+e.x,i.y+e.y+this.powerBar.height+this.powerBar.y),this.addChild(this.speedBar),this.bg.position.set(this.bg.width/2,(this.speedBar.height+this.speedBar.y)/2),this.profile.position.set(this.bg.position.x,this.bg.position.y),this.removeButton.position.set(this.bg.x+15,this.bg.y+30),t.position.set(this.bg.position.x,this.bg.position.y)};h.prototype=Object.create(n.Container.prototype),h.prototype.setData=function(t){this.data="undefined"!=typeof t?t:null,this.showData(this.data)},h.prototype.showData=function(t){"undefined"!=typeof t&&null!==t?(this.setProfile(t.profile),this.skillBar.setData(2*t.skill),this.powerBar.setData(2*t.power),this.speedBar.setData(2*t.speed)):(this.setProfile(),this.skillBar.setData(),this.powerBar.setData(),this.speedBar.setData())},h.prototype.setProfile=function(t){var e="undefined"!=typeof t&&null!==t;!e&&this.profile.item&&(TweenLite.killTweensOf(this.profile.item.scale),this.profile.removeChild(this.profile.item),this.profile.item=null),e&&(this.profile.item?this.profile.item.texture=n.Texture.fromFrame(t):(this.profile.item=n.Sprite.fromFrame(t),this.profile.item.anchor.set(.5),this.profile.item.scale.set(0),this.profile.addChild(this.profile.item),TweenLite.to(this.profile.item.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2}))),TweenLite.to(this.removeButton,.25,{alpha:e?1:0,ease:Linear.None})},h.prototype.onRemoveButtonPressed=function(){this.onRemoved.dispatch(this.data)},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(72)),o={skill:function(t){var e=new n("player-select-icons-skill.png",t?t:null,15953407);return e},power:function(t){var e=new n("player-select-icons-power.png",t?t:null,9527013);return e},speed:function(t){var e=new n("player-select-icons-speed.png",t?t:null,15847248);return e}};r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=function(t,e,i){n.Container.call(this),this.barW=94,this.level="undefined"!=typeof e?e:0,this.color="undefined"!=typeof i?i:0,this.bg=n.Sprite.fromFrame(t),this.bg.anchor.set(.5,.5),this.bg.position.set(this.bg.width/2,this.bg.height/2),this.addChild(this.bg);var r=new n.Point(5,(this.bg.height-10)/2),o=(new n.Graphics).beginFill(16777215).drawRect(0,0,this.barW,10).endFill();o.position.set(this.bg.width+r.x,r.y),this.addChild(o),this.bar=(new n.Graphics).beginFill(this.color).drawRect(0,0,this.barW,10).endFill(),this.bar.position.set(o.x,o.y),this.bar.scale.x=0,this.addChild(this.bar);for(var s=(new n.Graphics).beginFill(16777215),a=0;4>a;a++)s.drawRect(18*(a+1)+1*a,0,1,10);s.endFill(),s.position.set(o.x,o.y),this.addChild(s);var h=new n.Sprite.from("player_stat_frame.png");this.addChild(h),h.position.x=32,h.position.y=7};o.prototype=Object.create(n.Container.prototype),o.prototype.setData=function(t){this.level="undefined"!=typeof t?t:0;var e=50*Math.abs(this.level-this.bar.scale.x)/this.barW;TweenLite.killTweensOf(this.bar.scale),TweenLite.to(this.bar.scale,e,{x:this.level,ease:Linear.easeIn,delay:.2})},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=i(35),a=i(46),h=i(47),l=i(21),c=i(31),u=i(34),p=i(62),d=function(t){n.Container.call(this),this.app=t,this.scaleRatio=.75,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-player-select-and-tournament.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new s(u.tournament_screen.title,"title-bar-long.png"),this.title.position.set(0,-275),this.bg.addChild(this.title),this.stageLabel=new n.Text("",{fill:"white",font:"28px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"}),this.stageLabel.anchor.set(.5,.5),this.stageLabel.position.set(0,-185),this.bg.addChild(this.stageLabel);var e=n.Sprite.from(ASSET_URL+"img/ui/diagram.png");e.anchor.set(.5,.5),e.position.set(0,-25),this.bg.addChild(e);new n.Point(0,15),new n.Point(10,15);this.stageInfo={quarter:{id:"quarter",pos:[{x:-350,y:0},{x:-350,y:80},{x:-350,y:175},{x:-350,y:255},{x:350,y:0},{x:350,y:80},{x:350,y:175},{x:350,y:255}]},semi:{id:"semi",pos:[{x:-225,y:40},{x:-225,y:215},{x:225,y:40},{x:225,y:215}]},"final":{id:"final",pos:[{x:-105,y:125},{x:105,y:125}]},winner:{id:"winner",pos:[{x:0,y:200}]}},this.emptyFlag={ID:"",FLAG:"empty-flag.png"},this.blackFlag={ID:"",FLAG:"black-flag.png"},this.sponsorButton=o.sponsor("sponsor-background.png",u.sponsor.url),this.sponsorButton.position.set(0,200),this.bg.addChild(this.sponsorButton);var i=n.Sprite.from(ASSET_URL+u.sponsor.path);i.anchor.set(.5,.5),this.sponsorButton.addChild(i),this.previousButton=o.big("icon-back.png"),this.previousButton.position.set(-370,200),this.previousButton.onPress.add(this.onPreviousButtonPressed,this),this.bg.addChild(this.previousButton),this.nextButton=o.big("icon-back.png"),this.nextButton.position.set(380,200),this.nextButton.icon.rotation=Math.PI,this.nextButton.onPress.add(this.onNextButtonPressed,this),this.bg.addChild(this.nextButton),l.instance.desktop||(this.backButton=o.small("icon-back.png"),this.backButton.y=64,this.backButton.x=76,this.backButton.onPress.add(this.goBackToMainSite,this),this.addChild(this.backButton))};d.prototype=Object.create(n.Container.prototype),d.prototype.setContent=function(){this.previousButton.visible=void 0===a.tournamentData.semi[0],this.bg.removeChild(this.itemContainer),this.itemContainer=new n.Container,this.itemContainer.position.set(0,-150),this.bg.addChild(this.itemContainer),this.stage,a.tournamentData.winner.length>0?this.stage=this.stageInfo.winner.id:a.tournamentData["final"].length>0?this.stage=this.stageInfo["final"].id:a.tournamentData.semi.length>0?this.stage=this.stageInfo.semi.id:a.tournamentData.quarter.length>0&&(this.stage=this.stageInfo.quarter.id);var t={quarter:0,semi:0,"final":1};a.difficulty=t[this.stage],this.stageLabel.text=u.tournament_screen.stages[this.stage],this.arrangeItems(this.stage,!0)},d.prototype.chooseOpponent=function(){a.leftOverPlayers=[];for(var t in h){var e=h[t];e.available&&-1===a.teamA.indexOf(e)&&a.leftOverPlayers.push(e)}p.shuffle(a.leftOverPlayers),a.teamB=[a.leftOverPlayers[0],a.leftOverPlayers[1],a.leftOverPlayers[2]];var i=this.flattenArray(a.tournamentData[this.stage]),r=i.indexOf(a.countryID);a.opponentID=i[r%2===0?++r:--r]},d.prototype.chooseRivals=function(t,e){for(var i,r,n,o=[],s=[],h=a.tournamentData[t],l=0;l<h.length;l++)i=h[l],r=i.indexOf(a.countryID),n=r>-1?i[e?r:(r+1)%2]:i[Math.floor(2*Math.random())],o.push(n),2==o.length&&(s.push(o),o=[]);return s},d.prototype.updateRivals=function(t,e){t===this.stageInfo["final"].id?a.tournamentData.winner=[e?a.countryID:a.tournamentData["final"][Math.floor(2*Math.random())]]:t===this.stageInfo.semi.id?(a.tournamentData["final"]=this.flattenArray(this.chooseRivals(t,e)),e||this.updateRivals(this.stageInfo["final"].id,!1)):t===this.stageInfo.quarter.id&&(a.tournamentData.semi=this.chooseRivals(t,e),e||this.updateRivals(this.stageInfo.semi.id,!1))},d.prototype.arrangeItems=function(t,e){t===this.stageInfo.winner.id?(this.placeItems(this.stageInfo.winner.id,[this.emptyFlag]),this.placeItems(t,a.tournamentData.winner),this.arrangeItems(this.stageInfo["final"].id,!1)):t===this.stageInfo["final"].id?(e?(this.placeItems(this.stageInfo.winner.id,[this.emptyFlag]),this.placeItems(this.stageInfo["final"].id,[this.emptyFlag,this.emptyFlag]),this.placeItems(t,a.tournamentData["final"])):this.placeItems(t,a.tournamentData["final"]),this.arrangeItems(this.stageInfo.semi.id,!1)):t===this.stageInfo.semi.id?(e?(this.placeItems(this.stageInfo.winner.id,[this.emptyFlag]),this.placeItems(this.stageInfo["final"].id,[this.emptyFlag,this.emptyFlag]),this.placeItems(this.stageInfo.semi.id,[this.emptyFlag,this.emptyFlag,this.emptyFlag,this.emptyFlag]),
this.placeItems(t,this.flattenArray(a.tournamentData.semi))):this.placeItems(t,this.flattenArray(a.tournamentData.semi)),this.arrangeItems(this.stageInfo.quarter.id,!1)):t===this.stageInfo.quarter.id&&(e&&(this.placeItems(this.stageInfo.winner.id,[this.emptyFlag]),this.placeItems(this.stageInfo["final"].id,[this.emptyFlag,this.emptyFlag]),this.placeItems(this.stageInfo.semi.id,[this.emptyFlag,this.emptyFlag,this.emptyFlag,this.emptyFlag])),this.placeItems(t,this.flattenArray(a.tournamentData.quarter)))},d.prototype.placeItems=function(t,e){var i=[];a.tournamentData.winner.length>0?i=a.tournamentData.winner:a.tournamentData["final"].length>0?i=a.tournamentData["final"]:a.tournamentData.semi.length>0&&(i=this.flattenArray(a.tournamentData.semi));for(var r,o,s,h,l,c=0;c<e.length;c++)r=e[c],o=n.Sprite.fromFrame(r.FLAG),s=this.stageInfo[t].pos[c],o.scale.set(this.scaleRatio),o.anchor.set(.5),o.x=s.x,o.y=s.y,this.itemContainer.addChild(o),i.length>0&&i.indexOf(r)<0&&(h=n.Sprite.fromFrame(this.blackFlag.FLAG),h.anchor.set(.5),h.alpha=.5,o.addChild(h)),r===a.countryID&&(l=n.Sprite.fromFrame("flag-white-border.png"),l.anchor.set(.5),o.addChild(l))},d.prototype.flattenArray=function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(t[i]);return e},d.prototype.goBackToMainSite=function(){window.location.href="http://www.disney.co.uk"},d.prototype.onPreviousButtonPressed=function(){this.screenManager.gotoScreenByID(c.SCREEN_ID.TEAM_SELECT)},d.prototype.onNextButtonPressed=function(){void 0===a.tournamentData.winner[0]?(this.chooseOpponent(),void 0===a.tournamentData.semi[0]?this.screenManager.gotoScreenByID(c.SCREEN_ID.INSTRUCTIONS):this.screenManager.gotoScreenByID(c.SCREEN_ID.GAME)):a.tournamentData.winner[0]===a.countryID?this.screenManager.gotoScreenByID(c.SCREEN_ID.SUCCEED):this.screenManager.gotoScreenByID(c.SCREEN_ID.FAIL)},d.prototype.onShow=function(){a.matchResult.goalsA>-1&&this.updateRivals(this.stage,a.matchResult.goalsA>a.matchResult.goalsB),this.setContent(),this.bg.scale.set(0),this.app.topMenu.normalMode(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},d.prototype.onShown=function(){},d.prototype.resize=function(t,e){this.position.y=e/2-372.5-40,this.bg.position.set(t/2,440)},r.exports=d}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=i(35),a=(i(61),i(75)),h=(i(46),i(47),i(21),i(31)),l=i(34),c=(i(62),i(63)),u=i(76),p=i(77),d=i(79),f=i(20),m=i(82),g=function(t){n.Container.call(this),this.app=t,this.itemList=[],this.margin=new n.Point(50,40),c.getScores(function(t){this.setContent(t)}.bind(this)),this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-player-select-and-tournament.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new s(l.leaderboard_screen.title,"title-bar-long.png"),this.title.position.set(0,-235),this.bg.addChild(this.title),this.itemContainer=new n.Container,this.bg.addChild(this.itemContainer),this.titleLabel=new n.Container;var e={fill:"white",font:"20px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round",dropShadow:!1},i=new n.Text("#",e),r=n.Sprite.from("icon_country.png"),h=n.Sprite.from("icon_points.png"),f=n.Sprite.from("icon_won.png"),g=n.Sprite.from("icon_lost.png"),v=n.Sprite.from("icon_goal_difference.png");r.x=25,h.x=337,f.x=447,g.x=557,v.x=667,this.tooltop=new a,this.tooltop.addItem(h,window.translations.STR_POINTS),this.tooltop.addItem(f,window.translations.STR_WINS),this.tooltop.addItem(g,window.translations.STR_LOSES),this.tooltop.addItem(v,window.translations.STR_GOAL_DIFFERENCE),this.titleLabel.addChild(i),this.titleLabel.addChild(r),this.titleLabel.addChild(h),this.titleLabel.addChild(f),this.titleLabel.addChild(g),this.titleLabel.addChild(v),this.titleLabel.addChild(this.tooltop),this.titleLabel.position.set(-475,-175),this.titleLabel.position.x+=50,this.previousButton=o.big("icon-back.png"),this.previousButton.position.set(-370,200),this.previousButton.onPress.add(this.onPreviousButtonPressed,this),this.bg.addChild(this.previousButton);var y={frameWidth:880,frameHeight:310,lineHeight:30,padding:{top:0,right:0,bottom:0,left:0}};this.leaderboard=new m(y),this.leaderboard.position.set(this.titleLabel.x,-130),this.leaderboard.disappear(),this.bg.addChild(this.leaderboard),this.sponsorButton=o.sponsor("sponsor-background.png",l.sponsor.url),this.sponsorButton.position.set(0,200),this.bg.addChild(this.sponsorButton);var x=n.Sprite.from(ASSET_URL+l.sponsor.path);x.anchor.set(.5,.5),this.sponsorButton.addChild(x);var _={target:this.leaderboard.container},b=new d(_),w=300,S=30,T=n.Sprite.from("scrollbar_button.png");T.anchor.set(.25);var M=n.Sprite.from("scrollbar_bg.png"),E=new u({draggerHeight:S,dragLength:w,bar:M,dragger:T});E.position.set(370,-160),this.bg.addChild(E);var C=new p({scrollbar:E,trackpad:b,min:0,max:380});this.scrollCombo=C,this.translationIds={};for(var A in l.countries){var L=l.countries[A];this.translationIds[L.SCORE_ID]=L.NAME}this.bg.addChild(this.titleLabel)};g.prototype=Object.create(n.Container.prototype),g.prototype.setContent=function(t){for(var e=0;e<this.itemList.length;e++)this.itemContainer.removeChild(this.itemList[e]);this.data=t,this.data=this.data.map(function(t,e){return t.name=this.translationIds[t.id],t.name&&(t.name=t.name.replace("\n"," ")),t.rank=e+1,t}.bind(this)),this.itemList=[],this.leaderboard.setData(this.data);var i=30*(t.length-1)-220;this.scrollCombo.max=i,this.scrollCombo.trackpad.scrollMinY=-i,this.itemContainer.position.set(this.titleLabel.position.x,this.titleLabel.position.y+this.margin.x)},g.prototype.onPreviousButtonPressed=function(){this.screenManager.gotoScreenByID(h.SCREEN_ID.TITLE)},g.prototype.onShow=function(){this.bg.scale.set(0),this.app.topMenu.normalMode(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2}),this.leaderboard.appear(),f.instance.add(this.update,this),this.scrollCombo.value=0},g.prototype.onShown=function(){},g.prototype.onHidden=function(){f.instance.remove(this.update,this),this.leaderboard.disappear()},g.prototype.update=function(){this.scrollCombo.update(),this.leaderboard.scrollPosition=this.scrollCombo.value},g.prototype.resize=function(t,e){this.position.y=e/2-372.5-40,this.bg.position.set(t/2,405)},r.exports=g}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(34),function(){n.Container.call(this),this.interactive=!1,this.interactiveChildren=!1,this.data="undefined"!=typeof data?data:{name:"",label:"",ranking:""},this.alpha=0,this.bg=n.Sprite.fromFrame("tooltip_explaination.png"),this.bg.anchor.set(.5,0),this.addChild(this.bg),this.name=new n.Text("HELLO",{fill:"black",font:"20px "+window.MAIN_FONT,align:"center"}),this.name.anchor.set(.5,0),this.name.position.y=32,this.addChild(this.name)});o.prototype=Object.create(n.Container.prototype),o.prototype.addItem=function(t,e){t.interactive=!0,t.on("mouseover",function(){this.position.x=t.position.x+15,this.position.y=t.position.y+35,this.show(e)},this),t.on("mouseout",function(){this.hide()},this)},o.prototype.show=function(t){this.name.text=t.toUpperCase(),TweenLite.to(this,.1,{alpha:1,ease:Linear.None})},o.prototype.hide=function(){TweenLite.to(this,.1,{alpha:0,ease:Linear.None})},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(45),o=i(7),s=new o.Point,a=function(t){t=t||{},this.value=0,this._ratio=0,this.dragOffset=0,this.dragPosition=0,this.draggerHeight=t.draggerHeight||30,this.dragLength=t.dragLength||300,o.Container.call(this),this.bar=t.bar||(new o.Graphics).beginFill(16711680).drawRect(0,0,20,this.dragLength),this.dragger=t.dragger||(new o.Graphics).beginFill(16776960).drawRect(0,-this.draggerHeight/2,20,this.draggerHeight),this.addChild(this.bar),this.addChild(this.dragger),this.dragger.position.y=this.draggerHeight/2,this.interactive=!0,this.buttonMode=!0,this.mousedown=this.onDown.bind(this),this.onUp=this.onUp.bind(this),this.onMove=this.onMove.bind(this),this.onUpdate=null};a.prototype=Object.create(o.Container.prototype),a.prototype.updateTransform=function(){var t=this.draggerHeight/2+this.ratio*(this.dragLength-this.draggerHeight);this.dragger.position.y+=.5*(t-this.dragger.position.y),this.containerUpdateTransform()},Object.defineProperties(a.prototype,{ratio:{get:function(){return this._ratio},set:function(t){this._ratio=n.cap(t,0,1)}}}),a.prototype.updateRatio=function(t){this._ratio=n.map(t,this.draggerHeight/2,this.dragLength-this.draggerHeight/2,0,1),this._ratio=n.cap(this.ratio,0,1),this.onUpdate()},a.prototype.onDown=function(t){var e=t.data.getLocalPosition(this,s).y;this.updateRatio(e),this.isDragging=!0,this.mousemove=this.onMove,this.mouseup=this.mouseupoutside=this.onUp},a.prototype.onUp=function(){this.isDragging=!1,this.mousemove=null,this.mouseup=this.mouseupoutside=null},a.prototype.onMove=function(t){var e=t.data.getLocalPosition(this,s).y;this.updateRatio(e)},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(78),i(20),i(79),i(45));PixiScrollCombo=function(t){this.min=t.min||0,this.max=t.max||500,this.trackpad=t.trackpad,this.trackpad.scrollMinY=-this.max,this.trackpad.scrollMaxY=this.min,this.trackpad.capMovement=!0,this.trackpad.easeToPosition(0,this.min),this.scrollbar=t.scrollbar,Device.instance.desktop||(this.scrollbar.visible=!1),this.scrollbar.onUpdate=this.onScrollUpdate.bind(this),this.value=0},Object.defineProperties(PixiScrollCombo.prototype,{value:{get:function(){return this._value},set:function(t){this._value=t,this.trackpad.easeToPosition(0,t)}}}),PixiScrollCombo.prototype.update=function(){this.trackpad.update(),this._value=this.trackpad.valueY,this.scrollbar.ratio=n.map(-this.trackpad.valueY,this.min,this.max,0,1)},PixiScrollCombo.prototype.onScrollUpdate=function(){var t=n.map(this.scrollbar.ratio,1,0,-this.max,this.min);this.trackpad.easeToPosition(0,t)},r.exports=PixiScrollCombo}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(){this.x=0,this.ax=0,this.dx=0,this.tx=0,this.max=160,this.damp=.8,this.springiness=.1};r.prototype.update=function(){this.ax=(this.tx-this.x)*this.springiness,this.dx+=this.ax,this.dx*=this.damp,this.dx<-this.max?this.dx=-this.max:this.dx>this.max&&(this.dx=this.max),this.x+=this.dx},r.prototype.reset=function(){this.x=0,this.ax=0,this.dx=0,this.tx=0},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(80),o=i(81),s=i(21),a=i(14);PixiTrackpad=function(t){this.spring=new n,this.onScrollUpdate=new a;var e=t.scrollbarClass||o;this.target=t.target,this.value=0,this.easingValue=0,this.dragOffset=0,this.dragging=!1,this.speed=0,this.size=1024,this.maxSlots=1,this.capMovement=!0,this.prevPosition=0,this.valueY=0,this.easingValueY=0,this.dragOffsetY=0,this.speedY=0,this.prevPositionY=0,this.didMove=!1,this.didMoveY=!1,this.target.interactive=!0,this.scrollMin=-(1/0),this.scrollMax=0,this.scrollMinY=-(1/0),this.scrollMaxY=0,this.snapTo=!1,t.scrollbar===!0&&s.instance.mobile===!1&&s.instance.iPad===!1&&(this.scrollBar=new e({target:t.scrollTarget,trackpad:this})),this._onDownBinded=this.onDown.bind(this),this._onUpBinded=this.onUp.bind(this),this._onMoveBinded=this.onMove.bind(this),this.target.on("touchstart",this._onDownBinded).on("mousedown",this._onDownBinded)},PixiTrackpad.constructor=PixiTrackpad,PixiTrackpad.prototype.unlock=function(){this.locked=!1,this.speed=0,this.easingValue=this.value,this.easingValueY=this.valueY,this.speedY=0,this.speedX=0,window.onmousewheel=this.onMouseWheel.bind(this)},PixiTrackpad.prototype.lock=function(){this.locked=!0,window.onmousewheel=null},PixiTrackpad.prototype.update=function(){if(this.value+=.3*(this.easingValue-this.value),this.valueY+=.3*(this.easingValueY-this.valueY),!this.locked)if(this.dragging){var t=this.easingValue-this.prevPosition;t*=.7,this.speed+=.5*(t-this.speed),this.prevPosition=this.easingValue;var e=this.easingValueY-this.prevPositionY;e*=.7,this.speedY+=.5*(e-this.speedY),this.prevPositionY=this.easingValueY}else this.snapTo?(this.spring.update(),this.easingValue=this.spring.x,this.easingValueY=this.spring.y,this.capMovement&&(this.easingValue>this.scrollMax?this.easingValue+=.3*(this.scrollMax-this.easingValue):this.easingValue<this.scrollMin&&(this.easingValue+=.3*(this.scrollMin-this.easingValue)),this.easingValueY>this.scrollMaxY?this.easingValueY+=.3*(this.scrollMaxY-this.easingValueY):this.easingValueY<this.scrollMinY&&(this.easingValueY+=.3*(this.scrollMinY-this.easingValueY)))):(this.speed*=.95,this.easingValue+=this.speed,this.speedY*=.95,this.easingValueY+=this.speedY,this.capMovement&&(this.easingValue>this.scrollMax?this.easingValue+=.3*(this.scrollMax-this.easingValue):this.easingValue<this.scrollMin&&(this.easingValue+=.3*(this.scrollMin-this.easingValue)),this.easingValueY>this.scrollMaxY?this.easingValueY+=.3*(this.scrollMaxY-this.easingValueY):this.easingValueY<this.scrollMinY&&(this.easingValueY+=.3*(this.scrollMinY-this.easingValueY))))},PixiTrackpad.prototype.stop=function(){this.speed=0,this.speedY=0,this.value=this.prevPosition=this.easingValue,this.valueY=this.prevPositionY=this.easingValueY},PixiTrackpad.prototype.setPosition=function(t,e){this.value=this.easingValue=t,this.valueY=this.easingValueY=e},PixiTrackpad.prototype.easeToPosition=function(t,e){this.easingValue=t,this.easingValueY=e},PixiTrackpad.prototype.onDown=function(t){this.locked||(this.speed=0,this.speedY=0,this.stop(),this.didMove=!1,this.didMoveY=!1,this.checkX=t.data.global.x,this.checkY=t.data.global.y,this.dragging=!0,this.dragOffset=t.data.global.x-this.value,this.dragOffsetY=t.data.global.y-this.valueY,this.target.on("touchend",this._onUpBinded).on("touchendoutside",this._onUpBinded).on("mouseup",this._onUpBinded).on("mouseupoutside",this._onUpBinded).on("touchmove",this._onMoveBinded).on("mousemove",this._onMoveBinded))},PixiTrackpad.prototype.onMouseWheel=function(t){this.target.interactive&&(t.preventDefault?t.preventDefault():t.returnValue=!1,this.locked||(this.speed=.15*t.wheelDeltaX,this.speedY=.15*t.wheelDeltaY))},PixiTrackpad.prototype.onUp=function(){if(!this.locked){if(this.dragging=!1,this.snapTo){if(this.didMove){this.spring.dx=this.speed;var t;t=this.speed<0?Math.floor(this.easingValue/this.size):Math.ceil(this.easingValue/this.size),this.capMovement&&(t>0?t=0:t<-this.maxSlots&&(t=-this.maxSlots)),this.spring.tx=t*this.size,this.spring.dy=this.speedY,t=this.speedY<0?Math.floor(this.easingValueY/this.size):Math.ceil(this.easingValueY/this.size),this.capMovement&&(t>0?t=0:t<-this.maxSlots&&(t=-this.maxSlots)),this.spring.ty=t*this.size}this.spring.x=this.easingValue,this.spring.y=this.easingValueY}this.cap(),this.target.off("touchend",this._onUpBinded).off("touchendoutside",this._onUpBinded).off("mouseup",this._onUpBinded).off("mouseupoutside",this._onUpBinded).off("touchmove",this._onMoveBinded).off("mousemove",this._onMoveBinded)}},PixiTrackpad.prototype.cap=function(){this.capMovement&&(this.snapTo&&(this.spring.tx>this.scrollMax?this.spring.tx=this.scrollMax:this.spring.tx<this.scrollMin&&(this.spring.tx=this.scrollMin)),this.snapTo&&(this.spring.ty>this.scrollMaxY?this.spring.ty=this.scrollMaxY:this.spring.ty<this.scrollMinY&&(this.spring.ty=this.scrollMinY)))},PixiTrackpad.prototype.setSlot=function(t,e){this.spring.tx=t*-this.size,e&&(this.value=this.easingValue=this.spring.x=this.spring.tx),this.cap()},PixiTrackpad.prototype.setSlotY=function(t){this.spring.ty=t*-this.size,this.cap()},PixiTrackpad.prototype.nextSlot=function(){this.spring.tx-=this.size,this.spring.tx<-(this.maxSlots*this.size)&&(this.spring.tx=-(this.maxSlots*this.size)),this.cap()},PixiTrackpad.prototype.nextSlotY=function(){this.spring.ty-=this.size,this.spring.ty<-(this.maxSlots*this.size)&&(this.spring.ty=-(this.maxSlots*this.size)),this.cap()},PixiTrackpad.prototype.previousSlot=function(){this.spring.tx+=this.size,this.cap()},PixiTrackpad.prototype.previousSlotY=function(){this.spring.ty+=this.size,this.cap()},PixiTrackpad.prototype.setSize=function(t){this.size=t,this.scrollbar&&this.scrollBar.setSize(t)},PixiTrackpad.prototype.setSlots=function(t){this.maxSlots=t-1},PixiTrackpad.prototype.onMove=function(t){if(!this.locked){var e;e=Math.abs(this.checkX-t.data.global.x),e>10&&(this.didMove=!0),e=Math.abs(this.checkY-t.data.global.y),e>10&&(this.didMove=!0),this.easingValue=t.data.global.x-this.dragOffset,this.easingValueY=t.data.global.y-this.dragOffsetY,this.capMovement&&(this.easingValue>this.scrollMax?this.easingValue=this.scrollMax+.3*(this.easingValue-this.scrollMax):this.easingValue<this.scrollMin&&(this.easingValue=this.scrollMin+.3*(this.easingValue-this.scrollMin)),this.easingValueY>this.scrollMaxY?this.easingValueY=this.scrollMaxY+.3*(this.easingValueY-this.scrollMaxY):this.easingValueY<this.scrollMinY&&(this.easingValueY=this.scrollMinY+.3*(this.easingValueY-this.scrollMinY)))}},r.exports=PixiTrackpad}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(){this.x=0,this.ax=0,this.dx=0,this.tx=0,this.y=0,this.ay=0,this.dy=0,this.ty=0,this.max=30,this.damp=.75,this.springiness=.09,this.max=160,this.damp=.85,this.springiness=.29};r.constructor=r,r.prototype.update=function(){this.ax=(this.tx-this.x)*this.springiness,this.dx+=this.ax,this.dx*=this.damp,this.dx<-this.max?this.dx=-this.max:this.dx>this.max&&(this.dx=this.max),this.x+=this.dx,this.ay=(this.ty-this.y)*this.springiness,this.dy+=this.ay,this.dy*=this.damp,this.dy<-this.max?this.dy=-this.max:this.dy>this.max&&(this.dy=this.max),this.y+=this.dy},r.prototype.reset=function(){this.x=0,this.ax=0,this.dx=0,this.tx=0,this.y=0,this.ay=0,this.dy=0,this.ty=0},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(78),i(20));i(79);PixiScrollBar=function(t){this.topMargin=15,this.bottomMargin=15,this.yTouchOffset=0,this.dragging=!1,this.trackpad=t.trackpad,this.targetPosition={x:0,y:0},this.container=t.target,this.guideLine=new PIXI.Sprite,this.guideLine.anchor.set(1,0),this.guideLine.position.x=630,this.guideLine.position.y=1,this.guideLine.height=229,this.guideLine.hitArea=new PIXI.Rectangle(-10,0,40,300),this.guideLine.interactive=!1,this.guideLine.buttonMode=!1,this.guideButton=new PIXI.Sprite,this.guideButton.anchor.set(1,.5),this.guideButton.position.x=642,this.guideButton.hitArea=new PIXI.Rectangle(-100,-100,400,300),this.guideButton.position.y=this.topMargin+.5*this.guideButton.height,this.guideButton.interactive=!0,this.guideButton.buttonMode=!0,this.container.addChild(this.guideLine),this.container.addChild(this.guideButton),this.guideButton.touchstart=this.guideButton.mousedown=this.onDown.bind(this),this.guideButton.touchend=this.guideButton.touchendoutside=this.guideButton.mouseup=this.guideButton.mouseupoutside=this.onUp.bind(this),this.guideButton.mousemove=this.guideButton.touchmove=this.onMove.bind(this),this.panelHeight=this.container.viewHeight,this.scrollHeight=this.container.scrollHeight-this.panelHeight,this.scrollableDistance=this.panelHeight-this.topMargin-this.bottomMargin-this.guideButton.height,this.scrollBarRatio=this.scrollHeight/this.scrollableDistance,n.instance.add(this.update,this)},PixiScrollBar.prototype.onDown=function(t){alert(2),this.dragging=!0,this.yTouchOffset=t.data.getLocalPosition(this.guideButton).y,this.onMove(t)},PixiScrollBar.prototype.onUp=function(){alert(2434),this.dragging=!1,this.yTouchOffset=0},PixiScrollBar.prototype.onMove=function(t){this.dragging===!0&&(this.targetPosition=t.data.getLocalPosition(this.container),this.targetPosition.y<this.topMargin+.5*this.guideButton.height&&(this.targetPosition.y=this.topMargin+.5*this.guideButton.height),this.targetPosition.y>this.scrollableDistance+this.topMargin+.5*this.guideButton.height&&(this.targetPosition.y=this.scrollableDistance+this.topMargin+.5*this.guideButton.height))},PixiScrollBar.prototype.update=function(){if(this.dragging){var t=-((this.guideButton.position.y-this.topMargin-.5*this.guideButton.height)*this.scrollBarRatio);this.trackpad.easeToPosition(0,t),this.guideButton.position.y=this.targetPosition.y}else this.guideButton.position.y=-1*this.trackpad.valueY/this.scrollBarRatio+this.topMargin+.5*this.guideButton.height},r.exports=PixiScrollBar}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(33),i(20),i(61)),s=function(t){n.Container.call(this),this.list=[],this.realHeight=0,this.viewHeight=t.frameHeight||240,this.viewWidth=t.frameWidth||800,this.scoreViewHeight=t.lineHeight||40,this.padding="object"==typeof t.padding?t.padding:{top:0,right:0,bottom:0,left:0},this.container=new n.Container,this.container.hitArea=new n.Rectangle(-50,0,this.viewWidth,this.viewHeight),this.addChild(this.container),this.maskGraphic=(new n.Graphics).beginFill(16711680,.4).drawRect(-50,0,this.viewWidth,this.viewHeight-30),this.addChild(this.maskGraphic),this.container.mask=this.maskGraphic,this.containerScrollbar=new n.Container,this.containerScrollbar.position.x=5,this.containerScrollbar.viewHeight=t.frameHeight||240,this.containerScrollbar.viewWidth=t.frameWidth||800,this.addChild(this.containerScrollbar),this.containerScrollbar.realHeight=this.containerScrollbar.viewHeight+2*this.scoreViewHeight,this.realHeight=this.containerScrollbar.viewHeight+1.5*this.scoreViewHeight;for(var e=Math.floor(this.containerScrollbar.realHeight/this.scoreViewHeight),i=0;e>i;i++){var r=new o(i);this.container.addChild(r),r.position.y=i*this.scoreViewHeight,this.list.push(r)}this.dirty=!0};s.constructor=s,s.prototype=Object.create(n.Container.prototype),Object.defineProperty(s.prototype,"scrollPosition",{get:function(){return this._scrollPosition},set:function(t){this._scrollPosition=t,this.updateScrollPosition()}}),s.prototype.setData=function(t){this.data=t;for(var e=0;e<this.list.length;e++){var i=this.list[e];i.id=99999}this.alpha=0,TweenLite.to(this,.3,{alpha:1}),this.scrollHeight=t.length*this.scoreViewHeight+this.padding.top+this.padding.bottom,this.dirty=!0,this.updateScrollPosition()},s.prototype.updateScrollPosition=function(){if(this.data){for(var t=0;t<this.list.length;t++){var e=this.list[t];e.position.y=t*this.scoreViewHeight+this._scrollPosition+this.padding.top,e.position.y+=this.scoreViewHeight;var i=Math.floor((e.position.y+40)/this.realHeight);i*=this.list.length,i-=t,i*=-1,e.id!=i&&(e.id=i,e.visible=e.id>=0&&e.id<this.data.length,e.visible&&e.setData(this.data[i])),e.position.y%=this.realHeight,e.position.y<-20&&(e.position.y+=this.realHeight),e.position.y-=this.scoreViewHeight}this.dirty=!1}},s.prototype.disappear=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];TweenLite.to(e,.4,{alpha:0}),TweenLite.to(this.containerScrollbar.position,.4,{x:200})}},s.prototype.appear=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];TweenLite.to(e,.4,{alpha:1}),TweenLite.to(this.containerScrollbar.position,.4,{x:5})}},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(38)),s=i(35),a=i(31),h=i(46),l=i(34);GameoverScreen=function(t){n.Container.call(this),this.app=t,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-final-score-background.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new s(l.gameover_screen.title,"title-bar-final-score-background.png"),this.title.position.set(0,-185),this.bg.addChild(this.title),this.flag=null,this.flag2=null;var e={fill:"white",font:"20px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round",align:"center"};this.labelCountry=new n.Text("",e),this.labelCountry.anchor.set(.5),this.labelCountry.position.set(-125,0),this.bg.addChild(this.labelCountry),this.labelCountry2=new n.Text("",e),this.labelCountry2.anchor.set(.5),this.labelCountry2.position.set(125,0),this.bg.addChild(this.labelCountry2),e={fill:"white",font:"100px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round",align:"center"},this.labelScore=new n.Text("",e),this.labelScore.anchor.set(.5),this.labelScore.position.set(-125,75),this.bg.addChild(this.labelScore),this.labelVs=new n.Text("-",e),this.labelVs.anchor.set(.5),this.labelVs.position.set(0,75),this.bg.addChild(this.labelVs),this.labelScore2=new n.Text("",e),this.labelScore2.anchor.set(.5),this.labelScore2.position.set(125,75),this.bg.addChild(this.labelScore2),this.restartButton=o.big("icon-back.png"),this.restartButton.position.set(-425,290),this.restartButton.onPress.add(this.onRestartButtonPressed,this),this.nextButton=o.big("icon-back.png"),this.nextButton.position.set(380,200),this.nextButton.icon.rotation=Math.PI,this.nextButton.onPress.add(this.onNextButtonPressed,this),this.bg.addChild(this.nextButton)},GameoverScreen.prototype=Object.create(n.Container.prototype),GameoverScreen.prototype.onRestartButtonPressed=function(){this.screenManager.gotoScreenByID(a.SCREEN_ID.GAME)},GameoverScreen.prototype.onNextButtonPressed=function(){this.screenManager.gotoScreenByID(a.SCREEN_ID.TITLE)},GameoverScreen.prototype.updateContent=function(){null!==this.flag&&(this.bg.removeChild(this.flag),this.bg.removeChild(this.flag2));var t=h.countryID,e=h.opponentID;this.flag=new n.Sprite.fromFrame(t.FLAG),this.flag.anchor.set(.5,.5),this.flag.scale.set(.9),this.flag.position.set(-125,-75),this.bg.addChild(this.flag),this.flag2=new n.Sprite.fromFrame(e.FLAG),this.flag2.anchor.set(.5,.5),this.flag2.scale.set(.9),this.flag2.position.set(125,-75),this.bg.addChild(this.flag2),this.labelCountry.text=l.countries[t.ID].NAME,this.labelCountry2.text=l.countries[e.ID].NAME,this.labelScore.text=""+this.app.game.goalsA,this.labelScore2.text=""+this.app.game.goalsB},GameoverScreen.prototype.onShow=function(){this.updateContent(),this.bg.scale.set(0),this.app.topMenu.normalMode(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},GameoverScreen.prototype.onShown=function(){},GameoverScreen.prototype.resize=function(t,e){this.position.y=e/2-372.5-40,this.bg.position.set(t/2,440)},r.exports=GameoverScreen}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(37),i(85)),s=(i(164),i(166)),a=i(31),h=i(46),l=i(63),c=function(t){n.Container.call(this),this.app=t,this.game=new o,this.game.onGameover.add(this.onGameover,this),this.addChild(this.game.view),this.app.game=this.game,this.transition=new s};c.prototype=Object.create(n.Container.prototype),c.prototype.onShow=function(){TweenLite.to(this.app.background,.4,{alpha:0,delay:.4}),this.game.start(),this.app.overlayManager.onShow.add(this.onOverlayShow,this),this.app.overlayManager.onHide.add(this.onOverlayHide,this),this.app.topMenu.gameMode()},c.prototype.quit=function(){this.screenManager.gotoScreenByID(a.SCREEN_ID.TITLE)},c.prototype.onGameover=function(){var t=h.matchResult.goalsA-h.matchResult.goalsB,e=h.countryID.SCORE_ID;l.sendScore(e,t),h.isTournament===!0?this.screenManager.gotoScreenByID(a.SCREEN_ID.TOURNAMENT):this.screenManager.gotoScreenByID(a.SCREEN_ID.GAMEOVER)},c.prototype.onShown=function(){},c.prototype.onHide=function(){TweenLite.to(this.app.background,.4,{alpha:1}),this.game.pause(),this.app.overlayManager.onShow.remove(this.onOverlayShow,this),this.app.overlayManager.onHide.remove(this.onOverlayHide,this),app.view.style["-webkit-filter"]=null},c.prototype.onHidden=function(){this.game.pause(),this.app.topMenu.normalMode()},c.prototype.onOverlayShow=function(){this.game.pause()},c.prototype.onOverlayHide=function(){this.game.isGameover?(this.game.reset(),this.game.resume()):this.game.resume()},c.prototype.resize=function(t,e){this.game.resize(t,e),this.position.x=0,this.position.y=0},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(10),i(14)),s=i(20),a=i(21),h=i(29),l=i(37),c=i(86),u=i(88),p=i(91),d=i(98),f=i(109),m=i(114),g=i(116),v=i(118),y=i(130),x=i(133),_=i(135),b=i(137),w=i(138),S=i(139),T=i(140),M=i(141),E=i(145),C=(i(146),i(147)),A=i(148),L=i(149),P=i(150),R=i(151),O=i(117),I=i(46),D=i(152),B=i(48),k=i(160),F=i(161),N=i(162);s.game=new s;var U=function(t){this.onGameover=new o,this.wait=new S(s.game),s.game.start(),this.isGameover=!1,this.paused=!0,this.score=0,this.counter=0,this.view=new n.Container,this.world=new d.World;var e={camera:new m(this),camera3d:new g(this)};this.world.install(new d.CrashWorld,"crash"),this.world.install(new d.PixiView(e),"view"),this.world.install(new f(e),"view3d"),this.world.overlay=new n.Container,this.view.addChild((new n.Graphics).beginFill(1044480).drawRect(0,0,2,2)),this.view.addChild(this.world.view3d),this.world.crash.registerCollison(0,1),this.world.crash.registerCollison(1,1),this.world.crash.registerCollison(1,4),this.world.game=this,this.balanceManager=new F(this),this.pitch=new b,this.world.add(this.pitch),this.goalLeft=new x,this.goalRight=new x(!0),this.keeperLeft=new _,this.keeperRight=new _(!0),this.ball=new y,this.teamLeft=new d.Group([new v(!1),new v(!1),new v(!1)]),this.teamRight=new d.Group([new v(!0),new v(!0),new v(!0)]),this.teamLeft.run(function(t){t.setTeam(this)},this.teamLeft),this.teamRight.run(function(t){t.setTeam(this)},this.teamRight),this.world.addGroup(this.teamLeft),this.world.addGroup(this.teamRight),this.speed=1,this.endState=0,this.setPositions(),this.world.add(this.goalLeft),this.world.add(this.goalRight),this.world.add(this.keeperRight),this.world.add(this.keeperLeft),this.world.add(this.ball),this.gameDetails=new T(this),this.teamManagerA=new M(this,this.teamLeft,this.teamRight),this.teamManagerA.setSide(!0),this.teamManagerA.human=!0,this.teamManagerB=new M(this,this.teamRight,this.teamLeft),this.teamManagerB.setSide(!1),this.keeperManagerRight=new E(this.keeperRight,!1,this),this.keeperManagerLeft=new E(this.keeperLeft,!0,this),this.powerupManager=new D,this.world.add(this.powerupManager),this.black=(new n.Graphics).beginFill(0).drawRect(0,0,100,100),this.goalLeft.onGoalScored.add(this.onGoalScored,this),this.goalRight.onGoalScored.add(this.onGoalScored,this),this.scripts={start:new C(this),goal:new A(this),"super":new P(this),end:new L(this)},this.hud=new p(this),this.world.view.interactiveChildren=!1,this.view.addChild(this.world.overlay),this.view.addChild(this.hud.party),this.view.addChild(this.black),this.view.addChild(this.hud),this.flash=new B,this.movieBorders=new k(1,1,.05),this.timer=new R(180,s.game),this.timer.onComplete.add(this.onTimeUp,this),this.black.alpha=0,this.goalsA=0,this.goalsB=0,this.view.addChild(this.flash),this.teamManagerB.debug.position.x=400,this.team1AI,this.superMove=new N,this.view.addChild(this.superMove),this.vignette=new n.Sprite.from(ASSET_URL+"img/game/vignette.png"),this.view.addChild(this.vignette),this.controller=a.instance.desktop?new c(this):new u(this),this.goldenGoal=!1};U.constructor=U,U.prototype.setPositions=function(){var t=1600,e=900;this.pitchWidth=t,this.pitchHeight=e,this.pitch.view.width=t,this.pitch.view.height=e,this.setBounds(new n.Rectangle(0,0,t,e)),this.ball.position.x=t/2,this.ball.position.y=e/2,this.goalLeft.position.x=-100,this.goalLeft.left=!0,this.goalLeft.position.y=e/2,this.goalRight.position.x=t,this.goalRight.position.y=e/2,this.keeperRight.position.x=t-30,this.keeperRight.position.y=e/2,this.keeperLeft.position.x=30,this.keeperLeft.position.y=e/2,this.teamLeft.run(function(e){e.position.x=t/2,e.position.y=0},this),this.teamRight.run(function(e){e.position.x=t/2,e.position.y=0},this)},U.prototype.onGoalScored=function(t){this.powerupManager.clear(),this.world.view.camera.shake(),Math.random()<.5?h.sfx.play("crowd_goal_1"):h.sfx.play("crowd_goal_2"),t.left?this.goalsB++:this.goalsA++,this.goldenGoal?this.finish():this.scripts.goal.run(t.left),this.hud.updateScore()},U.prototype.reset=function(t){this.isGameover=!1,this.goldenGoal=!1,this.scripts.start.reset(),this.scripts.goal.reset(),this.scripts["super"].reset(),this.scripts.end.reset(),
this.powerupManager.clear(),this.teamManagerA.setTeam(I.teamA),this.teamManagerB.setTeam(I.teamB),this.teamManagerA.resetPositions(!0,!1),this.teamManagerB.resetPositions(!1,!1),this.counter=0,this.score=0,this.goalsA=0,this.goalsB=0,this.hud.reset(),this.hud.setData(I.countryID,I.opponentID),this.timer.reset(),this.scripts.start.run(!0,!0)},U.prototype.start=function(t){this.reset(t),this.resume()},U.prototype.pause=function(){this.paused||(l.volume=1,l.play("menumusic2"),this.paused=!0,this.view.interactive=!1,s.game.stop(),s.game.remove(this.update,this))},U.prototype.resume=function(){this.paused&&(l.volume=.5,l.play("applause_loop"),this.paused=!1,this.view.interactive=!0,s.game.start(),s.game.add(this.update,this,1))},U.prototype.update=function(){s.game.speed+=.3*(.8*this.speed-s.game.speed),this.world.crash.dt=s.game.speed,this.world.update(),this.world.view3d.camera.focusMode?this.vignette.alpha+=.05*(1-this.vignette.alpha):this.vignette.alpha+=.1*(0-this.vignette.alpha),this.balanceManager.update();this.ball.view3d;this.controller.update(),this.keeperManagerRight.update(),this.keeperManagerLeft.update(),this.teamManagerA.update(),this.teamManagerB.update(),this.hud.update()},U.prototype.onTimeUp=function(){this.goalsA===this.goalsB?this.goldenGoal=!0:this.finish()},U.prototype.finish=function(){this.goldenGoal=!1,this.goalsA>this.goalsB?this.endState=O.END_STATE.WIN:this.goalsA===this.goalsB?this.endState=O.END_STATE.DRAW:this.endState=O.END_STATE.LOSE,this.scripts.end.run(this.endState)},U.prototype.gameover=function(){this.isGameover||(this.isGameover=!0,this.onGameover.dispatch())},U.prototype.setBounds=function(t){var e=200,i=new w(t.x-100,0,100,t.height/2-e/2),r=new w(t.x-100,t.height/2+e/2,100,t.height/2-e/2),n=new w(t.x-200+20,-100,100,t.height+200);n.net=!0;var o=new w(t.x+t.width,0,100,t.height/2-e/2),s=new w(t.x+t.width,t.height/2+e/2,100,t.height/2+e/2),a=new w(t.x+t.width+100-20,-100,100,t.height+200);a.net=!0;var h=new w(t.x-100,t.y-100,t.width+200,100),l=new w(t.x-100,t.y+t.height,t.width+200,100);this.world.add(i),this.world.add(r),this.world.add(n),this.world.add(o),this.world.add(s),this.world.add(a),this.world.add(h),this.world.add(l)},U.prototype.resize=function(t,e){this.hud.resize(t,e),this.controller.resize(t,e),this.world.view3d.resize(t,e),this.black.scale.set(t/100,e/100),this.flash.resize(t,e),this.movieBorders.resize(t,e),this.vignette.width=t,this.vignette.height=e,this.superMove.resize(t,e)},r.exports=U}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(87),o=i(15),s=function(t){this.game=t,this.keyboard=new n,this.keyIsDown=!1,this.enadbled=!0,this.currentActiveItem=null,this.dPad=new PIXI.Point;var e=o.getJson("config").config.LOCALE,i="z";"_fr"===e?i="w":"_de"===e&&(i="y"),this.keyboard.onKeyPress("x",this.onSpacePressed.bind(this)),this.keyboard.onKeyRelease("x",this.onSpaceReleased.bind(this)),this.keyboard.onKeyPress(i,this.onXPressed.bind(this)),this.keyboard.onKeyRelease(i,this.onXReleased.bind(this)),this.keyboard.onKeyRelease("s",function(){})};s.prototype.reset=function(){this.keyIsDown=!1,window.focus()},s.prototype.update=function(t){this.game.paused&&(this.keyIsDown=!1);var e=0,i=0,r=this.game.teamManagerA;if(this.keyboard.isPressed("left")?e=-1:this.keyboard.isPressed("right")&&(e=1),this.keyboard.isPressed("up")?i=-1:this.keyboard.isPressed("down")&&(i=1),0===e&&0===i)r.stopActivePlayer();else{var n=Math.sqrt(e*e+i*i);e/=n,i/=n,r.moveActivePlayerInDirection(e,-i)}},s.prototype.onSpacePressed=function(){this.game.teamManagerA.actionOneBegin()},s.prototype.onSpaceReleased=function(){this.game.teamManagerA.actionOneEnd()},s.prototype.onXPressed=function(){this.game.teamManagerA.actionTwoBegin()},s.prototype.onXReleased=function(){this.game.teamManagerA.actionTwoEnd()},s.prototype.resize=function(t,e){},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){Keyboard=function(){this._states={up:0,down:1},this._keyCodes={37:{label:"left",state:0,preventBubble:!0},38:{label:"up",state:0,preventBubble:!0},39:{label:"right",state:0,preventBubble:!0},40:{label:"down",state:0,preventBubble:!0},49:{label:"1",state:0,preventBubble:!0},50:{label:"2",state:0,preventBubble:!0},51:{label:"3",state:0,preventBubble:!0},52:{label:"4",state:0,preventBubble:!0},53:{label:"5",state:0,preventBubble:!0},54:{label:"6",state:0,preventBubble:!0},55:{label:"7",state:0,preventBubble:!0},56:{label:"8",state:0,preventBubble:!0},57:{label:"9",state:0,preventBubble:!0},97:{label:"numpad1",state:0,preventBubble:!0},98:{label:"numpad2",state:0,preventBubble:!0},99:{label:"numpad3",state:0,preventBubble:!0},100:{label:"numpad4",state:0,preventBubble:!0},101:{label:"numpad5",state:0,preventBubble:!0},102:{label:"numpad6",state:0,preventBubble:!0},103:{label:"numpad7",state:0,preventBubble:!0},104:{label:"numpad8",state:0,preventBubble:!0},105:{label:"numpad9",state:0,preventBubble:!0},13:{label:"enter",state:0,preventBubble:!0},32:{label:"space",state:0,preventBubble:!0},65:{label:"a",state:0,preventBubble:!0},68:{label:"d",state:0,preventBubble:!0},83:{label:"s",state:0,preventBubble:!0},87:{label:"w",state:0,preventBubble:!0},89:{label:"y",state:0,preventBubble:!0},90:{label:"z",state:0,preventBubble:!0},88:{label:"x",state:0,preventBubble:!0}},this.hash={},this.hashUp={},this.disabled=!1,this.start(),this.dirty=!1},Keyboard.prototype.start=function(){var t=this;this._onKeyDown=function(e){return t.processKeyDown(e)},this._onKeyUp=function(e){return t.processKeyUp(e)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1)},Keyboard.prototype.stop=function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp)},Keyboard.prototype.processKeyDown=function(t){if(this.disabled!==!0){var e=t.keyCode;if(this.keyCode=e,this._keyCodes.hasOwnProperty(e)){var i=this._keyCodes[e];i.preventBubble&&t.preventDefault(),i.state!=this._states.down&&(i.state=this._states.down,this.dirty=!0,this.hash[i.label]&&this.hash[i.label](i))}}},Keyboard.prototype.processKeyUp=function(t){if(this.disabled!==!0){var e=t.keyCode;if(this.keyCode=null,this._keyCodes.hasOwnProperty(e)){var i=this._keyCodes[e];i.preventBubble&&t.preventDefault(),i.state!=this._states.up&&(i.state=this._states.up,this.dirty=!0,this.hashUp[i.label]&&this.hashUp[i.label](i))}}},Keyboard.prototype.isPressed=function(t){var e=this.getCodeFromLabel(t);return e?this._keyCodes[e].state===this._states.down:!1},Keyboard.prototype.getCodeFromLabel=function(t){for(var e in this._keyCodes)if(this._keyCodes[e].label===t)return e;return!1},Keyboard.prototype.onKeyPress=function(t,e){this.hash[t]=e},Keyboard.prototype.onKeyRelease=function(t,e){this.hashUp[t]=e},i.exports=Keyboard}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){function n(t){var t=t||{};s.call(this),this.sprite=PIXI.Sprite.from(t.downFrame),this.sprite.anchor.set(.5),this.addChild(this.sprite),this.interactiveChildren=!1,this.view.hitArea=new PIXI.Circle(0,0,80),this.actionFrame=new PIXI.Sprite,this.actionFrame.anchor.set(.5),this.addChild(this.actionFrame),this.onDown.add(function(){this.sprite.texture=PIXI.Texture.fromFrame(t.downFrame)},this),this.onUp.add(function(){this.sprite.texture=PIXI.Texture.fromFrame(t.upFrame)},this)}var o=i(89),s=i(90),a=function(t){this.game=t,this.view=this.game.view,this.view.interactive=!0,this.view.buttonMode=!0;var e=PIXI.Sprite.from("touch-button-background.png");e.anchor.set(.5);var i=PIXI.Sprite.from("touch-button-movement.png");i.anchor.set(.5);var r={background:e,stick:i};this.analogueStick=new o(r),this.buttonOne=new n({downFrame:"touch-button-yellow-on.png",upFrame:"touch-button-yellow.png"}),this.buttonOne.setActionFrame("touch-icon-shoot.png"),this.buttonOne.addCallbacks(function(){this.game.teamManagerA.actionOneBegin()},function(){this.game.teamManagerA.actionOneEnd()},this),this.buttonTwo=new n({downFrame:"touch-button-blue-on.png",upFrame:"touch-button-blue.png"}),this.buttonTwo.addCallbacks(function(){this.game.teamManagerA.actionTwoBegin()},function(){this.game.teamManagerA.actionTwoEnd()},this),this.view.addChild(this.analogueStick.view),this.view.addChild(this.buttonOne.view),this.view.addChild(this.buttonTwo.view),this.w=1024,this.h=702,this.resize(this.w,this.h)};a.prototype.disable=function(){this.view.interactive=!1},a.prototype.enable=function(){this.view.interactive=!0},a.prototype.update=function(){this.analogueStick.update();var t=this.game.teamManagerA;this.game.teamManagerA.activePlayer&&this.game.teamManagerA.activePlayer.ballSkills.ball?this.buttonTwo.setActionFrame("touch-icon-pass.png"):this.buttonTwo.setActionFrame("touch-icon-tackle.png");var e=this.analogueStick.delta;t.moveActivePlayerInDirection(e.x,-e.y)},a.prototype.resize=function(t,e){this.analogueStick.view.position.set(100,.65*e),this.buttonOne.view.position.set(t-100,.65*e-80),this.buttonTwo.view.position.set(t-100,.65*e+60)},a.prototype.onDown=function(t){t.data.getLocalPosition(this.view)};n.prototype=Object.create(s.prototype),n.prototype.setActionFrame=function(t){this.actionFrame.texture=PIXI.Texture.fromFrame(t)},n.prototype.addCallbacks=function(t,e,i){this.onDown.add(t,i),this.onUp.add(e,i)},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(45),new n.Point),s=function(t){t=t||{},this.view=new n.Container,this.view.hitArea=new n.Rectangle(0,0,1e4,1e4),this.view.interactive=!0,this.dot=t.background||(new n.Graphics).beginFill(16711680,.4).drawCircle(0,0,70),this.view.addChild(this.dot),this.pad=t.stick||(new n.Graphics).beginFill(16711680).drawCircle(0,0,50),this.pad.interactive=!0,t.stick||(this.pad.hitArea=new n.Circle(0,0,60)),this.pad.alpha=.6,this.view.addChild(this.pad),this.range=30,this.pad.on("mousedown",this.down,this),this.view.on("mouseup",this.up,this),this.view.on("mouseupoutside",this.up,this),this.pad.on("touchstart",this.down,this),this.view.on("touchend",this.up,this),this.view.on("touchendoutside",this.up,this),this.delta=new n.Point};s.prototype.update=function(t){},s.prototype.down=function(t){this.view.hitArea=this.hit,this.moveId=t.data.identifier,this.isDown=!0;t.data.getLocalPosition(this.view,o);this.pad.alpha=1,this.view.on("mousemove",this.move,this),this.view.on("touchmove",this.move,this)},s.prototype.up=function(t){if(this.view.hitArea=null,this.moveId===t.data.identifier){this.moveId=99999999,this.isDown=!1;t.data.getLocalPosition(this.view,o);this.pad.x=0,this.pad.y=0,this.pad.alpha=.6,this.delta.x=0,this.delta.y=0,this.view.off("mousemove",this.move,this),this.view.off("touchmove",this.move,this)}},s.prototype.move=function(t){if(this.moveId===t.data.identifier){var e=t.data.getLocalPosition(this.view,o);this.pad.x=e.x,this.pad.y=e.y;var i=e.x,r=e.y,n=Math.sqrt(i*i+r*r);i/=n,r/=n,n>this.range&&(n=this.range),this.pad.x=i*n,this.pad.y=r*n,this.delta.x=i*n/30,this.delta.y=r*n/30}},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(14),o=i(7),s=function(){o.Container.call(this),this.view=this,this.onPress=new n,this.onDown=new n,this.onUp=new n,this.onHover=new n,this.onOut=new n,this.mousedown=this.touchstart=this.onDown.dispatch.bind(this,this),this.mouseup=this.touchend=this.onUp.dispatch.bind(this,this),this.click=this.tap=this.onPress.dispatch.bind(this,this),this.mouseover=this.onHover.dispatch.bind(this,this),this.touchendoutside=this.mouseupoutside=this.mouseout=this.onOut.dispatch.bind(this,this),this.onDown.add(this.down,this),this.onUp.add(this.up,this),this.onHover.add(this.hover,this),this.onOut.add(this.out,this),this._scale=new o.Point,this.enable()};s.prototype=Object.create(o.Container.prototype),s.prototype.constructor=s,s.prototype.setSize=function(t){switch(t){case"small":this.scale.set(.5);break;case"big":this.scale.set(2);break;default:this.scale.set(1)}},s.prototype.enable=function(){this.interactive=!0,this.buttonMode=!0},s.prototype.disable=function(){this.interactive=!1,this.buttonMode=!1},s.prototype.down=function(t,e){},s.prototype.up=function(t,e){},s.prototype.hover=function(t,e){},s.prototype.out=function(t,e){},s.prototype.show=function(){this.visible=!0,this.enable()},s.prototype.hide=function(){this.disable(),this.visible=!1},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(92),s=i(50),a=(i(33),i(93)),h=i(49),l=(i(46),i(31),i(21),i(34)),c=function(t){n.Container.call(this),this.game=t,this.scorePanel=new n.Container,this.addChild(this.scorePanel),this.score=new n.Text("0 - 0",{fill:"white",font:"32px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"}),this.score.anchor.set(.5,.5),this.scorePanel.addChild(this.score),this.time=new n.Text("00:00",{fill:"#ffd800",font:"20px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round"}),this.time.position.set(0,20),this.time.anchor.x=.5,this.scorePanel.addChild(this.time),this.detailPool=new s(o),this.message=new a(this.game),this.addChild(this.message),this.party=new h(null,null,1),this.party.visible=!1,this.pos=new n.Point};c.prototype=Object.create(n.Container.prototype),c.prototype.setData=function(t,e){t&&e&&(this.scorePanel.removeChild(this.flag),this.flag=new n.Sprite.fromFrame(t.FLAG),this.flag.anchor.set(.5,.5),this.flag.scale.set(.5),this.flag.position.set(-75,2),this.scorePanel.addChild(this.flag),this.scorePanel.removeChild(this.flag2),this.flag2=new n.Sprite.fromFrame(e.FLAG),this.flag2.anchor.set(.5,.5),this.flag2.scale.set(.5),this.flag2.position.set(75,2),this.scorePanel.addChild(this.flag2))},c.prototype.reset=function(){this.score.text=this.game.score,this.message.reset()},c.prototype.updateScore=function(t,e){},c.prototype.update=function(){var t=this.game.goalsA+" : "+this.game.goalsB;this.score.text=t,this.pos.x=this.game.world.view3d.camera.position.x,this.party.update(this.pos),this.game.goldenGoal?this.time.text=l.game_screen.goldenGoal:this.time.text=this.formatTime(Math.floor(this.game.timer.getSecondsLeft()))},c.prototype.formatTime=function(t){var e=Math.max(Math.floor(t/60),0),i=Math.max(t%60,0);return(10>e?"0":"")+e+":"+(10>i?"0":"")+i},c.prototype.showGameover=function(){},c.prototype.resize=function(t,e){this.message.x=t/2,this.message.y=e/2,this.scorePanel.position.y=55,this.scorePanel.position.x=t/2},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(50),i(14)),s=function(){n.Text.call(this,"YAY",{font:"26px chunkfiveroman",fill:"#eaff32",dropShadow:!0}),this.anchor.set(.5),this.count=0,this.multiplierColors=["#eaff32","#ffd300","#ff70df","#00ebff"],this.onFinish=new o};s.prototype=Object.create(n.Text.prototype),s.prototype.setup=function(t,e,i,r){this.x=t,this.y=e,this.speed=5,this.alpha=1,this.count=0,this.scale.x=this.scale.y=0,TweenLite.to(this.scale,.5,{x:1+.2*(r-1),y:1+.2*(r-1),ease:Elastic.easeOut}),this.style.fill=this.multiplierColors[(r-1)%4],this.text=i+(r>1?"x"+r:"")},s.prototype.updateTransform=function(){n.Text.prototype.updateTransform.call(this),this.speed*=.95,this.position.y-=this.speed,this.count++,this.count>20&&(this.alpha*=.95),this.alpha<.3&&this.onFinish.dispatch(this)},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(17),i(31)),s=(i(46),i(94)),a=i(95),h=i(96),l=i(97),c=function(t){n.Container.call(this),this.game=t,this.message=null};c.prototype=Object.create(n.Container.prototype),c.prototype.show=function(t){this.onAnimComplete(this),t===o.MESSAGE_ID.VS?(this.message=new s(this.game),this.animToBottom()):t===o.MESSAGE_ID.WHISTLE?(this.message=new a(this.game),this.animFromBottom()):t===o.MESSAGE_ID.GOAL?(this.message=new h(this.game),this.animToBottom()):t===o.MESSAGE_ID.SCORE&&(this.message=new l(this.game),this.animToBottom()),null!==this.message&&this.addChild(this.message)},c.prototype.reset=function(){this.onAnimComplete(this)},c.prototype.animToBottom=function(){TweenLite.killTweensOf(this.message),TweenLite.killTweensOf(this.message.scale),this.message.alpha=0,this.message.scale.set(2),TweenLite.to(this.message,.2,{alpha:1}),TweenLite.to(this.message.scale,.5,{x:1,y:1}),TweenLite.to(this.message,.2,{alpha:0,delay:2}),TweenLite.to(this.message.scale,.5,{x:0,y:0,delay:2,onComplete:this.onAnimComplete,onCompleteScope:this})},c.prototype.animFromBottom=function(){TweenLite.killTweensOf(this.message.position),this.message.position.y=this.game.pitchHeight/2,TweenLite.to(this.message.position,.5,{y:this.game.pitchHeight/2-this.message.height,ease:Back.easeOut}),TweenLite.to(this.message.position,.5,{y:this.message.height,delay:2,ease:Back.easeIn,onComplete:this.onAnimComplete,onCompleteScope:this})},c.prototype.onAnimComplete=function(){null!==this.message&&(this.removeChild(this.message),TweenLite.killTweensOf(this.message),TweenLite.killTweensOf(this.message.position),TweenLite.killTweensOf(this.message.scale),this.message=null)},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(34),s=i(46),a=function(t){n.Container.call(this),this.game=t,this.bg=n.Sprite.from(ASSET_URL+"img/ui/vs-panel.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg);var e=s.countryID,i=s.opponentID;this.flag=new n.Sprite.fromFrame(e.FLAG),this.flag.anchor.set(.5,.5),this.flag.scale.set(.75),this.flag.position.set(-100,-35),this.addChild(this.flag),this.flag2=new n.Sprite.fromFrame(i.FLAG),this.flag2.anchor.set(.5,.5),this.flag2.scale.set(.75),this.flag2.position.set(100,-35),this.addChild(this.flag2);var r={fill:"white",font:"20px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round",align:"center"};this.labelCountry=new n.Text(o.countries[e.ID].NAME,r),this.labelCountry.anchor.set(.5,.5),this.labelCountry.position.set(-100,35),this.addChild(this.labelCountry),this.labelVs=new n.Text("vs",r),this.labelVs.anchor.set(.5,.5),this.labelVs.position.set(0,35),this.addChild(this.labelVs),this.labelCountry2=new n.Text(o.countries[i.ID].NAME,r),this.labelCountry2.anchor.set(.5,.5),this.labelCountry2.position.set(100,35),this.addChild(this.labelCountry2)};a.prototype=Object.create(n.Container.prototype),r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(34),i(46),i(33)),s=function(t){n.Container.call(this),this.game=t;var e=["robin-referee-whistle0001.png","robin-referee-whistle0002.png","robin-referee-whistle0003.png","robin-referee-whistle0004.png","robin-referee-whistle0005.png","robin-referee-whistle0006.png","robin-referee-whistle0007.png","robin-referee-whistle0008.png","robin-referee-whistle0009.png","robin-referee-whistle0010.png","robin-referee-whistle0011.png","robin-referee-whistle0012.png","robin-referee-whistle0013.png","robin-referee-whistle0014.png","robin-referee-whistle0015.png","robin-referee-whistle0016.png","robin-referee-whistle0017.png","robin-referee-whistle0018.png","robin-referee-whistle0019.png","robin-referee-whistle0020.png","robin-referee-whistle0021.png","robin-referee-whistle0022.png","robin-referee-whistle0023.png","robin-referee-whistle0024.png","robin-referee-whistle0025.png","robin-referee-whistle0026.png","robin-referee-whistle0027.png","robin-referee-whistle0028.png","robin-referee-whistle0029.png","robin-referee-whistle0030.png","robin-referee-whistle0031.png","robin-referee-whistle0032.png","robin-referee-whistle0033.png","robin-referee-whistle0034.png","robin-referee-whistle0035.png","robin-referee-whistle0036.png","robin-referee-whistle0037.png","robin-referee-whistle0038.png"];this.referee=new n.MovieClip(o.getTexturesFromFrames(e)),this.referee.anchor.set(.5,0),this.referee.position.set(70,-10),this.referee.animationSpeed=.3,this.addChild(this.referee),this.referee.play(),t.scripts.start.left||(this.referee.scale.x=-1,this.referee.position.x=-70)};s.prototype=Object.create(n.Container.prototype),r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(34),s=(i(46),function(t){n.Container.call(this),this.game=t;var e={fill:"white",font:"108px "+window.MAIN_FONT,stroke:!0,strokeThickness:30,lineJoin:"round",align:"center",dropShadow:!1};this.message=new n.Text(o.game_screen.goal,e),this.message.anchor.set(.5),this.addChild(this.message)});s.prototype=Object.create(n.Container.prototype),r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(34),i(46)),s=function(t){n.Container.call(this),this.game=t,this.bg=n.Sprite.from(ASSET_URL+"img/ui/vs-panel.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg);var e=o.countryID,i=o.opponentID;this.flag=new n.Sprite.fromFrame(e.FLAG),this.flag.anchor.set(.5,.5),this.flag.scale.set(.75),this.flag.position.set(-100,-30),this.addChild(this.flag),this.flag2=new n.Sprite.fromFrame(i.FLAG),this.flag2.anchor.set(.5,.5),this.flag2.scale.set(.75),this.flag2.position.set(100,-30),this.addChild(this.flag2);var r={fill:"white",font:"30px "+window.MAIN_FONT,stroke:!0,strokeThickness:8,lineJoin:"round",align:"center"};this.labelScore=new n.Text(""+this.game.goalsA,r),this.labelScore.anchor.set(.5,.5),this.labelScore.position.set(-100,30),this.addChild(this.labelScore),this.labelVs=new n.Text("-",r),this.labelVs.anchor.set(.5,.5),this.labelVs.position.set(0,30),this.addChild(this.labelVs),this.labelScore2=new n.Text(""+this.game.goalsB,r),this.labelScore2.anchor.set(.5,.5),this.labelScore2.position.set(100,30),this.addChild(this.labelScore2)};s.prototype=Object.create(n.Container.prototype),r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){r.exports={World:i(99),Group:i(100),PixiView:i(101),CrashWorld:i(102)}}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(100)),o=i(20),s=function(){this.allItems=new n,this.updateItems=new n,this.groups={},this.itemsToRemove=[],this.systems=[]};s.constructor=s,s.prototype.install=function(t,e){this.systems.push(t),t.init(this),this[e]=t},s.prototype.addGroup=function(t){for(var e=0;e<t.children.length;e++)this.add(t.children[e])},s.prototype.initGroups=function(t){for(var e=0;e<t.length;e++){var i=t[e],r=this.groups[i];r||(r=this.groups[i]=new n)}},s.prototype.add=function(t){if(t._gc){var e=this.itemsToRemove.indexOf(t);this.itemsToRemove.splice(e,1),t._gc=!1}t.world&&this.removeItem(t),t.world=this;for(var i=0;i<this.systems.length;i++)this.systems[i].add(t);this.allItems.add(t);for(var i=0;i<t.groups.length;i++){var r=t.groups[i],o=this.groups[r];o||(o=this.groups[r]=new n),o.add(t)}t.update&&this.updateItems.add(t),t.addedToWorld&&t.addedToWorld(this)},s.prototype.remove=function(t){!t._gc&&t.world&&(t._gc=!0,this.itemsToRemove.push(t))},s.prototype.update=function(){var t=Math.round(o.game.deltaTime/o.game.speed);t>2&&(t=2);for(var e=0;t>e;e++){this.removeItems();for(var i=0;i<this.systems.length;i++)this.systems[i].preupdate();for(var r=this.updateItems.children,i=0;i<r.length;i++)r[i].update();for(var i=0;i<this.systems.length;i++)this.systems[i].update();for(var i=0;i<this.systems.length;i++)this.systems[i].postupdate()}},s.prototype.removeItems=function(){this.itemsToRemove.length;for(var t=0;t<this.itemsToRemove.length;t++){var e=this.itemsToRemove[t];this.removeItem(e)}this.itemsToRemove.length=0},s.prototype.removeItem=function(t){t._gc=!1;for(var e=0;e<this.systems.length;e++)this.systems[e].remove(t);t.update&&this.updateItems.remove(t),t.removedFromWorld&&t.removedFromWorld(this),t.world=null,this.allItems.remove(t);for(var e=0;e<t.groups.length;e++){var i=t.groups[e];this.groups[i].remove(t)}},s.prototype.clear=function(){for(var t=0;t<this.systems.length;t++)this.systems[t].clear();this.allItems.empty(),this.updateItems.empty(),this.groups={},this.removeItems(),this.collisionHash={}},s.prototype.find=function(t,e){if(!this.groups[t])return null;for(var i=this.groups[t].children,r=0;r<i.length;r++)if(i[r].meta.name===e)return i[r]};var a=[];s.prototype.findAll=function(t,e){if(!this.groups[t])return null;var i=this.groups[t].children;a.length=0;for(var r=0;r<i.length;r++)i[r].meta.name===e&&a.push(i[r]);return a},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(t){this.children=t||[]};r.prototype.add=function(t){return this.children.push(t),t},r.prototype.remove=function(t){var e=this.children.indexOf(t);return-1===e?null:(this.children.splice(e,1),t)},r.prototype.getIndex=function(t){return this.children.indexOf(t)},r.prototype.getItem=function(t){return this.children[t]},r.prototype.run=function(t,e){if(e)for(var i=0;i<this.children.length;i++)t.call(e,this.children[i]);else for(var i=0;i<this.children.length;i++)t(this.children[i])},r.prototype.empty=function(){this.children.length=0},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7);n.DisplayObject.prototype.layer="default";var o=function(t){n.Container.call(this),this.innerContainer=new n.Container,this.activeItemsContainer=new n.Container,this.addChild(this.innerContainer),this.innerContainer.addChild(this.activeItemsContainer),this.filterArea=new n.Rectangle(0,0,1e6,1e6),this.layers={},this.camera=t.camera||{x:0,y:0,zoom:1},this.addLayer("back"),this.addLayer("default"),this.addLayer("front")};o.prototype=Object.create(n.Container.prototype),o.prototype.init=function(t){},o.prototype.preupdate=function(t){},o.prototype.update=function(){this.camera.update();var t=this.camera.zoom;this.scale.set(t),this.position.x=this.camera.viewWidth/2-this.camera.viewWidth/2*t,this.position.y=this.camera.viewHeight/2-this.camera.viewHeight/2*t,this.innerContainer.x=-this.camera.x+this.camera.viewWidth/2,this.innerContainer.y=-this.camera.y+this.camera.viewHeight/2},o.prototype.postupdate=function(t){},o.prototype.add=function(t){if(t.view){var e=t.view,i=this.layers[e.layer];e.parent=i,i.children.push(t.view)}},o.prototype.remove=function(t){if(t.view){var e=t.view,i=this.layers[e.layer],r=i.children.indexOf(e);-1!=r&&(e.parent=null,i.children.splice(r,1))}},o.prototype.clear=function(){for(var t in this.layers)this.layers[t].removeChildren()},o.prototype.addLayer=function(t){this.layers[t]=new n.Container,this.activeItemsContainer.addChild(this.layers[t])},o.prototype.bringToFront=function(t){var e=this.layers[t.view.layer],i=e.children.indexOf(t.view);-1!=i&&(e.children.splice(i,1),e.children.push(t.view))},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(100),o=i(103),s=i(106),a=i(108),h=function(){this.staticItems=new a,this.kinimaticItems=new n,this.dynamicItems=new n,this.collisions=[],this.narrowPhase=new o,this.dt=1,this.collisionKeys={},this.DEBUG=!1};h.prototype.init=function(t){},h.prototype.preupdate=function(){},h.prototype.add=function(t){t.body&&(this.DEBUG&&(t._debugView||(t._debugView=t.body.getDebugView(),t._debugView.alpha=.5,t.view&&t.view.addChild(t._debugView))),t.body.type===s.STATIC?this.staticItems.add(t):t.body.type===s.KINIMATIC?this.kinimaticItems.add(t):t.body.type===s.DYNAMIC&&this.dynamicItems.add(t))},h.prototype.remove=function(t){t.body&&(t.body.type===s.STATIC?this.staticItems.remove(t):t.body.type===s.KINIMATIC?this.kinimaticItems.remove(t):t.body.type===s.DYNAMIC&&this.dynamicItems.remove(t))},h.prototype.update=function(){for(var t=this.getCollisions(),e=0;e<this.dynamicItems.children.length;e++)this.dynamicItems.children[e].body.update(this.dt);this.narrowPhase.hitTest(t)},h.prototype.postupdate=function(t){},h.prototype.reset=function(){this.staticItems.empty(),this.kinimaticItems.empty(),this.dynamicItems.empty(),this.collisions.length=0,this.narrowPhase.reset()},h.prototype.onCollision=function(t,e){},h.prototype.getKey=function(t,e){return(t<<12)+e},h.prototype.registerCollison=function(t,e){this.collisionKeys[this.getKey(t,e)]=!0,this.collisionKeys[this.getKey(e,t)]=!0},h.prototype.getCollisions=function(){this.collisions.length=0;var t=this.dynamicItems.children;this.sortAxisList(t);for(var e=0;e<t.length;e++)for(var i=t[e],r=i.body.position.x+i.body.shape.x+i.body.shape.width+5,n=e+1;n<t.length;n++){var o=t[n],s=o.body.position.x+o.body.shape.x-5;if(s>=r)break;var a=!0,h=this.getKey(o.type,i.type);this.collisionKeys[h]?o.canCollide&&i.canCollide||(a=!1):a=!1,a&&this.collisions.push(i,o)}for(var e=0;e<this.dynamicItems.children.length;e++)for(var l=this.dynamicItems.children[e],c=this.staticItems.retrieveArea(l),n=0;n<c.length;n++){var u=c[n];u.canCollide&&l.canCollide&&this.collisions.push(l,u)}for(var e=0;e<this.dynamicItems.children.length;e++)for(var n=0;n<this.kinimaticItems.children.length;n++){var l=this.dynamicItems.children[e],u=this.kinimaticItems.children[n],a=!0,h=this.getKey(u.type,l.type);this.collisionKeys[h]?l.canCollide&&u.canCollide||(a=!1):a=!1,a&&(l.debug,this.collisions.push(l,u))}return this.collisions},h.prototype.sortAxisList=function(t){for(var e=1,i=t.length;i>e;e++){for(var r=t[e],n=e-1;n>=0;n--){var o=t[n];if(o.body.shape.x+o.body.position.x<=r.body.shape.x+r.body.position.x)break;t[n+1]=t[n]}t[n+1]=r}return t},h.prototype.castRay=function(t,e){},h.prototype.constrainToBounds=function(){for(var t=this.bounds,e=0;e<this.dynamicItems.children.length;e++){var i=this.dynamicItems.children[e].body;i.position.x+i.shape.x<t.x?i.position.x=t.x+i.shape.x:i.position.x+i.shape.x+i.shape.width>t.x+t.width&&(i.position.x=t.x+t.width-(i.shape.x+i.shape.width)),i.position.y+i.shape.y<t.y?i.position.y=t.y+i.shape.y:i.position.y+i.shape.y+i.shape.height>t.y+t.height&&(i.position.y=t.y+t.height-(i.shape.y+i.shape.height),this.dynamicItems.children[e].onGround=!0)}},h.prototype.setBounds=function(t){this.bounds.x=t.x,this.bounds.y=t.y,this.bounds.width=t.width,this.bounds.height=t.height},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(104)),o=i(105),s=i(106),a=(i(107),function(){this.collisions={},this.pool=[],this.tickId=0,this.currentCollisions=[],this.collisionDatas=[]});a.prototype.hitTest=function(t){this.tickId++;for(var e=0;2>e;e++)for(var i=0;i<t.length;i+=2){var r=this.hitTestAABBAABB(t[i],t[i+1]);r&&r.object1.body.solid&&r.object2.body.solid&&this.solve(r)}for(var i=0;i<this.currentCollisions.length;i++){var n=this.currentCollisions[i];n._tickId!==this.tickId&&(this.endCollision(n),this.currentCollisions.splice(i,1),i--)}},a.prototype.hitTestAABBAABB=function(t,e){var i=t.body,r=e.body,o=i.shape,s=r.shape,a=o.x+t.position.x,h=o.y+t.position.y,l=s.x+e.position.x,c=s.y+e.position.y,u=h+o.height-c,p=c+s.height-h,d=a+o.width-l,f=l+s.width-a,m=999999;if(m>d&&(m=d),m>f&&(m=f),m>u&&(m=u),m>p&&(m=p),m>0){var g=new n;m==d?(g.x=-1,g.y=0):m==f?(g.x=1,g.y=0):m==u?(g.x=0,g.y=-1):m==p&&(g.x=0,g.y=1);var v=-m,y=this.startCollision(t,e,v,g);if(!y.ignore)return y}return null},a.prototype.solve=function(t){var e=t.object1,i=t.object2,r=t.projection,n=t.penetration;if(i.body.type===s.DYNAMIC){e.position.x-=r.x*n*.5,e.position.y-=r.y*n*.5,i.position.x+=r.x*n*.5,i.position.y+=r.y*n*.5;var o=e.body.velocity.x-i.body.velocity.x,a=e.body.velocity.y-i.body.velocity.y;0!==r.x?o*r.x<=0&&(e.body.velocity.x-=.5*o,i.body.velocity.x+=.5*o):a*r.y<=0&&(e.body.velocity.y-=.5*a,i.body.velocity.y+=.5*a)}else{e.position.x-=r.x*n,e.position.y-=r.y*n;var o=e.body.velocity.x-i.body.velocity.x,a=e.body.velocity.y-i.body.velocity.y;0!==r.x?o*r.x<=0&&(e.body.velocity.x*=-e.body.bounce):a*r.y<=0&&(e.body.velocity.y*=-e.body.bounce)}},a.prototype.startCollision=function(t,e,i,r){var n;n=t.UID>e.UID?(e.UID<<12)+t.UID:(t.UID<<12)+e.UID;var s=this.collisions[n];return s?(s.penetration=i,s.projection=r,s._tickId=this.tickId,s.ignore||(-1===r.y?t.body.velocity.y>=0&&(t.body.currentSurface=e,t.onGround=!0):1===r.y&&e.body.velocity.y>=0&&(e.body.currentSurface=t,
e.onGround=!0)),s):(s=this.pool.pop(),s?(s.object1=t,s.object2=e,s.penetration=i,s.projection=r,s.ignore=!1):s=new o(t,e,i,r,!1),s._key=n,s._tickId=this.tickId,r.y===-1*t.body.flip?(t.body.currentSurface=e,t.onGround=!0):r.y===1*e.body.flip&&(e.body.currentSurface=t,e.onGround=!0),t.onCollideBegin&&t.onCollideBegin(s),e.onCollideBegin&&e.onCollideBegin(s),this.collisions[n]=s,this.currentCollisions.push(s),s)},a.prototype.endCollision=function(t){var e=t._key,i=this.collisions[e];return i&&(this.pool.push(i),this.collisions[e]=null),t.object1.world&&(t.object1.onCollideEnd&&t.object1.onCollideEnd(i),t.object2.onCollideEnd&&t.object2.onCollideEnd(i)),i},a.prototype.reset=function(){this.collisions={},this.tickId=0,this.currentCollisions=[]},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(t,e){this.x=t||0,this.y=e||0,this.id=r._UID++};r._UID=0,r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.plus=function(t){return this.x+=t.x,this.y+=t.y,this},r.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this},r.prototype.invert=function(t){return this.x*=-1,this.y*=-1,this},r.prototype.multiply=r.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},r.prototype.divideScalar=function(t){if(0===t)this.x=0,this.y=0;else{var e=1/t;this.x*=e,this.y*=e}return this},r.prototype.dot=function(t){return this.x*t.x+this.y*t.y},r.prototype.length=function(t){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},r.prototype.normalize=function(){return this.divideScalar(this.length())},r.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSq(t))},r.prototype.distanceToSq=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},r.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},r.prototype.setX=function(t){return this.x=t,this},r.prototype.setY=function(t){return this.y=t,this},r.prototype.setLength=function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},r.prototype.invert=function(t){return this.x*=-1,this.y*=-1,this},r.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},r.prototype.rad=function(){return Math.atan2(this.x,this.y)},r.prototype.deg=function(){return 180*this.rad()/Math.PI},r.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},r.prototype.rotate=function(t){var e=this.x;return this.x=this.x*Math.cos(t)-this.y*Math.sin(t),this.y=e*Math.sin(t)+this.y*Math.cos(t),this},r.projectPoint=function(t,e){var i=new r(0,0),n=r.project(t.clone().minus(i),e);return n.clone().plus(i)},r.project=function(t,e){var i=new r(0,0),n=t.dot(e);return i.x=n/(e.x*e.x+e.y*e.y)*e.x,i.y=n/(e.x*e.x+e.y*e.y)*e.y,i},r.prototype.constructor=r,i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(t,e,i,r,n){this.object1=t,this.object2=e,this.penetration=i,this.projection=r,this.ignore=n||!1,this._key=null,this._tickId=null};r.prototype.getOtherObject=function(t){return t===this.object1?this.object2:this.object1},r.pool=[],i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(45),s=i(104),a=function(t){this.type=a.DYNAMIC,this.shape=t,this.passthrough=!1,this.currentSurface=null,this.position=new n.Point,this.timeScale=1,this.velocity=new s,this.acceleration=new s,this.bounce=0,this.maxSpeed=3,this.maxSpeedY=3,this.gravity=0,this.friction=.9,this.sleeping=!1,this.solid=!0,this.active=!0,this.remainder=0,this.flip=1};a.prototype.setMaxSpeed=function(t){this.maxSpeed=this.maxSpeedY=t},a.prototype.update=function(t){this.active&&(this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.velocity.y*=this.friction,this.velocity.x*=this.friction,this.velocity.y+=this.gravity*this.timeScale,this.velocity.x=o.cap(this.velocity.x,-this.maxSpeed,this.maxSpeed),this.velocity.y=o.cap(this.velocity.y,-this.maxSpeedY,this.maxSpeedY),this.position.x+=this.velocity.x*this.timeScale*t,this.position.y+=this.velocity.y*this.timeScale*t)},a.prototype.reset=function(){this.velocity.x=0,this.velocity.y=0,this.acceleration.x=0,this.acceleration.y=0,this.remainder=0,this.active=!0},a.prototype.getDebugView=function(t){var e=this.shape,t=t||colors[this.type];return(new n.Graphics).beginFill(t).drawRect(e.x,e.y,e.width,e.height)},a.fromRect=function(t,e,i,r){return new a(new n.Rectangle(t,e,i,r))},a.STATIC=0,a.KINIMATIC=1,a.DYNAMIC=2,a.NONE=3,colors=[4602488,16776960,16711680,255],r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,r){var n;n=function(t,e,n){var o=r(106),s=function(){};s.solve=function(t,e){for(i=0;i<t.length;i++){var r=t[i],n=r.object1,s=r.object2,a=r.projection,h=r.penetration;if(s.body.type===o.DYNAMIC){n.position.x-=a.x*h*.5,n.position.y-=a.y*h*.5,s.position.x+=a.x*h*.5,s.position.y+=a.y*h*.5;var l=n.body.velocity.x-s.body.velocity.x,c=n.body.velocity.y-s.body.velocity.y;0!==a.x?l*a.x<=0&&(n.body.velocity.x-=.5*l,s.body.velocity.x+=.5*l):c*a.y<=0&&(n.body.velocity.y-=.5*c,s.body.velocity.y+=.5*c)}else{n.position.x-=a.x*h,n.position.y-=a.y*h;var l=n.body.velocity.x-s.body.velocity.x,c=n.body.velocity.y-s.body.velocity.y;0!==a.x?l*a.x<=0&&(n.body.velocity.x-=l):(c*a.y<=0&&(n.body.velocity.y-=c),n.body.position.x+=s.body.velocity.x)}}},s.solve3=function(t){var e=t.object1,i=t.object2,r=t.projection,n=t.penetration;if(i.body.type===o.DYNAMIC){e.position.x-=r.x*n*.5,e.position.y-=r.y*n*.5,i.position.x+=r.x*n*.5,i.position.y+=r.y*n*.5;var s=e.body.velocity.x-i.body.velocity.x,a=e.body.velocity.y-i.body.velocity.y;0!==r.x?s*r.x<=0&&(e.body.velocity.x-=.5*s,i.body.velocity.x+=.5*s):a*r.y<=0&&(e.body.velocity.y-=.5*a,i.body.velocity.y+=.5*a)}else{e.position.x-=r.x*n,e.position.y-=r.y*n;var s=e.body.velocity.x-i.body.velocity.x,a=e.body.velocity.y-i.body.velocity.y;0!==r.x?s*r.x<=0&&(e.body.velocity.x-=s):(a*r.y<=0&&(e.body.velocity.y-=a),e.body.position.x+=i.body.velocity.x)}},s.solve2=function(t,e){for(i=0;i<t.length;i++){var r=t[i],n=r.object1,s=r.object2,a=r.object2,h=r.projection,l=r.penetration,c=n.body,u=a.body,p=c.shape,d=u.shape,f=p.x+n.position.x,m=p.y+n.position.y,g=d.x+a.position.x,v=d.y+a.position.y,y=m+p.height-v,x=v+d.height-m,_=f+p.width-g,b=g+d.width-f,w=999999;if(a.passthrough,w>_&&(w=_),w>b&&(w=b),w>y&&(w=y),w>x&&(w=x),w>0)if(w==_?(h.x=-1,h.y=0):w==b?(h.x=1,h.y=0):w==y?(h.x=0,h.y=-1):w==x&&(h.x=0,h.y=1),l=-w,s.body.type===o.DYNAMIC){n.position.x-=h.x*l*.5,n.position.y-=h.y*l*.5,s.position.x+=h.x*l*.5,s.position.y+=h.y*l*.5;var S=n.body.velocity.x-s.body.velocity.x,T=n.body.velocity.y-s.body.velocity.y;0!==h.x?S*h.x<=0&&(n.body.velocity.x-=.5*S,s.body.velocity.x+=.5*S):T*h.y<=0&&(n.body.velocity.y-=.5*T,s.body.velocity.y+=.5*T)}else{n.position.x-=h.x*l,n.position.y-=h.y*l;var S=n.body.velocity.x-s.body.velocity.x,T=n.body.velocity.y-s.body.velocity.y;0!==h.x?S*h.x<=0&&(n.body.velocity.x-=S):(T*h.y<=0&&(n.body.velocity.y-=T),n.body.position.x+=s.body.velocity.x)}}},n.exports=s}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,i){var r;r=function(t,e,r){var n=(i(14),0),o=function(t,e,i){this.hash=[],this.width=300,this.height=300,this.size=96,this.buildHash(),this.cache={}};o.prototype.buildHash=function(){for(var t=this.width,e=this.height,i=t*e,r=0;i>r;r++)this.hash[r]=[];this.cache={}},o.prototype.add=function(t){this.cache={};var e,i,r=t.body.shape,n=(t.position.x+r.x)/this.size|0,o=(t.position.y+r.y)/this.size|0,s=(t.position.x+r.x+r.width)/this.size|0,a=(t.position.y+r.y+r.height)/this.size|0;for(i=o;a>=i;i++)for(e=n;s>=e;e++){var h=i*this.width+e;this.hash[h]&&this.hash[h].push(t)}},o.prototype.retrieve=function(t){var e=t.position.x/this.size|0,i=t.position.y/this.size|0,r=this.cache[e+":"+i];return r||(r=[],r=this.addSquare(e-1,i-1,r),r=this.addSquare(e,i-1,r),r=this.addSquare(e+1,i-1,r),r=this.addSquare(e-1,i,r),r=this.addSquare(e,i,r),r=this.addSquare(e+1,i,r),r=this.addSquare(e,i+1,r),r=this.addSquare(e,i+1,r),r=this.addSquare(e+1,i+1,r),r=this.removeDuplicates(r),this.cache[e+":"+i]=r),r},o.prototype.addSquare=function(t,e,i){var r=e*this.width+t;return this.hash[r]&&(i=i.concat(this.hash[r])),i};var s=[];o.prototype.retrieveArea=function(t){var e,i,r=t.body.shape,o=(t.position.x+r.x)/this.size|0,a=(t.position.y+r.y)/this.size|0,h=(t.position.x+r.x+r.width)/this.size|0,l=(t.position.y+r.y+r.height)/this.size|0,c=s;s.length=0;var u=n++,p=0;for(i=a;l>=i;i++)for(e=o;h>=e;e++){var d=i*this.width+e,f=this.hash[d];if(f)for(var m=0;m<f.length;m++){var g=f[m];g._TICK!==u&&(g._TICK=u,c[p++]=g)}}return c},o.prototype.removeDuplicates=function(t){for(var e={},i=[],r=t.length,n=0,o=0;r>o;o++){var s=t[o];1!==e[s.UID]&&(e[s.UID]=1,i[n++]=s)}return i},o.prototype.remove=function(t){var e,i,r=t.body.shape,n=(t.position.x+r.x)/this.size|0,o=(t.position.y+r.y)/this.size|0,s=(t.position.x+r.x+r.width)/this.size|0,a=(t.position.y+r.y+r.height)/this.size|0;for(i=o;a>=i;i++)for(e=n;s>=e;e++){var h=i*this.width+e;if(h>0){var l=this.hash[h].indexOf(t);-1!==l&&this.hash[h].splice(l,1)}this.cache={}}},o.prototype.empty=function(){this.buildHash()},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(10),s=i(110),a=(i(111),function(t){n.Container.call(this);var e=t.camera3d||new o.PerspectiveCamera(40,4,1,3e3);e.position.z=800;var i=new o.Scene;this.scene=i,this.camera=e,this.camera.position.x=0,this.camera.position.y=0,this.threeRenderer=null,this.w=-1,this.h=-1});a.prototype=Object.create(n.Container.prototype),a.prototype._renderWebGL=function(t){this.camera.update(),this.threeRenderer||(this.threeRenderer=new o.WebGLRenderer({context:t.gl}),this.threeRenderer.setSize(800,600),this.threeRenderer.autoClear=!1,this.threeRenderer.autoClearColor=!1),this.threeRenderer.resetGLState(),this.threeRenderer.render(this.scene,this.camera),t.reset()},a.prototype.init=function(t){},a.prototype.preupdate=function(t){},a.prototype.update=function(){},a.prototype.postupdate=function(t){},a.prototype.add=function(t){t.view3d&&this.scene.add(t.view3d)},a.prototype.remove=function(t){t.view3d&&this.scene.remove(t.view3d)},a.prototype.clear=function(){for(var t in this.layers)this.layers[t].removeChildren()},a.prototype.addLayer=function(t){this.layers[t]=new n.Container,this.activeItemsContainer.addChild(this.layers[t])},a.prototype.bringToFront=function(t){var e=this.layers[t.view.layer],i=e.children.indexOf(t.view);-1!=i&&(e.children.splice(i,1),e.children.push(t.view))};var h=new n.Point;a.prototype.toScreenPosition=function(t){return s.toScreenPosition(t.view3d,this.w,this.h,this.camera,h)},a.prototype.resize=function(t,e){this.w===t&&this.h===e||(this.w=t,this.h=e,this.threeRenderer,this.camera.aspect=t/e,this.camera.updateProjectionMatrix())},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(10),s={},a={},h=new o.Texture;s.getMesh=function(t,e,i,r){var a=new o.MeshBasicMaterial({map:h});a.transparent=!0,a.alphaTest=.25,a.side=o.DoubleSide;var l=new o.PlaneGeometry(200,200),c=new o.Mesh(l,a);if(t){var u=n.Texture.from(t);s.setUvs(c,u,e,i,r)}return c},s.setUvs=function(t,e,i,r,n){var s=e.baseTexture.uid;if(!a[s]){var h=new o.Texture;h.image=e.baseTexture.source,h.flipY=!1,h.needsUpdate=!0,h.wrapS=o.ClampToEdgeWrapping,h.wrapT=o.ClampToEdgeWrapping,h.minFilter=o.LinearFilter,h.maxFilter=o.LinearFilter,a[s]=h}var l=a[s],c=t.geometry;t.material.map=l;var u=c.faceVertexUvs[0],p=u[0],d=u[1];p[0].x=e._uvs.x3,p[0].y=e._uvs.y3,p[1].x=e._uvs.x0,p[1].y=e._uvs.y0,p[2].x=e._uvs.x2,p[2].y=e._uvs.y2,d[0].x=e._uvs.x0,d[0].y=e._uvs.y0,d[1].x=e._uvs.x1,d[1].y=e._uvs.y1,d[2].x=e._uvs.x2,d[2].y=e._uvs.y2,c.uvsNeedUpdate=!0;c.vertices;i=i||.5,r=r||.85;var f=e.orig,m=e.trim;if(m)t.position.x=m.width+2*m.x,t.position.x-=f.width*i*2,t.position.y=m.height+2*m.y,t.position.y-=f.height*r*2,t.scale.x=m.width/100,t.scale.y=m.height/100;else{var m=e._frame;t.scale.x=m.width/100,t.scale.y=m.height/100,t.position.x=m.width/2-f.width*i*2,t.position.y=m.height/2-f.height*r*2}};var l=new o.Vector3;s.toScreenPosition=function(t,e,i,r,n){var o=.5*e,s=.5*i;return t.updateMatrixWorld(),l.setFromMatrixPosition(t.matrixWorld),l.project(r),l.x=l.x*o+o,l.y=-(l.y*s)+s,n.x=l.x,n.y=l.y,n},s.getPixiTexture=function(t){var e=window.renderer.extract.image(t),i=new o.Texture;return i.image=e,i.wrapS=o.ClampToEdgeWrapping,i.wrapT=o.ClampToEdgeWrapping,i.minFilter=o.LinearFilter,i.maxFilter=o.LinearFilter,i.needsUpdate=!0,i},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){t.exports=i(112),t.exports.color=i(113)},function(t,e){var i=t.exports=i||{};i.gui=i.gui||{},i.utils=i.utils||{},i.controllers=i.controllers||{},i.dom=i.dom||{},i.color=i.color||{},i.utils.css=function(){return{load:function(t,e){e=e||document;var i=e.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=t,e.getElementsByTagName("head")[0].appendChild(i)},inject:function(t,e){e=e||document;var i=document.createElement("style");i.type="text/css",i.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(i)}}}(),i.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var i in e)this.isUndefined(e[i])||(t[i]=e[i])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var i in e)this.isUndefined(t[i])&&(t[i]=e[i])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var i=e.call(arguments),r=t.length-1;r>=0;r--)i=[t[r].apply(this,i)];return i[0]}},each:function(e,i,r){if(t&&e.forEach===t)e.forEach(i,r);else if(e.length===e.length+0){for(var n=0,o=e.length;o>n;n++)if(n in e&&i.call(r,e[n],n)===this.BREAK)return}else for(var n in e)if(i.call(r,e[n],n)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),i.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(i.utils.common),i.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var i=e.match(n);return t.isNull(i)?0:parseFloat(i[1])}var i={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},r={};t.each(i,function(e,i){t.each(e,function(t){r[t]=i})});var n=/(\d+(\.\d+)?)px/,o={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,i,r){t.isUndefined(i)&&(i=!0),t.isUndefined(r)&&(r=!0),e.style.position="absolute",i&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,i,n,o){n=n||{};var s=r[i];if(!s)throw new Error("Event type "+i+" not supported.");var a=document.createEvent(s);switch(s){case"MouseEvents":var h=n.x||n.clientX||0,l=n.y||n.clientY||0;a.initMouseEvent(i,n.bubbles||!1,n.cancelable||!0,window,n.clickCount||1,0,0,h,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;t.defaults(n,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(i,n.bubbles||!1,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:a.initEvent(i,n.bubbles||!1,n.cancelable||!0)}t.defaults(a,o),e.dispatchEvent(a)},bind:function(t,e,i,r){return r=r||!1,t.addEventListener?t.addEventListener(e,i,r):t.attachEvent&&t.attachEvent("on"+e,i),o},unbind:function(t,e,i,r){return r=r||!1,t.removeEventListener?t.removeEventListener(e,i,r):t.detachEvent&&t.detachEvent("on"+e,i),o},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var i=t.className.split(/ +/);-1==i.indexOf(e)&&(i.push(e),t.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(t,e){if(e)if(void 0===t.className);else if(t.className===e)t.removeAttribute("class");else{var i=t.className.split(/ +/),r=i.indexOf(e);-1!=r&&(i.splice(r,1),t.className=i.join(" "))}else t.className=void 0;return o},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var i=getComputedStyle(t);return e(i["border-left-width"])+e(i["border-right-width"])+e(i["padding-left"])+e(i["padding-right"])+e(i.width)},getHeight:function(t){var i=getComputedStyle(t);return e(i["border-top-width"])+e(i["border-bottom-width"])+e(i["padding-top"])+e(i["padding-bottom"])+e(i.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return o}(i.utils.common),i.controllers.OptionController=function(t,e,i){var r=function(t,n,o){r.superclass.call(this,t,n);var s=this;if(this.__select=document.createElement("select"),i.isArray(o)){var a={};i.each(o,function(t){a[t]=t}),o=a}i.each(o,function(t,e){var i=document.createElement("option");i.innerHTML=e,i.setAttribute("value",t),s.__select.appendChild(i)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;s.setValue(t)}),this.domElement.appendChild(this.__select)};return r.superclass=t,i.extend(r.prototype,t.prototype,{setValue:function(t){var e=r.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.NumberController=function(t,e){function i(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var r=function(t,n,o){r.superclass.call(this,t,n),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,e.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=i(this.__impliedStep)};return r.superclass=t,e.extend(r.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),r.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this}}),r}(i.controllers.Controller,i.utils.common),i.controllers.NumberControllerBox=function(t,e,i){function r(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}var n=function(t,r,o){function s(){var t=parseFloat(p.__input.value);i.isNaN(t)||p.setValue(t)}function a(){s(),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}function h(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),u=t.clientY}function l(t){var e=u-t.clientY;p.setValue(p.getValue()+e*p.__impliedStep),u=t.clientY}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c)}this.__truncationSuspended=!1,n.superclass.call(this,t,r,o);var u,p=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",s),e.bind(this.__input,"blur",a),e.bind(this.__input,"mousedown",h),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(p.__truncationSuspended=!0,this.blur(),p.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return n.superclass=t,i.extend(n.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():r(this.getValue(),this.__precision),n.superclass.prototype.updateDisplay.call(this)}}),n}(i.controllers.NumberController,i.dom.dom,i.utils.common),i.controllers.NumberControllerSlider=function(t,e,i,r,n){function o(t,e,i,r,n){return r+(n-r)*((t-e)/(i-e))}var s=function(t,i,r,n,a){function h(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),l(t)}function l(t){t.preventDefault();var i=e.getOffset(u.__background),r=e.getWidth(u.__background);return u.setValue(o(t.clientX,i.left,i.left+r,u.__min,u.__max)),!1}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c),u.__onFinishChange&&u.__onFinishChange.call(u,u.getValue())}s.superclass.call(this,t,i,{min:r,max:n,step:a});var u=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",h),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return s.superclass=t,s.useDefaultStyles=function(){i.inject(n)},r.extend(s.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",s.superclass.prototype.updateDisplay.call(this)}}),s}(i.controllers.NumberController,i.dom.dom,i.utils.css,i.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),i.controllers.FunctionController=function(t,e,i){var r=function(t,i,n){r.superclass.call(this,t,i);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===n?"Fire":n,e.bind(this.__button,"click",function(t){return t.preventDefault(),o.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=t,i.extend(r.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.BooleanController=function(t,e,i){var r=function(t,i){function n(){o.setValue(!o.__prev)}r.superclass.call(this,t,i);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",n,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=t,i.extend(r.prototype,t.prototype,{setValue:function(t){var e=r.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(i.controllers.Controller,i.dom.dom,i.utils.common),i.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var i=e.hex.toString(16);i.length<6;)i="0"+i;return"#"+i}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(i.utils.common),i.color.interpret=function(t,e){var i,r,n=function(){r=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(n){return n.litmus(t)?(e.each(n.conversions,function(n,o){return i=n.read(t),r===!1&&i!==!1?(r=i,i.conversionName=o,i.conversion=n,e.BREAK):void 0}),e.BREAK):void 0}),r},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return n}(i.color.toString,i.utils.common),i.GUI=i.gui.GUI=function(t,e,i,r,n,o,s,a,h,l,c,u,p,d,f){function m(t,e,i,o){if(void 0===e[i])throw new Error("Object "+e+' has no property "'+i+'"');var s;if(o.color)s=new c(e,i);else{var a=[e,i].concat(o.factoryArgs);s=r.apply(t,a)}o.before instanceof n&&(o.before=o.before.__li),y(t,s),d.addClass(s.domElement,"c");var h=document.createElement("span");d.addClass(h,"property-name"),h.innerHTML=s.property;var l=document.createElement("div");l.appendChild(h),l.appendChild(s.domElement);var u=g(t,l,o.before);return d.addClass(u,N.CLASS_CONTROLLER_ROW),d.addClass(u,typeof s.getValue()),v(t,u,s),t.__controllers.push(s),s}function g(t,e,i){var r=document.createElement("li");return e&&r.appendChild(e),i?t.__ul.insertBefore(r,params.before):t.__ul.appendChild(r),t.onResize(),r}function v(t,e,i){if(i.__li=e,i.__gui=t,f.extend(i,{options:function(e){return arguments.length>1?(i.remove(),m(t,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[f.toArray(arguments)]})):f.isArray(e)||f.isObject(e)?(i.remove(),m(t,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return i.__li.firstElementChild.firstElementChild.innerHTML=t,i},listen:function(){return i.__gui.listen(i),i},remove:function(){return i.__gui.remove(i),i}}),i instanceof h){var r=new a(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});f.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=i[t],n=r[t];i[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(i,t),n.apply(r,t)}}),d.addClass(e,"has-slider"),i.domElement.insertBefore(r.domElement,i.domElement.firstElementChild)}else if(i instanceof a){var n=function(e){return f.isNumber(i.__min)&&f.isNumber(i.__max)?(i.remove(),m(t,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]})):e};i.min=f.compose(n,i.min),i.max=f.compose(n,i.max)}else i instanceof o?(d.bind(e,"click",function(){d.fakeEvent(i.__checkbox,"click")}),d.bind(i.__checkbox,"click",function(t){t.stopPropagation()})):i instanceof s?(d.bind(e,"click",function(){d.fakeEvent(i.__button,"click")}),d.bind(e,"mouseover",function(){d.addClass(i.__button,"hover")}),d.bind(e,"mouseout",function(){d.removeClass(i.__button,"hover")})):i instanceof c&&(d.addClass(e,"color"),i.updateDisplay=f.compose(function(t){return e.style.borderLeftColor=i.__color.toString(),t},i.updateDisplay),i.updateDisplay());i.setValue=f.compose(function(e){return t.getRoot().__preset_select&&i.isModified()&&E(t.getRoot(),!0),e},i.setValue)}function y(t,e){var i=t.getRoot(),r=i.__rememberedObjects.indexOf(e.object);if(-1!=r){var n=i.__rememberedObjectIndecesToControllers[r];if(void 0===n&&(n={},i.__rememberedObjectIndecesToControllers[r]=n),n[e.property]=e,i.load&&i.load.remembered){var o,s=i.load.remembered;if(s[t.preset])o=s[t.preset];else{if(!s[I])return;o=s[I]}if(o[r]&&void 0!==o[r][e.property]){var a=o[r][e.property];e.initialValue=a,e.setValue(a)}}}}function x(t,e){return document.location.href+"."+e}function _(t){function e(){l.style.display=t.useLocalStorage?"block":"none"}var i=t.__save_row=document.createElement("li");d.addClass(t.domElement,"has-save"),t.__ul.insertBefore(i,t.__ul.firstChild),d.addClass(i,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",d.addClass(r,"button gears");var n=document.createElement("span");n.innerHTML="Save",d.addClass(n,"button"),d.addClass(n,"save");var o=document.createElement("span");o.innerHTML="New",d.addClass(o,"button"),d.addClass(o,"save-as");var s=document.createElement("span");s.innerHTML="Revert",d.addClass(s,"button"),d.addClass(s,"revert");var a=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?f.each(t.load.remembered,function(e,i){T(t,i,i==t.preset)}):T(t,I,!1),d.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),i.appendChild(a),i.appendChild(r),i.appendChild(n),i.appendChild(o),i.appendChild(s),D){var h=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");h.style.display="block";var c=document.getElementById("dg-local-storage");"true"===localStorage.getItem(x(t,"isLocal"))&&c.setAttribute("checked","checked"),e(),d.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,e()})}var u=document.getElementById("dg-new-constructor");d.bind(u,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||A.hide()}),d.bind(r,"click",function(){u.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),A.show(),u.focus(),u.select()}),d.bind(n,"click",function(){t.save()}),d.bind(o,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),d.bind(s,"click",function(){t.revert()})}function b(t){function e(e){return e.preventDefault(),n=e.clientX,d.addClass(t.__closeButton,N.CLASS_DRAG),d.bind(window,"mousemove",i),d.bind(window,"mouseup",r),!1}function i(e){return e.preventDefault(),t.width+=n-e.clientX,
t.onResize(),n=e.clientX,!1}function r(){d.removeClass(t.__closeButton,N.CLASS_DRAG),d.unbind(window,"mousemove",i),d.unbind(window,"mouseup",r)}t.__resize_handle=document.createElement("div"),f.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var n;d.bind(t.__resize_handle,"mousedown",e),d.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function w(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function S(t,e){var i={};return f.each(t.__rememberedObjects,function(r,n){var o={},s=t.__rememberedObjectIndecesToControllers[n];f.each(s,function(t,i){o[i]=e?t.initialValue:t.getValue()}),i[n]=o}),i}function T(t,e,i){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),i&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function M(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function E(t,e){var i=t.__preset_select[t.__preset_select.selectedIndex];e?i.innerHTML=i.value+"*":i.innerHTML=i.value}function C(t){0!=t.length&&u(function(){C(t)}),f.each(t,function(t){t.updateDisplay()})}t.inject(i);var A,L,P="dg",R=72,O=20,I="Default",D=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),B=!0,k=!1,F=[],N=function(t){function e(){localStorage.setItem(x(r,"gui"),JSON.stringify(r.getSaveObject()))}function i(){var t=r.getRoot();t.width+=1,f.defer(function(){t.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),d.addClass(this.domElement,P),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=f.defaults(t,{autoPlace:!0,width:N.DEFAULT_WIDTH}),t=f.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),f.isUndefined(t.load)?t.load={preset:I}:t.preset&&(t.load.preset=t.preset),f.isUndefined(t.parent)&&t.hideable&&F.push(this),t.resizable=f.isUndefined(t.parent)&&t.resizable,t.autoPlace&&f.isUndefined(t.scrollable)&&(t.scrollable=!0);var n=D&&"true"===localStorage.getItem(x(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:t.load.preset},set:function(e){r.parent?r.getRoot().preset=e:t.load.preset=e,M(this),r.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,w(r,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,s&&(s.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?d.addClass(r.__ul,N.CLASS_CLOSED):d.removeClass(r.__ul,N.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=e?N.TEXT_OPEN:N.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return n},set:function(t){D&&(n=t,t?d.bind(window,"unload",e):d.unbind(window,"unload",e),localStorage.setItem(x(r,"isLocal"),t))}}}),f.isUndefined(t.parent)){if(t.closed=!1,d.addClass(this.domElement,N.CLASS_MAIN),d.makeSelectable(this.domElement,!1),D&&n){r.useLocalStorage=!0;var o=localStorage.getItem(x(this,"gui"));o&&(t.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=N.TEXT_CLOSED,d.addClass(this.__closeButton,N.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),d.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===t.closed&&(t.closed=!0);var s=document.createTextNode(t.name);d.addClass(s,"controller-name");var a=g(r,s),h=function(t){return t.preventDefault(),r.closed=!r.closed,!1};d.addClass(this.__ul,N.CLASS_CLOSED),d.addClass(a,"title"),d.bind(a,"click",h),t.closed||(this.closed=!1)}t.autoPlace&&(f.isUndefined(t.parent)&&(B&&(L=document.createElement("div"),d.addClass(L,P),d.addClass(L,N.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(L),B=!1),L.appendChild(this.domElement),d.addClass(this.domElement,N.CLASS_AUTO_PLACE)),this.parent||w(r,t.width)),d.bind(window,"resize",function(){r.onResize()}),d.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),d.bind(this.__ul,"transitionend",function(){r.onResize()}),d.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),t.resizable&&b(this);r.getRoot();t.parent||i()};return N.toggleHide=function(){k=!k,f.each(F,function(t){t.domElement.style.zIndex=k?-999:999,t.domElement.style.opacity=k?0:1})},N.CLASS_AUTO_PLACE="a",N.CLASS_AUTO_PLACE_CONTAINER="ac",N.CLASS_MAIN="main",N.CLASS_CONTROLLER_ROW="cr",N.CLASS_TOO_TALL="taller-than-window",N.CLASS_CLOSED="closed",N.CLASS_CLOSE_BUTTON="close-button",N.CLASS_DRAG="drag",N.DEFAULT_WIDTH=245,N.TEXT_CLOSED="Close Controls",N.TEXT_OPEN="Open Controls",d.bind(window,"keydown",function(t){"text"===document.activeElement.type||t.which!==R&&t.keyCode!=R||N.toggleHide()},!1),f.extend(N.prototype,{add:function(t,e){return m(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return m(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;f.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&L.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var i=new N(e);this.__folders[t]=i;var r=g(this,i.domElement);return d.addClass(r,"folder"),i},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=d.getOffset(t.__ul).top,i=0;f.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(i+=d.getHeight(e))}),window.innerHeight-e-O<i?(d.addClass(t.domElement,N.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-O+"px"):(d.removeClass(t.domElement,N.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&f.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(f.isUndefined(A)&&(A=new p,A.domElement.innerHTML=e),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;f.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&_(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=S(this)),t.folders={},f.each(this.__folders,function(e,i){t.folders[i]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=S(this),E(this,!1)},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[I]=S(this,!0)),this.load.remembered[t]=S(this),this.preset=t,T(this,t,!0)},revert:function(t){f.each(this.__controllers,function(e){this.getRoot().load.remembered?y(t||this.getRoot(),e):e.setValue(e.initialValue)},this),f.each(this.__folders,function(t){t.revert(t)}),t||E(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&C(this.__listening)}}),N}(i.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",i.controllers.factory=function(t,e,i,r,n,o,s){return function(a,h){var l=a[h];return s.isArray(arguments[2])||s.isObject(arguments[2])?new t(a,h,arguments[2]):s.isNumber(l)?s.isNumber(arguments[2])&&s.isNumber(arguments[3])?new i(a,h,arguments[2],arguments[3]):new e(a,h,{min:arguments[2],max:arguments[3]}):s.isString(l)?new r(a,h):s.isFunction(l)?new n(a,h,""):s.isBoolean(l)?new o(a,h):void 0}}(i.controllers.OptionController,i.controllers.NumberControllerBox,i.controllers.NumberControllerSlider,i.controllers.StringController=function(t,e,i){var r=function(t,i){function n(){s.setValue(s.__input.value)}function o(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}r.superclass.call(this,t,i);var s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",n),e.bind(this.__input,"change",n),e.bind(this.__input,"blur",o),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=t,i.extend(r.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.FunctionController,i.controllers.BooleanController,i.utils.common),i.controllers.Controller,i.controllers.BooleanController,i.controllers.FunctionController,i.controllers.NumberControllerBox,i.controllers.NumberControllerSlider,i.controllers.OptionController,i.controllers.ColorController=function(t,e,i,r,n){function o(t,e,i,r){t.style.background="",n.each(h,function(n){t.style.cssText+="background: "+n+"linear-gradient("+e+", "+i+" 0%, "+r+" 100%); "})}function s(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var a=function(t,h){function l(t){d(t),e.bind(window,"mousemove",d),e.bind(window,"mouseup",c)}function c(){e.unbind(window,"mousemove",d),e.unbind(window,"mouseup",c)}function u(){var t=r(this.value);t!==!1?(m.__color.__state=t,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function p(){e.unbind(window,"mousemove",f),e.unbind(window,"mouseup",p)}function d(t){t.preventDefault();var i=e.getWidth(m.__saturation_field),r=e.getOffset(m.__saturation_field),n=(t.clientX-r.left+document.body.scrollLeft)/i,o=1-(t.clientY-r.top+document.body.scrollTop)/i;return o>1?o=1:0>o&&(o=0),n>1?n=1:0>n&&(n=0),m.__color.v=o,m.__color.s=n,m.setValue(m.__color.toOriginal()),!1}function f(t){t.preventDefault();var i=e.getHeight(m.__hue_field),r=e.getOffset(m.__hue_field),n=1-(t.clientY-r.top+document.body.scrollTop)/i;return n>1?n=1:0>n&&(n=0),m.__color.h=360*n,m.setValue(m.__color.toOriginal()),!1}a.superclass.call(this,t,h),this.__color=new i(this.getValue()),this.__temp=new i(0);var m=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&u.call(this)}),e.bind(this.__input,"blur",u),e.bind(this.__selector,"mousedown",function(t){e.addClass(this,"drag").bind(window,"mouseup",function(t){e.removeClass(m.__selector,"drag")})});var g=document.createElement("div");n.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),n.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),n.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),n.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),n.extend(g.style,{width:"100%",height:"100%",background:"none"}),o(g,"top","rgba(0,0,0,0)","#000"),n.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),s(this.__hue_field),n.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",l),e.bind(this.__field_knob,"mousedown",l),e.bind(this.__hue_field,"mousedown",function(t){f(t),e.bind(window,"mousemove",f),e.bind(window,"mouseup",p)}),this.__saturation_field.appendChild(g),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};a.superclass=t,n.extend(a.prototype,t.prototype,{updateDisplay:function(){var t=r(this.getValue());if(t!==!1){var e=!1;n.each(i.COMPONENTS,function(i){return n.isUndefined(t[i])||n.isUndefined(this.__color.__state[i])||t[i]===this.__color.__state[i]?void 0:(e=!0,{})},this),e&&n.extend(this.__color.__state,t)}n.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,a=255-s;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),n.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})}});var h=["-moz-","-o-","-webkit-","-ms-",""];return a}(i.controllers.Controller,i.dom.dom,i.color.Color=function(t,e,i,r){function n(t,e,i){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(s(this,e,i),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(s(this,e,i),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(a(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(a(this),this.__state.space="HSV"),this.__state[e]=t}})}function s(t,i,n){if("HEX"===t.__state.space)t.__state[i]=e.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw"Corrupted color state";r.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function a(t){var i=e.rgb_to_hsv(t.r,t.g,t.b);r.extend(t.__state,{s:i.s,v:i.v}),r.isNaN(i.h)?r.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=i.h}var h=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return h.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(h.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),n(h.prototype,"r",2),n(h.prototype,"g",1),n(h.prototype,"b",0),o(h.prototype,"h"),o(h.prototype,"s"),o(h.prototype,"v"),Object.defineProperty(h.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(h.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),h}(i.color.interpret,i.color.math=function(){var t;return{hsv_to_rgb:function(t,e,i){var r=Math.floor(t/60)%6,n=t/60-Math.floor(t/60),o=i*(1-e),s=i*(1-n*e),a=i*(1-(1-n)*e),h=[[i,a,o],[s,i,o],[o,i,a],[o,s,i],[a,o,i],[i,o,s]][r];return{r:255*h[0],g:255*h[1],b:255*h[2]}},rgb_to_hsv:function(t,e,i){var r,n,o=Math.min(t,e,i),s=Math.max(t,e,i),a=s-o;return 0==s?{h:NaN,s:0,v:0}:(n=a/s,r=t==s?(e-i)/a:e==s?2+(i-t)/a:4+(t-e)/a,r/=6,0>r&&(r+=1),{h:360*r,s:n,v:s/255})},rgb_to_hex:function(t,e,i){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,i)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,i,r){return r<<(t=8*i)|e&~(255<<t)}}}(),i.color.toString,i.utils.common),i.color.interpret,i.utils.common),i.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),i.dom.CenteredDiv=function(t,e){var i=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var i=this;t.bind(this.backgroundElement,"click",function(){i.hide()})};return i.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},i.prototype.hide=function(){var e=this,i=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",i),t.unbind(e.domElement,"transitionend",i),t.unbind(e.domElement,"oTransitionEnd",i)};t.bind(this.domElement,"webkitTransitionEnd",i),t.bind(this.domElement,"transitionend",i),t.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},i.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},i}(i.dom.dom,i.utils.common),i.dom.dom,i.utils.common)},function(t,e){var i=t.exports=i||{};i.color=i.color||{},i.utils=i.utils||{},i.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var i in e)this.isUndefined(e[i])||(t[i]=e[i])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var i in e)this.isUndefined(t[i])&&(t[i]=e[i])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var i=e.call(arguments),r=t.length-1;r>=0;r--)i=[t[r].apply(this,i)];return i[0]}},each:function(e,i,r){if(t&&e.forEach===t)e.forEach(i,r);else if(e.length===e.length+0){for(var n=0,o=e.length;o>n;n++)if(n in e&&i.call(r,e[n],n)===this.BREAK)return}else for(var n in e)if(i.call(r,e[n],n)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),i.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var i=e.hex.toString(16);i.length<6;)i="0"+i;return"#"+i}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(i.utils.common),i.Color=i.color.Color=function(t,e,i,r){function n(t,e,i){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(s(this,e,i),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(s(this,e,i),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(a(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(a(this),this.__state.space="HSV"),this.__state[e]=t}})}function s(t,i,n){if("HEX"===t.__state.space)t.__state[i]=e.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw"Corrupted color state";r.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function a(t){var i=e.rgb_to_hsv(t.r,t.g,t.b);r.extend(t.__state,{s:i.s,v:i.v}),r.isNaN(i.h)?r.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=i.h}var h=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return h.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(h.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),n(h.prototype,"r",2),n(h.prototype,"g",1),n(h.prototype,"b",0),o(h.prototype,"h"),o(h.prototype,"s"),o(h.prototype,"v"),Object.defineProperty(h.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(h.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),h}(i.color.interpret=function(t,e){var i,r,n=function(){r=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(n){return n.litmus(t)?(e.each(n.conversions,function(n,o){return i=n.read(t),r===!1&&i!==!1?(r=i,i.conversionName=o,i.conversion=n,e.BREAK):void 0}),e.BREAK):void 0}),r},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return n}(i.color.toString,i.utils.common),i.color.math=function(){var t;return{hsv_to_rgb:function(t,e,i){var r=Math.floor(t/60)%6,n=t/60-Math.floor(t/60),o=i*(1-e),s=i*(1-n*e),a=i*(1-(1-n)*e),h=[[i,a,o],[s,i,o],[o,i,a],[o,s,i],[a,o,i],[i,o,s]][r];return{r:255*h[0],g:255*h[1],b:255*h[2]}},rgb_to_hsv:function(t,e,i){var r,n,o=Math.min(t,e,i),s=Math.max(t,e,i),a=s-o;return 0==s?{h:NaN,s:0,v:0}:(n=a/s,r=t==s?(e-i)/a:e==s?2+(i-t)/a:4+(t-e)/a,r/=6,0>r&&(r+=1),{h:360*r,s:n,v:s/255})},rgb_to_hex:function(t,e,i){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,i)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,i,r){return r<<(t=8*i)|e&~(255<<t)}}}(),i.color.toString,i.utils.common);
},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(115)),o=i(21),s=i(80),a=function(t){n.call(this),this.game=t,this.padding=(o.instance.isMobile,0),this.idleZoom=1,this.zoom=this.idleZoom,this.zoomWait=0,this.lockToFrame=!0,this.easeX=0,this.easeY=0,this.mobileMode=!1,this.spring=new s,this.canShake=!0};a.prototype=Object.create(n.prototype),a.prototype.reset=function(){this.x=this.easeX=this.viewWidth/2},a.prototype.shake=function(t,e){this.canShake&&(t=t||Math.random()*Math.PI*2,e=e||20,this.spring.dx=Math.sin(t)*e,this.spring.dy=Math.cos(t)*e)},a.prototype.update=function(){this.spring.update();var t=this.game.ball,e=t.position.x,i=t.position.y;this.viewWidth,this.viewHeight;this.easeX+=.1*(e-this.x),this.easeY+=.1*(i-this.y),this.x=this.easeX+this.spring.x,this.y=this.easeY+this.spring.y},a.prototype.resize=function(t,e){this.viewWidth=t,this.viewHeight=e},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),function(){this.x=0,this.y=0,this.rotation=0,this.zoom=1,this.viewWidth=1130,this.viewHeight=640});n.prototype.update=function(){},n.prototype.resize=function(t,e){this.viewWidth=t,this.viewHeight=e},r.exports=n}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(10)),o=i(45),s=i(21),a=i(80),h=(i(111),i(117)),l=function(t){n.PerspectiveCamera.call(this,40,4,1,3e3),this.game=t,this.padding=(s.instance.isMobile,0),this.idleZoom=1,this.targetZoom=1,this.zoom=this.idleZoom,this.zoomWait=0,this.lockToFrame=!0,this.easeX=0,this.easeY=0,this.easeZ=0,this.mobileMode=!1,this.spring=new a,this.canShake=!0,this.focusMode=!1,this.celebrateMode=!1,this.endMode=!1,this.rock=0,this.tick=0,this.currentId=0};l.prototype=Object.create(n.PerspectiveCamera.prototype),l.prototype.reset=function(){this.x=this.easeX=this.viewWidth/2,this.endMode=!1,this.celebrateMode=!1},l.prototype.shake=function(t,e){this.canShake&&(t=t||Math.random()*Math.PI*2,e=e||20,this.spring.dx=Math.sin(t)*e,this.spring.dy=Math.cos(t)*e)},l.prototype.update=function(){this.spring.update();var t=this.game.ball;if(this.celebrateMode)t=this.game.ball.lastOwner||this.game.ball;else if(this.endMode){this.tick>100&&(this.currentId++,this.tick=0);var e=this.game.endState===h.END_STATE.WIN?this.game.teamLeft:this.game.teamRight;this.game,t=e.children[this.currentId%e.children.length]}var i=t.position.x;200>i?i=200:i>1400&&(i=1400);var r=t.position.y;150>r?r=150:r>800&&(r=800);var n=i,s=r-400,a=500-o.map(r,150,800,150,0);this.focusMode?(a=300,this.targetZoom=1.4,this.shake(null,(this.zoom-1)/.2),this.easeZ+=.1*(a-this.easeZ)):(this.targetZoom=1,this.easeZ+=.3*(a-this.easeZ)),this.easeX+=.2*(n-this.easeX),this.easeY+=.2*(s-this.easeY),this.position.x=this.easeX,this.position.y=this.easeY,this.position.z=this.easeZ;var l=this.position.z-0,c=this.position.y-r,u=this.position.x-i,p=Math.atan2(-c,l),d=Math.atan2(-l,u)+Math.PI/2;if(this.rotation.x+=o.smallestAngle(this.rotation.x,p),this.rotation.y+=o.smallestAngle(this.rotation.y,d),window.test=this.rotation.x,this.position.x+=this.spring.x,this.position.z+=this.spring.y,this.celebrateMode){this.rotation.z=.15*Math.sin(.6*this.rock),this.rock+=.1;var f=1.5+.2*Math.sin(.5*this.rock);this.zoom+=.1*(f-this.zoom)}else this.rotation.z*=.9,this.zoom+=.01*(this.targetZoom-this.zoom);this.updateProjectionMatrix()},r.exports=l}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e){t.exports={PLAYER_STATE:{IDLE:0,RUN:1,FREE_RUN:2,WIN:3,LOSE:4,TACKLE:5,FALL:6,KICK_CHARGE:7,KICK:8},KEEPER_STATE:{IDLE:0,DIVE:1,CLOSING_DOWN:2},TEAM_STATE:{ATTACKING:0,DEFENDING:1,ATTACK_IDLE:2,KICK_OFF:3,DEFEND_IDLE:4,SCORED:5,LOST:6},END_STATE:{WIN:0,LOSE:1,DRAW:2}}},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(10),i(29)),s=i(20),a=(i(14),i(119)),h=(i(21),i(120)),l=i(121),c=i(117),u=i(126),p=i(127),d=i(128),f=i(60),m=i(129),g=i(45),v=(i(110),i(50)),y=c.PLAYER_STATE,x=function(t){var e=20,i=new l.CrashBody.fromRect(-e/2,-e/2,e,e),r=(new n.Graphics).beginFill(16711680).drawRect(-20,-20,40,40);t&&(r.tint=65280),this.isTeamA=t,a.call(this,400,50,r,i),this.view3d=new h(this),this.speedBoost=1,this.shotPower=1,this.tacklePower=1,this._tick=1e3*Math.random(),this.type=1,this.currentTouchingPlayer=null,this.touchingBall=!1,this.ball=null,this.body.position=this.position,this.name="player",this.groups=["Player"],this.state=y.IDLE,this.startPosition=new l.Vector,this.ballSkills=new u(this),this.movement=new p(this),this.DEBUG=!1,this.auto=!0,this.shootTarget=null,this.tackleWait=0,this.fallWait=0,this.chaseWait=0,this.passWait=0,this.shotWait=0,this.turnCount=0,this.canTackleCount=0,this.overwriteStopWalk=!1,this.reticle=new d(this),this.view.addChild(this.reticle),this.reticle.visible=!1,this.shootArrow=(new n.Graphics).beginFill(16776960).drawRect(0,-5,100,10).drawCircle(0,0,20),this.view.addChild(this.shootArrow),this.shootDirection=new n.Point(1,0),this.shootAngle=0,this.shootOffsetAngle=0,this.didModifyShootAngle=!1,this.chargeBar=new f,this.powerup=null,this.speedBoost=!1,this.canBeTackled=!0,this.offScreenIcon=new m,this.balanceData=null,this.helpTackle=!0,this.tackleSize=30,this.normalSize=20,this.actualSpeed=3};x.prototype=Object.create(a.prototype),x.prototype.fallOver=function(){o.sfx.play("tackle_hit_deck");var t=Math.random();.4>t&&o.sfx.playGroup("croudAngry"),this.body.acceleration.x=0,this.body.acceleration.y=0,this.fallWait=0,this.setState(y.FALL),this.ballSkills.ball&&this.ballSkills.releaseBall()},x.prototype.reset=function(){this.setState(y.STOP),this.endPowerup(),this.ballSkills.ball&&this.ballSkills.releaseBall()},x.prototype.setData=function(t){this.data=t,this.view3d.setData(t),this.data.power>=.4?this.chargeBar.setSize(2):this.data.power>=.3?this.chargeBar.setSize(1):this.chargeBar.setSize(0),this.offScreenIcon.setData(t)},x.prototype.setTeam=function(t){for(var e=[],i=0;i<t.children.length;i++){var r=t.children[i];r!==this&&e.push(r)}this.reticle.setArrows(e),this.view3d.reticle.setArrows(e)},x.prototype.setReticle=function(t){this.reticle.visible=t},x.prototype.setState=function(t){if(this.state!==t){this.state===y.KICK_CHARGE&&(this.world.view3d.camera.focusMode=!1),this.canCollide=t!==y.FALL;var e=this.normalSize;t!==y.TACKLE||this.auto||(e=this.tackleSize),this.body.shape.x=-e/2,this.body.shape.y=-e/2,this.body.shape.width=e,this.body.shape.height=e,t===y.KICK_CHARGE?this.world.view3d.camera.focusMode=!0:t===y.TACKLE?(this.tackleWait=0,this.body.friction=.9,this.actualSpeed=20):this.body.friction=.94,this.state=t,this.overwriteStopWalk=!1,this.state!==y.WIN&&this.state!==y.LOSE||this.movement.stop(),this.state!==y.LOSE&&this.state!==y.WIN&&this.state!==y.TACKLE&&this.state!==y.FALL&&this.state!==y.KICK_CHARGE||(this.overwriteStopWalk=!0)}},x.prototype.setPowerUp=function(t){this.setState(y.STOP),this.endPowerup(),this.powerup=v.get(t),this.powerup.reset(this)},x.prototype.endPowerup=function(t){this.powerup&&(this.powerup.stop(),v["return"](this.powerup),this.powerup=null)},x.prototype.update=function(){this.count+=.3;var t=this.data.speed>.25?1.1:.9;if(this.speedBoost?this.actualSpeed=4*this.balanceData.speedMod*t:this.actualSpeed=3*this.balanceData.speedMod*t,this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y,this.view3d.update(),this.powerup&&(this.powerup.update(),this.powerup.dead&&this.endPowerup()),this.canTackleCount++,this.view3d.reticle.chargeArrow.visible=!1,this.ballSkills.update(),this.view3d.reticle.update(),this.state===y.RUN)this.movement.update();else if(this.state===y.TACKLE){this.actualSpeed=20;var e=this.body.velocity.length();2>e&&(this.tackleWait++,this.tackleWait>20&&(this.setState(y.IDLE),this.stop()))}else if(this.state===y.FALL)this.view.scale.set(.5),this.fallWait++,this.body.velocity.x*=.8,this.body.velocity.y*=.8,this.fallWait>140&&(this.view.scale.set(1),this.setState(y.IDLE),this.stop());else if(this.state===y.KICK_CHARGE){if(!this.ballSkills.ball)return void this.setState(y.IDLE);this.chargeBar.show(),this.view3d.reticle.chargeArrow.visible=!0;var i=Math.atan2(this.shootDirection.y,this.shootDirection.x);i+=this.shootOffsetAngle,!this.didModifyShootAngle,this.didModifyShootAngle=!1,this.shootAngle=i+Math.PI/2;var r=this.data.power<.25?1.1:.9;this.speedBoost&&(r*=1.5),this.shotWait+=.7*r;var n=this.shotWait/75;n*=n,this.body.velocity.x*=.8,this.body.velocity.y*=.8,this.chargeBar.setRatio(n),this.ballSkills.ball.chargeEffect.setRatio(n),this.shotWait>75&&this.shootRelease(this.shootTarget)}this.movingTo&&(this.actualSpeed*=1.1),this.body.setMaxSpeed(this.actualSpeed),this.state===y.KICK_CHARGE?this.chargeBar.show():this.chargeBar.hide();var o=this.world.view3d.toScreenPosition(this);this.chargeBar.position.x=o.x,this.chargeBar.position.y=o.y+40,this.isTeamA||this.offScreenIcon.update(o);var s=this.world.game.ball;this.touchingBall&&!this.ballSkills.ball&&s.body.velocity.z<15&&s.body.position.z<10&&(this.touchingBall=!1,this.ballSkills.pickupBall(s))},x.prototype.addedToWorld=function(){this.world.overlay.addChild(this.chargeBar),this.isTeamA||this.world.overlay.addChild(this.offScreenIcon)},x.prototype.removedFromWorld=function(){this.world.overlay.removeChild(this.chargeBar),this.isTeamA||this.world.overlay.removeChild(this.offScreenIcon)},x.prototype.chaseDown=function(t){if(this.auto&&this.state!==y.TACKLE&&this.state!==y.FALL){this.movingTo=!1,this.alpha=Math.random(),this.movement.follow(t);var e=t.position.x-this.position.x,i=t.position.y-this.position.y,r=Math.sqrt(e*e+i*i);if(e/=r,i/=r,t.owner&&t.owner!==this&&150>r&&(this.chaseWait+=s.game.speed,this.chaseWait>70+this.balanceData.aggressiveness||t.owner.canTackleCount>0&&t.owner.body.velocity.length()<2)){var n=Math.atan2(i,e);this.balanceData.tackleChance<Math.random()&&(n=Math.atan2(this.body.velocity.y,this.body.velocity.x)),this.slideTackle(Math.cos(n),Math.sin(n)),this.chaseWait=-80}}},x.prototype.chargeGoal=function(){this.auto&&this.moveInDirection(-1,0)},x.prototype.shootBegin=function(t){if(this.ballSkills.ball){o.sfx.playGroup("croudHappy"),o.sfx.play("charge_up"),this.shotWait=0,this.world.game.speed=.1,this.shootTarget=t,this.movement.target=null,this.body.acceleration.x=1e-4,this.body.acceleration.y=0;var e=t.position.x-this.position.x,i=t.position.y-this.position.y,r=Math.sqrt(e*e+i*i);e/=r,i/=r,this.shootDirection.x=e,this.shootDirection.y=i,this.shootDirection.visible=!0,this.setState(y.KICK_CHARGE)}},x.prototype.shootRelease=function(t){if(this.state!==y.TACKLE){this.world.game.speed=1,this.passWait=0;var e=15;if(this.ballSkills.ball){if(this.setState(y.KICK),t)if(this.auto){var i=0;i=this.position.x<t.position.x?0:Math.PI,i+=g.random(-.3,.3);var r=Math.random()<this.balanceData.goalScorePercentage;r&&o.sfx.play("big_kick"),this.ballSkills.ball.shoot(Math.cos(i)*e,Math.sin(i)*e,r)}else{var n=Math.atan2(this.shootDirection.y,this.shootDirection.x);n+=this.shootOffsetAngle,this.shootDirection.x=Math.cos(n),this.shootDirection.y=Math.sin(n);var s=this.shotWait/75;s*=s;var a=this.chargeBar.min,h=this.chargeBar.max,r=!1;if(s>a&&h>s){var l=this.position.x-this.shootTarget.position.x,c=this.position.y-this.shootTarget.position.y,u=Math.sqrt(l*l+c*c);500>u&&(r=Math.random()<this.balanceData.goalScorePercentage,this.data.isCaptain?(r=!0,this.world.game.scripts["super"].run(this)):r&&o.sfx.play("big_kick"))}this.ballSkills.ball.shoot(this.shootDirection.x*e,this.shootDirection.y*e,r)}this.ballSkills.releaseBall()}}},x.prototype.slideTackle=function(t,e){if(!this.overwriteStopWalk){if(o.sfx.playGroup("slide"),this.setState(y.TACKLE),this.chaseWait=-80,!this.auto){t=this.body.velocity.x,e=this.body.velocity.y;var i=Math.sqrt(t*t+e*e);t/=i,e/=i}this.movement.direction.x=t,this.movement.direction.y=e,this.body.velocity.x=15*t,this.body.velocity.y=15*e,this.body.acceleration.x=0,this.body.acceleration.y=0,this.currentTouchingPlayer&&this.runTackle(this.currentTouchingPlayer)}},x.prototype.moveTo=function(t,e){this.overwriteStopWalk||this.auto&&(this.setState(y.RUN),this.movement.moveTo(t,e))},x.prototype.moveInDirection=function(t,e){this.state===y.KICK_CHARGE&&(this.didModifyShootAngle=!0,this.shootOffsetAngle+=.02*(.4*e-this.shootOffsetAngle)),this.overwriteStopWalk||this.movement.moveInDirection(t,e)},x.prototype.win=function(){this.setState(y.WIN)},x.prototype.lose=function(){this.setState(y.LOSE)},x.prototype.stop=function(){this.overwriteStopWalk||(this.setState(y.STOP),this.movement.stop())},x.prototype.onCollideBegin=function(t){var e=t.getOtherObject(this);"ball"===e.name?(t.ignore=!0,e.body.velocity.z<15&&e.body.position.z<20?(this.canTackleCount=-50,this.passWait=-150*Math.random(),this.onBallCollide(e)):this.touchingBall=!0):"player"===e.name&&(t.ignore=!0,e.isTeamA!==this.isTeamA&&(this.currentTouchingPlayer=e,this.state===y.TACKLE&&this.runTackle(e)))},x.prototype.runTackle=function(t){var e=this.body.velocity.length();e>4&&(this.tackleWait=1e3,t.canBeTackled?(t.ballSkills.ball&&(t.ballSkills.releaseBall(),this.ballSkills.pickupBall(this.world.game.ball)),t.fallOver()):this.fallOver(),this.world.view3d.camera.shake())},x.prototype.onCollideEnd=function(t){var e=t.getOtherObject(this);"ball"===e.name?this.touchingBall=!1:"player"===e.name&&e.isTeamA!==this.isTeamA&&(this.currentTouchingPlayer=null)},x.prototype.onBallCollide=function(t){this.state!==y.FALL&&(t.owner||this.ballSkills.pickupBall(t))},r.exports=x}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(50),s=i(23),a=function(t,e,i,r){this.UID=a._UID++,this.view=i||null,this.body=r||null,this.signals={},this.position=new n.Point,this.view&&(this.view.position=this.position),this.position.x=0|t,this.position.y=0|e,this.world=null,this.canCollide=!0,this.collideWithSelf=!0,this.type=0,this.groups=[],this._TICK=-1,this.keepInBonus=!0,this._gc=!1,this.returnToPool=function(){o.returnObject(this)}.bind(this)};a.prototype.updateView=function(t){this.view=t},a.prototype.reset=function(t){},a.prototype.destroy=function(){this.world&&(this.world.remove(this),s.wait(this.returnToPool))},a._UID=0,a.mixin=function(t,e){e.call(t),Object.assign(t,e)},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(10)),o=i(110),s=i(33),a=(i(119),i(121),i(20)),h=i(123),l=(new n.PlaneGeometry(200,200),i(124)),c=i(125),u=i(117),p=i(15),d=u.PLAYER_STATE,f=function(t){n.Object3D.call(this),this.player=t,this.scale.x=this.scale.y=this.scale.z=.24,this.flipContainer=new n.Object3D,this.flipContainer.rotation.x=-Math.PI+.6,this.add(this.flipContainer),this.playerMesh=new o.getMesh,this.flipContainer.add(this.playerMesh),t.isTeamA,this.animation=new h,this.animation.register("run",{frames:[],loop:!0}),this.animation.register("dash",{frames:[],loop:!0}),this.animation.register("stand",{frames:[],speed:.1,loop:!0}),this.animation.register("tackle",{frames:[],loop:!1}),this.animation.register("fall",{frames:[],loop:!1}),this.animation.register("kickCharge",{frames:[],loop:!1}),this.animation.register("kickRelease",{frames:[],loop:!1}),this.animation.register("win",{frames:[],loop:!0}),this.animation.register("lose",{frames:[],loop:!1}),this.reticle=new l(t),this.reticle.position.z+=10,this.add(this.reticle),this.chargeArrow=new c(t)};f.prototype=Object.create(n.Object3D.prototype),f.prototype.setData=function(t){this.scale.x=this.scale.y=this.scale.z=.24*t.scale;var e=this.player.isTeamA?"blue":"red",i=t.spriteSheet.replace("%COLOR%",e),r=p.getJson("character-animation")[i],n=this.animation.animations;n.run.frames=s.getTexturesFromFrames(r.run),n.dash.frames=s.getTexturesFromFrames(r.dash),n.stand.frames=s.getTexturesFromFrames(r.stand),n.tackle.frames=s.getTexturesFromFrames(r.tackle),n.fall.frames=s.getTexturesFromFrames(r.fall),n.kickCharge.frames=s.getTexturesFromFrames(r.kickCharge),n.win.frames=s.getTexturesFromFrames(r.win),n.lose.frames=s.getTexturesFromFrames(r.lose)},f.prototype.update=function(){this.chargeArrow.update(),this.player.state===d.KICK_CHARGE?this.animation.play("kickCharge"):this.player.state===d.FALL?this.animation.play("fall"):this.player.state===d.TACKLE?this.animation.play("tackle"):this.player.state===d.WIN?this.animation.play("win"):this.player.state===d.LOSE?this.animation.play("lose"):this.player.body.velocity.length()>1?this.player.speedBoost?this.animation.play("dash"):this.animation.play("run"):this.animation.play("stand"),this.animation.update(a.game.deltaTime),this.count++,o.setUvs(this.playerMesh,this.animation.texture);var t=this.player.body.velocity.x>0?1:-1;this.flipContainer.scale.x=t,this.flipContainer.rotation.x=window.test-Math.PI},r.exports=f}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){r.exports={Vector:i(104),CrashData:i(105),CrashBody:i(106),CrashWorld:i(102),CrashTests:i(122)}}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(104)),o=function(){};o.hitTestItemGroup=function(t,e,i,r){for(var n=e.children,s=0;s<n.length;s++)o.hitTestAABBAABB(t,n[s],i,r)},o.hitTestItemItem=function(t,e,i,r){o.hitTestAABBAABB(t,e,i,r)},o.hitTestGroup=function(t,e,i){for(var r=t.children,n=0;n<r.length-1;n++)for(var s=n+1;s<r.length;s++)o.hitTestAABBAABB(r[n],r[s],e,i)},o.hitTestGroupGroup=function(t,e,i,r){for(var n=t.children,s=e.children,a=0;a<n.length;a++)for(var h=0;h<s.length;h++)o.hitTestAABBAABB(n[a],s[h],i,r);o.hitTestAABBAABB(item,n[a],i,r)},o.hitTestAABBAABB=function(t,e,i,r){var o=t.body,s=e.body,a=o.shape,h=s.shape,l=a.x+t.position.x,c=a.y+t.position.y,u=h.x+e.position.x,p=h.y+e.position.y,d=c+a.height-p,f=p+h.height-c,m=l+a.width-u,g=u+h.width-l,v=999999;if(v>m&&(v=m),v>g&&(v=g),v>d&&(v=d),v>f&&(v=f),v>=0){var y=new n;v==m?(y.x=-1,y.y=0):v==g?(y.x=1,y.y=0):v==d?(y.x=0,y.y=-1):v==f&&(y.x=0,y.y=1);var x=-v;i&&i(t,e,x,y)}else r&&r(t,e)},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),function(){this.animations={},this.rules={},this.texture=null,this.nextAnimation=null,this.currentAnimation=null});n.prototype.register=function(t,e){e.id=t,e.currentFrame=0,e.speed=e.speed||.4,this.animations[t]=e},n.prototype.play=function(t,e){var i=this.animations[t];i!==this.currentAnimation&&(i.currentFrame=0,this.currentAnimation=i,e?(this.nextAnimation=this.animations[e],this.nextAnimation.currentFrame=0):this.nextAnimation=null)},n.prototype.update=function(t){t=t||1;var e=this.currentAnimation,i=Math.floor(e.currentFrame);e&&(e.loop?i%=e.frames.length:i>e.frames.length-1&&(i=e.frames.length-1,this.nextAnimation&&(this.currentAnimation=this.nextAnimation,this.nextAnimation=null)),e.currentFrame+=e.speed*t,this.texture=e.frames[i])},r.exports=n}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(10)),o=i(110),s=(i(119),i(121),i(123),i(45)),a=i(117),h=function(t){n.Object3D.call(this),this.owner=t,this.spin=new n.Object3D,this.reticle=o.getMesh("player_marker_ring.png",.5,.5,!0),this.chargeArrow=o.getMesh("player_marker_shoot.png",.5,1,!0),this.chargeArrow.material.alphaTest=.8,this.reticle.material.alphaTest=.8,this.chargeArrow.position.y+=30,this.chargeArrow.position.x+=25,this.spin.add(this.reticle),this.spin.add(this.chargeArrow),this.add(this.spin),this.reticle.scale.x*=1.5,this.reticle.scale.y*=1.5,this.reticle.scale.z*=1.5,this.visible=!1,this.shootDir};h.prototype=Object.create(n.Object3D.prototype),h.prototype.setArrows=function(t){this.team=t},h.prototype.update=function(){if(this.visible){if(this.owner.state!==a.PLAYER_STATE.KICK_CHARGE){var t=Math.atan2(this.owner.movement.direction.y,this.owner.movement.direction.x);t+=Math.PI/2}else t=this.owner.shootAngle;this.spin.rotation.z+=.2*s.smallestAngle(this.spin.rotation.z,t)}},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r=(i(7),i(10)),n=i(110),o=(i(119),i(121),i(123),i(45),function(t){r.Object3D.call(this),this.owner=t,this.reticle=n.getMesh("player_marker_shoot.png",.5,1),this.add(this.reticle),this.reticle.scale.x*=1.5,this.reticle.scale.y*=1.5,this.reticle.scale.z*=1.5});o.prototype=Object.create(r.Object3D.prototype),o.prototype.setArrows=function(t){this.team=t},o.prototype.update=function(){},t.exports=o},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=i(45),a=function(t){this.item=t,this.ball=null,t.signals.onBallRecieved=new o(this),t.signals.onBallLost=new o(this),this.easeX=.1,this.offset=new n.Point,this.offset.z=0,this.speedRange=35};a.prototype.pickupBall=function(t){this.ball=t,t.pickUp(this.item),this.item.signals.onBallRecieved.dispatch(this.item)},a.prototype.update=function(){if(this.ball){var t=this.item.body.velocity.x/3;t*=40,t=s.cap(t,-this.speedRange,this.speedRange),this.ball.position.x+=(this.item.position.x+this.offset.x+t-this.ball.position.x)*this.easeX,this.item.body.velocity.y>0?this.ball.position.y+=.5*(this.item.position.y+0-this.ball.position.y):this.ball.position.y+=.5*(this.item.position.y-10-this.ball.position.y),this.ball.position.z=this.offset.z,this.ball.body.velocity.z=0}},a.prototype.releaseBall=function(){this.ball.released(),this.ball=null,this.item.signals.onBallLost.dispatch(this.item)},a.prototype.passTo=function(t){this.ball&&(this.ball.passTo(t),this.releaseBall())},a.prototype.pass=function(t,e,i,r){this.ball&&(this.ball.pass(t,e,i,r),this.releaseBall())},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(121)),o=i(14),s=i(45),a=function(t){this.item=t,this.direction=new n.Vector(1,0),this.targetDirection=new n.Vector(1,0),this.targetPosition=new n.Vector(1,0),t.signals.onArrive=new o(this),t.signals.onMoveTo=new o(this),this.callback=null,this.scope=null,this.active=!0,this.turnMultiplier=1,this.accel=1,this.lookingForTarget=!1};a.prototype.update=function(){if(this.lookingForTarget){this.target&&(this.targetPosition.x=this.target.position.x,this.targetPosition.y=this.target.position.y);var t=this.targetPosition.x-this.item.position.x,e=this.targetPosition.y-this.item.position.y,i=Math.sqrt(t*t+e*e);t/=i,e/=i,i>10?this.moveInDirection(t,e):(this.callback&&(this.callback.call(this.scope),this.callback=null),this.stop())}},a.prototype.follow=function(t,e){this.target=t,this.lookingForTarget=!0},a.prototype.moveTo=function(t,e){this.target=null,this.callback=null,this.lookingForTarget=!0,this.targetPosition.x=t,this.targetPosition.y=e},a.prototype.then=function(t,e){this.callback=t,this.scope=e},a.prototype.moveInDirection=function(t,e){if(this.targetDirection=t,this.targetDirection=e,this.item.auto){var i=Math.atan2(this.direction.y,this.direction.x),r=Math.atan2(e,t),n=s.smallestAngle(i,r);i+=n*this.turnMultiplier,this.direction.x=Math.cos(i),this.direction.y=Math.sin(i)}else this.direction.x=t,this.direction.y=e;this.item.body.acceleration.x=.6*this.direction.x*this.accel,this.item.body.acceleration.y=.6*this.direction.y*this.accel},a.prototype.stop=function(){this.target=null,this.lookingForTarget=!1,this.item.body.acceleration.x=1e-4,this.item.body.acceleration.y=0,this.item.body.velocity.x=.001,this.item.body.velocity.y=0},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(119),i(121),i(45)),s=function(t){n.Container.call(this),this.arrows=[],this.team=null,this.owner=t;var e=(new n.Graphics).lineStyle(2,16711680).drawCircle(0,0,30);this.addChild(e);for(var i=0;2>i;i++)this.arrows.push((new n.Graphics).beginFill(0,.4).moveTo(30,5).lineTo(30,-5).lineTo(40,0)),this.addChild(this.arrows[i]);this.directionArrow=(new n.Graphics).beginFill(16711680).moveTo(30,15).lineTo(30,-15).lineTo(50,0),this.addChild(this.directionArrow)};s.prototype=Object.create(n.Container.prototype),s.prototype.setArrows=function(t){this.team=t},s.prototype.update=function(){if(this.visible){for(var t=0;t<this.team.length;t++){var e=this.team[t],i=Math.atan2(e.position.y-this.owner.position.y,e.position.x-this.owner.position.x);this.arrows[t].rotation=i}var r=Math.atan2(this.owner.movement.direction.y,this.owner.movement.direction.x);this.directionArrow.rotation+=.2*o.smallestAngle(this.directionArrow.rotation,r)}},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(45),s=function(){n.Container.call(this),this.circle=(new n.Graphics).beginFill(16711680).drawCircle(0,0,30),this.icon=new n.Sprite,this.addChild(this.circle),this.addChild(this.icon),this.icon.anchor.set(.5),this.icon.mask=this.circle,this.ring=new n.Sprite.from("offscreen_marker_ring.png"),this.addChild(this.ring),this.ring.anchor.set(.5),this.ring.position.y=2};s.prototype=Object.create(n.Container.prototype),s.prototype.setData=function(t){this.cacheAsBitmap=!1,this.icon.texture=n.Texture.from(t.profile),this.cacheAsBitmap=!0},s.prototype.update=function(t){var e=t.x,i=t.y-50,r=!0,n=30;n>e||e>1136-n?(e=o.cap(e,n,1136-n),r=!1):(n>i||i>745-n)&&(i=o.cap(i,n,745-n),r=!1),r?(this.alpha-=.1,this.alpha<0&&(this.alpha=0)):(this.alpha+=.1,this.alpha>1&&(this.alpha=1)),this.position.x=e,this.position.y=i},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(10),s=i(29),a=i(110),h=i(131),l=i(132),c=i(33),u=i(119),p=i(45),d=i(121),f=function(){var t=new d.CrashBody.fromRect(-10,-10,20,20);t.maxSpeed=1e4,t.maxSpeedY=1e4,t.bounce=.8,t.friction=.99;var e=(new n.Graphics).beginFill(16777215).drawCircle(0,0,10);u.call(this,0,0,e,t);var i=new o.SphereGeometry(10,32,32),r=o.ImageUtils.loadTexture(ASSET_URL+"img/game/football.jpg"),s=new o.MeshBasicMaterial({map:r});s.side=o.DoubleSide,this.view3d=new o.Object3D,this.container=new o.Object3D,this.innerBall=new o.Mesh(i,s),this.view3d.add(this.container),this.container.add(this.innerBall),this.ballMatrix=new o.Matrix4,this.body.position=this.position,t.position.z=0,t.velocity.z=0,this.groups=["Ball"],this.name="ball",this.shot=!1,this.active=!1,this.perfect=!1,this.type=99,this.pickedUp=!1,this.owner=null,this.target=null,this.lastOwner=null,this.shadow=a.getMesh(ASSET_URL+"img/game/game_objects/ball-shadow.png",.5,.5),this.shadow.position.z=10,this.shadow.scale.x=this.shadow.scale.y=this.shadow.scale.z=.1,this.shadow.position.z=-6,this.quaternion=new o.Quaternion,this.quaternion2=new o.Quaternion,this.chargeEffect=new h(this),this.trailEffect=new l(this),this.rect=new n.Sprite.from("ball_trail_00003.png"),this.frames=c.getTexturesFromFramesWithPrefix("ball_trail_000%%.png",15),this.tick=0,this.rect.blendMode=n.BLEND_MODES.ADD,this.rect.scale.set(2),this.rect.anchor.x=.5,this.rect.anchor.y=.75};f.prototype=Object.create(u.prototype),f.prototype.addedToWorld=function(){this.world.view3d.scene.add(this.shadow),this.world.view3d.scene.add(this.trailEffect.view),this.world.overlay.addChild(this.rect)},f.prototype.removedFromWorld=function(){this.world.view3d.scene.remove(this.shadow),this.world.view3d.scene.remove(this.trailEffect.view),this.world.overlay.removeChild(this.rect)},f.prototype.setActive=function(t){this.active=t,t?this.type=0:this.type=99},f.prototype.reset=function(){},f.prototype.released=function(){this.pickedUp=!1,this.owner=null},f.prototype.pickUp=function(t){s.sfx.playGroup("ball_pickup"),this.pickedUp=!0,this.lastOwner=this.owner=t,this.target=null,this.body.velocity.set(0),this.chargeEffect.setRatio(0)},f.prototype.shoot=function(t,e,i){this.perfect=i,this.shot=!0,this.body.velocity.y=e,this.body.velocity.x=t,i?(s.sfx.playGroup("croudHappy"),this.body.velocity.y*=1.5,this.body.velocity.x*=1.5,this.rect.visible=!0):(Math.random()<.3&&s.sfx.playGroup("croudHappy"),s.sfx.play("ballkick_shoot_hard")),this.body.velocity.z=13,this.chargeEffect.setRatio(0)},f.prototype.pass=function(t,e,i,r){s.sfx.play("ballkick_pass"),this.shot=!1,this.body.velocity.x=t*i,this.body.velocity.y=e*i,this.body.velocity.z=r||0},f.prototype.passTo=function(t){if(this.owner!==t){s.sfx.play("ballkick_pass"),this.target=t;var e=t.position.x-this.position.x,i=t.position.y-this.position.y,r=Math.sqrt(e*e+i*i);e/=r,i/=r;var n=15;this.body.velocity.x=e*n,this.body.velocity.y=i*n,this.body.velocity.z=1}},f.prototype.update=function(){var t=this.body;t.velocity.z-=.6,t.position.z+=t.velocity.z,t.position.z<0&&(t.position.z=0,t.velocity.z*=-.6,this.rect.visible=!1),this.owner&&(this.rect.visible=!1);var e=700,i=e/(e-t.position.z);this.view.scale.set(i);var r=this.body.velocity.length();if(this.target){var n=this.target,o=n.body.position.x-this.body.position.x,s=n.body.position.y-this.body.position.y,a=Math.sqrt(o*o+s*s);o/=a,s/=a,this.body.velocity.x=o*r,this.body.velocity.y=s*r}if(this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y,this.view3d.position.z=.5*this.position.z+10,this.owner){var o=this.owner.body.velocity.x,s=this.owner.body.velocity.y,a=Math.sqrt(o*o+s*s);this.innerBall.rotation.x+=.1*a,this.container.rotation.z=Math.atan2(s,o)+Math.PI/2}else this.container.rotation.y+=.03*this.body.velocity.x;this.shadow.position.x=this.view3d.position.x,this.shadow.position.y=this.view3d.position.y;var h=p.map(this.view3d.position.z,80,0,0,2);h=Math.max(h,.3),this.shadow.material.alphaTest=0,this.shadow.material.opacity=.5*h,this.shadow.scale.x=this.shadow.scale.y=this.shadow.scale.z=.05*h;var l=p.cap(p.map(r,4,12,1,.2),.3,1);if(this.view3d.scale.z+=.1*(l-this.view3d.scale.z),this.chargeEffect.update(),this.trailEffect.update(),this.rect.visible){var c=this.world.view3d.toScreenPosition(this);this.rect.position.x=c.x,this.rect.position.y=c.y,this.tick+=.5,this.rect._texture=this.frames[(0|this.tick)%this.frames.length],this.owner?this.rect.rotation=-Math.atan2(this.owner.body.velocity.y,this.owner.body.velocity.x)-Math.PI/2:this.rect.rotation=-Math.atan2(this.body.velocity.y,this.body.velocity.x)-Math.PI/2}},f.prototype.onCollideBegin=function(t){this.target=null;var e=t.getOtherObject(this);e.net&&(this.body.velocity.x*=.15,this.body.velocity.y*=.15),e.wall&&s.sfx.play("ballkick_post")},r.exports=f}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(14),i(45)),o=i(10),s=i(110),a=["attribute float alpha;","uniform float tick;","uniform float power;","void main() {","    float pos = alpha + tick;","    pos = mod(pos, 1.0);","    vec4 mvPosition = modelViewMatrix * vec4( position * pos, 1.0 );","    gl_PointSize = (1.0-pos) * 28.0 * power* 3.0;","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),h=["uniform vec3 color;","uniform sampler2D circle;","void main() {","    gl_FragColor = texture2D(circle, gl_PointCoord);","}"].join("\n"),l=function(t){this.item=t,this.ratio=0;for(var e=new o.SphereBufferGeometry(100,16,8),i=new Float32Array(e.attributes.position.count),r=0;r<i.length;r++)i[r]=Math.random();e.addAttribute("alpha",new o.BufferAttribute(i,1)),this.geometry=e;var n=o.ImageUtils.loadTexture(ASSET_URL+"img/dot.png");uniforms={color:{type:"c",value:new o.Color(65280)},tick:{type:"f",value:0},power:{type:"f",value:0},circle:{type:"t",value:n}};var l=new o.ShaderMaterial({uniforms:uniforms,vertexShader:a,fragmentShader:h,transparent:!0,depthTest:!1});l.blending=o.AdditiveBlending;var c=new o.Points(e,l);t.view3d.add(c),this.cloud=c,this.ring=s.getMesh("powerupGet.png"),this.ring.material.blending=o.AdditiveBlending,t.view3d.add(this.ring),this.ring.rotation.x=-Math.PI/2,this.ring.position.x=0,this.ring.position.y=0,this.ratio=99,this.tick=0,this.setRatio(0)};l.prototype.setRatio=function(t){t!==this.ratio&&(t>1&&(t=1),this.ratio=t,this.tick+=.02+.01*t,this.ring.visible=this.cloud.visible=0!==t,this.ring.material.opacity=n.map(t,0,1,0,10),this.ring.scale.x=this.ring.scale.y=1-t-.1,this.cloud.material.uniforms.tick.value=-this.tick,this.cloud.material.uniforms.power.value=Math.sin(t*Math.PI))},l.prototype.update=function(){this.cloud.rotation.x+=.03,this.cloud.rotation.y+=.03},r.exports=l}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),
i(14),i(45)),o=i(10),s=(i(110),["attribute float alpha;","varying float vAlpha;","void main() {","    vAlpha = alpha;","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n")),a=["uniform vec3 color;","uniform float uAlpha;","uniform sampler2D circle;","varying float vAlpha;","void main() {","    gl_FragColor = vec4(color, vAlpha * uAlpha);","}"].join("\n"),h=function(t){this.item=t,this.trailLength=40,this.top=14,this.bottom=-14;var e=new o.BufferGeometry,i=new Float32Array(3*this.trailLength);this.realVerticies=new Float32Array(3*this.trailLength);for(var r=new Float32Array(this.trailLength),n=new Uint32Array(this.trailLength),h=0;h<n.length;h++)n[h]=h;for(var h=0;h<r.length;h+=2){var l=h/2/this.trailLength;r[h]=l,r[h+1]=l}for(var h=0;h<i.length;h+=3);for(var h=0;h<i.length;h+=3){var c=h/3,u=c%2,p=Math.floor(c/2);i[h]=30*u,i[h+1]=30*p,i[h+2]=0}e.setIndex(new o.BufferAttribute(n,1)),e.addAttribute("position",new o.BufferAttribute(i,3)),e.addAttribute("alpha",new o.BufferAttribute(r,1)),this.geometry=e;o.ImageUtils.loadTexture(ASSET_URL+"img/dot.png");uniforms={color:{type:"c",value:new o.Color(16730352)},uAlpha:{type:"f",value:1}};var d=new o.ShaderMaterial({uniforms:uniforms,vertexShader:s,fragmentShader:a,transparent:!0});d.side=o.DoubleSide,d.blending=o.AdditiveBlending,d.depthTest=!1;var f=new o.Mesh(e,d);f.drawMode=o.TriangleStripDrawMode,this.cloud=f,this.view=f,this.pos=0};h.prototype.update=function(){this.pos++,this.pos%=this.trailLength/2;for(var t=this.cloud.geometry.getAttribute("position"),e=2*this.pos,i=2*this.pos+1,r=this.realVerticies,o=0;o<t.array.length;o+=3);var s=this.item.view3d.position;r[3*e]=s.x,r[3*e+1]=s.y+this.top,r[3*e+2]=s.z,r[3*i]=s.x,r[3*i+1]=s.y+this.bottom,r[3*i+2]=s.z;for(var o=0;o<t.array.length;o+=3){var a=o+3*(2*this.pos+2);a%=r.length,t.array[o+0]=r[a+0]-s.x,t.array[o+1]=r[a+1]-s.y,t.array[o+2]=r[a+2]}this.view.position.x=this.item.position.x,this.view.position.y=this.item.position.y,t.needsUpdate=!0;var h=n.cap(n.map(this.item.body.velocity.length(),5,20,0,1),0,1),l=this.cloud.material.uniforms.uAlpha.value;l>h?l+=.2*(h-l):l=h,this.cloud.visible=l>.1,this.cloud.material.uniforms.uAlpha.value=l,this.view.material.needsUpdate=!0},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(10)),o=i(14),s=i(119),a=i(121),h=function(t){var e=200,r=new a.CrashBody.fromRect(0,-e/2,100,e);r.type=a.CrashBody.STATIC,r.solid=!1;var h=r.getDebugView();h.alpha=.5,s.call(this,100,100,h,r),this.body.position=this.position,this.groups=["Goal"],this.type=1,this.left=!1,this.onGoalScored=new o;var l=(i(134),new n.SphereGeometry(1,1,1),new n.TextureLoader,new n.TextureLoader);this.view3d=new n.Object3D,l.load(ASSET_URL+"models/texture_test_goal2.png",function(e){e.wrapS=n.ClampToEdgeWrapping,e.wrapT=n.ClampToEdgeWrapping,e.minFilter=n.LinearFilter,e.maxFilter=n.LinearFilter;var i=new n.MeshBasicMaterial({map:e});i.side=n.DoubleSide,i.transparent=!0;var r=new n.OBJLoader;r.load(ASSET_URL+"models/GOAL.obj",function(e){e.rotation.x=Math.PI/2,e.traverse(function(t){t instanceof n.Mesh&&(t.material=i,t.material.needsUpdate=!0)}),this.view3d.add(e),e.position.y=-95,e.position.x=100,t&&(e.rotation.y=Math.PI,e.position.x=0,e.position.y=95),e.scale.x=e.scale.y=e.scale.z=.53}.bind(this),function(){},function(){})}.bind(this))};h.prototype=Object.create(s.prototype),h.prototype.addedToWorld=function(){},h.prototype.reset=function(){},h.prototype.update=function(){this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y},h.prototype.onCollideBegin=function(t){var e=t.getOtherObject(this);"ball"===e.name&&(t.ignore=!0,this.onGoalScored.dispatch(this))},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e){THREE.OBJLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.materials=null},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(t,e,i,r){var n=this,o=new THREE.XHRLoader(n.manager);o.setPath(this.path),o.load(t,function(t){e(n.parse(t))},i,r)},setPath:function(t){this.path=t},setMaterials:function(t){this.materials=t},parse:function(t){function e(t){var e={vertices:[],normals:[],uvs:[]},i={name:"",smooth:!0};l={name:t,geometry:e,material:i},c.push(l)}function i(t){var e=parseInt(t);return 3*(e>=0?e-1:e+p.length/3)}function r(t){var e=parseInt(t);return 3*(e>=0?e-1:e+d.length/3)}function n(t){var e=parseInt(t);return 2*(e>=0?e-1:e+f.length/2)}function o(t,e,i){l.geometry.vertices.push(p[t],p[t+1],p[t+2],p[e],p[e+1],p[e+2],p[i],p[i+1],p[i+2])}function s(t,e,i){l.geometry.normals.push(d[t],d[t+1],d[t+2],d[e],d[e+1],d[e+2],d[i],d[i+1],d[i+2])}function a(t,e,i){l.geometry.uvs.push(f[t],f[t+1],f[e],f[e+1],f[i],f[i+1])}function h(t,e,h,l,c,u,p,d,f,m,g,v){var y,x=i(t),_=i(e),b=i(h);void 0===l?o(x,_,b):(y=i(l),o(x,_,y),o(_,b,y)),void 0!==c&&(x=n(c),_=n(u),b=n(p),void 0===l?a(x,_,b):(y=n(d),a(x,_,y),a(_,b,y))),void 0!==f&&(x=r(f),_=r(m),b=r(g),void 0===l?s(x,_,b):(y=r(v),s(x,_,y),s(_,b,y)))}var l,c=[],u=!1,p=[],d=[],f=[];e("");for(var m=/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,g=/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,v=/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,y=/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,x=/^f\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)))?/,_=/^f\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)\/(-?\d+)))?/,b=/^f\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))(?:\s+((-?\d+)\/\/(-?\d+)))?/,w=/^[og]\s*(.+)?/,S=/^s\s+(\d+|on|off)/,T=t.split("\n"),M=0;M<T.length;M++){var E=T[M];E=E.trim();var C;if(0!==E.length&&"#"!==E.charAt(0))if(null!==(C=m.exec(E)))p.push(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3]));else if(null!==(C=g.exec(E)))d.push(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3]));else if(null!==(C=v.exec(E)))f.push(parseFloat(C[1]),parseFloat(C[2]));else if(null!==(C=y.exec(E)))h(C[1],C[2],C[3],C[4]);else if(null!==(C=x.exec(E)))h(C[2],C[5],C[8],C[11],C[3],C[6],C[9],C[12]);else if(null!==(C=_.exec(E)))h(C[2],C[6],C[10],C[14],C[3],C[7],C[11],C[15],C[4],C[8],C[12],C[16]);else if(null!==(C=b.exec(E)))h(C[2],C[5],C[8],C[11],void 0,void 0,void 0,void 0,C[3],C[6],C[9],C[12]);else if(null!==(C=w.exec(E))){var A=C[0].substr(1).trim();u===!1?(u=!0,l.name=A):e(A)}else if(/^usemtl /.test(E))l.material.name=E.substring(7).trim();else if(/^mtllib /.test(E));else{if(null===(C=S.exec(E)))throw new Error("Unexpected line: "+E);l.material.smooth="1"===C[1]||"on"===C[1]}}for(var L=new THREE.Group,M=0,P=c.length;P>M;M++){l=c[M];var R=l.geometry,O=new THREE.BufferGeometry;O.addAttribute("position",new THREE.BufferAttribute(new Float32Array(R.vertices),3)),R.normals.length>0?O.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(R.normals),3)):O.computeVertexNormals(),R.uvs.length>0&&O.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(R.uvs),2));var I;null!==this.materials&&(I=this.materials.create(l.material.name)),I||(I=new THREE.MeshPhongMaterial,I.name=l.material.name),I.shading=l.material.smooth?THREE.SmoothShading:THREE.FlatShading;var D=new THREE.Mesh(O,I);D.name=l.name,L.add(D)}return L}}},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(14),i(29)),o=i(119),s=i(45),a=(i(10),i(121)),h=i(126),l=i(127),c=(i(110),i(136)),u=i(117),p=function(t){var e=new a.CrashBody.fromRect(-20,-20,40,40),i=e.getDebugView();o.call(this,100,100,i,e),this.right=t,this.view3d=new c(this),this.view3d.scale.x=this.view3d.scale.y=this.view3d.scale.z=.3,this.type=1,this.active=!0,this.body.position=this.position,this.groups=["GoalKeeper"],this.name="keeper",this.body.setMaxSpeed(2.5),this.ballSkills=new h(this),this.ballSkills.speedRange=1,this.movement=new l(this),this.diveTarget=null,this.diving=!1,this.ballSkills.offset.x=t?-24:24,this.ballSkills.offset.z=38,this.balanceData=null};p.prototype=Object.create(o.prototype),p.prototype.dive=function(t){if(!this.diving){this.diveTarget=t,this.diving=!0,this.body.friction=.9;var e=t.position.x-this.body.position.x,i=t.position.y-this.body.position.y,r=Math.sqrt(e*e+i*i);e/=r,i/=r,this.body.velocity.x=15*e,this.body.velocity.y=15*i,this.body.acceleration.x=0,this.body.acceleration.y=0,this.body.setMaxSpeed(20)}},p.prototype.reset=function(){},p.prototype.update=function(){if(this.diving){var t=this.body.velocity.length();if(this.diveTarget){var e=this.diveTarget.position.x-this.body.position.x,i=this.diveTarget.position.y-this.body.position.y,r=Math.sqrt(e*e+i*i);e/=r,i/=r,this.body.velocity.x=e*t,this.body.velocity.y=i*t}2>t&&(this.diving=!1,this.body.friction=.9,this.body.setMaxSpeed(2.5))}else this.movement.update();this.ballSkills.update(),this.view3d.update(),this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y},p.prototype.kickOut=function(t,e){this.ballSkills.pass(t,e,10,20),this.view3d.animation.play("kick","stand")},p.prototype.onCollideBegin=function(t){var e=t.getOtherObject(this);if("ball"===e.name){var i=e;if(i.perfect&&i.shot)return void(t.ignore=!0);n.sfx.playGroup("croudAngry");var r=i.body.velocity.length();r>15?(i.body.velocity.x*=-1,i.body.velocity.y=s.randomSign()*s.random(3,8),i.body.velocity.setLength(.5*r)):(t.ignore=!0,i.owner&&i.owner.ballSkills.releaseBall(),this.ballSkills.pickupBall(i),this.diveTarget=null,this.diving=!1)}else"player"===e.name&&(e.state===u.PLAYER_STATE.KICK_CHARGE&&e.shootRelease(this),t.ignore=!0)},r.exports=p}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(10)),o=i(110),s=i(33),s=(i(119),i(33)),a=(i(121),i(20)),h=i(123),l=(new n.PlaneGeometry(200,200),i(117)),c=(l.PLAYER_STATE,function(t){n.Object3D.call(this),this.keeper=t,this.scale.x=this.scale.y=this.scale.z=.22,this.flipContainer=new n.Object3D,this.flipContainer.rotation.x=-Math.PI+.6,this.add(this.flipContainer),this.keeperMesh=new o.getMesh,this.flipContainer.add(this.keeperMesh),t.right&&(this.flipContainer.scale.x*=-1),this.animation=new h,this.animation.register("run",{frames:s.getTexturesFromFramesWithPrefix("characters_goalkeeper_stand00%%.png",3,1),loop:!0}),this.animation.register("stand",{frames:s.getTexturesFromFramesWithPrefix("characters_goalkeeper_stand00%%.png",3,1),loop:!0}),this.animation.register("kick",{frames:s.getTexturesFromFramesWithPrefix("characters_goalkeeper_kick00%%.png",10,1),loop:!1}),this.animation.register("jump",{frames:s.getTexturesFromFramesWithPrefix("characters_goalkeeper_jumpup00%%.png",1,10),loop:!1}),this.animation.play("stand")});c.prototype=Object.create(n.Object3D.prototype),c.prototype.setData=function(t){},c.prototype.update=function(){this.animation.update(a.game.deltaTime),this.count++,o.setUvs(this.keeperMesh,this.animation.texture)},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(10),s=i(119),a=(i(121),i(110)),h=(i(111),function(){for(var t=n.Sprite.from(ASSET_URL+"img/game/toon_pitch_full.jpg"),e=new o.PlaneGeometry(1800,1100),i=new n.Container,r=0;8>r;r++){var h=n.Sprite.from(ASSET_URL+"img/sponsor/board"+(r%2+1)+".png");h.x=305*r,i.addChild(h)}var l=o.ImageUtils.loadTexture(ASSET_URL+"img/game/toon_pitch_full.jpg"),c=new o.MeshBasicMaterial({map:l});c.side=o.DoubleSide,c.polygonOffset=!0,c.polygonOffsetFactor=40,this.view3d=new o.Mesh(e,c),this.view3d.position.x=800,this.view3d.position.y=450,s.call(this,0,0,t);var l=a.getPixiTexture(i),c=new o.MeshBasicMaterial({map:l});c.side=o.DoubleSide,c.transparent=!0,boardGeometry=new o.PlaneGeometry(i.width,82),this.boardMesh=new o.Mesh(boardGeometry,c),this.view3d.add(this.boardMesh),this.boardMesh.rotation.x=Math.PI/2-.8,this.boardMesh.position.z=25,this.boardMesh.position.y=500,this.addCrowd(),this.addRunoff(),this.frontCrowd(),this.groups=["Pitch"];var u=n.Texture.from(ASSET_URL+"img/sponsor/pitch-logo.png"),p=new o.Texture;p.image=u.baseTexture.source,p.needsUpdate=!0;var c=new o.MeshBasicMaterial({map:p});c.side=o.DoubleSide,c.transparent=!0,c.depthTest=!1,c.opacity=.5,logoGeometry=new o.PlaneGeometry(336,336),this.logoMesh=new o.Mesh(logoGeometry,c),this.view3d.add(this.logoMesh)});h.prototype=Object.create(s.prototype),h.prototype.showLogo=function(){this.logoMesh.visible=!0,this.logoMesh.material.opacity=.4,TweenLite.to(this.logoMesh.material,.5,{opacity:0,onComplete:function(){this.logoMesh.visible=!1}.bind(this),delay:8})},h.prototype.hideLogo=function(){TweenLite.to(this.logoMesh.material,.3,{opacity:0,onComplete:function(){this.logoMesh.visible=!1}.bind(this),delay:0})},h.prototype.addCrowd=function(){var t=o.ImageUtils.loadTexture(ASSET_URL+"img/game/stadium-02.jpg");t.repeat.set(6*.3,1.2),t.wrapS=t.wrapT=o.RepeatWrapping;var e=new o.MeshBasicMaterial({map:t});e.side=o.DoubleSide,crowdGeometry=new o.PlaneGeometry(2400,-500),this.crowdMesh=new o.Mesh(crowdGeometry,e),this.view3d.add(this.crowdMesh),this.crowdMesh.rotation.x=-Math.PI/2-1.2,this.crowdMesh.position.z=75,this.crowdMesh.position.y=780,this.crowdMesh.scale.z=-1},h.prototype.addRunoff=function(){var t=o.ImageUtils.loadTexture(ASSET_URL+"img/game/runnoff.png");t.repeat.set(1,3),t.wrapS=t.wrapT=o.RepeatWrapping;var e=new o.MeshBasicMaterial({map:t});e.side=o.DoubleSide,e.polygonOffset=!0,e.polygonOffsetFactor=40;var i=new o.PlaneGeometry(400,1400),r=new o.Mesh(i,e);this.view3d.add(r),r.position.x=-1100,r.position.y=300;var n=new o.Mesh(i,e);this.view3d.add(n),n.scale.x=-1,n.position.x=1100,n.position.y=300},h.prototype.frontCrowd=function(){var t=o.ImageUtils.loadTexture(ASSET_URL+"img/game/front_crowd.png");t.repeat.set(4,1),t.wrapS=t.wrapT=o.RepeatWrapping;var e=new o.MeshBasicMaterial({map:t});e.side=o.DoubleSide,e.transparent=!0;var i=new o.PlaneGeometry(1600,112),r=new o.Mesh(i,e);this.view3d.add(r),r.position.z=106,r.position.y=-586,r.rotation.x=1},h.prototype.reset=function(){},h.prototype.update=function(){},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(119)),o=i(121),s=function(t,e,i,r){var s=new o.CrashBody.fromRect(0,0,i,r);s.type=o.CrashBody.STATIC;var a=s.getDebugView();this.wall=!0,n.call(this,t,e,a,s),this.body.position=this.position,this.groups=["Wall"]};s.prototype=Object.create(n.prototype),s.prototype.reset=function(){},s.prototype.update=function(){},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e){var i=function(t){this.ticker=t,this.updateBind=this.update.bind(this),this.waits=[],this.active=!1};i.prototype.wait=function(t,e,i){var r={callback:e,scope:i,count:t||2};this.waits.push(r),this.active||(this.active=!0,this.ticker.add(this.update,this))},i.prototype.update=function(){for(var t=this.waits.length-1;t>=0;t--){var e=this.waits[t];e.count--,e.count<=0&&(e.callback.call(e.scope),this.waits.splice(t,1))}this.waits.length<0&&(this.active=!1,this.ticker.remove(this.update,this))},t.exports=i},function(t,e,i){var r=(i(7),function(t){});r.constructor=r,r.prototype.get,t.exports=r},function(t,e,i){var r=i(7),n=i(117),o=i(142),s=i(143),a=i(144),h=n.TEAM_STATE,l=n.PLAYER_STATE,c=function(t,e,i){this.game=t,this.team=e,this.teamBad=i,this.state=h.DEFENDING,this.human=!1,this.goal=null,this.firstGo=!1,this.team.children[0].DEBUG=!0,this.team.run(function(e){e.balanceManager=t,e.signals.onBallRecieved.add(this.onPlayerRecievedBall,this),e.signals.onBallLost.add(this.onPlayerLostBall,this)},this),this.teamBad.run(function(t){t.signals.onBallRecieved.add(this.onPlayerBadRecievedBall,this),t.signals.onBallLost.add(this.onPlayerBadLostBall,this)},this),this.game.keeperLeft.signals.onBallRecieved.add(this.onKeeperRecievedBall,this),this.game.keeperRight.signals.onBallRecieved.add(this.onKeeperRecievedBall,this),this.game.keeperLeft.signals.onBallLost.add(this.onKeeperLostBall,this),this.game.keeperRight.signals.onBallLost.add(this.onKeeperLostBall,this),this.debug=new r.Text("HI MUM"),this.signCount=0};c.constructor=c,c.prototype.setSide=function(t){this.left!==t&&(this.left=t,t?(this.team.children[0].startPosition.set(300,100),this.team.children[1].startPosition.set(200,300),this.team.children[2].startPosition.set(100,400),this.goal=this.game.goalRight,this.keeper=this.game.keeperRight,this.balanceData=this.game.balanceManager.teamA):(this.team.children[0].startPosition.set(700,100),this.team.children[1].startPosition.set(600,300),this.team.children[2].startPosition.set(500,400),this.goal=this.game.goalLeft,this.keeper=this.game.keeperLeft,this.balanceData=this.game.balanceManager.teamB),this.keeper.balanceData=this.balanceData,this.team.children[0].balanceData=this.balanceData,this.team.children[1].balanceData=this.balanceData,this.team.children[2].balanceData=this.balanceData)},c.prototype.setTeam=function(t){for(var e=0;e<this.team.children.length;e++)this.team.children[e].setData(t[e])},c.prototype.resetPositions=function(t,e){var i=this.team.children;this.setState(h.KICK_OFF),this.setPlayer(null),t?e?(this.resetPlayerAt(i[0],.2,.4),this.resetPlayerAt(i[1],.2,.6),this.resetPlayerAt(i[2],.45,.5)):(i[0].reset(),i[1].reset(),i[2].reset(),i[0].position.set(800,50),i[1].position.set(800,50),i[2].position.set(800,50),this.movePlayerTo(i[0],.2,.4),this.movePlayerTo(i[1],.2,.6),this.movePlayerTo(i[2],.45,.5)):e?(this.resetPlayerAt(i[0],.15,.4),this.resetPlayerAt(i[1],.15,.6),this.resetPlayerAt(i[2],.4,.5)):(i[0].reset(),i[1].reset(),i[2].reset(),i[0].position.set(800,50),i[1].position.set(800,50),i[2].position.set(800,50),this.movePlayerTo(i[0],.15,.4),this.movePlayerTo(i[1],.15,.6),this.movePlayerTo(i[2],.4,.5))},c.prototype.go=function(){this.firstGo=!0,this.setState(h.DEFENDING),this.team.children[2].movement.direction.x=1,this.team.children[2].movement.direction.y=0},c.prototype.happy=function(){this.setState(h.SCORED)},c.prototype.sad=function(){this.setState(h.LOST)},c.prototype.stopActivePlayer=function(){this.activePlayer&&this.human&&this.activePlayer.stop()},c.prototype.moveActivePlayerInDirection=function(t,e){this.activePlayer&&this.human&&this.activePlayer.moveInDirection(t,e)},c.prototype.setPlayer=function(t){this.activePlayer!==t&&(this.activePlayer&&(this.activePlayer.stop(),this.activePlayer.auto=!0,this.activePlayer.view3d.reticle.visible=!1),this.activePlayer=t,t&&this.human&&(t.auto=!1,t.view3d.reticle.visible=!0,t.stop()))};var u={};u[h.ATTACKING]="attack",u[h.DEFENDING]="defending",u[h.ATTACK_IDLE]="attack_idle",u[h.KICK_OFF]="kickoff",u[h.DEFEND_IDLE]="defend_idle",u[h.SCORED]="scored",u[h.LOST]="lost",c.prototype.setState=function(t){this.state!==t&&(this.debug.text="state "+u[t],this.makeDecision=!0,t===h.SCORED?this.team.run(function(t){t.win()}):t===h.LOST&&this.team.run(function(t){t.lose()}),t===h.ATTACKING||t===h.DEFENDING?this.keeper.active=!0:this.keeper.active=!1,this.state=t)},c.prototype.actionOneBegin=function(){this.state===h.ATTACKING&&this.activePlayer.shootBegin(this.goal)},c.prototype.actionOneEnd=function(){this.activePlayer.shootRelease(this.goal)},c.prototype.actionTwoBegin=function(){if(this.state===h.ATTACKING){var t=o(this.activePlayer,this.team);t.player?this.activePlayer.ballSkills.passTo(t.player):this.activePlayer.ballSkills.pass(t.dx,t.dy,10)}else if(!(this.state!==h.DEFENDING||this.activePlayer&&this.activePlayer.ball)){var t=o(this.activePlayer,this.teamBad);this.activePlayer.slideTackle(t.dx,t.dy,10)}},c.prototype.actionTwoEnd=function(){},c.prototype.update=function(){var t=this.game.pitchWidth,e=(this.game.pitchHeight,this.team),i=this.team.getIndex(this.activePlayer),r=this.activePlayer,n=e.getItem((i+1)%3),o=e.getItem((i+2)%3);o.position.x>n.position.x;var l=160;if(this.state===h.DEFENDING){this.makeDecision&&(this.makeDecision=!1);var c=this.team.getItem(0),u=this.team.getItem(1),p=this.team.getItem(2);this.game.ball.position.x>.4*t?(this.movePlayerTo(c,.5,.5),this.movePlayerTo(u,.3,.6),this.movePlayerTo(p,.2,.4)):this.game.ball.position.x>.5*t?(this.movePlayerTo(c,.8,.5),this.movePlayerTo(u,.5,.6),this.movePlayerTo(p,.3,.4)):(this.movePlayerTo(c,.8,.5),this.movePlayerTo(u,.7,.4),this.movePlayerTo(p,.5,.4));var d=s(this.game.ball,this.team);d.player.movement.turnMultiplier=.2*this.balanceData.turnMultiplier,d.player.chaseDown(this.game.ball);var f=a(this.game.ball,this.activePlayer,this.team,this.left);this.setPlayer(f.player)}else if(this.state===h.ATTACKING){var m=this.team.getItem(0),g=this.team.getItem(1),v=this.team.getItem(2);if(this.human)if(this.game.ball.position.x<.3*t)this.movePlayerTo(m,.5,.4),this.movePlayerTo(v,.2,.75),this.movePlayerTo(g,.2,.25);else{if(this.left)var y=Math.max(r.position.x,.8*t),x=r.position.x-200;else var y=Math.min(r.position.x,.2*t),x=r.position.x+200;r.position.y<450?o.moveTo(y,r.position.y+l+100):o.moveTo(y,r.position.y-l-50),n.moveTo(x,r.position.y+l)}else{if(o.moveTo(r.position.x,r.position.y-l-100),n.moveTo(r.position.x+200,r.position.y+l),this.signCount+=.02,this.movePlayerTo(r,.81,.5+.1*Math.sin(this.signCount)),r.passWait++,r.ballSkills.ball){var d=s(this.game.ball,this.teamBad);r.passWait>30&&this.agro<.4&&d.len<100&&this.passToPlayer(o)}if(o.position.x>r.position.x&&n.position.x>r.position.x&&r.position.x<500&&(r.passWait=0),r.position.x<this.percentFromGoal(.2)){var _=this.game.pitchHeight;r.position.y>.25*_&&r.position.y<.75*_?r.shootRelease(this.goal):this.passToPlayer(o)}else r.passWait>90?this.passToPlayer(Math.random()>.5?o:n):r.passWait>40?o.position.x<this.activePlayer.position.x&&this.passToPlayer(o):r.passWait>10;if(!this.game.ball.owner){var d=s(this.game.ball,this.team);d.player.movement.turnMultiplier=.2*this.balanceData.turnMultiplier,d.player.chaseDown(this.game.ball)}}}else if(this.state===h.DEFEND_IDLE){var c=this.team.getItem(0),u=this.team.getItem(1),p=this.team.getItem(2);this.movePlayerTo(c,.2,.5),this.movePlayerTo(u,.3,.3),this.movePlayerTo(p,.6,.4)}else if(this.state===h.ATTACK_IDLE){var c=this.team.getItem(0),u=this.team.getItem(1),p=this.team.getItem(2);this.movePlayerTo(c,.4,.5),this.movePlayerTo(u,.6,.3),this.movePlayerTo(p,.6,.2)}},c.prototype.passToPlayer=function(t){t!==this.activePlayer&&t.state!==l.FALL&&this.activePlayer.ballSkills.passTo(t)},c.prototype.resetPlayerAt=function(t,e,i){this.left?(t.position.x=this.game.pitchWidth*e,t.position.y=this.game.pitchHeight*i):(t.position.x=this.game.pitchWidth*(1-e),t.position.y=this.game.pitchHeight*(1-i)),t.reset()},c.prototype.movePlayerTo=function(t,e,i){t.movement.turnMultiplier=1,t.movingTo=!1,t.ballSkills.ball||(t.movingTo=!0),this.left?t.moveTo(this.game.pitchWidth*e,this.game.pitchHeight*i):t.moveTo(this.game.pitchWidth*(1-e),this.game.pitchHeight*(1-i))},c.prototype.onPlayerRecievedBall=function(t){if((Math.random()>.5||this.firstGo)&&(this.firstGo=!1,!this.human)){var e=this.team,i=e.getIndex(t),r=e.getItem((i+1)%3),n=e.getItem((i+2)%3),o=Math.random();o>.25&&(o>.75?this.passToPlayer(r):this.passToPlayer(n))}for(var s=0;s<this.team.children.length;s++);this.agro=Math.random(),this.setPlayer(t),this.setState(h.ATTACKING)},c.prototype.onPlayerLostBall=function(t){var e=.5*this.game.pitchWidth;this.left?this.game.ball.position.x<e&&this.setState(h.DEFENDING):this.game.ball.position.x>e&&this.setState(h.DEFENDING);for(var i=0;i<this.team.children.length;i++)this.team.children[i].chaseWait=0},c.prototype.percentFromGoal=function(t){return this.left&&(t=1-t),this.game.pitchWidth*t},c.prototype.onPlayerBadRecievedBall=function(t){var e=s(this.game.ball,this.team);this.setPlayer(e.player),this.setState(h.DEFENDING)},c.prototype.onPlayerBadLostBall=function(t){this.setState(h.DEFENDING)},c.prototype.onKeeperRecievedBall=function(t){t===this.keeper?this.setState(h.ATTACK_IDLE):this.setState(h.DEFEND_IDLE)},c.prototype.onKeeperLostBall=function(t){this.setState(h.DEFENDING)},t.exports=c},function(t,e,i){var r=i(117),n=r.PLAYER_STATE,o={dx:0,dy:0,player:null},s=function(t,e){for(var i,r=e.children,s=t.movement.direction.x,a=t.movement.direction.y,h=1/0,l=null,c=s,u=a,p=0;p<r.length;p++)if(i=r[p],i!==t&&i.state!==n.FALL){var d=i.position.x-t.position.x,f=i.position.y-t.position.y,m=Math.sqrt(d*d+f*f);d/=m,f/=m;var g=d*s+f*a;g>.6&&h>m&&(c=d,u=f,l=i,h=m)}return o.dx=c,o.dy=u,o.player=l,o};t.exports=s},function(t,e,i){var r=i(117),n=r.PLAYER_STATE,o={dx:0,dy:0,player:null},s=function(t,e){for(var i,r=e.children,s=1/0,a=r[0],h=0,l=0,c=0;c<r.length;c++)if(i=r[c],i!==t&&i.state!==n.FALL){var u=i.position.x-t.position.x,p=i.position.y-t.position.y,d=Math.sqrt(u*u+p*p);u/=d,p/=d,s>d&&(h=u,l=p,a=i,s=d)}return o.dx=h,o.dy=l,o.len=s,o.player=a,o};t.exports=s},function(t,e,i){var r=i(117),n=r.PLAYER_STATE,o={dx:0,dy:0,player:null},s=function(t,e,i,r){for(var s,a=i.children,h=1/0,l=a[0],c=0,u=0,p=0;p<a.length;p++)if(s=a[p],s.state!==n.FALL){var d=s.position.x-t.position.x,f=s.position.y-t.position.y,m=Math.sqrt(d*d+f*f);d/=m,f/=m,s===e&&(m-=100),h>m&&(c=d,u=f,l=s,h=m)}return o.dx=c,o.dy=u,o.player=l,o};t.exports=s},function(t,e,i){var r=(i(7),i(117)),n=i(45),o=i(142),s=(r.TEAM_STATE,function(t,e,i){this.game=i,this.left=e,this.keeper=t,e?(this.goal=i.goalLeft,this.teamBad=i.teamLeft,this.team=i.teamRight):(this.goal=i.goalRight,this.team=i.teamLeft,this.teamBad=i.teamRight),this.keeperHome=this.goal.position.clone(),e?this.keeperHome.x=40:this.keeperHome.x-=40,this.keeper.signals.onBallRecieved.add(this.onRecievedBall,this),this.keeper.signals.onBallLost.add(this.onLostBall,this),this.closeDownDistance=300,this.active=!0});s.constructor=s,s.prototype.onRecievedBall=function(){if(this.left){var t=Math.min(this.goal.position.x+320,this.keeper.position.x+100);this.keeper.movement.moveTo(t,this.keeper.position.y)}else{var t=Math.max(this.goal.position.x-220,this.keeper.position.x-100);this.keeper.movement.moveTo(t,this.keeper.position.y)}this.active=!1,this.game.wait.wait(120,function(){this.keeper.movement.moveTo(this.keeperHome.x,this.keeperHome.y),this.left?this.keeper.movement.direction.set(1,0):this.keeper.movement.direction.set(-1,0);var t=o(this.keeper,this.teamBad);this.keeper.kickOut(t.dx,t.dy),this.active=!0},this)},s.prototype.update=function(){if(this.active){var t=this.game.ball,e=Math.abs(t.position.x-this.goal.position.x),i=Math.abs(t.position.y-this.goal.position.y),r=Math.sqrt(e*e+i*i);if(220>r&&t.active&&this.keeper.dive(t),e<this.closeDownDistance&&200>i&&t.active)this.keeper.movement.follow(t);else{var o=this.goal.position.y;600>e&&(o=n.cap(t.position.y,this.goal.position.y-20,this.goal.position.y+20)),this.keeper.movement.moveTo(this.keeperHome.x,o)}var s=this.keeper;s.right?s.body.velocity.x<0&&s.body.position.x<this.goal.position.x-300&&(s.body.velocity.x*=0):s.body.velocity.x>0&&s.body.position.x>this.goal.position.x+300&&(s.body.velocity.x*=0)}},s.prototype.onLostBall=function(){},t.exports=s},function(t,e,i){var r=(i(7),i(117)),n=r.TEAM_STATE,o=function(t){this.game=t,this.team=t.teamRight,this.state=n.DEFENDING,this.team.children[0].DEBUG=!0,this.team.run(function(t){t.signals.onBallRecieved.add(this.onPlayerRecievedBall,this)},this),this.resetPositions()};o.constructor=o,o.prototype.resetPositions=function(){this.team.run(function(t){t.moveTo(t.startPosition.x,t.startPosition.y)})},o.prototype.update=function(){this.state===n.ATTACKING},o.prototype.stopActivePlayer=function(){this.activePlayer&&this.activePlayer.stop()},o.prototype.moveActivePlayerInDirection=function(t,e){this.activePlayer&&this.activePlayer.moveInDirection(t,e)},o.prototype.setPlayer=function(t){this.activePlayer!==t&&(this.activePlayer&&this.activePlayer.stop(),this.activePlayer=t)},o.prototype.setState=function(t){this.state!==t&&(this.state=t)},o.prototype.onPlayerRecievedBall=function(t){this.setPlayer(t),this.setState(n.ATTACKING)},t.exports=o},function(t,e,i){var r=(i(139),i(31)),n=i(29),o=function(t){this.game=t,this.active=!1,this.firstRun=!0,this.runID=0};o.prototype.run=function(t,e){this.active=!0,this.runID++,this.game.movieBorders.show(),this.left=e;var i=this.game.ball;i.setActive(!1),i.body.velocity.x=0,i.body.velocity.y=0,i.body.position.x=.5*this.game.pitchWidth,i.body.position.y=.5*this.game.pitchHeight,t&&this.firstRun?e?(this.game.teamManagerA.resetPositions(!0),this.game.teamManagerB.resetPositions(!1)):(this.game.teamManagerA.resetPositions(!1),this.game.teamManagerB.resetPositions(!0)):e?(this.game.teamManagerA.resetPositions(!0,!0),this.game.teamManagerB.resetPositions(!1,!0)):(this.game.teamManagerA.resetPositions(!1,!0),this.game.teamManagerB.resetPositions(!0,!0));var o=150;0===this.game.goalsA&&0===this.game.goalsB&&(this.game.wait.wait(o,function(){this.game.hud.message.show(r.MESSAGE_ID.VS)},this),o+=150);var s=this.runID;this.game.wait.wait(o,function(){this.active&&s===this.runID&&(this.game.hud.message.show(r.MESSAGE_ID.WHISTLE),TweenLite.delayedCall(.5,function(){n.sfx.play("whistle_full_time")}))},this),o+=150,this.game.wait.wait(o,function(){this.active&&s===this.runID&&(this.game.movieBorders.hide(),this.game.ball.setActive(!0),this.game.pitch.hideLogo(),this.left?this.game.teamManagerA.go():this.game.teamManagerB.go(),this.game.timer.start(!0))},this),this.game.pitch.showLogo()},o.prototype.update=function(){},o.prototype.reset=function(){this.active=!1},t.exports=o},function(t,e,i){var r=(i(139),i(31)),n=function(t){this.game=t,this.left=!1,this.active=!1};n.prototype.run=function(t){this.active=!0,this.left=t,this.game.movieBorders.show(.05,1),this.game.flash.flash(),this.game.hud.party.visible=!0,this.game.world.view3d.camera.shake(30),this.game.world.view3d.camera.celebrateMode=!0,this.game.teamManagerA.left===t?(this.game.teamManagerB.happy(),this.game.teamManagerA.sad()):(this.game.teamManagerA.happy(),this.game.teamManagerB.sad()),this.game.hud.message.show(r.MESSAGE_ID.GOAL),this.game.wait.wait(150,function(){this.active&&this.game.hud.message.show(r.MESSAGE_ID.SCORE)},this),this.game.timer.stop(),this.game.ball.setActive(!1),TweenLite.to(this.game.black,.8,{delay:5,alpha:1,ease:Sine.easeOut,onComplete:this.onFadeOut,onCompleteScope:this})},n.prototype.onFadeOut=function(){TweenLite.to(this.game.black,.8,{alpha:0,ease:Sine.easeOut});var t=this.game.ball;t.body.velocity.x=0,t.body.velocity.y=0,t.body.position.x=.5*this.game.pitchWidth,t.body.position.y=.5*this.game.pitchHeight,this.game.world.view3d.camera.celebrateMode=!1,this.game.hud.party.visible=!1,this.active&&this.game.scripts.start.run(!1,this.left)},n.prototype.update=function(){},n.prototype.reset=function(){this.active=!1},t.exports=n},function(t,e,i){var r=(i(139),i(117)),n=i(46),o=i(31),s=i(29),a=function(t){this.game=t,this.active=!1};a.prototype.run=function(t){this.active=!0,t===r.END_STATE.LOSE?(this.game.teamManagerA.sad(),this.game.teamManagerB.happy(),this.game.hud.message.show("lose :/")):t===r.END_STATE.WIN?(this.game.teamManagerA.happy(),this.game.teamManagerB.sad(),this.game.hud.message.show("WIN!!"),this.game.flash.flash(),this.game.hud.party.visible=!0,this.game.world.view3d.camera.shake(30)):t===r.END_STATE.DRAW&&(this.game.teamManagerA.sad(),this.game.teamManagerB.happy(),this.game.hud.message.show("DRAW!!")),n.matchResult.goalsA=this.game.goalsA,n.matchResult.goalsB=this.game.goalsB,this.game.world.view3d.camera.endMode=!0,this.game.ball.body.velocity.x*=.1,this.game.ball.body.velocity.y*=.1,this.game.ball.setActive(!1),this.game.hud.message.show(o.MESSAGE_ID.WHISTLE),TweenLite.delayedCall(.5,function(){this.active&&s.sfx.play("whistle_full_time")}.bind(this)),TweenLite.to(this.game.black,.3,{delay:6,alpha:1,ease:Sine.easeOut,onComplete:this.onFadeOut,onCompleteScope:this})},a.prototype.onFadeOut=function(){TweenLite.to(this.game.black,.3,{alpha:0,ease:Sine.easeOut}),this.game.hud.party.visible=!1,this.game.world.view3d.camera.endMode=!1,this.active&&this.game.gameover()},a.prototype.update=function(){},a.prototype.reset=function(){this.active=!1},t.exports=a},function(t,e,i){var r=(i(139),i(20)),n=i(29),o=function(t){this.game=t,
this.active=!1};o.prototype.run=function(t){this.active=!0,this.game.movieBorders.show(),r.game.stop(),this.game.superMove.onFinish.addOnce(this.onFinish,this),this.game.superMove.show(t.data)},o.prototype.onFinish=function(){this.active&&(r.game.start(),n.sfx.play("big_kick"))},o.prototype.reset=function(){this.active=!1},t.exports=o},function(t,e,i){var r;r=function(t,e,r){var n=i(20),o=i(14),s=function(t,e){this.isOn=!1,this.count=0,this.ticker=e||n.instance,this.duration=60*t,this.onComplete=new o};s.prototype.setDuration=function(t){this.duration=60*t},s.prototype.getDuration=function(){return this.duration/60},s.prototype.start=function(t){this.isOn||(this.ticker.add(this.update,this),this.isOn=!0),t||(this.count=0)},s.prototype.stop=function(){this.isOn=!1,this.ticker.remove(this.update,this)},s.prototype.reset=function(){this.stop(),this.count=0},s.prototype.getRatio=function(){return this.count/this.duration},s.prototype.getSeconds=function(){return this.count/60},s.prototype.getSecondsLeft=function(){return(this.duration-this.count)/60},s.prototype.update=function(){this.count+=this.ticker.deltaTime,this.count>this.duration&&(this.onComplete.dispatch(),this.stop())},r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(50),o=i(153),s=i(119),a=i(45),h=i(154),l=i(156),c=i(157),u=i(158),p=i(20),d=i(159),f=function(t){this.game=t,this.count=100,this.pool=new n(o),this.activePowerups=[],this.maxPowerups=4,this.powerups=[u,c,h,l],this.paused=!1,this.onPowerupActivated=new d,this.firstRun=!0,this.firstRunCount=0,this.powerupStates={},this.world=null,s.call(this,400,50,null,null)};f.constructor=f,f.prototype=Object.create(s.prototype),f.prototype.pause=function(){this.paused=!0},f.prototype.resume=function(){this.paused=!1},f.prototype.clear=function(){var t=this.world.groups.pickup;t&&t.run(function(t){t.destroy()},this)},f.prototype.update=function(){if(!this.paused&&(this.count+=p.game.deltaTime,this.count>1e3)){var t=this.world.groups.pickup;t?t.children.length<this.maxPowerups&&0==this.activePowerups.length&&this.addPickup():this.addPickup()}},f.prototype.addPickup=function(){this.count=0;var t=n.getObject(o);t.timer=0,t.position.x=a.random(400,1200),t.position.y=a.random(250,650);var e=Math.random()*this.powerups.length|0;t.reset(this.powerups[e]),this.world.add(t)},f.prototype.onPickupActivate=function(t){t=t||this.cachePickup},f.prototype.reset=function(t){for(var e=0;e<this.pickups.length;e++){var i=this.pickups[e];this.game.world.remove(i),GameObjectPool.returnObject(i)}this.powerups=t.powerups,this.paused=!1},r.exports=f}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(14),o=i(119),s=i(121),a=(i(20),i(110)),h=(i(123),i(29)),l=i(33),c=function(){var t=new PIXI.DisplayObjectContainer,e=new s.CrashBody.fromRect(-10,-10,20,20);o.call(this,0,0,t,e),this.type=4,this.timer=0,this.tick=100*Math.random(),this.onDead=new n,this.onPickedup=new n,e.position=this.position,this.height=300;var i=a.getMesh("pickup_box.png");this.view3d=i,i.scale.x=i.scale.y=i.scale.z=.2,i.rotation.x=window.test-Math.PI,this.powerup=null,this.groups=["pickup"],this.shadow=a.getMesh(ASSET_URL+"img/game/game_objects/ball-shadow.png",.5,.5),this.shadow.position.z=10,i.material.depthTest=!1,this.shadow.scale.x=this.shadow.scale.y=this.shadow.scale.z=.1,this.shadow.position.z=-6,this.pickupEffect=new PIXI.Sprite.from("pickup_00000.png"),this.pickupEffect.anchor.set(.5),this.pickupEffect.blendMode=PIXI.BLEND_MODES.ADD,this.pickupFrames=l.getTexturesFromFramesWithPrefix("pickup_000%%.png",6),this.frameTick=0,this.pickedUp=!1};c.prototype=Object.create(o.prototype),c.prototype.setType=function(t){this.powerup&&this.view.removeChild(this.powerup.icon),this.powerup=t,this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y},c.prototype.addedToWorld=function(){this.world.view3d.scene.add(this.shadow),this.world.overlay.addChild(this.pickupEffect)},c.prototype.removedFromWorld=function(){this.world.view3d.scene.remove(this.shadow),this.world.overlay.removeChild(this.pickupEffect)},c.prototype.reset=function(t){this.view3d.visible=!0,this.height=300,this.powerup=t,this.landed=!1,this.view3d.position.z=300,this.canCollide=!0,this.pickupEffect.visible=!1,this.shadow.visible=!0,this.pickedUp=!1,t.customIcon?(a.setUvs(this.view3d,PIXI.Texture.from(t.customIcon),.5,.85),this.view3d.scale.x=this.view3d.scale.y=this.view3d.scale.z=.2):(a.setUvs(this.view3d,PIXI.Texture.from("pickup_box.png"),.5,.85),this.view3d.scale.x=this.view3d.scale.y=this.view3d.scale.z=.2),this.shadow.scale.x=this.shadow.scale.y=this.shadow.scale.z=0,TweenLite.to(this.view3d.position,1.5,{z:2,ease:Bounce.easeOut}),TweenLite.to(this.shadow.scale,1.5,{x:.32,y:.32,z:.32,ease:Bounce.easeOut})},c.prototype.update=function(){if(this.timer++,this.timer>=1e4&&this.destroy(),this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y,this.shadow.position.x=this.view3d.position.x,this.shadow.position.y=this.view3d.position.y-5,this.view3d.rotation.x=window.test-Math.PI,this.tick+=.1,this.view3d.rotation.z=.1*Math.sin(1.6*this.tick),this.view3d.scale.x=.2+.01*Math.sin(this.tick),this.view3d.scale.y=.2+.01*Math.cos(this.tick),this.pickedUp){var t=this.world.view3d.toScreenPosition(this);if(this.pickupEffect.position.x=t.x,this.pickupEffect.position.y=t.y,this.frameTick>this.pickupFrames.length)this.destroy();else{var e=this.pickupFrames[0|this.frameTick];this.pickupEffect._texture=e,this.frameTick+=.4}}},c.prototype.activate=function(){this.onPickedup.dispatch(this)},c.prototype.onCollideBegin=function(t){var e=t.getOtherObject(this);if("player"===e.name){var i=this.world.view3d.toScreenPosition(this);h.sfx.play("bonus_box_pickup"),h.sfx.playGroup("croudHappy");var r=30,n=i.x,o=i.y-50,s=!1;r>n||n>1136-r?s=!0:(r>o||o>745-r)&&(s=!0),s||(this.pickedUp=!0,this.canCollide=!1,this.view3d.visible=!1,this.shadow.visible=!1,this.frameTick=0,this.pickupEffect.visible=!0,e.setPowerUp(this.powerup))}},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(121),i(14),i(45),i(151)),o=i(20),s=i(155),a=function(){this.item=null,this.timer=new n(10,o.game),this.timer.onComplete.add(this.stop,this),this.trailEffect=new s,this.dead=!1};a.prototype.reset=function(t){this.trailEffect.item=t,this.item=t,this.dead=!1,this.timer.start(),this.item.speedBoost=!0,this.item.body.setMaxSpeed(4),t.world.view3d.scene.add(this.trailEffect.cloud)},a.prototype.update=function(){this.trailEffect.update(this.item)},a.prototype.stop=function(){this.item.speedBoost=!1,this.dead=!0,this.item.body.setMaxSpeed(3),this.item.world.view3d.scene.remove(this.trailEffect.cloud)},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(14),i(45),i(10)),o=(i(110),["attribute float alpha;","attribute float random;","uniform float tick;","uniform float power;","varying float valpha;","void main() {","    vec3 pos = position;","    pos.z = alpha * 250.0 * mix(0.5, 1.0, random);","    float scaleOff = mix(0.5, 1.0, random);","    vec4 mvPosition = modelViewMatrix * vec4( pos, 1.0 );","    valpha = 1.0-(alpha * 3.0);","    gl_PointSize = (40.0 + (103.0 * (alpha * 3.0) ) )* 2.0 * scaleOff;","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n")),s=["uniform vec3 ucolor;","uniform sampler2D circle;","varying float valpha;","void main() {","    vec4 color = texture2D(circle, gl_PointCoord);","    gl_FragColor = vec4(color.rgb, color.a * valpha * 0.5);","}"].join("\n"),a=function(){this.ratio=0,this.totalDust=20;var t=[];this.count=0,this.targetCount=0;for(var e=0;e<this.totalDust;e++)t.push(140*Math.random(),0,0);var i=new Float32Array(t),r=new n.BufferGeometry;r.addAttribute("position",new n.BufferAttribute(i,3));for(var a=new Float32Array(r.attributes.position.count),e=0;e<a.length;e++)a[e]=0;for(var h=new Float32Array(r.attributes.position.count),e=0;e<h.length;e++)h[e]=Math.random();r.addAttribute("alpha",new n.BufferAttribute(a,1)),r.addAttribute("random",new n.BufferAttribute(h,1)),this.geometry=r;var l=n.ImageUtils.loadTexture(ASSET_URL+"img/smoke_mixed.png");uniforms={ucolor:{type:"c",value:new n.Color(0)},tick:{type:"f",value:0},power:{type:"f",value:0},circle:{type:"t",value:l}};var c=new n.ShaderMaterial({uniforms:uniforms,vertexShader:o,fragmentShader:s,transparent:!0,depthTest:!1}),u=new n.Points(r,c);u.frustumCulled=!1,this.cloud=u,this.ratio=99,this.tick=0};a.prototype.update=function(t){var e=this.cloud.geometry.getAttribute("position"),i=this.cloud.geometry.getAttribute("alpha"),r=e.array,n=i.array;this.count+=.5,this.count%=this.totalDust,this.targetCount;var o=t.body.velocity.length();if(!(this.count%1)&&o>3){var s=t.position.x;t.body.velocity.x>0?s-=20:s+=20,r[3*this.count]=s+10*(Math.random()-.5),r[3*this.count+1]=t.position.y,n[this.count]=0}for(var a=0;a<this.totalDust;a++)n[a]+=.01;e.needsUpdate=!0,i.needsUpdate=!0},r.exports=a}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(121),i(14),i(45),i(151)),s=i(20),a=(i(110),null),h=function(){if(this.item=null,this.timer=new o(8,s.game),this.timer.onComplete.add(this.stop,this),!a){a=[];for(var t=0;40>t;t++){var e=t;10>e&&(e="0"+e);var i=n.Texture.from(ASSET_URL+"img/game/shield/shield_"+e+".png"),r=new THREE.Texture;r.image=i.baseTexture.source,r.needsUpdate=!0,a.push(r)}}var h=new THREE.SphereGeometry(20,32,32),l=a[0],c=new THREE.MeshBasicMaterial({map:l});c.side=THREE.DoubleSide,c.blending=THREE.AdditiveBlending,c.transparent=!0,c.alphaTest=.25;var u=new THREE.Mesh(h,c);this.shieldView=new THREE.Object3D,this.shieldView.position.y=30,this.shieldView.position.z=100,this.ball=u,this.count=0,this.dead=!1;var i=n.Texture.from(ASSET_URL+"img/game/shield_bubble.png"),r=new THREE.Texture;r.image=i.baseTexture.source,r.needsUpdate=!0;var c=new THREE.MeshBasicMaterial({map:r});c.side=THREE.DoubleSide,c.blending=THREE.AdditiveBlending,c.transparent=!0,c.depthTest=!1,c.opacity=.5;var h=new THREE.PlaneGeometry(60,60),p=new THREE.Mesh(h,c);p.rotation.x=window.test-Math.PI,this.outline=p,this.shieldView.scale.x=this.shieldView.scale.y=this.shieldView.scale.z=9,this.shieldView.add(u),this.shieldView.add(this.outline)};h.prototype.reset=function(t){this.item=t,this.dead=!1,this.timer.start(),this.item.canBeTackled=!1,this.item.view3d.add(this.shieldView)},h.prototype.update=function(){this.ball.rotation.y+=.02,this.ball.rotation.x+=.02,this.count+=1,this.ball.material.map=a[(0|this.count)%a.length],this.ball.material.opacity=.2+.5*(Math.sin(.1*this.count)+1)*.6,this.ball.material.needsUpdate=!0},h.prototype.stop=function(t){this.item.canBeTackled=!0,this.dead=!0,this.item.view3d.remove(this.shieldView)},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(121),i(14),i(45)),o=i(151),s=i(20),a=i(10),h=i(110),l=i(119),c=i(33),u=i(50),p=i(29),d=function(){this.item=null,this.timer=new o(10,s.game),this.timer.onComplete.add(this.stop,this),this.dead=!1};d.prototype.reset=function(t){var e=t.isTeamA?t.world.game.teamLeft:t.world.game.teamRight;p.sfx.play("electro_cute"),e.run(function(t){if(t.ballSkills.ball){var e=Math.random()*Math.PI*2;t.ballSkills.pass(Math.sin(e),Math.cos(e),5,10)}t.fallOver(),t.fallWait=-30;var i=u.get(m);i.reset(t),t.world.add(i)},this)},d.prototype.update=function(){},d.prototype.stop=function(){},r.exports=d;var f,m=function(){l.call(this),this.view3d=new a.Object3D;var t=h.getMesh("lightning_03.png",.5,0);this.view3d.scale.x=this.view3d.scale.y=this.view3d.scale.z=.22,this.light=t,t.material.blending=a.AdditiveBlending,this.view3d.add(t),this.view3d.rotation.x=-Math.PI/2,this.tick=0,f||(f=c.getTexturesFromFrames(["lightning_01.png","lightning_02.png","lightning_03.png","lightning_04.png"])),this.life=0,this.target=null};m.prototype=Object.create(l.prototype),m.prototype.reset=function(t){this.target=t,this.life=0,this.position.x=t.position.x,this.position.y=t.position.y+30},m.prototype.update=function(){this.view3d.position.x=this.position.x,this.view3d.position.y=this.position.y,this.tick+=.5,h.setUvs(this.light,f[this.tick%f.length|0],.5,0),this.target.view3d.rotation.y=n.random(-.3,.3),this.life++,this.life>100&&(this.destroy(),this.target.view3d.rotation.y=0)}}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=(i(7),i(121),i(14),i(45),i(151),i(20),function(){this.item=null});n.customIcon="banana-skin.png",n.prototype.reset=function(t){if(t.ballSkills.ball){var e=Math.random()*Math.PI*2;t.ballSkills.pass(Math.sin(e),Math.cos(e),5,10)}t.fallOver(),t.fallWait=-30},n.prototype.update=function(){},n.prototype.stop=function(t){},r.exports=n}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;!function(n){function o(t,e,i,r,n){this._listener=e,this._isOnce=i,this.context=r,this._signal=t,this._priority=n||0}function s(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function a(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){a.prototype.dispatch.apply(t,arguments)}}o.prototype={active:!0,params:null,execute:function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},a.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,i,r){var n,s=this._indexOfListener(t,i);if(-1!==s){if(n=this._bindings[s],n.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else n=new o(this,t,e,i,r),this._addBinding(n);return this.memorize&&this._prevParams&&n.execute(this._prevParams),n},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,r=this._bindings.length;r--;)if(i=this._bindings[r],i._listener===t&&i.context===e)return r;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){return s(t,"add"),this._registerListener(t,!1,e,i)},addOnce:function(t,e,i){return s(t,"addOnce"),this._registerListener(t,!0,e,i)},remove:function(t,e){s(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(t){if(this.active){var e,i=Array.prototype.slice.call(arguments),r=this._bindings.length;if(this.memorize&&(this._prevParams=i),r){e=this._bindings.slice(),this._shouldPropagate=!0;do r--;while(e[r]&&this._shouldPropagate&&e[r].execute(i)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var h=a;h.Signal=a,r=function(){return h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))}(this)},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(14),function(t,e,i){n.Container.call(this),this.w=t,this.h=e,this.ratio=i||.1;var r=(new n.Graphics).beginFill(0).drawRect(0,0,32,32).generateTexture();this.topBar=new n.Sprite(r),this.bottomBar=new n.Sprite(r),this.addChild(this.topBar),this.addChild(this.bottomBar),this.resize(t,e),this.shown=!1,this.topBar.anchor.y=1,this.bottomBar.anchor.y=-1});o.prototype=Object.create(n.Container.prototype),o.prototype.show=function(t){t?(this.topBar.anchor.y=0,this.bottomBar.anchor.y=0):(TweenLite.to(this.topBar.anchor,2,{y:0,ease:Ease.easeIn}),TweenLite.to(this.bottomBar.anchor,2,{y:0,ease:Ease.easeIn}))},o.prototype.hide=function(t){t?(this.topBar.anchor.y=1,this.bottomBar.anchor.y=-1):(TweenLite.to(this.topBar.anchor,2,{y:1,ease:Ease.easeOut}),TweenLite.to(this.bottomBar.anchor,2,{y:-1,ease:Ease.easeOut}))},o.prototype.resize=function(t,e){this.w=t,this.h=e,this.topBar.scale.x=t/32,this.bottomBar.scale.x=t/32;var i=e*this.ratio;this.topBar.scale.y=i/32,this.bottomBar.scale.y=i/32,this.bottomBar.position.y=e-i},r.exports=o}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r=i(46),n=function(t){this.game=t,this.teamA={lastScored:0,goalScorePercentage:.5,speedMod:1,aggressiveness:0,tackleChance:1,turnMultiplier:1},this.teamB={lastScored:0,goalScorePercentage:.5,speedMod:.95,aggressiveness:20,tackleChance:.5,turnMultiplier:1},this.human=this.teamA,this.ai=this.teamB,this.difficulty=1,this.eb=0};n.prototype.update=function(){r.difficulty;this.eb++;var t=this.game.goalsA-this.game.goalsB;-1>=t?(this.ai.goalScorePercentage=.15,this.human.goalScorePercentage=1,this.ai.turnMultiplier=4):t>=1?(this.human.goalScorePercentage=.5,this.ai.goalScorePercentage=.75,this.ai.turnMultiplier=1,1===this.difficulty&&(this.ai.goalScorePercentage*=.5)):(this.human.goalScorePercentage=1,this.ai.goalScorePercentage=.25,this.ai.turnMultiplier=1),this.ai.tackleChance=.5,this.ai.aggressiveness=0,1===this.difficulty&&(this.ai.tackleChance=.75,this.ai.speedMod=1),-3>=t?(this.ai.aggressiveness=200,this.ai.speedMod=.9,this.ai.tackleChance=.3,this.ai.goalScorePercentage=.1):t>=3&&(this.ai.aggressiveness=-50,this.ai.speedMod=1.3,this.ai.tackleChance=1,this.ai.goalScorePercentage=1),this.human.speedMod=1,this.eb>3600&&(t>=0&&(this.human.speedMod=.9),this.eb>7200&&(this.human.speedMod=1.1))},t.exports=n},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=i(163),a=(i(15),i(29)),h=function(){n.Container.call(this),this.onFinish=new o,this.bg=new n.Sprite.from(ASSET_URL+"img/game/bg_superkick_red.jpg"),this.rushBackground=new s,this.addChild(this.bg),this.addChild(this.rushBackground),this.bg.width=1136,this.bg.height=746,this.item=new n.Sprite,this.addChild(this.item),this.item.anchor.set(1),this.item.scale.set(1.5),this.visible=!1,this.pos=new n.Point};h.prototype=Object.create(n.Container.prototype),h.prototype.show=function(t){var e="red";t.spriteSheet.replace("%COLOR%",e);a.sfx.play(t.id),this.item.texture=n.Texture.from(t["super"]),this.visible=!0,this.item.x=0,this.item.y=this.h,this.item.scale.set(1),TweenLite.to(this.item.scale,1.2,{x:1.5,y:1.5,ease:Sine.easeOut}),TweenLite.to(this.item,1,{x:this.w+1.5*this.item.width,onComplete:function(){this.onFinish.dispatch(),this.visible=!1},onCompleteScope:this,delay:.2,ease:Sine.easeIn})},h.prototype.updateTransform=function(){this.rushBackground.update(this.pos),this.containerUpdateTransform()},h.prototype.resize=function(t,e){this.w=t,this.h=e},r.exports=h}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(50),s=i(21);RushBackground=function(t,e,i){n.Container.call(this),this.particals=[],this.particalPool=new o(ParticalTicker),this.max=n.isWebGL?80:5,this.overallScale=i||1,s.instance.isMobile&&(this.max=n.isWebGL?60:10),this.count=0,this.pos=0;for(var r=0;r<this.max;r++){var a=this.particalPool.getObject();a.home.x=-1136*Math.random(),a.position.y=a.home.y=110640*Math.random(),a.speed=new n.Point(5+10*Math.random(),0),a.speed.x*=5,this.particals.push(a),this.addChild(a)}this.w=t||1136,this.h=e||740,this.focalLength=150},RushBackground.prototype=Object.create(n.Container.prototype),RushBackground.prototype.update=function(t){if(this.visible)for(var e=0;e<this.particals.length;e++){var i=this.particals[e],r=this.focalLength/(this.focalLength+i.z),r=this.focalLength/(this.focalLength+i.z);i.scale.x=i.scale.y=.5*r*i.scaleOffset*this.overallScale,i.home.x+=i.speed.x,i.home.y+=i.speed.y,i.position.y=(i.home.y-t.y)*r*.5,i.position.x=(i.home.x-t.x)*r*.5;var n=300;i.position.x+=n;var o=this.w+2*n;i.position.x%=o,i.position.x<0&&(i.position.x+=o),i.position.x-=n,i.position.y%=this.h,i.position.y<0&&(i.position.y+=this.h)}},RushBackground.prototype.resize=function(t){},ParticalTicker=function(){ParticalTicker.globalCount++,n.Sprite.call(this,n.Texture.fromFrame(ParticalTicker.frames[ParticalTicker.globalCount%1])),this.anchor.x=.5,this.anchor.y=.5,this.scaleOffset=1+Math.random(),this.z=-50+-50*Math.random(),this.rotation=0,this.home=new n.Point},ParticalTicker.globalCount=0,ParticalTicker.frames=["superkick_streak_large.png","confetti-blue.png","confetti-red.png","streamer-blue.png","streamer-red.png","streamer-yellow.png"],ParticalTicker.prototype=Object.create(n.Sprite.prototype),r.exports=RushBackground}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(165),o=i(14),s=function(){this.onLoaded=new o,this.localStorage=new n("com.oneeyedrhino.filmclub"),this.save=null};s.prototype.loadGame=function(){this.loadGameFromLocalStorage()},s.prototype.loadGameFromLocalStorage=function(){var t=this.localStorage.getObject("save");t||(t=new a,this.localStorage.storeObject("save",t)),this.save=t,this.onLoaded.dispatch()},s.prototype.isPB=function(t,e){var i=this.save.levelBestScores[t];return e>i},s.prototype.getPB=function(t){var e=this.save.levelBestScores[t];return e},s.prototype.unlockLevel=function(t,e){return this.save.levelBestScores[t-1]>=e?0===this.save.levelStates[t]?(this.save.levelStates[t]=1,this.saveToStorage(),!0):!0:!1},s.prototype.saveScore=function(t,e){var i=this.save.levelBestScores[t];if(this.save.totalScore=this.save.totalScore||0,this.save.totalScore+=e,e>i){for(var r=0;r<this.save.levelBestScores.length;r++){var n=this.save.levelBestScores[r];e>n&&window.Highscores&&window.UserDetails.isUserSignedIn()&&Highscores.setUserScore(function(t){},function(t){},["allatbreak_overall"],[e])}this.save.levelBestScores[t]=e}window.Highscores&&window.UserDetails.isUserSignedIn()&&Highscores.setUserScore(function(t){},function(t){},["allatbreak_total"],[this.save.totalScore]),this.saveToStorage()},s.prototype.saveToStorage=function(){window.Data&&this.localStorage.storeObject("save",this.save)};var a=function(){this.levelStates=[1,0,0,0,0,0,0],this.levelBestScores=[0,0,0,0,0,0,0],this.tutorials=[0,0,0,0,0,0,0],this.totalScore=0};s.instance=new s,r.exports=s}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){var r=function(t){this.id=t||"com.goodboydigital",this.canSave=!1;try{localStorage.setItem(this.id+".access",!0),localStorage.removeItem(this.id+".access",!0),this.canSave=!0}catch(e){}};r.prototype.store=function(t,e){this.canSave&&localStorage.setItem(this.id+"."+t,e)},r.prototype.get=function(t){return this.canSave?localStorage.getItem(this.id+"."+t):void 0},r.prototype.storeObject=function(t,e){this.canSave&&localStorage.setItem(this.id+"."+t,JSON.stringify(e))},r.prototype.getObject=function(t){return this.canSave?JSON.parse(localStorage.getItem(this.id+"."+t)):void 0},r.prototype.remove=function(t){this.canSave&&localStorage.removeItem(this.id+"."+t)},r.prototype.reset=function(){if(this.canSave)for(var t in localStorage)-1!==t.indexOf(this.id+".")&&localStorage.removeItem(t)},i.exports=r}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){CartoonTransition=function(){this.circle=(new PIXI.Graphics).beginFill(1044480).drawCircle(0,0,100)},CartoonTransition.constructor=CartoonTransition,CartoonTransition.prototype.begin=function(t,e,i){this.screenManager=t,this.currentScreen=e,this.nextScreen=i,this.nextScreen.onShow&&this.nextScreen.onShow(),t.container.addChild(this.circle),t.container.mask=this.circle,this.circle.scale.set(this.targetScale),this.currentScreen?(this.currentScreen.onHide&&this.currentScreen.onHide(),TweenLite.to(this.circle.scale,1,{x:.001,y:.001,ease:Sine.easeOut,onComplete:this.onFadeout.bind(this)})):this.onFadeout()},CartoonTransition.prototype.onFadeout=function(){this.currentScreen&&(this.currentScreen.onHidden&&this.currentScreen.onHidden(),this.screenManager.container.removeChild(this.currentScreen)),this.nextScreen.resize&&this.nextScreen.resize(this.screenManager.w,this.screenManager.h),this.screenManager.container.addChild(this.nextScreen),TweenLite.to(this.circle.scale,1.2,{delay:.2,x:this.targetScale,y:this.targetScale,ease:Cubic.easeIn,onComplete:this.onFadein.bind(this)})},CartoonTransition.prototype.onFadein=function(){this.nextScreen.onShown&&this.nextScreen.onShown(),this.screenManager.container.removeChild(this.circle),this.screenManager.container.mask=null,this.screenManager.onTransitionComplete()},CartoonTransition.prototype.onResize=function(t,e){this.w=t,this.h=e,this.targetScale=t/100*1.2,this.circle.x=t/2,this.circle.y=e/2},i.exports=CartoonTransition}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=(i(41),i(35)),a=(i(21),i(46)),h=(i(47),i(31)),l=i(34),c=(i(48),i(15)),u=i(33),p=i(49),d=function(t){n.Container.call(this),this.app=t,this.characters=[],this.pos=new n.Point,this.party=new p(1136,800,1),this.addChild(this.party),this.bg=new n.Container,this.addChild(this.bg),this.title=new s(l.succeed_screen.title,"title-bar-short.png"),this.title.position.set(0,-100),this.bg.addChild(this.title),this.trophy=n.Sprite.fromFrame("trophy-winner.png"),this.trophy.anchor.set(.5,.5),this.trophy.position.set(0,75),this.bg.addChild(this.trophy),this.teamContainer=new n.Container,this.bg.addChild(this.teamContainer),this.nextButton=o.big("icon-back.png"),this.nextButton.icon.rotation=Math.PI,this.nextButton.position.set(450,350),this.nextButton.onPress.add(this.onNextButtonPressed,this),this.bg.addChild(this.nextButton)};d.prototype=Object.create(n.Container.prototype),d.prototype.onNextButtonPressed=function(){this.screenManager.gotoScreenByID(h.SCREEN_ID.LEADERBOARD)},d.prototype.setContent=function(){for(var t=[{x:-250,y:400},{x:-400,y:400},{x:-100,y:400}],e=0;e<this.characters.length;e++){var i=this.characters[e];this.bg.removeChild(i)}this.characters=[];var r,o,s,h,i;for(e=0;e<a.teamA.length;e++)r=t[e],o=a.teamA[e],s=o.spriteSheet.replace("%COLOR%","red"),h=c.getJson("character-animation")[s],i=new n.MovieClip(u.getTexturesFromFrames(h.win)),i.anchor.set(.5,1),i.position.set(r.x,r.y),i.animationSpeed=.3,i.play(),this.bg.addChild(i),this.characters.push(i);for(e=0;e<a.teamB.length;e++)r=t[e],o=a.teamB[e],s=o.spriteSheet.replace("%COLOR%","blue"),h=c.getJson("character-animation")[s],i=new n.MovieClip(u.getTexturesFromFrames(h.lose)),i.anchor.set(.5,1),i.position.set(-r.x,r.y),i.scale.x=-1,i.animationSpeed=.3,i.loop=!1,i.play(),this.bg.addChild(i),this.characters.push(i)},d.prototype.onShow=function(){this.setContent(),this.bg.scale.set(0),this.app.topMenu.normalMode(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},d.prototype.onShown=function(){},d.prototype.updateTransform=function(){this.party.update(this.pos),this.containerUpdateTransform()},d.prototype.resize=function(t,e){this.bg.position.set(t/2,200)},r.exports=d}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=(i(41),i(35)),a=(i(21),i(46)),h=(i(47),i(31)),l=i(15),c=i(33),u=i(34),p=function(t){n.Container.call(this),this.app=t,this.characters=[],this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-various-paused-bg.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new s(u.fail_screen.title,"title-bar-short.png"),this.title.position.set(0,-100),this.bg.addChild(this.title),this.restartButton=o.big("icon-back.png"),this.restartButton.icon.rotation=Math.PI,this.restartButton.position.set(-65,0),this.restartButton.onPress.add(this.onRestartButtonPressed,this),this.bg.addChild(this.restartButton),this.quitButton=o.big("icon-exit.png"),this.quitButton.position.set(65,0),this.quitButton.onPress.add(this.onQuitButtonPressed,this),this.bg.addChild(this.quitButton)};p.prototype=Object.create(n.Container.prototype),p.prototype.onRestartButtonPressed=function(){this.screenManager.gotoScreenByID(h.SCREEN_ID.LEADERBOARD)},p.prototype.onQuitButtonPressed=function(){this.screenManager.gotoScreenByID(h.SCREEN_ID.COUNTRY_SELECT)},p.prototype.setContent=function(){for(var t=[{x:-250,y:400},{x:-400,y:400},{x:-100,y:400}],e=0;e<this.characters.length;e++){var i=this.characters[e];this.bg.removeChild(i)}this.characters=[];var r,o,s,h,i;for(e=0;e<a.teamA.length;e++)r=t[e],o=a.teamA[e],s=o.spriteSheet.replace("%COLOR%","red"),h=l.getJson("character-animation")[s],i=new n.MovieClip(c.getTexturesFromFrames(h.lose)),i.anchor.set(.5,1),i.position.set(r.x,r.y),i.animationSpeed=.3,i.loop=!1,i.play(),this.bg.addChild(i),this.characters.push(i);for(e=0;e<a.teamB.length;e++)r=t[e],o=a.teamB[e],s=o.spriteSheet.replace("%COLOR%","blue"),h=l.getJson("character-animation")[s],i=new n.MovieClip(c.getTexturesFromFrames(h.win)),i.anchor.set(.5,1),i.position.set(-r.x,r.y),i.scale.x=-1,i.animationSpeed=.3,i.play(),this.bg.addChild(i),this.characters.push(i)},p.prototype.onShow=function(){this.setContent(),this.bg.scale.set(0),this.app.topMenu.normalMode(),TweenLite.to(this.bg.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.2})},p.prototype.onShown=function(){},p.prototype.resize=function(t,e){this.bg.position.set(t/2,250)},r.exports=p}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,i){SlideTransition=function(){},SlideTransition.constructor=SlideTransition,SlideTransition.prototype.begin=function(t,e,i){this.screenManager=t,this.currentScreen=e,this.nextScreen=i,this.currentScreen?(this.currentScreen.onHide&&this.currentScreen.onHide(),TweenLite.to(this.currentScreen,.45,{ease:Sine.easeInOut,x:this.reverse?1224:-1224}),this.onFadeout()):this.onFadeout()},SlideTransition.prototype.onFadeout=function(){this.nextScreen.onShow&&this.nextScreen.onShow(),this.nextScreen.resize&&this.nextScreen.resize(this.screenManager.w,this.screenManager.h),this.nextScreen.position.x=this.reverse?-1224:1224,TweenLite.to(this.nextScreen,.45,{x:0,ease:Sine.easeInOut,onComplete:this.onFadein.bind(this)}),this.screenManager.container.addChild(this.nextScreen)},SlideTransition.prototype.onFadein=function(){this.currentScreen&&(this.currentScreen.onHidden&&this.currentScreen.onHidden(),this.screenManager.container.removeChild(this.currentScreen)),this.nextScreen.onShown&&this.nextScreen.onShown(),this.screenManager.onTransitionComplete()},SlideTransition.prototype.resize=function(t,e){this.w=t,this.h=e},i.exports=SlideTransition}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(38),s=i(31),a=i(46),h=i(29),l=i(21),c=function(t){this.app=t,n.Container.call(this),this.muteButton=o.small("icon-sound-on.png"),this.muteButton.onPress.add(this.onMuteButtonPressed,this),this.addChild(this.muteButton),this.pauseButton=o.small("icon-pause.png"),this.pauseButton.alpha=0,this.pauseButton.onPress.add(this.onPauseButtonPressed,this),this.addChild(this.pauseButton),this.backButton=o.small("icon-back.png"),this.backButton.x=82,this.backButton.y=82,this.backButton.alpha=0,this.backButton.onPress.add(this.onBackButtonPressed,this),this.addChild(this.backButton),h.sfx.onMuteToggle.add(this.onMuteToggle,this),h.music.onMuteToggle.add(this.onMuteToggle,this)};c.prototype=Object.create(n.Container.prototype),c.prototype.gameMode=function(){TweenLite.to(this.pauseButton,.3,{alpha:1,ease:Linear.None}),this.backButton.visible=!1},c.prototype.normalMode=function(){
TweenLite.to(this.pauseButton,.3,{alpha:0,ease:Linear.None}),this.showBackButton(l.instance.mobile)},c.prototype.showBackButton=function(t){TweenLite.to(this.backButton,.3,{alpha:t?1:0,ease:Linear.None})},c.prototype.onMuteButtonPressed=function(){a.isMuted?(h.music.unmute(),h.sfx.unmute()):(h.music.mute(),h.sfx.mute()),a.isMuted=!a.isMuted},c.prototype.onPauseButtonPressed=function(){this.app.overlayManager.show(s.OVERLAY_ID.PAUSE)},c.prototype.onBackButtonPressed=function(){this.app.screenManager.gotoScreenByID(s.SCREEN_ID.TITLE)},c.prototype.onMuteToggle=function(){h.music.isMuted&&h.sfx.isMuted?this.muteButton.setIcon("icon-sound-off.png"):this.muteButton.setIcon("icon-sound-on.png")},c.prototype.onShown=function(){},c.prototype.resize=function(t,e){if(this.isMobile){var i=100,r=42;this.muteButton.position.set(t-i-r,82),this.pauseButton.position.set(t-i-r-140,82)}else{var n={width:45,height:38},o={x:40,y:40};this.muteButton.position.set(t-o.x-n.width,o.y+n.height),this.pauseButton.position.set(t-2*(o.x+n.width),o.y+n.height)}},r.exports=c}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=i(14),s=i(17),a=i(53),h=i(172),l=i(173),c=i(174),u=i(31),p=i(18),d=function(t){s.call(this),this.defaultTransition=new p,this.app=t,this.view=new n.Container,this.view.visible=!1,this.shown=!1,this.pauseScreen=new h(t),this.quitScreen=new l(t),this.instructionsScreen=new c(t),this.addScreen(this.pauseScreen,u.OVERLAY_ID.PAUSE),this.addScreen(this.quitScreen,u.OVERLAY_ID.QUIT),this.addScreen(this.instructionsScreen,u.OVERLAY_ID.INSTRUCTIONS),this.addScreen(new n.Container,u.OVERLAY_ID.EMPTY),this.onShow=new o,this.onHide=new o,this.black=n.Sprite.from(ASSET_URL+"img/ui/overlay-background.png"),this.black.anchor.set(.5,.5),this.black.interactive=!0,this.closeButton=a.close("icon-back.png"),this.closeButton.onPress.add(this.goBack,this),this.closeButton.x=1e4,this.closeButton.y=120,this.view.addChild(this.black),this.view.addChild(this.container),this.view.addChild(this.closeButton),this.app.screenManager.container.filterArea=new n.Rectangle(0,0,1e4,1e4)};d.prototype=Object.create(s.prototype),d.prototype.goBack=function(){this.history.pop();var t=this.history.pop();t?this.gotoScreen(t):this.hide()},d.prototype.show=function(t){return this.shown?void this.gotoScreenByID(t,!0):(this.shown=!0,this.history=[],this.gotoScreenByID(t,!0),this.onShow.dispatch(),this.view.alpha=0,this.view.visible=!0,TweenLite.to(this.view,.3,{alpha:1}),void this.closeButton.scale.set(0))},d.prototype.gotoScreen=function(t){void 0===t.hasClose||t.hasClose===!0?(this.closeButton.interactive=!0,TweenLite.to(this.closeButton.scale,.3,{x:this.closeButton.defaultScale,y:this.closeButton.defaultScale,ease:Back.easeOut,delay:.4})):(this.closeButton.interactive=!1,TweenLite.to(this.closeButton.scale,.3,{x:0,y:0,ease:Back.easeOut})),s.prototype.gotoScreen.call(this,t)},d.prototype.hide=function(){this.shown&&(this.shown=!1,this.history=[],this.closeButton.interactive=!1,this.gotoScreenByID(u.OVERLAY_ID.EMPTY),TweenLite.to(this.closeButton.scale,.3,{x:0,y:0,ease:Back.easeOut}),TweenLite.to(this.view,.3,{alpha:0,onComplete:function(){this.view.visible=!1,this.onHide.dispatch()}.bind(this)}))},d.prototype.resize=function(t,e){this.closeButton.x=t/2+320-5,this.closeButton.y=e/2-180-12;var i=Math.max(t,e);this.black.width=this.black.height=i,this.black.position.set(t/2,e/2),s.prototype.resize.call(this,t,e)},d.prototype.onFadeout=function(){this.currentScreen&&(this.currentScreen.onHidden&&this.currentScreen.onHidden(),this.container.removeChild(this.currentScreen)),this.currentScreen=this.nextScreen,this.currentScreen.alpha=0,this.currentScreen.onShow&&this.currentScreen.onShow(),this.currentScreen.resize&&this.currentScreen.resize(this.w,this.h),this.container.addChild(this.currentScreen),TweenLite.to(this.currentScreen,.4,{alpha:1,onComplete:this.onFadein.bind(this)})},r.exports=d}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(53)),s=(i(15),i(35)),a=i(31),h=i(34);PauseScreen=function(t){n.Container.call(this),this.app=t,this.hasClose=!1,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-various-paused-bg.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new s(h.pause_overlay.title,"title-bar-short.png"),this.title.position.set(0,-100),this.addChild(this.title),this.helpButton=o.big("icon-help.png"),this.helpButton.position.set(-130,0),this.helpButton.onPress.add(this.onHelpButtonPressed,this),this.addChild(this.helpButton),this.resumeButton=o.big("icon-back.png"),this.resumeButton.icon.rotation=Math.PI,this.resumeButton.onPress.add(this.onResumeButtonPressed,this),this.addChild(this.resumeButton),this.quitButton=o.big("icon-exit.png"),this.quitButton.position.set(130,0),this.quitButton.onPress.add(this.onQuitButtonPressed,this),this.addChild(this.quitButton)},PauseScreen.prototype=Object.create(n.Container.prototype),PauseScreen.prototype.onHelpButtonPressed=function(){this.app.overlayManager.show(a.OVERLAY_ID.INSTRUCTIONS)},PauseScreen.prototype.onResumeButtonPressed=function(){this.app.overlayManager.hide(),this.app.gameScreen.game.resume()},PauseScreen.prototype.onQuitButtonPressed=function(){this.app.overlayManager.show(a.OVERLAY_ID.QUIT)},PauseScreen.prototype.resize=function(t,e){this.x=t/2,this.y=e/2},r.exports=PauseScreen}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(53)),s=(i(15),i(35)),a=i(31),h=i(34),l=i(46);QuitScreen=function(t){n.Container.call(this),this.app=t,this.hasClose=!1,this.bg=n.Sprite.from(ASSET_URL+"img/ui/panel-various-paused-bg.png"),this.bg.anchor.set(.5,.5),this.addChild(this.bg),this.title=new s(h.quit_overlay.title,"title-bar-short.png"),this.title.position.set(0,-100),this.addChild(this.title),this.yesButton=o.big("icon-tick.png"),this.yesButton.position.set(-65,0),this.yesButton.onPress.add(this.onYesButtonPressed,this),this.addChild(this.yesButton),this.noButton=o.big("icon-cross.png"),this.noButton.position.set(65,0),this.noButton.onPress.add(this.onNoButtonPressed,this),this.addChild(this.noButton)},QuitScreen.prototype=Object.create(n.Container.prototype),QuitScreen.prototype.onYesButtonPressed=function(){this.app.overlayManager.hide(),l.isTournament?this.app.screenManager.gotoScreenByID(a.SCREEN_ID.TITLE):this.app.screenManager.gotoScreenByID(a.SCREEN_ID.TITLE)},QuitScreen.prototype.onNoButtonPressed=function(){this.app.overlayManager.show(a.OVERLAY_ID.PAUSE)},QuitScreen.prototype.resize=function(t,e){this.x=t/2,this.y=e/2},r.exports=QuitScreen}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))},function(t,e,i){var r;r=function(t,e,r){var n=i(7),o=(i(29),i(53),i(15),i(52)),s=i(31);i(34),i(46);InstructionsScreen=function(t){n.Container.call(this),this.app=t,this.hasClose=!1,this.content=new o,this.content.onNextButton.add(this.onNextButtonPressed,this),this.content.onPreviousButton.add(this.onPreviousButtonPressed,this),this.addChild(this.content),this.content.nextButton.visible=!1},InstructionsScreen.prototype=Object.create(n.Container.prototype),InstructionsScreen.prototype.onShow=function(){},InstructionsScreen.prototype.onPreviousButtonPressed=function(){this.app.overlayManager.show(s.OVERLAY_ID.PAUSE)},InstructionsScreen.prototype.onNextButtonPressed=function(){this.app.overlayManager.show(s.OVERLAY_ID.PAUSE)},InstructionsScreen.prototype.resize=function(t,e){this.x=t/2,this.y=e/2},r.exports=InstructionsScreen}.call(e,i,e,t),!(void 0!==r&&(t.exports=r))}]);
 
 console.log(' BUILD VERSION: 8d2dc3f' );